{"category_name":"easy","status":"success","problem_code":"SHOPTRIP","problem_name":"Bear and Shop Trip","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK81\/mandarin\/SHOPTRIP.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK81\/russian\/SHOPTRIP.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK81\/vietnamese\/SHOPTRIP.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n\n<p>Bear Limak is an assistant in the kitchen.\nWhile he doesn't really know how to cook, he can run very fast and thus Chef often sends him to buy new ingredients from shops.<\/p>\n\n<p>Chef needs <b>K<\/b> different ingredients, numbered 1 through <b>K<\/b>.<\/p>\n\n<p>The kitchen is located at the point (0, 0).\nThere are <b>N<\/b> shops.\nThe i-th shop is located at the point (<b>X<\/b><sub>i<\/sub>, <b>Y<\/b><sub>i<\/sub>) and its inventory is described by the string <b>s<\/b><sub>i<\/sub> of length <b>K<\/b>.\nThe i-th character of <b>s<\/b><sub>i<\/sub> is '1' if the i-th ingredient is available in this shop, and '0' otherwise.<\/p>\n\n<p>All <b>N<\/b>+1 points are distinct (the kitchen and the <b>N<\/b> shops).<\/p>\n\n<p>Limak must start from the kitchen, visit some shops and buy all necessary ingredients (each of <b>K<\/b> ingredients should be available in at least one visited shop), and go back to the kitchen.\nWhat is the minimum total distance Limak will cover?\nPrint -1 if it's impossible to get all the ingredients.<\/p>\n\n\n<h3>Input<\/h3>\n\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/p>\n\n<p>The first line of each test case contains two integers <b>N<\/b> and <b>K<\/b> denoting the number of shops and the number of ingredients.<\/p>\n\n<p>The i-th of the next <b>N<\/b> lines contains two integers <b>x<\/b><sub>i<\/sub> and <b>y<\/b><sub>i<\/sub> denoting coordinates of the i-th shop.\nNo two shops are at the same point, and no shop is at the point (0, 0).<\/p>\n\n<p>The i-th of the next <b>N<\/b> lines contains a string <b>s<\/b><sub>i<\/sub> of length <b>K<\/b>, consisting of characters '1' and '0'.\nThe j-th character is '1' if and only if the j-th ingredient is available in this shop.<\/p>\n\n\n<h3>Output<\/h3>\n\n<p>For each test case, output a single line containing the answer: a number -1 if Limak can't get all <b>K<\/b> ingredients, or one real value otherwise \u2014 the minimum total distance.\nThe relative or absolute error shouldn't exceed 10<sup>-6<\/sup>.<\/p>\n\n\n\n<h3>Constraints<\/h3>\n\n<ul>\n<li>1 \u2264 <b>T<\/b> \u2264 10<\/li>\n<li>1 \u2264 <b>N<\/b> \u2264 36<\/li>\n<li>1 \u2264 <b>K<\/b> \u2264\u00a012<\/li>\n<li>-1000 \u2264 <b>x<\/b><sub>i<\/sub>, <b>y<\/b><sub>i<\/sub> \u2264 1000<\/li>\n<\/ul>\n\n\n\n<h3>Example<\/h3>\n\n<pre><b>Input:<\/b>\n5\n3 6\n100 100\n-50 100\n0 -100\n111110\n110011\n001111\n3 6\n100 100\n-50 100\n0 -100\n111110\n110011\n111111\n3 6\n100 100\n-50 100\n0 -210\n111110\n110011\n111111\n3 6\n100 100\n-50 100\n0 -210\n111010\n110011\n111011\n10 10\n763 77\n512 859\n494 362\n-986 -885\n-866 890\n128 553\n-879 981\n449 310\n-406 10\n-955 -475\n0000001000\n1000000000\n0000000100\n0001000000\n0000100000\n0010000000\n0000010000\n0000000001\n0100000000\n0000000010\n\n<b>Output:<\/b>\n403.2247551123\n200.0000000000\n403.2247551123\n-1\n6652.7837723893\n<\/pre>\n\n\n<h3>Explanation<\/h3>\n\n<p><b>Test case 1.<\/b> There are 3 shops, located at points (100, 100), (-50, 100) and (0, -100). The first shop is described by a string \"111110\", which means that ingredients 1 through 5 are available in this shop, but ingredient 6 isn't. The other two shops are described by strings \"110011\" and \"001111\" respectively. Any two shops are enough to get all 6 ingredients (because, for every two shops it's true that each of 6 ingredients is available in at least one of those two shops).<\/p>\n\n<p>To minimize the total distance, Limak should visit the first and the second shop (in any order). For example, his journey can look as follows:<\/p>\n\n<ul>\n<li>Go from the starting point (0, 0) to the first shop (100, 100). The distance is sqrt(100<sup>2<\/sup> + 100<sup>2<\/sup>) = 141.4213562373095.<\/li>\n<li>Go from (100, 100) to (-50, 100). The distance is 150.<\/li>\n<li>Go from (-50, 100) back to the kitchen at (0, 0). The distance is sqrt(50<sup>2<\/sup> + 100<sup>2<\/sup>) = 111.80339887498948<\/li>\n<\/ul>\n\n<p>The total distance is 141.4213562373095 + 150 + 111.80339887498948 = 403.224755112299.<\/p>\n\n<p><b>Test case 2.<\/b> This time the third shop has all the ingredients. It's optimal to visit only this shop and go back to the kitchen.<\/p>\n\n<p><b>Test case 4.<\/b> Limak can't get all ingredients, even if he visits all the shops. The answer is -1.<\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"errichto","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>errichto<\/span>","problem_tester":"mnbvmar","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>mnbvmar<\/span>","date_added":"20-04-2017","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook81'>\n                    cook81\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/dp+bitmask'>\n                    dp+bitmask\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/easy'>\n                    easy\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/errichto'>\n                    errichto\n                <\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SHOPTRIP","user":{"username":null},"time":{"view_start_date":1492972200,"submit_start_date":1492972200,"visible_start_date":1492972200,"end_date":1735669800,"current":1497284112},"todo":false,"problem_status":"unattempted"}