{"category_name":"easy","status":"success","problem_code":"CODON","problem_name":"Node Codon","body":"### Read problem statements in [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME94\/russian\/CODON.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME94\/bengali\/CODON.pdf), and [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME94\/mandarin\/CODON.pdf) as well.\r\n\r\nYou are given an undirected graph with $N$ nodes (numbered $1$ through $N$) and $M$ edges. Each edge connects two distinct nodes. However, there may be multiple edges connecting the same pairs of nodes, and they are considered to be distinct edges. A lowercase English letter is written in each node.\r\n\r\nYou are also given a string $S$ with length $L$. A *beautiful path* is a sequence of $L-1$ edges such that there is a sequence of $L$ nodes with the following properties:\r\n- for each valid $i$, the $i$-th edge connects the $i$-th and $(i+1)$-th of these nodes\r\n- for each valid $i$, the $i$-th character of $S$ is written in the $i$-th of these nodes\r\n\r\nThere are no other restrictions \u2014 a path may visit nodes or edges any number of times in any order.\r\n\r\nDetermine the number of beautiful paths in the graph. Since the answer can be very large, compute it modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains three space-separated integers $N$, $M$ and $L$.\r\n- The second line contains a single string $S$ with length $L$.\r\n- The third line contains a single string with length $N$. For each valid $i$, the $i$-th character of the string is the letter written in the $i$-th node.\r\n- Two lines follow. The first line contains $M$ integers $u_1,\\ldots,u_m$. The second lines contains $M$ integers, $v_1,\\ldots,v_m$. This denotes that there is an edge connecting nodes $u_i$ and to $v_i$. These edges are distinct, even though they may connect the same pair of nodes.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2014 the number of beautiful paths modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 200$\r\n- $2 \\le N \\le 10^3$\r\n- $1 \\le M \\le 10^3$\r\n- $2 \\le L \\le 20$\r\n- $S$ contains only lowercase English letters\r\n- $1 \\le u, v \\le N$\r\n- $u \\neq v$\r\n\r\n### Subtasks\r\n**Subtask #1 (100 points):** original constraints\r\n \r\n### Example Input\r\n```\r\n2\r\n4 4 3\r\naac\r\naaca\r\n1 2 2 1\r\n2 3 4 2\r\n2 1 2\r\naa\r\naa\r\n1\r\n2\r\n```\r\n\r\n### Example Output\r\n```\r\n3\r\n1\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** The three beautiful paths (sequences of edges) are:\r\n- $(1,2)$, passing through nodes $(1,2,3)$ in this order\r\n- $(4,2)$, also passing through nodes $(1,2,3)$\r\n- $(3,2)$, passing through nodes $(4,2,3)$\r\n\r\n**Example case 2:** There is only one beautiful path, which contains only edge $1$. Note that for this path (sequence of edges), there are two valid sequences of nodes: $(1,2)$ and $(2,1)$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME94\/russian\/CODON.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME94\/bengali\/CODON.pdf), and [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME94\/mandarin\/CODON.pdf) as well.\r\n\r\nYou are given an undirected graph with $N$ nodes (numbered $1$ through $N$) and $M$ edges. Each edge connects two distinct nodes. However, there may be multiple edges connecting the same pairs of nodes, and they are considered to be distinct edges. A lowercase English letter is written in each node.\r\n\r\nYou are also given a string $S$ with length $L$. A *beautiful path* is a sequence of $L-1$ edges such that there is a sequence of $L$ nodes with the following properties:\r\n- for each valid $i$, the $i$-th edge connects the $i$-th and $(i+1)$-th of these nodes\r\n- for each valid $i$, the $i$-th character of $S$ is written in the $i$-th of these nodes\r\n\r\nThere are no other restrictions \u2014 a path may visit nodes or edges any number of times in any order.\r\n\r\nDetermine the number of beautiful paths in the graph. Since the answer can be very large, compute it modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains three space-separated integers $N$, $M$ and $L$.\r\n- The second line contains a single string $S$ with length $L$.\r\n- The third line contains a single string with length $N$. For each valid $i$, the $i$-th character of the string is the letter written in the $i$-th node.\r\n- Two lines follow. The first line contains $M$ integers $u_1,\\ldots,u_m$. The second lines contains $M$ integers, $v_1,\\ldots,v_m$. This denotes that there is an edge connecting nodes $u_i$ and to $v_i$. These edges are distinct, even though they may connect the same pair of nodes.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2014 the number of beautiful paths modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 200$\r\n- $2 \\le N \\le 10^3$\r\n- $1 \\le M \\le 10^3$\r\n- $2 \\le L \\le 20$\r\n- $S$ contains only lowercase English letters\r\n- $1 \\le u, v \\le N$\r\n- $u \\neq v$\r\n\r\n### Subtasks\r\n**Subtask #1 (100 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n4 4 3\r\naac\r\naaca\r\n1 2 2 1\r\n2 3 4 2\r\n2 1 2\r\naa\r\naa\r\n1\r\n2","output":"3\r\n1","explanation":"**Example case 1:** The three beautiful paths (sequences of edges) are:\r\n- $(1,2)$, passing through nodes $(1,2,3)$ in this order\r\n- $(4,2)$, also passing through nodes $(1,2,3)$\r\n- $(3,2)$, passing through nodes $(4,2,3)$\r\n\r\n**Example case 2:** There is only one beautiful path, which contains only edge $1$. Note that for this path (sequence of edges), there are two valid sequences of nodes: $(1,2)$ and $(2,1)$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"minh2345","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span class='m-username--link'>minh2345<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"2-01-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/graphs'>graphs<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime94'>ltime94<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/minh2345'>minh2345<\/a>","problem_difficulty_level":"Easy-Medium","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CODON","time":{"view_start_date":1616864402,"submit_start_date":1616864402,"visible_start_date":1616864402,"end_date":1735669800,"current":1643797793},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=CODON","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}