{"category_name":"easy","status":"success","problem_code":"FRIEMEET","problem_name":"Friends Meeting","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/mandarin\/FRIEMEET.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/russian\/FRIEMEET.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/vietnamese\/FRIEMEET.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n\n<p>\nChef and his friend John have not see each other for years. They are both are looking forward to meeting again in the city they both grew up in.\n<\/p>\n\n<p>\nThe city has <b>N<\/b> public squares that they can meet in.\nThe squares are numbered from <b>1<\/b> to <b>N<\/b> and are connected with <b>N-1<\/b> roads. Each road has its own length\n<\/p>\n\n<p>\nIt is known that between two squares there is exactly one path that goes through the roads and squares such that no square appears in the path more than once. Roads do not intersect each other and it takes 0 time to pass through a square.\n<\/p>\n\n<p>\nChef and John have previously met in squares <b>A<sub>1<\/sub><\/b>, <b>A<sub>2<\/sub><\/b>, ..., <b>A<sub>M<\/sub><\/b> so they will meet in one of these squares again.\nTo make this meeting more adventurous they do not agree on the square beforehand. Rather, Chef will pick a random square <b>C<\/b> from this list of squares and John will independently pick a random square <b>J<\/b> from this list of squares. Both random choices will be taken uniformly over the list of squares.\n<\/p>\n\n<p>\nIn the day before the meeting, Chef spoke with his roomate about their plan and asked him to calculate the expected distance between squares that Chef and John randomly pick. Please remember that Chef's roommate knows neither <b>C<\/b> nor <b>J<\/b>. Help him calculate this expected distance.\n<\/p>\n\n<h3>Input<\/h3>\n\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.\n<\/p>\n\n<p>\nThe first line of each test case contains two space-separated integers <b>N<\/b> and <b>M<\/b>.\n<\/p>\n\n<p>\nThe next <b>N-1<\/b> lines contain three space-separated integers <b>V<\/b>, <b>U<\/b>, and <b>L<\/b> describing a road with length <b>L<\/b> between squares <b>V<\/b> and <b>U<\/b>.\n<\/p>\n\n<p>\nThe final line of each case contains <b>M<\/b> space-separated integers <b>A<sub>1<\/sub><\/b>, <b>A<sub>2<\/sub><\/b>, ..., <b>A<sub>M<\/sub><\/b>.\n<\/p>\n\n<h3>Output<\/h3>\n<p>\nFor each test case, output a single line containing two integers <b>numer<\/b> and <b>denom<\/b> separated by a space. These indicate the fraction <b>numer\/denom<\/b> giving expected distance between the squares randomly chosen by Chef and John. This fraction should be reduced so that gcd(<b>numer<\/b>, <b>denom<\/b>) = 1 and <b>denom<\/b> \u2265 1.\n<\/p>\n\n<p><\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>5<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>50000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>M<\/b> \u2264 <b>N<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>V<\/b> \u2264 <b>N<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>U<\/b> \u2264 <b>N<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>L<\/b> \u2264 <b>10000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>A<sub>i<\/sub><\/b> \u2264 <b>N<\/b><\/li>\n<li>The squares <b>A<sub>i<\/sub><\/b> are distinct.<\/li>\n<li><b>Subtask #1 [40 points]: N \u2264  1000<\/b><\/li>\n<li><b>Subtask #2 [60 points]: No additional constraints<\/b><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n<tt>2\n6 2\n1 3 1\n2 3 2\n3 4 3\n4 5 4\n4 6 5\n1 5\n6 6\n1 3 1\n2 3 2\n3 4 3\n4 5 4\n4 6 5\n1 2 3 4 5 6<\/tt>\n\n<b>Output:<\/b>\n<tt>4 1\n29 6<\/tt>\n<\/pre>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"cenadar","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>cenadar<\/span>","problem_tester":"xcwgf666","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","date_added":"29-07-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cenadar'>\n                    cenadar\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/dfs'>\n                    dfs\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/nov16'>\n                    nov16\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/tree'>\n                    tree\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/FRIEMEET","user":{"username":null},"time":{"view_start_date":1479115800,"submit_start_date":1479115800,"visible_start_date":1479115800,"end_date":1735669800,"current":1493558147},"todo":false,"problem_status":"unattempted"}