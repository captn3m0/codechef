---
{"category_name":"easy","problem_code":"GRIDPA","problem_name":"Grid Path","problemComponents":{"constraints":"- $1 \\leq T \\leq 4 \\cdot 10^3$\n- $2 \\leq N \\leq 150$\n- $0 \\leq K \\leq 2 \\cdot N - 2$\n- $1 \\leq A_{i,j} \\leq 10^5$\n- $S_{i,j}$ is either `\u0027.\u0027`  or `\u0027#\u0027`.\n- It is guaranteed that the top-left cell of the grid is a passable cell.\n- Sum $N^2$ over all testcases does not exceed $3 \\cdot 10^5$.\n","constraintsState":true,"subtasks":"","subtasksState":false,"inputFormat":"The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains two space-separated integers $N, K$.\n- $N$  lines follow. The $i^{th}$ of these lines contains a string $S_i$ of length $N$. The $j^{th}$ character of $S_i$ is `\u0027.\u0027` if the cell $(i, j)$ is passable, or `\u0027#\u0027` if it is a blocked cell. \n- Next $N$ lines follow. The $i^{th}$ of these lines contains $N$ space-separated integers  $A_{i,j}$, denoting the number of coins in the cell $(i, j)$.","inputFormatState":true,"outputFormat":"For each test case, print a single line containing one integer - the maximum amount of coin Chef can collect in the path or $-1$ if it is impossible to reach the bottom-right cell.","outputFormatState":true,"sampleTestCases":{"0":{"id":1,"input":"3\n2 1\n.#\n#.\n1 2\n3 4\n3 3\n.#.\n#.#\n..#\n1 1 1\n1 1 1\n1 1 1\n5 4 \n.....\n#####\n.....\n#####\n.....\n2 3 4 1 5\n1 7 15 12 2\n2 5 10 8 3\n9 9 9 9 9\n1 2 3 4 5\n","output":"8\n-1\n62\n","explanation":"**Test case $1$:** Chef breaks the blocked cell $(2, 1)$ and choose the path -\n$\\;(1, 1) \\rightarrow (2, 1) \\rightarrow (2,2)$. Total coins collected in the path is $1 + 3 + 4 = 8$.\n\n**Test case $2$:** There is no way to choose a path of length $3$ such that after breaking the blocked cells in the path, it is possible to reach the bottom-right cell.\n\n**Test case $3$:** Chef chooses the path of consisting of cells $(2, 3),$ $(2, 4)$, $(3, 4)$, $(4, 4)$ and break the blocked cells in this path. Then Chef chooses the path - $(1, 1) \\rightarrow (1, 2) \\rightarrow (1,3) \\rightarrow (2, 3) \\rightarrow (2, 4) \\rightarrow (3, 4) \\rightarrow (4, 4) \\rightarrow (5, 4)$ $\\;\\rightarrow (5, 5)$. Total coins collected in the path is $2 + 3 + 4$ $\\;+ 15 + 12 + 8$ $\\;+ 9 + 4 + 5  = 62$.","isDeleted":false}}},"video_editorial_url":"https://youtu.be/6QIeLiRuODY","languages_supported":{"0":"CPP14","1":"C","2":"JAVA","3":"PYTH 3.6","4":"CPP17","5":"PYTH","6":"PYP3","7":"CS2","8":"ADA","9":"PYPY","10":"TEXT","11":"PAS fpc","12":"NODEJS","13":"RUBY","14":"PHP","15":"GO","16":"HASK","17":"TCL","18":"PERL","19":"SCALA","20":"LUA","21":"kotlin","22":"BASH","23":"JS","24":"LISP sbcl","25":"rust","26":"PAS gpc","27":"BF","28":"CLOJ","29":"R","30":"D","31":"CAML","32":"FORT","33":"ASM","34":"swift","35":"FS","36":"WSPC","37":"LISP clisp","38":"SQL","39":"SCM guile","40":"PERL6","41":"ERL","42":"CLPS","43":"ICK","44":"NICE","45":"PRLG","46":"ICON","47":"COB","48":"SCM chicken","49":"PIKE","50":"SCM qobi","51":"ST","52":"SQLQ","53":"NEM"},"max_timelimit":1,"source_sizelimit":50000,"problem_author":"soumyadeep_21","problem_tester":"","date_added":"25-08-2021","tags":{"0":"dynamic","1":"dynamic","2":"easy","3":"easy","4":"soumyadeep_21","5":"start10","6":"start10"},"problem_difficulty_level":"Unavailable","best_tag":"Dynamic Programming","editorial_url":"https://discuss.codechef.com/problems/GRIDPA","time":{"view_start_date":1630243800,"submit_start_date":1630243800,"visible_start_date":1630243800,"end_date":1735669800},"is_direct_submittable":false,"problemDiscussURL":"https://discuss.codechef.com/search?q=GRIDPA","is_proctored":false,"visitedContests":{},"layout":"problem"}
---
There is a grid containing $N$ rows and $N$ columns. The cell at the $i^{th}$ row from the top and $j^{th}$ column from the left is a passable space if $S_{i,j}$ is `'.'` and a blocked cell if $S_{i,j}$ is `'#'`. 

Chef is at the top-left cell and wants to reach the bottom-right cell. Chef can move one cell down, or right to a passable cell. He can't leave the grid. If Chef is at the cell $(i,j)$, he can collect $A_{i,j}$ coins. 

Now, Chef has a special ability using which he can make all the blocked cells in a path of length $K$ into passable cells. Chef uses this ability before moving from the top-left cell. It is possible that **some of the cells in the chosen $K$ length path are already passable**. More formally, Chef can choose a sequence of $K$ cells such that for each $i$ $(1 \leq i \lt K)$, the $i^{th}$ and $(i+1)^{th}$ cells of the sequence are **adjacent** and make all these $K$ cells passable.

Find the maximum amount of coins Chef can collect in the path from the top-left cell to the bottom-right cell. Print $-1$ if it is impossible to reach the bottom-right cell.


**Note**: Two cells are considered to be *adjacent* if they share a common side. The cell $(i, j)$ has four adjacent cells i.e. the cells $(i - 1, j)$, $(i + 1, j)$, $(i, j - 1)$ and $(i, j + 1)$. It is guaranteed that the top-left cell of the grid is a passable cell.
<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.</div></aside>