{"category_name":"easy","status":"success","problem_code":"PLNTPATH","problem_name":"Planetary Path","body":"In order to expand its reach to the outer universe and ensure universal peace, the [MIB](https:\/\/en.wikipedia.org\/wiki\/Men_in_black) has decided to expand its offices.\nNamely, it has established its office on $N$ most important planets in the universe, with the base station on the planet $S$. Each office has an intergalactic teleporter that connects it to other planet offices. But the teleporters are bound to a planet's policy, so you cannot teleport to any planet you wish.\n\nDue to intergalactic feuds, the planets are divided into $K$ different alliances, numbered $1$ through $K$. You know for each planet $i$, the alliance that it belongs to. In other words, you're given a sequence $A_{1}, A_{2}, \\dots, A_{n}$, which says that planet $i$ belongs to alliance $A_{i}$.\n\nEach planet $i$ has a policy of teleportation to the planets of other alliances:\n- Cost to travel from one planet to another is determined by the alliance of the destination planet. More formally, the cost to reach a planet which belongs to alliance $j$ from planet $i$ is represented as $C_{i, j}$. \n- Intra-alliance travel is free, i.e., if $A_{i} = j$, then $C_{i, j} = 0$. \n- For a planet $i$, there are some forbidden alliances as well. For these alliances, $C_{i, j} = -1$, given that alliance $j$ is forbidden to travel from planet $i$.\n\nAs MIB is bound to follow the intergalactic rules and since they have limited funds (yes, the government is cheap everywhere), they have decided to find the most optimal way to travel to each of the planets from the base station at planet $S$. With all other agents busy with their missions, you are assigned the task to find these minimum-cost paths. This is your first task in MIB, so don't let them down!\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"- $1 \\leq N \\leq 2 * 10^4$\n- $1 \\leq K \\leq min(N, 1000)$\n- $N * K \\leq 2 * 10^6$\n- $1 \\leq A_i \\leq K$\n- $-1 \\leq C_{i,j} \\leq 10^9$","constraintsState":true,"subtasks":"- 30 points : $1 \\leq R \\leq 10000$\n- 70 points : $1 \\leq R \\leq 10^9$\n","subtasksState":false,"statement":"In order to expand its reach to the outer universe and ensure universal peace, the [MIB](https:\/\/en.wikipedia.org\/wiki\/Men_in_black) has decided to expand its offices.\nNamely, it has established its office on $N$ most important planets in the universe, with the base station on the planet $S$. Each office has an intergalactic teleporter that connects it to other planet offices. But the teleporters are bound to a planet's policy, so you cannot teleport to any planet you wish.\n\nDue to intergalactic feuds, the planets are divided into $K$ different alliances, numbered $1$ through $K$. You know for each planet $i$, the alliance that it belongs to. In other words, you're given a sequence $A_{1}, A_{2}, \\dots, A_{n}$, which says that planet $i$ belongs to alliance $A_{i}$.\n\nEach planet $i$ has a policy of teleportation to the planets of other alliances:\n- Cost to travel from one planet to another is determined by the alliance of the destination planet. More formally, the cost to reach a planet which belongs to alliance $j$ from planet $i$ is represented as $C_{i, j}$. \n- Intra-alliance travel is free, i.e., if $A_{i} = j$, then $C_{i, j} = 0$. \n- For a planet $i$, there are some forbidden alliances as well. For these alliances, $C_{i, j} = -1$, given that alliance $j$ is forbidden to travel from planet $i$.\n\nAs MIB is bound to follow the intergalactic rules and since they have limited funds (yes, the government is cheap everywhere), they have decided to find the most optimal way to travel to each of the planets from the base station at planet $S$. With all other agents busy with their missions, you are assigned the task to find these minimum-cost paths. This is your first task in MIB, so don't let them down!","inputFormat":"- The first line will consist of three space-separated integers $N$, $K$, and $S$ (number of planets, number of alliances, and base planet).\n- Second-line will consist of $N$ space-separated integers representing $A_{i}$, the alliance corresponding to the $i^{th}$ planet.\n- Each of the next $N$ lines will consist of $K$ space-separated integers, where the $j^{th}$ integer of the $i^{th}$ line represents $C_{i, j}$, the cost to travel from planet $i$ to alliance $j$.","inputFormatState":true,"outputFormat":"Print $N$ space separated integers, the $i^{th}$ integer representing the minimal cost to reach the $i^{th}$ planet from the base station. For unreachable planets print $-1$.","outputFormatState":true,"sampleTestCases":[{"id":"1","input":"5 3 4\n1 3 1 2 2 \n0 5 -1 \n-1 4 0 \n0 3 -1 \n4 0 -1 \n4 0 3 \n","output":"4 3 4 0 0 \n","explanation":"- As $4$ and $5$ belong to the same component, the cost of traveling in-between is $0$. \n\n- There are multiple shortest paths from $4$ to $1$. They are:\n$4 \\rightarrow 3 \\rightarrow 1, 4 \\rightarrow 5 \\rightarrow 3 \\rightarrow 1$, $4 \\rightarrow 1$, etc. All of these have equal costs, that is $4$.\n\n- Only path from $4$ to $2$ is $4 \\rightarrow 5 \\rightarrow 2$, which costs $3$ units.\n\n- Similarly for node $3$, the cost is $4$ units.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"hitch_hiker42","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>hitch_hiker42<\/span>","problem_tester":"ShivY08","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span class='m-username--link'>shivy08<\/span>","date_added":"18-07-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cdmn2021'>cdmn2021<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dijkstra-algorithm'>dijkstra-algorithm<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy'>easy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hitch_hiker42'>hitch_hiker42<\/a>","problem_difficulty_level":"Easy","user_zen_mode":false,"best_tag":"Dijkstra Algorithm","editorial_url":"https:\/\/discuss.codechef.com\/problems\/PLNTPATH","time":{"view_start_date":1630603800,"submit_start_date":1630603800,"visible_start_date":1630603800,"end_date":1735669800,"current":1643797861},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=PLNTPATH","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}