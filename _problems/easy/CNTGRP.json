{"category_name":"easy","status":"success","problem_code":"CNTGRP","problem_name":"Counting Graphs","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME87\/hindi\/CNTGRP.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME87\/bengali\/CNTGRP.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME87\/mandarin\/CNTGRP.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME87\/russian\/CNTGRP.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME87\/vietnamese\/CNTGRP.pdf) as well.\r\n\r\nOne day, Tanya was studying graph theory. She is very inquisitive, so the following problem soon came to her mind.\r\n\r\nFind the number of undirected unweighted connected simple graphs with $N$ vertices (numbered $1$ through $N$) and $M$ edges, such that for each $i$ ($2 \\le i \\le N$), the shortest path from vertex $1$ to vertex $i$ is unique and its length is equal to $A_i$. In other words, for each $i$ ($2 \\le i \\le N$), there should be exactly one path with length $A_i$ between vertices $1$ and $i$, and there should be no paths with smaller length between these vertices.\r\n\r\nTwo graphs with $N$ vertices are distinct if we can find two vertices $u$ and $v$ such that there is an edge between these vertices in one graph, but not in the other graph.\r\n\r\nSince the answer could be very large, compute it modulo $1,000,000,007$ ($10^9 + 7$).\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $M$.\r\n- The second line contains $N - 1$ space-separated integers $A_2, A_3, \\ldots, A_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the number of graphs modulo $10^9 + 7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 1,000$\r\n- $2 \\le N \\le 10^5$\r\n- $N-1 \\le M \\le \\mathrm{min}\\left(2\\cdot 10^5, \\frac{N(N-1)}{2}\\right)$\r\n- $1 \\le A_i \\le N-1$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $2 \\cdot 10^5$\r\n- the sum of $M$ over all test cases does not exceed $2 \\cdot 10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** $M = N-1$\r\n\r\n**Subtask #2 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n3\r\n4 3\r\n1 2 1\r\n4 6\r\n1 2 1\r\n3 2\r\n2 2\r\n```\r\n\r\n### Example Output\r\n```\r\n2\r\n0\r\n0\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** The two graphs which satisfy all conditions are:\r\n![](https:\/\/i.ibb.co\/whRxmGZ\/graph2.png)\r\n![](https:\/\/i.ibb.co\/rp8rjmc\/graph1.png)\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME87\/hindi\/CNTGRP.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME87\/bengali\/CNTGRP.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME87\/mandarin\/CNTGRP.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME87\/russian\/CNTGRP.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME87\/vietnamese\/CNTGRP.pdf) as well.\r\n\r\nOne day, Tanya was studying graph theory. She is very inquisitive, so the following problem soon came to her mind.\r\n\r\nFind the number of undirected unweighted connected simple graphs with $N$ vertices (numbered $1$ through $N$) and $M$ edges, such that for each $i$ ($2 \\le i \\le N$), the shortest path from vertex $1$ to vertex $i$ is unique and its length is equal to $A_i$. In other words, for each $i$ ($2 \\le i \\le N$), there should be exactly one path with length $A_i$ between vertices $1$ and $i$, and there should be no paths with smaller length between these vertices.\r\n\r\nTwo graphs with $N$ vertices are distinct if we can find two vertices $u$ and $v$ such that there is an edge between these vertices in one graph, but not in the other graph.\r\n\r\nSince the answer could be very large, compute it modulo $1,000,000,007$ ($10^9 + 7$).\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $M$.\r\n- The second line contains $N - 1$ space-separated integers $A_2, A_3, \\ldots, A_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the number of graphs modulo $10^9 + 7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 1,000$\r\n- $2 \\le N \\le 10^5$\r\n- $N-1 \\le M \\le \\mathrm{min}\\left(2\\cdot 10^5, \\frac{N(N-1)}{2}\\right)$\r\n- $1 \\le A_i \\le N-1$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $2 \\cdot 10^5$\r\n- the sum of $M$ over all test cases does not exceed $2 \\cdot 10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** $M = N-1$\r\n\r\n**Subtask #2 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3\r\n4 3\r\n1 2 1\r\n4 6\r\n1 2 1\r\n3 2\r\n2 2","output":"2\r\n0\r\n0","explanation":"**Example case 1:** The two graphs which satisfy all conditions are:\r\n![](https:\/\/i.ibb.co\/whRxmGZ\/graph2.png)\r\n![](https:\/\/i.ibb.co\/rp8rjmc\/graph1.png)","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/M8eCi06elJE","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"sawarnik123","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>sawarnik123<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"23-08-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy'>easy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime87'>ltime87<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/modular-arith'>modular-arith<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/modular-inv'>modular-inv<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/psychik'>psychik<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sawarnik'>sawarnik<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sawarnik123'>sawarnik123<\/a>","problem_difficulty_level":"Easy","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CNTGRP","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797792},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=CNTGRP","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}