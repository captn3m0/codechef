{"category_name":"easy","status":"success","problem_code":"PRT2","problem_name":"Profitable Paths 2","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/hindi\/PRT2.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/bengali\/PRT2.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/mandarin\/PRT2.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/russian\/PRT2.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/vietnamese\/PRT2.pdf) as well.\r\n\r\nYou are given a tree with $N$ vertices (numbered $1$ through $N$) and a sequence of integers $A_1, A_2, \\ldots, A_N$. You may choose an arbitrary permutation $p_1, p_2, \\ldots, p_N$ of the integers $1$ through $N$. For each valid $i$, you should assign the value $A_{p_i}$ to vertex $i$.\r\n\r\nThen, you should choose a vertex of the tree and $K-1$ times, perform one of the following operations:\r\n- Move forward \u2014 move to a vertex which is adjacent to your current vertex. However, you must not move to the vertex in which you were immediately before the previus operation (if it exists).\r\n- Turn around \u2014 stay in your current vertex. You may only do this if it is impossible to move forward. Since you do not move in this operation, you may move forward again afterwards.\r\n\r\nIn this process, you obtain a sequence of vertices $v_1, v_2, \\ldots, v_K$ \u2014 the initial vertex and the vertices in which you were after each operation. Your *score* is $\\sum_{i=1}^K A_{p_{v_i}}$. What is the maximum possible value of this score?\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- Each of the following $N-1$ lines contains two space-separated integers $u$ and $v$ denoting that vertices $u$ and $v$ are connected by an edge.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2014 the maximum possible score.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 1,000$\r\n- $2 \\le N \\le 300,000$\r\n- $1 \\le K \\le 10^9$\r\n- $1 \\le A_i \\le 10^9$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):**\r\n- $N \\le 1,000$\r\n- $K \\le 2,000$\r\n- the sum of $N$ over all test cases does not exceed $2,000$\r\n- the sum of $K$ over all test cases does not exceed $2,000$\r\n\r\n**Subtask #2 (50 points)**: original constraints\r\n\r\n### Example Input\r\n```\r\n3\r\n3 3\r\n1 1 1\r\n1 2\r\n2 3\r\n2 2\r\n1 2\r\n1 2\r\n3 3\r\n1 2 3\r\n1 2\r\n2 3\r\n```\r\n\r\n### Example Output\r\n```\r\n3\r\n3\r\n8\r\n```\r\n\r\n### Explanation\r\n**Example case 3:** We start at vertex $2$, move forward to vertex $3$, then turn around without moving anywhere and end the process. The score is $2 + 3 + 3 = 8$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/hindi\/PRT2.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/bengali\/PRT2.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/mandarin\/PRT2.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/russian\/PRT2.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/vietnamese\/PRT2.pdf) as well.\r\n\r\nYou are given a tree with $N$ vertices (numbered $1$ through $N$) and a sequence of integers $A_1, A_2, \\ldots, A_N$. You may choose an arbitrary permutation $p_1, p_2, \\ldots, p_N$ of the integers $1$ through $N$. For each valid $i$, you should assign the value $A_{p_i}$ to vertex $i$.\r\n\r\nThen, you should choose a vertex of the tree and $K-1$ times, perform one of the following operations:\r\n- Move forward \u2014 move to a vertex which is adjacent to your current vertex. However, you must not move to the vertex in which you were immediately before the previus operation (if it exists).\r\n- Turn around \u2014 stay in your current vertex. You may only do this if it is impossible to move forward. Since you do not move in this operation, you may move forward again afterwards.\r\n\r\nIn this process, you obtain a sequence of vertices $v_1, v_2, \\ldots, v_K$ \u2014 the initial vertex and the vertices in which you were after each operation. Your *score* is $\\sum_{i=1}^K A_{p_{v_i}}$. What is the maximum possible value of this score?\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- Each of the following $N-1$ lines contains two space-separated integers $u$ and $v$ denoting that vertices $u$ and $v$ are connected by an edge.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2014 the maximum possible score.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 1,000$\r\n- $2 \\le N \\le 300,000$\r\n- $1 \\le K \\le 10^9$\r\n- $1 \\le A_i \\le 10^9$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):**\r\n- $N \\le 1,000$\r\n- $K \\le 2,000$\r\n- the sum of $N$ over all test cases does not exceed $2,000$\r\n- the sum of $K$ over all test cases does not exceed $2,000$\r\n\r\n**Subtask #2 (50 points)**: original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3\r\n3 3\r\n1 1 1\r\n1 2\r\n2 3\r\n2 2\r\n1 2\r\n1 2\r\n3 3\r\n1 2 3\r\n1 2\r\n2 3","output":"3\r\n3\r\n8","explanation":"**Example case 3:** We start at vertex $2$, move forward to vertex $3$, then turn around without moving anywhere and end the process. The score is $2 + 3 + 3 = 8$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"ahmad_salah","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span class='m-username--link'>ahmad_salah<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"15-04-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/ahmad_salah'>ahmad_salah<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy'>easy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/greedy'>greedy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime86'>ltime86<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rajarshi_basu'>rajarshi_basu<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/trees'>trees<\/a>","problem_difficulty_level":"Easy","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"","time":{"view_start_date":1595696400,"submit_start_date":1595696400,"visible_start_date":1595696400,"end_date":1735669800,"current":1643797866},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=PRT2","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}