{"category_name":"easy","status":"success","problem_code":"CNDYGAME","problem_name":"Magical Candy Store","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/NOV20\/hindi\/CNDYGAME.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/NOV20\/bengali\/CNDYGAME.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/mandarin\/CNDYGAME.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/NOV20\/russian\/CNDYGAME.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/vietnamese\/CNDYGAME.pdf) as well.\r\n\r\nChef and Chefu are at a magical candy store playing a game with the following rules:\r\n- There are two candy counters; each of them stores an infinite number of candies. At any time, only one of the counters is open and the other is closed.\r\n- Exactly one player is present at each of the counters. Initially, Chef is at the open counter and Chefu is at the closed counter.\r\n- There is a sequence of $N$ **distinct** integers $A_1, A_2, \\ldots, A_N$. The game consists of $R$ turns; in the $i$-th turn, the open counter offers only $C = A_{ (i-1) \\% N + 1}$ candies to the player present at this counter. This player should choose a positive number of candies $M$ to accept, where $1 \\le M \\le C$.\r\n- If this player accepts an odd number of candies, the players have to swap their positions (each player goes to the other counter).\r\n- After each $N$ turns, the counter which was currently open is closed and the counter which was currently closed is opened.\r\n- The primary goal of each player is to maximise his own number of candies after $R$ turns. As a second priority, each player wants to minimise the number of candies his opponent has after $R$ turns.\r\n\r\nYou should process $Q$ queries. In each query, you are given $R$ and you should find the number of candies Chef has after $R$ turns, assuming that both players play the game optimally. Since this number could be very large, compute it modulo $10^9 + 7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains a single integer $Q$.\r\n- Each of the next $Q$ lines contains a single integer $R$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the maximum number of candies Chef can get, modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 25$\r\n- $1 \\le N \\le 10^5$\r\n- $1 \\le A_i \\le 10^9$ for each valid $i$\r\n- $A_1, A_2, \\ldots, A_N$ are pairwise distinct\r\n- $1 \\le Q \\le 10^5$\r\n- $1 \\le R \\le 10^{12}$\r\n- the sum of $N + Q$ over all test cases does not exceed $10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (15 points):**\r\n- $N \\le 10$\r\n- $Q \\le 35$\r\n- $R \\le 35$\r\n\r\n**Subtask #2 (85 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n1\r\n4\r\n4 10 2 1\r\n2\r\n4\r\n5\r\n```\r\n\r\n### Example Output\r\n```\r\n17\r\n21\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** In the $1$-st, $2$-nd and $3$-rd turn, Chef takes $4$, $10$ and $2$ candies ($16$ in total) respectively. In the $4$-th turn, Chef takes $1$ candy ($17$ in total; this is the answer to the first query), which is odd and hence he has to go to the counter which is closed. However, since $N = 4$ turns are just completed, the counter which was currently open closes and the other one (where Chef went) opens. In the $5$-th round, Chef can take $4$ candies, so he has $21$ candies. \r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/NOV20\/hindi\/CNDYGAME.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/NOV20\/bengali\/CNDYGAME.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/mandarin\/CNDYGAME.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/NOV20\/russian\/CNDYGAME.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/vietnamese\/CNDYGAME.pdf) as well.\r\n\r\nChef and Chefu are at a magical candy store playing a game with the following rules:\r\n- There are two candy counters; each of them stores an infinite number of candies. At any time, only one of the counters is open and the other is closed.\r\n- Exactly one player is present at each of the counters. Initially, Chef is at the open counter and Chefu is at the closed counter.\r\n- There is a sequence of $N$ **distinct** integers $A_1, A_2, \\ldots, A_N$. The game consists of $R$ turns; in the $i$-th turn, the open counter offers only $C = A_{ (i-1) \\% N + 1}$ candies to the player present at this counter. This player should choose a positive number of candies $M$ to accept, where $1 \\le M \\le C$.\r\n- If this player accepts an odd number of candies, the players have to swap their positions (each player goes to the other counter).\r\n- After each $N$ turns, the counter which was currently open is closed and the counter which was currently closed is opened.\r\n- The primary goal of each player is to maximise his own number of candies after $R$ turns. As a second priority, each player wants to minimise the number of candies his opponent has after $R$ turns.\r\n\r\nYou should process $Q$ queries. In each query, you are given $R$ and you should find the number of candies Chef has after $R$ turns, assuming that both players play the game optimally. Since this number could be very large, compute it modulo $10^9 + 7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains a single integer $Q$.\r\n- Each of the next $Q$ lines contains a single integer $R$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the maximum number of candies Chef can get, modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 25$\r\n- $1 \\le N \\le 10^5$\r\n- $1 \\le A_i \\le 10^9$ for each valid $i$\r\n- $A_1, A_2, \\ldots, A_N$ are pairwise distinct\r\n- $1 \\le Q \\le 10^5$\r\n- $1 \\le R \\le 10^{12}$\r\n- the sum of $N + Q$ over all test cases does not exceed $10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (15 points):**\r\n- $N \\le 10$\r\n- $Q \\le 35$\r\n- $R \\le 35$\r\n\r\n**Subtask #2 (85 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n4\r\n4 10 2 1\r\n2\r\n4\r\n5","output":"17\r\n21","explanation":"**Example case 1:** In the $1$-st, $2$-nd and $3$-rd turn, Chef takes $4$, $10$ and $2$ candies ($16$ in total) respectively. In the $4$-th turn, Chef takes $1$ candy ($17$ in total; this is the answer to the first query), which is odd and hence he has to go to the counter which is closed. However, since $N = 4$ turns are just completed, the counter which was currently open closes and the other one (where Chef went) opens. In the $5$-th round, Chef can take $4$ candies, so he has $21$ candies.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/FsC8T-55DHw","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"utkarsh911","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>utkarsh911<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"10-10-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/constructive'>constructive<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/game-theory'>game-theory<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/greedy'>greedy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nov20'>nov20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/prefix-sum'>prefix-sum<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/utkarsh911'>utkarsh911<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/utkarsh911'>utkarsh911<\/a>","problem_difficulty_level":"Easy-Medium","user_zen_mode":false,"best_tag":"Game Theory","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CNDYGAME","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797790},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=CNDYGAME","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}