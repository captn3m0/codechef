{"category_name":"easy","status":"success","problem_code":"SPTREE","problem_name":"A Special Tree","body":"You are given a tree with $N$ nodes (numbered $1$ through $N$). There are $K$ special nodes $f_1,f_2,\\ldots,f_K$ in this tree.\r\n\r\nWe define $d(p,q)$ to be the number of edges on the unique path from node $p$ to node $q$.\r\n\r\nYou are given a node $a$. For each node $b$ from $1$ to $N$, find the maximum value of $d(a,u)-d(b,u)$ where $u$ is a special node, as well as any special node $u$ for which that maximum value is attained.\r\n\r\n###Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains three space-separated integers $N$, $K$, $a$.\r\n- The second line contains $K$ space-separated integers $f_1,f_2,\\ldots,f_K$.\r\n- $N-1$ lines follow. For each valid $i$, the $i$-th of these lines contains two space-separated integers $u_i$ and $v_i$ denoting an edge of the tree.\r\n\r\n###Output\r\nFor each test case, print two lines.\r\n\r\nIn the first line print $N$ space-separated integers. For each valid $i$, the $i$-th integer should be the maximum value of $d(a,u)-d(i,u)$ where $u$ is a special node.\r\n\r\nIn the second line print $N$ space-separated integers. For each valid $i$, the $i$-th integer should be any special node $u$ for which the maximum of $d(a,u)-d(i,u)$ is attained.\r\n\r\n###Constraints \r\n- $1 \\le T \\le 200$\r\n- $1 \\le K \\le N \\le 2 \\cdot 10^5$\r\n- $1 \\le a \\le N$\r\n- $1 \\le f_i \\le N$ for each valid $i$\r\n- $f_i \\neq f_j$ for each valid $i$ and $j$ such that $i \\neq j$\r\n- $1 \\le u_i,v_i \\le N$ for each valid $i$\r\n- the graph described on the input is a tree \r\n- the sum of $N$ over all test cases does not exceed $4 \\cdot 10^5$\r\n\r\n\r\n###Subtasks\r\n\r\n**Subtask #1 (10 points):**\r\n- $T \\le 11$\r\n- $N \\le 200$\r\n- the sum of $N$ over all test cases does not exceed $400$\r\n\r\n**Subtask #2 (20 points):**\r\n- $T \\le 51$\r\n- $N \\le 2000$\r\n- the sum of $N$ over all test cases does not exceed $4000$\r\n\r\n**Subtask #3 (30 points):** \r\n- It holds that $u_i=i$, $v_i=i+1$ for each valid $i$.\r\n\r\n**Subtask #4 (40 points):** original constraints\r\n\r\n###Sample Input\r\n```\r\n2\r\n5 1 3\r\n2\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n8 3 2\r\n6 5 8\r\n1 2\r\n2 3\r\n2 4\r\n2 5\r\n4 6\r\n5 7\r\n5 8\r\n```\r\n\r\n###Sample Output\r\n```\r\n1 2 0 1 1\r\n2 2 2 2 2\r\n-1 0 -1 1 1 2 0 2\r\n5 5 5 6 5 6 5 8\r\n```\r\n\t\r\n###Explanation\r\n**Example case 1:**  The following picture shows the tree in the first example case with special nodes in bold:\r\n\r\n<img src=\"https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/LTIME95\/SPTREE\/SPTREE_1.png\">\r\n\r\nThe only special node is the node $2$ and $a=3$. Therefore, the desired maximum is $d(a,2)-d(b,2)=d(3,2)-d(b,2)=2-d(b,2)$ for each node $b$ and it is always attained for the special node $u=2$.\r\n\r\n**Example case 2:** The following picture shows the tree in the second example case with special nodes bolded:\r\n\r\n<img src=\"https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/LTIME95\/SPTREE\/SPTREE_2.png\">\r\n\r\nThe special nodes are $6$, $5$ and $8$, and $a=2$. The maximum values of $d(a,u)-d(b,u)$ ($u$ being a special node) for each $b$ are as follows:\r\n\r\n- $b=1$: The maximum value of $d(2,u)-d(1,u)$ is $-1$ and it is achieved for $u=5$ since $d(2,5)-d(1,5)=1-2=-1$.\r\n\r\n- $b=2$: The maximum value of $d(2,u)-d(2,u)$ is $0$ and it is achieved for $u=5$ since $d(2,5)-d(2,5)=1-1=0$.\r\n\r\n- $b=3$: The maximum value of $d(2,u)-d(3,u)$ is $-1$ and it is achieved for $u=5$ since $d(2,5)-d(3,5)=1-2=-1$.\r\n\r\n- $b=4$: The maximum value of $d(2,u)-d(4,u)$ is $1$ and it is achieved for $u=6$ since $d(2,6)-d(4,6)=2-1=1$.\r\n\r\n- $b=5$: The maximum value of $d(2,u)-d(5,u)$ is $1$ and it is achieved for $u=5$ since $d(2,5)-d(5,5)=1-0=1$.\r\n\r\n- $b=6$: The maximum value of $d(2,u)-d(6,u)$ is $2$ and it is achieved for $u=6$ since $d(2,6)-d(6,6)=2-0=2$.\r\n\r\n- $b=7$: The maximum value of $d(2,u)-d(7,u)$ is $0$ and it is achieved for $u=5$ since $d(2,5)-d(7,5)=1-1=0$.\r\n\r\n- $b=8$: The maximum value of $d(2,u)-d(8,u)$ is $2$ and it is achieved for $u=8$ since $d(2,8)-d(8,8)=2-0=2$.\r\n\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"You are given a tree with $N$ nodes (numbered $1$ through $N$). There are $K$ special nodes $f_1,f_2,\\ldots,f_K$ in this tree.\r\n\r\nWe define $d(p,q)$ to be the number of edges on the unique path from node $p$ to node $q$.\r\n\r\nYou are given a node $a$. For each node $b$ from $1$ to $N$, find the maximum value of $d(a,u)-d(b,u)$ where $u$ is a special node, as well as any special node $u$ for which that maximum value is attained.\r\n\r\n###Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains three space-separated integers $N$, $K$, $a$.\r\n- The second line contains $K$ space-separated integers $f_1,f_2,\\ldots,f_K$.\r\n- $N-1$ lines follow. For each valid $i$, the $i$-th of these lines contains two space-separated integers $u_i$ and $v_i$ denoting an edge of the tree.\r\n\r\n###Output\r\nFor each test case, print two lines.\r\n\r\nIn the first line print $N$ space-separated integers. For each valid $i$, the $i$-th integer should be the maximum value of $d(a,u)-d(i,u)$ where $u$ is a special node.\r\n\r\nIn the second line print $N$ space-separated integers. For each valid $i$, the $i$-th integer should be any special node $u$ for which the maximum of $d(a,u)-d(i,u)$ is attained.\r\n\r\n###Constraints \r\n- $1 \\le T \\le 200$\r\n- $1 \\le K \\le N \\le 2 \\cdot 10^5$\r\n- $1 \\le a \\le N$\r\n- $1 \\le f_i \\le N$ for each valid $i$\r\n- $f_i \\neq f_j$ for each valid $i$ and $j$ such that $i \\neq j$\r\n- $1 \\le u_i,v_i \\le N$ for each valid $i$\r\n- the graph described on the input is a tree \r\n- the sum of $N$ over all test cases does not exceed $4 \\cdot 10^5$\r\n\r\n\r\n###Subtasks\r\n\r\n**Subtask #1 (10 points):**\r\n- $T \\le 11$\r\n- $N \\le 200$\r\n- the sum of $N$ over all test cases does not exceed $400$\r\n\r\n**Subtask #2 (20 points):**\r\n- $T \\le 51$\r\n- $N \\le 2000$\r\n- the sum of $N$ over all test cases does not exceed $4000$\r\n\r\n**Subtask #3 (30 points):** \r\n- It holds that $u_i=i$, $v_i=i+1$ for each valid $i$.\r\n\r\n**Subtask #4 (40 points):** original constraints\r\n\r\n###Sample Input\r\n```\r\n2\r\n5 1 3\r\n2\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n8 3 2\r\n6 5 8\r\n1 2\r\n2 3\r\n2 4\r\n2 5\r\n4 6\r\n5 7\r\n5 8\r\n```\r\n\r\n###Sample Output\r\n```\r\n1 2 0 1 1\r\n2 2 2 2 2\r\n-1 0 -1 1 1 2 0 2\r\n5 5 5 6 5 6 5 8\r\n```\r\n\t\r\n###Explanation\r\n**Example case 1:**  The following picture shows the tree in the first example case with special nodes in bold:\r\n\r\n<img src=\"https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/LTIME95\/SPTREE\/SPTREE_1.png\">\r\n\r\nThe only special node is the node $2$ and $a=3$. Therefore, the desired maximum is $d(a,2)-d(b,2)=d(3,2)-d(b,2)=2-d(b,2)$ for each node $b$ and it is always attained for the special node $u=2$.\r\n\r\n**Example case 2:** The following picture shows the tree in the second example case with special nodes bolded:\r\n\r\n<img src=\"https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/LTIME95\/SPTREE\/SPTREE_2.png\">\r\n\r\nThe special nodes are $6$, $5$ and $8$, and $a=2$. The maximum values of $d(a,u)-d(b,u)$ ($u$ being a special node) for each $b$ are as follows:\r\n\r\n- $b=1$: The maximum value of $d(2,u)-d(1,u)$ is $-1$ and it is achieved for $u=5$ since $d(2,5)-d(1,5)=1-2=-1$.\r\n\r\n- $b=2$: The maximum value of $d(2,u)-d(2,u)$ is $0$ and it is achieved for $u=5$ since $d(2,5)-d(2,5)=1-1=0$.\r\n\r\n- $b=3$: The maximum value of $d(2,u)-d(3,u)$ is $-1$ and it is achieved for $u=5$ since $d(2,5)-d(3,5)=1-2=-1$.\r\n\r\n- $b=4$: The maximum value of $d(2,u)-d(4,u)$ is $1$ and it is achieved for $u=6$ since $d(2,6)-d(4,6)=2-1=1$.\r\n\r\n- $b=5$: The maximum value of $d(2,u)-d(5,u)$ is $1$ and it is achieved for $u=5$ since $d(2,5)-d(5,5)=1-0=1$.\r\n\r\n- $b=6$: The maximum value of $d(2,u)-d(6,u)$ is $2$ and it is achieved for $u=6$ since $d(2,6)-d(6,6)=2-0=2$.\r\n\r\n- $b=7$: The maximum value of $d(2,u)-d(7,u)$ is $0$ and it is achieved for $u=5$ since $d(2,5)-d(7,5)=1-1=0$.\r\n\r\n- $b=8$: The maximum value of $d(2,u)-d(8,u)$ is $2$ and it is achieved for $u=8$ since $d(2,8)-d(8,8)=2-0=2$.\r\n\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"https:\/\/youtu.be\/3K1rmX7XaaY","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"losmi247","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>losmi247<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"2-03-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/binary-lifting'>binary-lifting<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy'>easy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/losmi247'>losmi247<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime95'>ltime95<\/a>","problem_difficulty_level":"Easy","user_zen_mode":false,"best_tag":"Binary Lifting","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SPTREE","time":{"view_start_date":1619802000,"submit_start_date":1619802000,"visible_start_date":1619802000,"end_date":1735669800,"current":1643797885},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SPTREE","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}