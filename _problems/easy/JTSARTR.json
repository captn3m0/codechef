{"category_name":"easy","status":"success","problem_code":"JTSARTR","problem_name":"Joined Subarrays on Tree","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK122\/hindi\/JTSARTR.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK122\/mandarin\/JTSARTR.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK122\/russian\/JTSARTR.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK122\/vietnamese\/JTSARTR.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK122\/bengali\/JTSARTR.pdf) as well.\r\n\r\nAlice thought of a function $F$, which takes an arbitrary array of integers $A = (A_1, A_2, \\ldots, A_M)$ as the only argument and is defined in the following way:\r\n- Consider all pairs of subarrays $(A_i, A_{i+1}, \\ldots, A_j)$ and $(A_k, A_{k+1}, \\ldots, A_l)$ such that:\r\n    - $1 \\le i \\le j \\lt k \\le l \\le M$\r\n    - both subarrays are non-decreasing\r\n    - $A_j \\le A_k$\r\n- If there is no such pair of subarrays, $F(A) = 0$.\r\n- Otherwise, $F(A)$ is the maximum of the expression $(j-i+1) + (l-k+1)$ over all such pairs of subarrays.\r\n\r\nIn other words, you need to choose two non-overlapping non-empty subarrays of $A$ and concatenate them in the same order; the resulting array should be non-decreasing and $F(A)$ is its maximum possible length.\r\n\r\nBob challenged Alice to solve the following problem and she needs your help.\r\n\r\nYou are given a tree with $N$ vertices (numbered $1$ through $N$), rooted at the vertex $1$. There is an integer written in each vertex; for each valid $i$, let's denote the integer written in vertex $i$ by $V_i$. You should choose one vertex \u2015 let's denote it by $v$. Then, consider an array $A$ containing values which are written in vertices on the path from the root to $v$ (inclusive), in this order, and calculate $F(A)$. Find the maximum possible value of $F(A)$ which you can obtain this way.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $V_1, V_2, \\cdot, V_N$.\r\n- Each of the following $N-1$ lines contains two space-separated integers $u$ and $v$ denoting that vertices $u$ and $v$ are connected by an edge.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the maximum of $F(A)$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 1,000$\r\n- $2 \\le N \\le 5 \\cdot 10^5$\r\n- $|V_i| \\le 10^9$ for each valid $i$\r\n- $1 \\le u, v \\le N$\r\n- the sum of $N$ over all test cases does not exceed $10^6$\r\n\r\n### Example Input\r\n```\r\n1\r\n4\r\n2 1 5 3\r\n1 2\r\n1 3\r\n3 4\r\n```\r\n\r\n### Example Output\r\n```\r\n2\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** We choose $v = 3$. Then, $A(3) = (2, 5)$; its subarrays $(2)$ and $(5)$ satisfy all required conditions and the sum of their lengths is $2$. There is no way to get a greater value of the function $F$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK122\/hindi\/JTSARTR.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK122\/mandarin\/JTSARTR.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK122\/russian\/JTSARTR.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK122\/vietnamese\/JTSARTR.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK122\/bengali\/JTSARTR.pdf) as well.\r\n\r\nAlice thought of a function $F$, which takes an arbitrary array of integers $A = (A_1, A_2, \\ldots, A_M)$ as the only argument and is defined in the following way:\r\n- Consider all pairs of subarrays $(A_i, A_{i+1}, \\ldots, A_j)$ and $(A_k, A_{k+1}, \\ldots, A_l)$ such that:\r\n    - $1 \\le i \\le j \\lt k \\le l \\le M$\r\n    - both subarrays are non-decreasing\r\n    - $A_j \\le A_k$\r\n- If there is no such pair of subarrays, $F(A) = 0$.\r\n- Otherwise, $F(A)$ is the maximum of the expression $(j-i+1) + (l-k+1)$ over all such pairs of subarrays.\r\n\r\nIn other words, you need to choose two non-overlapping non-empty subarrays of $A$ and concatenate them in the same order; the resulting array should be non-decreasing and $F(A)$ is its maximum possible length.\r\n\r\nBob challenged Alice to solve the following problem and she needs your help.\r\n\r\nYou are given a tree with $N$ vertices (numbered $1$ through $N$), rooted at the vertex $1$. There is an integer written in each vertex; for each valid $i$, let's denote the integer written in vertex $i$ by $V_i$. You should choose one vertex \u2015 let's denote it by $v$. Then, consider an array $A$ containing values which are written in vertices on the path from the root to $v$ (inclusive), in this order, and calculate $F(A)$. Find the maximum possible value of $F(A)$ which you can obtain this way.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $V_1, V_2, \\cdot, V_N$.\r\n- Each of the following $N-1$ lines contains two space-separated integers $u$ and $v$ denoting that vertices $u$ and $v$ are connected by an edge.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the maximum of $F(A)$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 1,000$\r\n- $2 \\le N \\le 5 \\cdot 10^5$\r\n- $|V_i| \\le 10^9$ for each valid $i$\r\n- $1 \\le u, v \\le N$\r\n- the sum of $N$ over all test cases does not exceed $10^6$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n4\r\n2 1 5 3\r\n1 2\r\n1 3\r\n3 4","output":"2","explanation":"**Example case 1:** We choose $v = 3$. Then, $A(3) = (2, 5)$; its subarrays $(2)$ and $(5)$ satisfy all required conditions and the sum of their lengths is $2$. There is no way to get a greater value of the function $F$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/LGztBRQuHOY","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"manishtanwar","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>manishtanwar<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"18-02-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/binary-search'>binary-search<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/cook122'>cook122<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/depth-first-search'>depth-first-search<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/manishtanwar'>manishtanwar<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/manishtanwar'>manishtanwar<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rahuldugar'>rahuldugar<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rishup_nitdgp'>rishup_nitdgp<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Binary Search","editorial_url":"https:\/\/discuss.codechef.com\/problems\/JTSARTR","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797831},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=JTSARTR","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}