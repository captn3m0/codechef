{"category_name":"easy","status":"success","problem_code":"MIKE1","problem_name":"Mike and Matrices ","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME07\/mandarin\/MIKE1.pdf\">Mandarin Chinese<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME07\/russian\/MIKE1.pdf\">Russian<\/a>.<\/h3>\n<p>Mike is given a matrix <b>A<\/b>, <b>N<\/b> and <b>M<\/b> are numbers of rows and columns respectively. <b>A<sub>1, 1<\/sub><\/b> is the number in the top left corner. All the numbers in <b>A<\/b> are non-negative integers. He also has <b>L<\/b> pairs of integers (<b>i<sub>k<\/sub><\/b>, <b>j<sub>k<\/sub><\/b>). His task is to calculate <b>A<sub>i<sub>1<\/sub>, j<sub>1<\/sub><\/sub><\/b> + <b>A<sub>i<sub>2<\/sub>, j<sub>2<\/sub><\/sub><\/b> + ... + <b>A<sub>i<sub>L<\/sub>, j<sub>L<\/sub><\/sub><\/b>.\n<\/p>\n<p>\nUnfortunately, Mike forgot if <b>A<sub>i, j<\/sub><\/b> was a number in the <b>i<\/b>'th row and <b>j<\/b>'th column or vice versa, if <b>A<sub>i, j<\/sub><\/b> was a number in the <b>j<\/b>'th row and <b>i<\/b>'th column.\n<\/p>\n<p>\nSo, Mike decided to calculate both <b>E<sub>1<\/sub><\/b> = <b>A<sub>i<sub>1<\/sub>, j<sub>1<\/sub><\/sub><\/b> + <b>A<sub>i<sub>2<\/sub>, j<sub>2<\/sub><\/sub><\/b> + ... + <b>A<sub>i<sub>L<\/sub>, j<sub>L<\/sub><\/sub><\/b> and <b>E<sub>2<\/sub><\/b> = <b>A<sub>j<sub>1<\/sub>, i<sub>1<\/sub><\/sub><\/b> + <b>A<sub>j<sub>2<\/sub>, i<sub>2<\/sub><\/sub><\/b> + ... + <b>A<sub>j<sub>L<\/sub>, i<sub>L<\/sub><\/sub><\/b>. If it is impossible to calculate <b>E<sub>1<\/sub><\/b>(i.e. one of the summands doesn't exist), then let's assume, that it is equal to <b>-1<\/b>. If it is impossible to calculate <b>E<sub>2<\/sub><\/b>, then let's also assume, that it is equal to <b>-1<\/b>.\n<\/p>\n<p>\nYour task is to calculate <b>max(<b>E<sub>1<\/sub><\/b>, <b>E<sub>2<\/sub><\/b>)<\/b>.\n<\/p>\n\n<h3>Input<\/h3>\n<p>\nThe first line contains two integers <b>N<\/b> and <b>M<\/b>, denoting the number of rows and the number of columns respectively.<br \/><br \/>\nEach of next <b>N<\/b> lines contains <b>M<\/b> integers. The <b>j<\/b>'th integer in the <b>(i + 1)<\/b>'th line of the input denotes <b>A<sub>i, j<\/sub><\/b>.<br \/>\n<\/p>\n<p>\nThe <b>(N + 2)<\/b>'th line contains an integer <b>L<\/b>, denoting the number of pairs of integers, that Mike has.<br \/><br \/>\nEach of next <b>L<\/b> lines contains a pair of integers. The <b>(N + 2 + k)<\/b>-th line in the input contains a pair (<b>i<sub>k<\/sub><\/b>, <b>j<sub>k<\/sub><\/b>).\n<\/p>\n\n<h3>Output<\/h3>\n<p>The first line should contain an integer, denoting <b>max(<b>E<sub>1<\/sub><\/b>, <b>E<sub>2<\/sub><\/b>)<\/b>.<\/p>\n<h3>Examples<\/h3>\n<pre><b>Input:<\/b>\n3 2\n1 2\n4 5\n7 0\n2\n1 2\n2 2\n<b>Output:<\/b>\n9\n<\/pre>\n<pre><b>Input:<\/b>\n1 3\n1 2 3\n2\n1 3\n3 1\n<b>Output:<\/b>\n-1\n<\/pre>\n<pre><b>Input:<\/b>\n1 3\n1 2 3\n2\n1 1\n3 1\n<b>Output:<\/b>\n4\n<\/pre>\n<h3>Explanation<\/h3>\n<p>\nIn the first test case <b>N<\/b> equals to 3, <b>M<\/b> equals to 2, <b>L<\/b> equals to 2. <b>E<sub>1<\/sub><\/b> = 2 + 5 = 7, <b>E<sub>2<\/sub><\/b> = 4 + 5 = 9. The answer is <b>max(<b>E<sub>1<\/sub><\/b>, <b>E<sub>2<\/sub><\/b>)<\/b> = <b>max(<\/b>7<b>,<\/b> 9<b>)<\/b> = 9;\n<\/p>\n<p>\nIn the second test case <b>N<\/b> equals to 1, <b>M<\/b> equals to 3, <b>L<\/b> equals to 2. It is impossible to calculate <b>E<sub>1<\/sub><\/b> and <b>E<sub>2<\/sub><\/b>, because <b>A<sub>3, 1<\/sub><\/b> doesn't exist. So the answer is <b>max(<b>E<sub>1<\/sub><\/b>, <b>E<sub>2<\/sub><\/b>)<\/b> = <b>max(<\/b>-1<b>,<\/b> -1<b>)<\/b> = -1;\n<\/p>\n<p>\nIn the third test case <b>N<\/b> equals to 1, <b>M<\/b> equals to 3, <b>L<\/b> equals to 2. It is impossible to calculate <b>E<sub>1<\/sub><\/b>, because <b>A<sub>3, 1<\/sub><\/b> doesn't exist. So <b>E<sub>1<\/sub><\/b> is equal to -1. <b>E<sub>2<\/sub><\/b> = 1 + 3 = 4. The answer is <b>max(<b>E<sub>1<\/sub><\/b>, <b>E<sub>2<\/sub><\/b>)<\/b> = <b>max(<\/b>-1<b>,<\/b>4<b>)<\/b> = 4.\n<\/p>\n\n<h3>Scoring<\/h3>\n<p>\n1 \u2264 <b>i<sub>k<\/sub><\/b>, <b>j<sub>k<\/sub><\/b> \u2264 500 for each test case.\n<\/p>\n<p>\nSubtask 1 (10 points): 1 \u2264 <b>N<\/b>, <b>M<\/b>, <b>L<\/b> \u2264 5, 0 \u2264 <b>A<sub>i, j<\/sub><\/b> \u2264 10;<br \/><br \/>\nSubtask 2 (12 points): 1 \u2264 <b>N<\/b>, <b>M<\/b>, <b>L<\/b> \u2264 300, 0 \u2264 <b>A<sub>i, j<\/sub><\/b> \u2264 10<sup>6<\/sup>, all the numbers in <b>A<\/b> are equal;<br \/><br \/>\nSubtask 3 (20 points): 1 \u2264 <b>N<\/b>, <b>M<\/b>, <b>L<\/b> \u2264 300, 0 \u2264 <b>A<sub>i, j<\/sub><\/b> \u2264 10<sup>9<\/sup>;<br \/><br \/>\nSubtask 4 (26 points): 1 \u2264 <b>N<\/b>, <b>M<\/b>, <b>L<\/b> \u2264 500, 0 \u2264 <b>A<sub>i, j<\/sub><\/b> \u2264 10<sup>9<\/sup>;<br \/><br \/>\nSubtask 5 (32 points): 1 \u2264 <b>N<\/b>, <b>M<\/b> \u2264 500, 1 \u2264 <b>L<\/b> \u2264 250 000, 0 \u2264 <b>A<sub>i, j<\/sub><\/b> \u2264 10<sup>9<\/sup>.<br \/>\n<\/p>\n\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"kostya_by","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>kostya_by<\/span>","problem_tester":null,"problem_tester_html_handle":null,"date_added":"28-11-2013","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cakewalk'>\n                    cakewalk\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/implementation'>\n                    implementation\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/kostya_by'>\n                    kostya_by\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ltime07'>\n                    ltime07\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/MIKE1","user":{"username":null},"time":{"view_start_date":1388305813,"submit_start_date":1388305813,"visible_start_date":1388305800,"end_date":1735669800,"current":1493558169},"todo":false,"problem_status":"unattempted"}