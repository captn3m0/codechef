{"category_name":"easy","status":"success","problem_code":"GOLOMB","problem_name":"Golomb Sequence","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/hindi\/GOLOMB.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/bengali\/GOLOMB.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/mandarin\/GOLOMB.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/russian\/GOLOMB.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/vietnamese\/GOLOMB.pdf) as well.\r\n\r\nThe Golomb sequence $G_1, G_2, \\ldots$ is a non-decreasing integer sequence such that for each positive integer $n$, $G_n$ is the number of occurrences of $n$ in this sequence. The first few elements of $G$ are $[1, 2, 2, 3, 3, 4, 4, 4, 5, \\ldots]$. Do you know the recurrence relation for the Golomb sequence? It is $G_1 = 1$ and $G_{n+1} = 1+G_{n+1-G_{G_n}}$ for each $n \\ge 1$. A self-describing sequence, isn't it?\r\n\r\nMr. Strange wants to learn CP, so he asked Chef, who is one of the best competitive programmers in the world, to teach him. Chef decided to test his ability by giving him the following task.\r\n\r\nFind the sum of squares of the $L$-th through $R$-th term of the Golomb sequence, i.e. $S = \\sum_{i=L}^R G_i^2$. Since the sum can be quite large, compute it modulo $10^9+7$.\r\n\r\nCan you help Mr. Strange carry out this task given to him by his teacher?\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains two space-separated integers $L$ and $R$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $S$ modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10^5$\r\n- $1 \\le L \\le R \\le 10^{10}$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):**\r\n- $T \\le 10^2$\r\n- $R \\le 10^9$\r\n\r\n**Subtask #2 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n3\r\n1 5\r\n2 4\r\n100 100\r\n```\r\n\r\n### Example Output\r\n```\r\n27\r\n17\r\n441\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** $1^2 + 2^2 + 2^2 + 3^2 + 3^2 = 27$\r\n\r\n**Example case 2:** $2^2 + 2^2 + 3^2 = 17$\r\n\r\n**Example case 3:** $21^2 = 441$\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/hindi\/GOLOMB.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/bengali\/GOLOMB.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/mandarin\/GOLOMB.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/russian\/GOLOMB.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/vietnamese\/GOLOMB.pdf) as well.\r\n\r\nThe Golomb sequence $G_1, G_2, \\ldots$ is a non-decreasing integer sequence such that for each positive integer $n$, $G_n$ is the number of occurrences of $n$ in this sequence. The first few elements of $G$ are $[1, 2, 2, 3, 3, 4, 4, 4, 5, \\ldots]$. Do you know the recurrence relation for the Golomb sequence? It is $G_1 = 1$ and $G_{n+1} = 1+G_{n+1-G_{G_n}}$ for each $n \\ge 1$. A self-describing sequence, isn't it?\r\n\r\nMr. Strange wants to learn CP, so he asked Chef, who is one of the best competitive programmers in the world, to teach him. Chef decided to test his ability by giving him the following task.\r\n\r\nFind the sum of squares of the $L$-th through $R$-th term of the Golomb sequence, i.e. $S = \\sum_{i=L}^R G_i^2$. Since the sum can be quite large, compute it modulo $10^9+7$.\r\n\r\nCan you help Mr. Strange carry out this task given to him by his teacher?\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains two space-separated integers $L$ and $R$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $S$ modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10^5$\r\n- $1 \\le L \\le R \\le 10^{10}$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):**\r\n- $T \\le 10^2$\r\n- $R \\le 10^9$\r\n\r\n**Subtask #2 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3\r\n1 5\r\n2 4\r\n100 100","output":"27\r\n17\r\n441","explanation":"**Example case 1:** $1^2 + 2^2 + 2^2 + 3^2 + 3^2 = 27$\r\n\r\n**Example case 2:** $2^2 + 2^2 + 3^2 = 17$\r\n\r\n**Example case 3:** $21^2 = 441$","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"codemaster3840","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>codemaster3840<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"26-05-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/binary-search'>binary-search<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/codemaster3840'>codemaster3840<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/greedy'>greedy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime86'>ltime86<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/prefix-sum'>prefix-sum<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rajarshi_basu'>rajarshi_basu<\/a>","problem_difficulty_level":"Easy-Medium","user_zen_mode":false,"best_tag":"Binary Search","editorial_url":"https:\/\/discuss.codechef.com\/problems\/GOLOMB","time":{"view_start_date":1595696400,"submit_start_date":1595696400,"visible_start_date":1595696400,"end_date":1735669800,"current":1643797818},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=GOLOMB","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}