
{"category_name":"easy","status":"success","problem_code":"GCDSUM","problem_name":"GCD Sum","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME62\/hindi\/GCDSUM.pdf\" target=\"_blank\">Hindi,<\/a>\n<a href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME62\/mandarin\/GCDSUM.pdf\" target=\"_blank\">Mandarin chinese<\/a>\n, <a href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME62\/russian\/GCDSUM.pdf\" target=\"_blank\">Russian<\/a> and <a href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME62\/vietnamese\/GCDSUM.pdf\" target=\"_blank\">Vietnamese<\/a> as well.<\/h3>\n\n\nYou are given $n$ sequences $a_1, a_2, \\dots, a_n$. Each of these sequences contains $m$ integers; let's denote the $j$-th element of the $i$-th sequence by $a_{i,j}$. Chef must perform the following operation exactly once:\n- choose an integer $k$ ($2 \\le k \\le n$)\n- choose $k$ **increasing** valid indices of sequences $1 \\leq i_1 < i_2 < \\dots < i_k \\leq n$\n- choose $k$ arbitrary valid indices of elements $1 \\leq j_1, j_2, \\dots, j_k \\leq m$\n- calculate $G = gcd(a_{i_1, j_1}, a_{i_2, j_2}, \\dots, a_{i_k, j_k})$\n\nChef considered all possible ways to perform this operation, computed the number $G$ for each of them and calculated the sum of all these numbers modulo $10^9+7$. Can you find this sum?\n\n### Input\n- The first line of the input contains two space-separated integers $n$ and $m$.\n- $n$ lines follow. For each $i$ ($1 \\le i \\le n$), the $i$-th of these lines contains $m$ space-separated integers $a_{i,1}, a_{i,2}, \\dots, a_{i,m}$ denoting the $i$-th sequence.\n\n### Output\nPrint a single line containing one integer \u2014 the sum of all possible results modulo $10^9 + 7$.\n\n### Constraints \n- $2 \\le n \\le 20$\n- $1 \\le m \\le 10^5$\n- $1 \\le a_{i, j} \\le 10^5$ for each valid $i, j$\n\n### Subtasks\n**Subtask #1 (5 points):**\n- $2 \\le n \\le 10$\n- $1 \\le m \\le 5$\n\n**Subtask #2 (15 points):**\n- $n = 2$\n- each sequence is a permutation of the numbers $\\{1, 2, \\dots, m\\}$\n\n\n**Subtask #3 (20 points):**\n- $n = 3$\n- each sequence is a permutation of the numbers $\\{1, 2, \\dots, m\\}$\n\n\n**Subtask #4 (60 points):** original constraints\n\n### Example Input\n```\n2 3\n5 15 8\n3 12 10\n```\n\n### Example Output\n```\n25\n```\n\n### Explanation\nThe answer is $gcd(5, 3) + gcd(5, 12) + gcd(5, 10) + gcd(15, 3) + gcd(15, 12) + gcd(15, 10) + gcd(8, 3) + gcd(8, 12) + gcd(8, 10) = 1 + 1 + 5 + 3 + 3 + 5 + 1 + 4 + 2 = 25$.\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"fekete","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>fekete<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"25-07-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/counting'>counting<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fekete'>fekete<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fekete'>fekete<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/gcd'>gcd<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/inclusn-exclusn'>inclusn-exclusn<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/likecs'>likecs<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime62'>ltime62<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/GCDSUM","time":{"view_start_date":1532797200,"submit_start_date":1532797200,"visible_start_date":1532797200,"end_date":1735669800,"current":1559472945},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}