{"category_name":"easy","status":"success","problem_code":"TWOLANE","problem_name":"Two-lane Road","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME74\/hindi\/TWOLANE.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME74\/bengali\/TWOLANE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME74\/mandarin\/TWOLANE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME74\/russian\/TWOLANE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME74\/vietnamese\/TWOLANE.pdf) as well.\n\nChef works as a cook in a restaurant. Each morning, he has to drive down a straight road with length $K$ to reach the restaurant from his home. Let's describe this road using a coordinate $X$; the position of Chef's home is $X = 0$ and the position of the restaurant is $X = K$.\n\nThe road has exactly two lanes (numbered $1$ and $2$), but there are $N$ obstacles (numbered $1$ through $N$) on it. For each valid $i$, the $i$-th obstacle blocks the lane $L_i$ at the position $X = X_i$ and does not block the other lane.\n\nWhen driving, Chef cannot pass through an obstacle. He can switch lanes in zero time at any integer $X$-coordinate which does not coincide with the $X$-coordinate of any obstacle. However, whenever he switches lanes, he cannot switch again until driving for at least $D$ units of distance, and he can travel only in the direction of increasing $X$. Chef can start driving in any lane he wants. He can not switch lanes at non-integer  $X$-coordinate.\n\nSometimes, it is impossible to reach the restaurant without stopping at an obstacle. Find the maximum possible distance Chef can travel before he has to reach an obstacle which is in the same lane as him. If he can avoid all obstacles and reach the restaurant, the answer is $K$.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains three space-separated integers $N$, $K$ and $D$.\n- The second line contains $N$ space-separated integers $X_1, X_2, \\ldots, X_N$.\n- The third line contains $N$ space-separated integers $L_1, L_2, \\ldots, L_N$.\n\n### Output\nFor each test case, print a single line containing one integer \u2015 the maximum distance Chef can travel.\n\n### Constraints \n- $1 \\le T \\le 1,000$\n- $1 \\le N \\le 10^5$\n- $2 \\le K \\le 10^9$\n- $1 \\le D \\le 10^9$\n- $1 \\le X_i \\le K-1$ for each valid $i$\n- $X_i \\lt X_{i+1}$ for each valid $i$\n- $1 \\le L_i \\le 2$ for each valid $i$\n- the sum of $N$ over all test cases does not exceed $10^6$\n\n### Subtasks\n**Subtask #1 (100 points):** original constraints\n\n### Example Input\n```\n4\n2 10 20\n4 7\n1 2\n4 15 20\n4 6 9 13\n1 2 2 1\n5 10 1\n1 3 5 7 9\n1 2 1 2 1\n2 10 2\n4 5\n1 2\n```\n\n### Example Output\n```\n10\n13\n10\n5\n```\n\n### Explanation\n**Example case 1:** Chef can start in lane $2$ and switch to lane $1$ at the position $X = 6$, then continue until reaching the restaurant.\n\n**Example case 2:** Chef can start in lane $2$ and switch to lane $1$ at $X = 5$. However, he cannot avoid the obstacle at $X = 13$, because he has not driven for at least $20$ units since the last switch.\n\n**Example case 3:** Chef should start in lane $2$ and then switch lanes at the positions $X=2$, $X=4$, $X=6$ and $X=8$. This way, he can reach the restaurant.\n\n**Example case 4:** Chef can start in lane $2$ but he cannot escape the second obstacle at $X$=5 since the first obstacle at $X$=4 doesn't give enough space for Chef to switch lanes.\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME74\/hindi\/TWOLANE.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME74\/bengali\/TWOLANE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME74\/mandarin\/TWOLANE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME74\/russian\/TWOLANE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME74\/vietnamese\/TWOLANE.pdf) as well.\n\nChef works as a cook in a restaurant. Each morning, he has to drive down a straight road with length $K$ to reach the restaurant from his home. Let's describe this road using a coordinate $X$; the position of Chef's home is $X = 0$ and the position of the restaurant is $X = K$.\n\nThe road has exactly two lanes (numbered $1$ and $2$), but there are $N$ obstacles (numbered $1$ through $N$) on it. For each valid $i$, the $i$-th obstacle blocks the lane $L_i$ at the position $X = X_i$ and does not block the other lane.\n\nWhen driving, Chef cannot pass through an obstacle. He can switch lanes in zero time at any integer $X$-coordinate which does not coincide with the $X$-coordinate of any obstacle. However, whenever he switches lanes, he cannot switch again until driving for at least $D$ units of distance, and he can travel only in the direction of increasing $X$. Chef can start driving in any lane he wants. He can not switch lanes at non-integer  $X$-coordinate.\n\nSometimes, it is impossible to reach the restaurant without stopping at an obstacle. Find the maximum possible distance Chef can travel before he has to reach an obstacle which is in the same lane as him. If he can avoid all obstacles and reach the restaurant, the answer is $K$.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains three space-separated integers $N$, $K$ and $D$.\n- The second line contains $N$ space-separated integers $X_1, X_2, \\ldots, X_N$.\n- The third line contains $N$ space-separated integers $L_1, L_2, \\ldots, L_N$.\n\n### Output\nFor each test case, print a single line containing one integer \u2015 the maximum distance Chef can travel.\n\n### Constraints \n- $1 \\le T \\le 1,000$\n- $1 \\le N \\le 10^5$\n- $2 \\le K \\le 10^9$\n- $1 \\le D \\le 10^9$\n- $1 \\le X_i \\le K-1$ for each valid $i$\n- $X_i \\lt X_{i+1}$ for each valid $i$\n- $1 \\le L_i \\le 2$ for each valid $i$\n- the sum of $N$ over all test cases does not exceed $10^6$\n\n### Subtasks\n**Subtask #1 (100 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"4\n2 10 20\n4 7\n1 2\n4 15 20\n4 6 9 13\n1 2 2 1\n5 10 1\n1 3 5 7 9\n1 2 1 2 1\n2 10 2\n4 5\n1 2","output":"10\n13\n10\n5","explanation":"**Example case 1:** Chef can start in lane $2$ and switch to lane $1$ at the position $X = 6$, then continue until reaching the restaurant.\n\n**Example case 2:** Chef can start in lane $2$ and switch to lane $1$ at $X = 5$. However, he cannot avoid the obstacle at $X = 13$, because he has not driven for at least $20$ units since the last switch.\n\n**Example case 3:** Chef should start in lane $2$ and then switch lanes at the positions $X=2$, $X=4$, $X=6$ and $X=8$. This way, he can reach the restaurant.\n\n**Example case 4:** Chef can start in lane $2$ but he cannot escape the second obstacle at $X$=5 since the first obstacle at $X$=4 doesn't give enough space for Chef to switch lanes.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"kingofnumbers","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>kingofnumbers<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"24-07-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/easy'>easy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/greedy'>greedy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kingofnumbers'>kingofnumbers<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime74'>ltime74<\/a>","problem_difficulty_level":"Easy","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/TWOLANE","time":{"view_start_date":1564246800,"submit_start_date":1564246800,"visible_start_date":1564246800,"end_date":1735669800,"current":1643797901},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=TWOLANE","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}