{"category_name":"easy","status":"success","problem_code":"HDDN","problem_name":"Hidden Sequence","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK111\/hindi\/HDDN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK111\/mandarin\/HDDN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK111\/russian\/HDDN.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK111\/vietnamese\/HDDN.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK111\/bengali\/HDDN.pdf) as well.\r\n\r\nIt's not always easy to make up stories around problems \u2015 like this one.\r\n\r\nWe know that there is a hidden sequence $A_1, A_2, \\ldots, A_N$ which contains only integers between $1$ and $K$ inclusive. We have acquired $M$ triplets $(X_1, Y_1, Z_1), (X_2, Y_2, Z_2), \\ldots, (X_M, Y_M, Z_M)$. A very reliable source has given us intel that for each valid $i$, the $Y_i$-th occurrence of the integer $X_i$ in the sequence $A$ is $A_{Z_i}$, i.e. $A_{Z_i} = X_i$ and there are $Y_i-1$ indices $j \\lt Z_i$ such that $A_j = X_i$.\r\n\r\nFind any sequence $A$ consistent with this information or determine that no such sequence exists.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains three space-separated integers $N$, $K$ and $M$.\r\n- $M$ lines follow. For each $i$ ($1 \\le i \\le M$), the $i$-th of these lines contains three space-separated integers $X_i, Y_i$ and $Z_i$.\r\n\r\n### Output\r\nFor each test case:\r\n- If no valid sequence exists, print a single line containing the string `\"No\"`.\r\n- Otherwise, print two lines.\r\n- The first of these lines should contain the string `\"Yes\"`.\r\n- The second line should contain $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 5 \\cdot 10^5$\r\n- $1 \\le N, K, M \\le 5 \\cdot 10^5$\r\n- $1 \\le X_i \\le K$ for each valid $i$\r\n- $1 \\le Y_i, Z_i \\le N$ for each valid $i$\r\n- all triplets are pairwise distinct\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n- the sum of $K$ over all test cases does not exceed $5 \\cdot 10^5$\r\n- the sum of $M$ over all test cases does not exceed $5 \\cdot 10^5$\r\n\r\n### Example Input\r\n```\r\n3\r\n3 3 2\r\n1 1 2\r\n2 2 3\r\n3 1 1\r\n1 1 1\r\n3 1 1\r\n1 1 2\r\n```\r\n\r\n### Example Output\r\n```\r\nYes\r\n2 1 2 \r\nYes\r\n1 1 1 \r\nNo\r\n```\r\n\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK111\/hindi\/HDDN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK111\/mandarin\/HDDN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK111\/russian\/HDDN.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK111\/vietnamese\/HDDN.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK111\/bengali\/HDDN.pdf) as well.\r\n\r\nIt's not always easy to make up stories around problems \u2015 like this one.\r\n\r\nWe know that there is a hidden sequence $A_1, A_2, \\ldots, A_N$ which contains only integers between $1$ and $K$ inclusive. We have acquired $M$ triplets $(X_1, Y_1, Z_1), (X_2, Y_2, Z_2), \\ldots, (X_M, Y_M, Z_M)$. A very reliable source has given us intel that for each valid $i$, the $Y_i$-th occurrence of the integer $X_i$ in the sequence $A$ is $A_{Z_i}$, i.e. $A_{Z_i} = X_i$ and there are $Y_i-1$ indices $j \\lt Z_i$ such that $A_j = X_i$.\r\n\r\nFind any sequence $A$ consistent with this information or determine that no such sequence exists.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains three space-separated integers $N$, $K$ and $M$.\r\n- $M$ lines follow. For each $i$ ($1 \\le i \\le M$), the $i$-th of these lines contains three space-separated integers $X_i, Y_i$ and $Z_i$.\r\n\r\n### Output\r\nFor each test case:\r\n- If no valid sequence exists, print a single line containing the string `\"No\"`.\r\n- Otherwise, print two lines.\r\n- The first of these lines should contain the string `\"Yes\"`.\r\n- The second line should contain $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 5 \\cdot 10^5$\r\n- $1 \\le N, K, M \\le 5 \\cdot 10^5$\r\n- $1 \\le X_i \\le K$ for each valid $i$\r\n- $1 \\le Y_i, Z_i \\le N$ for each valid $i$\r\n- all triplets are pairwise distinct\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n- the sum of $K$ over all test cases does not exceed $5 \\cdot 10^5$\r\n- the sum of $M$ over all test cases does not exceed $5 \\cdot 10^5$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3\r\n3 3 2\r\n1 1 2\r\n2 2 3\r\n3 1 1\r\n1 1 1\r\n3 1 1\r\n1 1 2","output":"Yes\r\n2 1 2 \r\nYes\r\n1 1 1 \r\nNo","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"kmaaszraa","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>kmaaszraa<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"18-10-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook111'>cook111<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/implementation'>implementation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kmaaszraa'>kmaaszraa<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Easy-Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/HDDN","time":{"view_start_date":1571596202,"submit_start_date":1571596202,"visible_start_date":1571596202,"end_date":1735669800,"current":1643797820},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=HDDN","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}