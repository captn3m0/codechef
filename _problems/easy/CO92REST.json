{"category_name":"easy","status":"success","problem_code":"CO92REST","problem_name":"Chef Restores an Array","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/COOK92\/mandarin\/CO92REST.pdf\">Mandarin chinese<\/a>, <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/COOK92\/russian\/CO92REST.pdf\">Russian<\/a> and <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/COOK92\/vietnamese\/CO92REST.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Chef had an array <b>A<\/b> with length <b>N<\/b>, but some of its elements got lost. Now, each element of this array is either unknown (denoted by -1) or a positive integer not exceeding <b>K<\/b>.<\/p>\n\n<p>Chef decided to restore the array <b>A<\/b> by replacing each unknown element by a positive integer not exceeding <b>K<\/b>.<\/p>\n\n<p>However, Chef has <b>M<\/b> restrictions that must hold for the restored array. There are two types of restrictions:\n<ul>\n<li>I <b>L<\/b> <b>R<\/b>, meaning that for each <b>i<\/b> such that <b>L<\/b> < <b>i<\/b> \u2264 <b>R<\/b>, the condition <b>A<sub>i<\/sub> - A<sub>i-1<\/sub><\/b> = 1 should be satisfied.<\/li>\n<li>D <b>L<\/b> <b>R<\/b>, meaning that for each <b>i<\/b> such that <b>L<\/b> < <b>i<\/b>  \u2264 <b>R<\/b>, the condition <b>A<sub>i<\/sub> - A<sub>i-1<\/sub><\/b> = -1 should be satisfied.<\/li>\n<\/ul><\/p>\n\n<p>Chef would like to know the number of ways to restore the array while satisfying all restrictions, modulo 10<sup>9<\/sup>+7.<\/p>\n\n<h3>Input<\/h3>\n<ul>\n<li>The first line of the input contains a single integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/li>\n<li>The first line of each test case contains three space-separated integers <b>N<\/b>, <b>M<\/b> and <b>K<\/b>.<\/li>\n<li>The second line contains <b>N<\/b> integers <b>A<sub>1<\/sub>, A<sub>2<\/sub>, ..., A<sub>N<\/sub><\/b>.<\/li>\n<li>Each of the following <b>M<\/b> lines contains one restriction in the form I <b>L<\/b> <b>R<\/b> or D <b>L<\/b> <b>R<\/b>.<\/li>\n<\/ul>\n\n<h3>Output<\/h3>\n<p>For each test case, print a single line containing one integer - the number of ways to restore the array modulo 10<sup>9<\/sup>+7.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>T<\/b> \u2264 10<\/li>\n<li>1 \u2264 <b>N<\/b>, <b>M<\/b> \u2264 100,000<\/li>\n<li>1 \u2264 <b>K<\/b> \u2264 1,000,000,000<\/li>\n<li>1 \u2264 <b>L<\/b> < <b>R<\/b> \u2264 <b>N<\/b><\/li>\n<li>1 \u2264 <b>A<sub>i<\/sub><\/b> \u2264 <b>K<\/b> or <b>A<sub>i<\/sub><\/b> = -1 for each valid <b>i<\/b><\/li>\n<li>1 \u2264 sum of <b>N<\/b> over all test cases \u2264 500,000<\/li>\n<li>1 \u2264 sum of <b>M<\/b> over all test cases \u2264 500,000<\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n\n3\n4 2 10\n2 3 5 4\nI 1 2 \nD 3 4\n5 2 10\n-1 -1 -1 -1 -1\nI 1 3\nD 3 5\n6 2 2\n-1 -1 -1 -1 -1 -1\nI 1 4\nD 4 6\n\n<b>Output:<\/b>\n\n1\n8\n0\n<\/pre>\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"kefaa","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>kefaa<\/span>","problem_tester":null,"problem_tester_html_handle":null,"date_added":"15-03-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook92'>cook92<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/datastructure'>datastructure<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kefaa'>kefaa<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CO92REST","time":{"view_start_date":1521397800,"submit_start_date":1521397800,"visible_start_date":1521397800,"end_date":1735669800,"current":1525198933},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}