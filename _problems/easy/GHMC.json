
{"category_name":"easy","status":"success","problem_code":"GHMC","problem_name":"GukiZ Has More Candies","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME63\/mandarin\/GHMC.pdf\" target=\"_blank\">Mandarin chinese<\/a>\n, <a href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME63\/russian\/GHMC.pdf\" target=\"_blank\">Russian<\/a> and <a href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME63\/vietnamese\/GHMC.pdf\" target=\"_blank\">Vietnamese<\/a> as well.<\/h3>\n\n\nAfter six days, professor GukiZ decided to give more candies to his students. Like last time, he has $N$ students, numbered $1$ through $N$. Let's denote the number of candies GukiZ gave to the $i$-th student by $p_i$. As GukiZ has a lot of students, he does not remember all the exact numbers of candies he gave to the students. He only remembers the following properties of the sequence $p$:\n- The numbers of candies given to each of the first $K$ students ($p_1, p_2, \\dots, p_K$) are known exactly.\n- All elements of the sequence $p$ are distinct and positive.\n- GukiZ didn't give more than $x$ candies to any student (the maximum value in the sequence $p$ is not greater than $x$).\n- For each student $i$, there is at least one other student $j$ such that $|p_i - p_j| \\le D$.\n- The professor gave out the biggest possible total number of candies, i.e. $S = p_1 + p_2 + p_3 + \\ldots + p_N$ is maximum possible.\n\nGukiZ would like to know the total number of candies $S$ he had at the beginning. However, times change and after six days, the professor is really tired, so it is possible that there is no sequence $p$ which satisfies the constraints. Can you help GukiZ find the number of candies he gave out, or tell him that he must have made a mistake?\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains four space-separated integers $N$, $K$, $x$, $D$.\n- The second line contains $K$ distinct space-separated integers $p_1, p_2, \\dots, p_K$.\n\n### Output\nFor each test case, print a single line containing one integer \u2014 the number of candies GukiZ had, or $-1$ if there is no valid sequence $p$.\n\n### Constraints\n- $1 \\le T \\le 50$\n- $3 \\le N \\le 10^9$\n- $1 \\le K \\le \\mathrm{min}(N, 2 \\cdot 10^4)$ \n- $1 \\le x \\le 2 \\cdot 10^9$\n- $1 \\le D \\le 10^9$\n- $1 \\le p_i \\le x$ for each valid $i$\n- All values $p_i$ from input are distinct\n### Subtasks\n**Subtask #1 (15 points):** $1 \\leq x, N, D \\leq 15$ \n\n**Subtask #2 (35 points):** $1 \\leq x, N, D \\leq 10^5$ \n\n**Subtask #3 (50 points):** original constraints\n\n\n### Example Input\n```\n2\n4 3 5 3\n2 1 5\n3 2 8 2\n3 8\n```\n\n### Example Output\n```\n12\n-1\n```\n\n### Explanation\n**Example case 1:** There are four students. We know that the first student got $p_1 = 2$ candies, the second student got $p_2 = 1$ and the third got $p_3 = 5$ candies; we don't know the number of candies given to the last student. The maximum possible amount of candies given to some student is $x=5$. The best possible option is giving $p_4=4$ candies to the last student. Then, the fourth constraint (with $D=3$) is satisfied for all students. Only the pair of students $(2, 3)$ have numbers of candies that differ by more than $3$, but still, for each student, there are at least two other students with close enough numbers of candies.\n\n**Example case 2:** GukiZ made some mistake in distribution and there is no valid sequence $p$. The answer is $-1$.\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"allllekssssa","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>allllekssssa<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"24-08-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/allllekssssa'>allllekssssa<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/greedy'>greedy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime63'>ltime63<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/GHMC","time":{"view_start_date":1535216402,"submit_start_date":1535216402,"visible_start_date":1535216402,"end_date":1735669800,"current":1559472945},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}