{"category_name":"easy","status":"success","problem_code":"WARTLND","problem_name":"War in Treeland Again","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK108\/hindi\/WARTLND.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK108\/mandarin\/WARTLND.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK108\/russian\/WARTLND.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK108\/vietnamese\/WARTLND.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK108\/bengali\/WARTLND.pdf) as well.\n\nThere is a full-scale war taking place in Treeland. Chef needs to travel between cities in Treeland to work, but during the war, it is not safe.\n\nIn Treeland, there are $N$ cities (numbered $1$ through $N$) and $N - 1$ bidirectional roads connecting them in such a way that Chef can reach each city from any other city using these roads. Each road is occupied by a unique faction that assigned a positive integer code to it.\n\nLet $f(A, B)$ denote the greatest positive integer which divides the code of each road on the shortest path between cities $A$ and $B$ (the GCD of these codes). If Chef wants to go from city $A$ to city $B$ *safely*, he needs to pay $f(A, B)$ units of money.\n\nSince Chef is not sure between which pairs of cities he is going to travel, he wants to know\n$$S = \\sum\\limits_{i=1}^{N} \\sum\\limits_{j=i+1}^{N} f(i, j) \\,.$$\n\nHelp Chef calculate $S$.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains a single integer $N$.\n- Each of the next $N-1$ lines contains three space-separated integers $X$, $Y$ and $Z$ denoting that cities $X$ and $Y$ are connected by a road with code $Z$.\n\n### Output\nFor each test case, print a single line containing one integer $S$.\n\n### Constraints\n- $1 \\le T \\le 10$\n- $1 \\le N, Z \\le 10^5$\n- $1 \\le X, Y \\le N$\n\n### Example Input\n```\n1\n5\n1 2 4\n1 3 3\n2 4 1\n2 5 2\n```\n\n### Example Output\n```\n17\n```\n\n### Explanation\n**Example case 1:**\n- $f(1, 2) = \\mathrm{GCD}\\,(4) = 4$\n- $f(1, 3) = \\mathrm{GCD}\\,(3) = 3$\n- $f(1, 4) = \\mathrm{GCD}\\,(4, 1) = 1$\n- $f(1, 5) = \\mathrm{GCD}\\,(4, 2) = 2$\n- $f(2, 3) = \\mathrm{GCD}\\,(4, 3) = 1$\n- $f(2, 4) = \\mathrm{GCD}\\,(1) = 1$\n- $f(2, 5) = \\mathrm{GCD}\\,(2) = 2$\n- $f(3, 4) = \\mathrm{GCD}\\,(3, 4, 1) = 1$\n- $f(3, 5) = \\mathrm{GCD}\\,(3, 4, 2) = 1$\n- $f(4, 5) = \\mathrm{GCD}\\,(1, 2) = 1$\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK108\/hindi\/WARTLND.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK108\/mandarin\/WARTLND.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK108\/russian\/WARTLND.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK108\/vietnamese\/WARTLND.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK108\/bengali\/WARTLND.pdf) as well.\n\nThere is a full-scale war taking place in Treeland. Chef needs to travel between cities in Treeland to work, but during the war, it is not safe.\n\nIn Treeland, there are $N$ cities (numbered $1$ through $N$) and $N - 1$ bidirectional roads connecting them in such a way that Chef can reach each city from any other city using these roads. Each road is occupied by a unique faction that assigned a positive integer code to it.\n\nLet $f(A, B)$ denote the greatest positive integer which divides the code of each road on the shortest path between cities $A$ and $B$ (the GCD of these codes). If Chef wants to go from city $A$ to city $B$ *safely*, he needs to pay $f(A, B)$ units of money.\n\nSince Chef is not sure between which pairs of cities he is going to travel, he wants to know\n$$S = \\sum\\limits_{i=1}^{N} \\sum\\limits_{j=i+1}^{N} f(i, j) \\,.$$\n\nHelp Chef calculate $S$.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains a single integer $N$.\n- Each of the next $N-1$ lines contains three space-separated integers $X$, $Y$ and $Z$ denoting that cities $X$ and $Y$ are connected by a road with code $Z$.\n\n### Output\nFor each test case, print a single line containing one integer $S$.\n\n### Constraints\n- $1 \\le T \\le 10$\n- $1 \\le N, Z \\le 10^5$\n- $1 \\le X, Y \\le N$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\n5\n1 2 4\n1 3 3\n2 4 1\n2 5 2","output":"17","explanation":"**Example case 1:**\n- $f(1, 2) = \\mathrm{GCD}\\,(4) = 4$\n- $f(1, 3) = \\mathrm{GCD}\\,(3) = 3$\n- $f(1, 4) = \\mathrm{GCD}\\,(4, 1) = 1$\n- $f(1, 5) = \\mathrm{GCD}\\,(4, 2) = 2$\n- $f(2, 3) = \\mathrm{GCD}\\,(4, 3) = 1$\n- $f(2, 4) = \\mathrm{GCD}\\,(1) = 1$\n- $f(2, 5) = \\mathrm{GCD}\\,(2) = 2$\n- $f(3, 4) = \\mathrm{GCD}\\,(3, 4, 1) = 1$\n- $f(3, 5) = \\mathrm{GCD}\\,(3, 4, 2) = 1$\n- $f(4, 5) = \\mathrm{GCD}\\,(1, 2) = 1$","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"ezio_26","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>ezio_26<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"11-07-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook108'>cook108<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/divisors'>divisors<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ezio_26'>ezio_26<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/inclusion-exclusion'>inclusion-exclusion<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/union-find'>union-find<\/a>","problem_difficulty_level":"Easy","user_zen_mode":false,"best_tag":"Union Find","editorial_url":"https:\/\/discuss.codechef.com\/problems\/WARTLND","time":{"view_start_date":1563733802,"submit_start_date":1563733802,"visible_start_date":1563733802,"end_date":1735669800,"current":1643797906},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=WARTLND","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}