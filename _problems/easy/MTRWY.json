{"category_name":"easy","status":"success","problem_code":"MTRWY","problem_name":"Matrix","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MARCH15\/mandarin\/MTRWY.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MARCH15\/russian\/MTRWY.pdf\">Russian<\/a>.<\/h3>\n<p>You have a rectangular grid of size <b>N \u00d7 M<\/b>, namely, there are cells <b>(x, y)<\/b> for <b>1 \u2264 x \u2264 N, 1 \u2264 y \u2264 M<\/b>. Two cells are adjacent if they share a side. More formally, two cells <b>(x<sub>1<\/sub>, y<sub>1<\/sub>), (x<sub>2<\/sub>, y<sub>2<\/sub>)<\/b> are adjacent if <b>|x<sub>1<\/sub> \u2212 x<sub>2<\/sub>| + |y<sub>1<\/sub> \u2212 y<sub>2<\/sub>| = 1<\/b>. Between two adjacent cells there can be a wall. Two cells <b>a<\/b> and <b>b<\/b> are connected if there is a way between them (in other words there is a sequence of cells <b>c<sub>1<\/sub>, c<sub>2<\/sub>, ..., c<sub>k<\/sub><\/b> that <b>c<sub>1<\/sub> = a, c<sub>k<\/sub> = b<\/b>, and for each <b>1 \u2264 i &lt; k<\/b>, <b>c<sub>i<\/sub>, c<sub>i+1<\/sub><\/b> are adjacent cells without wall between them).<\/p>\n<p>Now you are given <b>Q<\/b> queries, each of whom is of following four types.<\/p>\n<ul>\n<li><b>1 x y<\/b> - build the wall between cells <b>(x, y)<\/b> and <b>(x, y+1)<\/b>. If there is already exist a wall between them, this query is ignored.<\/li>\n<li><b>2 x y<\/b> - build the wall between cells <b>(x, y)<\/b> and <b>(x+1, y)<\/b>. If there is already exist a wall between them, this query is ignored.<\/li>\n<li><b>3 x<sub>1<\/sub> y<sub>1<\/sub> x<sub>2<\/sub> y<sub>2<\/sub><\/b> - check if cells <b>(x<sub>1<\/sub>, y<sub>1<\/sub>)<\/b> and <b>(x<sub>2<\/sub>, y<sub>2<\/sub>)<\/b> are connected. You must answer <b>1<\/b> if they are connected, <b>0<\/b> otherwise.<\/li>\n<li><b>4<\/b> - You must answer the size of the largest connected component. A connected component is a set of sells wherein each two cells are connected. The size of a connected component is a number of the cells in it.<\/li>\n<\/ul>\n<p>You must assume that there are no walls on the grid before the queries.<\/p>\n<h3>Input<\/h3>\n<p>The first line of input contains an integer <b>T<\/b>, denoting the number of test cases. Then <b>T<\/b> test cases are follow.<\/p>\n<p>The first line of each test case contains three space-separated integers <b>N, M<\/b> and <b>Q<\/b>, denoting the grid sizes and amount of queries. For next <b>Q<\/b> lines, each line contains a query. The format of queries are the same as described by the statement.<\/p>\n<h3>Output<\/h3>\n<p>For each test case, output an integer, denoting the sum of answers for queries of type <b>3<\/b> and <b>4<\/b>. Note that you just print only the sum of the answers for each test case.<\/p>\n<h3>Constraints and Subtasks<\/h3>\n<ul>\n<li><b>1 \u2264 T \u2264 100<\/b><\/li>\n<li><b>2 \u2264 N, M \u2264 1000<\/b><\/li>\n<li>The sum of <b>Q<\/b> over all test cases in one test file does not exceed <b>10<sup>6<\/sup><\/b><\/li>\n<li>For queries of type <b>1<\/b>: <b>1 \u2264 x \u2264 N<\/b> and <b>1 \u2264 y \u2264 M\u22121<\/b><\/li>\n<li>For queries of type <b>2<\/b>: <b>1 \u2264 x \u2264 N\u22121<\/b> and <b>1 \u2264 y \u2264 M<\/b><\/li>\n<li>For queries of type <b>3<\/b>: <b>1 \u2264 x<sub>1<\/sub>, x<sub>2<\/sub> \u2264 N<\/b> and <b>1 \u2264 y<sub>1<\/sub>, y<sub>2<\/sub> \u2264 M<\/b><\/li>\n<\/ul>\n<p><\/p>\n<p><b>Subtask 1: (15 points)<\/b><\/p>\n<ul>\n<li><b>1 \u2264 Q \u00d7 N \u00d7 M \u2264 10<sup>6<\/sup><\/b><\/li>\n<\/ul>\n<p><\/p>\n<p><b>Subtask 2: (15 points)<\/b><\/p>\n<ul>\n<li><b>1 \u2264 N, M \u2264 300<\/b><\/li>\n<li>The sum of <b>Q<\/b> over all test cases in one test file does not exceed <b>10<sup>5<\/sup><\/b><\/li>\n<\/ul>\n<p><\/p>\n<p><b>Subtask 3: (70 points)<\/b><\/p>\n<ul>\n<li>No additional constraints<\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n1\n3 4 10\n3 1 1 3 4\n1 1 2\n1 2 2\n2 2 2\n4\n1 3 1\n4\n3 1 1 3 4\n1 1 2\n3 1 1 1 1\n\n<b>Output:<\/b>\n21\n<\/pre><h3>Explanation<\/h3>\n<p><b>Query 1.<\/b> There are a lot of ways from <b>(1,1)<\/b> to <b>(3,4)<\/b>. One of them is marked in red in the picture #1. So these are connected, then <b>Answer = 1<\/b> in this query.<\/p>\n<p><b>Query 2.<\/b> In the picture #2 you can see the grid after second query. <\/p>\n<p><b>Query 3.<\/b> In the picture #3 you can see the grid after third query. <\/p>\n<p><b>Query 4.<\/b> In the picture #4 you can see the grid after fourth query.<\/p>\n<p><b>Query 5.<\/b> In the picture #5 the largest connected component marked in green. Thus <b>Answer = 12<\/b>.<\/p>\n<p><b>Query 6.<\/b> In the picture #6 you can see the grid after sixth query.<\/p>\n<p><b>Query 7.<\/b> In the picture #7 the largest connected component marked in green. Thus <b>Answer = 7<\/b>.<\/p>\n<p><b>Query 8.<\/b> As you can see in the picture #8, there are no ways from <b>(1,1)<\/b> to <b>(3,4)<\/b>. So they are no longer connected, then <b>Answer = 0<\/b>.<\/p>\n<p><b>Query 9.<\/b> In the picture #9 you can see the grid after ninth query. There is no difference between it and the grid after the sixth query, because before the ninth query the wall was already built.<\/p>\n<p><b>Query 10.<\/b> When <b>a = b<\/b>, two cells <b>a<\/b> and <b>b<\/b> are always connected. Thus <b>Answer = 1<\/b>.<\/p>\n<p>Therefore, the sum of the answers is <b>1 + 12 + 7 + 0 + 1 = 21<\/b>, which you should print.<\/p>\n<p><img src=\"\/download\/extimages\/bec647a1cb00760db4257697e654151e.png\" width=\"600\" height=\"400\" alt=\"explanation\" \/> <\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"5","source_sizelimit":"50000","problem_author":"antoniuk1","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>antoniuk1<\/span>","problem_tester":"laycurse","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>laycurse<\/span>","date_added":"29-01-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/antoniuk1'>\n                    antoniuk1\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/easy'>\n                    easy\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/march15'>\n                    march15\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/union-find'>\n                    union-find\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/MTRWY","user":{"username":null},"time":{"view_start_date":1426498200,"submit_start_date":1426498200,"visible_start_date":1426498200,"end_date":1735669800,"current":1493558169},"todo":false,"problem_status":"unattempted"}