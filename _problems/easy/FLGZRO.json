{"category_name":"easy","status":"success","problem_code":"FLGZRO","problem_name":"Falling Zero","body":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK129\/mandarin\/FLGZRO.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK129\/russian\/FLGZRO.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK129\/vietnamese\/FLGZRO.pdf) and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK129\/bengali\/FLGZRO.pdf) as well.\r\n\r\nYou are given a tree of $N$ nodes rooted at node $1$. Each node $u$ initially has a positive value $a_u$ associated with it.\r\n\r\nYou randomly choose one node in the tree and change its value to zero. If any node $u$ has a value equal to $0$, a random node $v$ will be chosen in the subtree of $u$ ($u \\neq v$), and the values $a_u$ and $a_v$ will be swapped, hence the value of the node $v$ will become zero and the process will continue until the zero is on a leaf node. At this point, we will call the tree a final tree.\r\n\r\n**Note**: there is exactly one node with a value equal to zero in a final tree and that node is a leaf node.\r\n\r\nYour task is to tell how many different final trees are possible. Two final trees are different if there exists at least one node $u$, such that the value of the node $u$ in one final tree differs from the value of the node $u$ in the other final tree. Since the answer can be large, print it modulo $10^9 +7$.\r\n\r\n###Input\r\n\r\n- The first line contains an integer $T$, the number of test cases. Then the test cases follow. \r\n- The first line of each test case contains an integer $N$, the number of nodes.\r\n- Each of the next $N-1$ lines contains two integers $u$ and $v$, denoting that there is an undirected edge between the node $u$ and the node $v$.\r\n- The next line contains $N$ integers $a_1,\\ldots, a_N$.\r\n\r\n###Output\r\nFor each test case, output on a new line, number of different final trees possible, modulo $10^9+7$.\r\n\r\n###Constraints \r\n- $1 \\leq T \\leq 10^5$\r\n- $1 \\leq N \\leq 10^5$\r\n- $1 \\leq u, v \\leq N$\r\n- $1\\le a_i\\le 10^9$\r\n- The edges form a tree structure.\r\n- The sum of $N$ over all test cases does not exceed $10^6$.\r\n\r\n###Sample Input\r\n```\r\n3\r\n1\r\n1\r\n4\r\n1 2\r\n2 3\r\n2 4\r\n1 1 1 2\r\n7\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n3 6\r\n3 7\r\n1 2 3 4 1 2 1\r\n```\r\n\r\n\r\n###Sample Output\r\n```\r\n1\r\n4\r\n14\r\n```\r\n\t\r\n###Explanation\r\n- For the first test case, the only possible final tree is when node $1$ is chosen and its value becomes 0.\r\n- For the second test case, the four possible final trees are:\r\n    - [ 1, 1, 1, 0 ]\r\n    - [ 1, 1, 0, 2 ]\r\n    - [ 1, 2, 1, 0 ]\r\n    - [ 2, 1, 1, 0 ]\r\n\r\n    ( The $i$-th number in the array denotes the value of node $i$ in the final tree).\r\n\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK129\/mandarin\/FLGZRO.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK129\/russian\/FLGZRO.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK129\/vietnamese\/FLGZRO.pdf) and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK129\/bengali\/FLGZRO.pdf) as well.\r\n\r\nYou are given a tree of $N$ nodes rooted at node $1$. Each node $u$ initially has a positive value $a_u$ associated with it.\r\n\r\nYou randomly choose one node in the tree and change its value to zero. If any node $u$ has a value equal to $0$, a random node $v$ will be chosen in the subtree of $u$ ($u \\neq v$), and the values $a_u$ and $a_v$ will be swapped, hence the value of the node $v$ will become zero and the process will continue until the zero is on a leaf node. At this point, we will call the tree a final tree.\r\n\r\n**Note**: there is exactly one node with a value equal to zero in a final tree and that node is a leaf node.\r\n\r\nYour task is to tell how many different final trees are possible. Two final trees are different if there exists at least one node $u$, such that the value of the node $u$ in one final tree differs from the value of the node $u$ in the other final tree. Since the answer can be large, print it modulo $10^9 +7$.\r\n\r\n###Input\r\n\r\n- The first line contains an integer $T$, the number of test cases. Then the test cases follow. \r\n- The first line of each test case contains an integer $N$, the number of nodes.\r\n- Each of the next $N-1$ lines contains two integers $u$ and $v$, denoting that there is an undirected edge between the node $u$ and the node $v$.\r\n- The next line contains $N$ integers $a_1,\\ldots, a_N$.\r\n\r\n###Output\r\nFor each test case, output on a new line, number of different final trees possible, modulo $10^9+7$.\r\n\r\n###Constraints \r\n- $1 \\leq T \\leq 10^5$\r\n- $1 \\leq N \\leq 10^5$\r\n- $1 \\leq u, v \\leq N$\r\n- $1\\le a_i\\le 10^9$\r\n- The edges form a tree structure.\r\n- The sum of $N$ over all test cases does not exceed $10^6$.\r\n\r\n###Sample Input\r\n```\r\n3\r\n1\r\n1\r\n4\r\n1 2\r\n2 3\r\n2 4\r\n1 1 1 2\r\n7\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n3 6\r\n3 7\r\n1 2 3 4 1 2 1\r\n```\r\n\r\n\r\n###Sample Output\r\n```\r\n1\r\n4\r\n14\r\n```\r\n\t\r\n###Explanation\r\n- For the first test case, the only possible final tree is when node $1$ is chosen and its value becomes 0.\r\n- For the second test case, the four possible final trees are:\r\n    - [ 1, 1, 1, 0 ]\r\n    - [ 1, 1, 0, 2 ]\r\n    - [ 1, 2, 1, 0 ]\r\n    - [ 2, 1, 1, 0 ]\r\n\r\n    ( The $i$-th number in the array denotes the value of node $i$ in the final tree).\r\n\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"https:\/\/youtu.be\/oPYoK1EEOVQ","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"mexomerf","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>mexomerf<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"8-05-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook129'>cook129<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dsu-on-tree'>dsu-on-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/mexomerf'>mexomerf<\/a>","problem_difficulty_level":"Easy-Medium","user_zen_mode":false,"best_tag":"Dsu On Tree","editorial_url":"https:\/\/discuss.codechef.com\/problems\/FLGZRO","time":{"view_start_date":1621794602,"submit_start_date":1621794602,"visible_start_date":1621794602,"end_date":1735669800,"current":1643797813},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=FLGZRO","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}