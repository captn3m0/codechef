{"category_name":"easy","status":"success","problem_code":"CHSTR","problem_name":"Chef and String","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/JUNE15\/mandarin\/CHSTR.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/JUNE15\/russian\/CHSTR.pdf\">Russian<\/a>.<\/h3>\n<p>Chef has a string <b>S<\/b> consisting of <b>N<\/b> lowercase English alphabets. He has prepared a list <b>L<\/b> consisting of all non empty <a href=\"http:\/\/en.wikipedia.org\/wiki\/Substring\">substrings<\/a> of the string <b>S<\/b>.<\/p>\n<p>Now he asks you <b>Q<\/b> questions. To <b>i<sup>th<\/sup><\/b> question, you need to count the number of ways to choose exactly <b>K<sub>i<\/sub><\/b> equal strings from the list <b>L<\/b>. As answer could be large you need to find it modulo <b>10<sup>9<\/sup>+7<\/b>.<\/p>\n<h3>Input<\/h3>\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. First line of each test case contains two space-separated integers <b>N<\/b> and <b>Q<\/b> denoting the length of the string <b>S<\/b> and amount of questions. The next line of each test case contains a single string <b>S<\/b>. Each of the next <b>Q<\/b> lines contains a single integer <b>K<sub>i<\/sub><\/b>.<\/p>\n<h3>Output<\/h3>\n<p>For each test case, output <b>Q<\/b> lines, each line should contain one integer - amount of ways to choose exactly <b>K<sub>i<\/sub><\/b> equal strings from the list <b>L<\/b>.<\/p>\n<h3>Constraints<\/h3>\n<p><b>Subtask 1: (10 points)<\/b><\/p>\n<ul>\n<li><b>1 \u2264 T \u2264 100<\/b><\/li>\n<li><b>1 \u2264 N \u2264 5<\/b><\/li>\n<li><b>1 \u2264 Q \u2264 5<\/b><\/li>\n<li><b>1 \u2264 K<sub>i<\/sub> \u2264 5<\/b><\/li>\n<\/ul>\n<p><br \/>\n<b>Subtask 2: (20 points)<\/b><\/p>\n<ul>\n<li><b>T = 1<\/b><\/li>\n<li><b>1 \u2264 N \u2264 500<\/b><\/li>\n<li><b>1 \u2264 Q \u2264 10<sup>5<\/sup><\/b><\/li>\n<li><b>1 \u2264 K<sub>i<\/sub> \u2264 10<sup>9<\/sup><\/b><\/li>\n<\/ul>\n<p><br \/>\n<b>Subtask 3: (70 points)<\/b><\/p>\n<ul>\n<li><b>T = 1<\/b><\/li>\n<li><b>1 \u2264 N \u2264 5000<\/b><\/li>\n<li><b>1 \u2264 Q \u2264 10<sup>5<\/sup><\/b><\/li>\n<li><b>1 \u2264 K<sub>i<\/sub> \u2264 10<sup>9<\/sup><\/b><\/li>\n<\/ul>\n<p><\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n1\n5 4\nababa\n2\n1\n3\n4\n<b>Output:<\/b>\n7\n15\n1\n0\n<\/pre><h3>Explanation<\/h3>\n<p><b>L<\/b> = {<b>\"a\", \"b\", \"a\", \"b\", \"a\", \"ab\", \"ba\", \"ab\", \"ba\", \"aba\", \"bab\", \"aba\", \"abab\", \"baba\", \"ababa\"<\/b>}.<\/p>\n<ul>\n<li><b>k<sub>1<\/sub> = 2<\/b>: There are seven ways to choose two equal strings (\"a\", \"a\"), (\"a\", \"a\"), (\"a\", \"a\"), (\"b\", \"b\"), (\"ab\", \"ab\"), (\"ba\", \"ba\"), (\"aba\", \"aba\"). <\/li>\n<li><b>k<sub>2<\/sub> = 1<\/b>: We can choose any string from <b>L<\/b> (15 ways). <\/li>\n<li><b>k<sub>3<\/sub> = 3<\/b>: There is one way to choose three equal strings - (\"a\", \"a\", \"a\"). <\/li>\n<li><b>k<sub>4<\/sub> = 4<\/b>: There are no four equal strings in <b>L<\/b> . <\/li>\n<\/ul>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"antoniuk1","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>antoniuk1<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"6-04-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/antoniuk1'>\n                    antoniuk1\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>\n                    combinatorics\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/june15'>\n                    june15\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/suffix-array'>\n                    suffix-array\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/zfunction'>\n                    zfunction\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/CHSTR","user":{"username":null},"time":{"view_start_date":1434360600,"submit_start_date":1434360600,"visible_start_date":1434360600,"end_date":1735669800,"current":1493558214},"todo":false,"problem_status":"unattempted"}