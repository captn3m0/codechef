{"category_name":"easy","status":"success","problem_code":"SUMSUB","problem_name":"Subarray Sum","body":"Chef has a sequence of $N$ integers $A_1, A_2,\\dots, A_N$. He defines a function $f(i, j)$ as follows:\r\n\r\n$f(i, j) = A_i + max(A_i, A_{i + 1}) + max(A_i, A_{i + 1}, A_{i + 2}) + \\dots + max(A_i, A_{i + 1}, \\dots, A_j)$\r\n\r\nChef tries to find the sum of $f(i, j)$ over all $(i, j)$ such that $1 \\leq i \\leq j \\leq N$ $(i.e \\sum\\limits_{i=1}^n \\sum\\limits_{j=i}^nf(i, j))$, but fails. Can you help him find the sum? \r\n\r\nSince the sum can be very large, find it modulo $(10^9 + 7)$.\r\n\r\n**Note:** Since the size of the input and output is large, please use fast input-output methods.\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"- $1 \\leq T \\leq 5\\cdot 10^3$\n- $1 \\leq N \\leq 2\\cdot 10^5$\n- $1 \\leq A_i \\leq 10^9$\n- Sum of $N$ over all test cases does not exceed $10^6$.\n","constraintsState":true,"subtasks":"","subtasksState":false,"statement":"Chef has a sequence of $N$ integers $A_1, A_2,\\dots, A_N$. He defines a function $f(i, j)$ as follows:\n\n$f(i, j) = A_i + max(A_i, A_{i + 1}) + max(A_i, A_{i + 1}, A_{i + 2}) + \\dots + max(A_i, A_{i + 1}, \\dots, A_j)$\n\nChef tries to find the sum of $f(i, j)$ over all $(i, j)$ such that $1 \\leq i \\leq j \\leq N$ $(i.e \\sum\\limits_{i=1}^n \\sum\\limits_{j=i}^nf(i, j))$, but fails. Can you help him find the sum? \n\nSince the sum can be very large, find it modulo $(10^9 + 7)$.\n\n**Note:** Since the size of the input and output is large, please use fast input-output methods.","inputFormat":"- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains an integer $N$.\n- The second line contains $N$ space-separated integers $A_1, A_2, \\dots, A_N$.","inputFormatState":true,"outputFormat":"For each test case, print a single line containing one integer - the required sum i.e $\\sum\\limits_{i=1}^n \\sum\\limits_{j=i}^nf(i, j)$ modulo $(10^9 + 7)$.","outputFormatState":true,"sampleTestCases":[{"id":"1","input":"3\n2\n1 2\n3\n1 2 3\n4\n5 4 1 3\n\n\n\n","output":"6\n20\n82\n","explanation":"**Test case $1$**: \n\n- $f(1, 1) = A_1 = 1$.\n- $f(1, 2) = A_1 + max(A_1, A_2) = 1 + max(1, 2) = 1 + 2 = 3$.\n- $f(2, 2) = A_2 = 2$. \n\nHence the required sum $= 1 + 3 + 2 = 6$.\n\n**Test case $2$**: \n\n- $f(1, 1) = A_1 = 1$.\n- $f(1, 2) = A_1 + max(A_1, A_2) = 1 + max(1, 2) = 1 + 2 = 3$.\n- $f(1, 3) = A_1 + max(A_1, A_2) + max(A_1, A_2, A_3) = 1 + max(1, 2) + max(1, 2, 3) = 1 + 2 + 3 = 6$.\n- $f(2, 2) = A_2 = 2$. \n- $f(2, 3) = A_2 + max(A_2, A_3) = 2 + max(2, 3) = 2 + 3 = 5$.\n- $f(3, 3) = A_3 = 3$. \n\nHence the required sum $= 1 + 3 + 6 + 2 + 5 + 3 = 20$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"soumyadeep_21","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>soumyadeep_21<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"4-10-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/soumyadeep_21'>soumyadeep_21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/stack'>stack<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/start16'>start16<\/a>","problem_difficulty_level":"Unavailable","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SUMSUB","time":{"view_start_date":1634751002,"submit_start_date":1634751002,"visible_start_date":1634751002,"end_date":1735669800,"current":1643797893},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SUMSUB","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}