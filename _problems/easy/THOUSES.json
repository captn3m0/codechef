{"category_name":"easy","status":"success","problem_code":"THOUSES","problem_name":"Tree House","body":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/MAY21\/bengali\/THOUSES.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MAY21\/mandarin\/THOUSES.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MAY21\/russian\/THOUSES.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MAY21\/vietnamese\/THOUSES.pdf) as well.\r\n\r\nThere is a large tree house in an unknown world. It is ruled by the great emperor KZS. It consists of $N$ nodes numbered from $1$ to $N$ in which the people of that world reside. The nodes are organized in a tree structure rooted at node $1$. You need to assign values to the nodes according to the wishes of emperor KZS which are as follows :-\r\n\r\n- The value of node $1$ is $X$.\r\n- All immediate children of any node have pairwise distinct values.                                   \r\n- For every node with at least one immediate child, the $\\gcd$ of the values of all immediate children is equal to the value of the node.                                                                                                                                           \r\n- The total sum of the values of all nodes should be minimum.\r\n\r\nThe greatest common divisor $\\gcd(a,b)$ of two positive integers $a$ and $b$ is equal to the largest integer $d$ such that both integers $a$ and $b$ are divisible by $d$.\r\n\r\nPrint the sum of all values, modulo $10^{9} + 7$.\r\n\r\n###Input\r\n\r\n- The first line contains an integer $T$, the number of test cases. $T$ testcases follow.  \r\n- The first line of each test contains two integers $N$ and $X$.\r\n- Each of the following $N-1$ lines contains two integers $u$ and $v$, denoting an edge between nodes $u$ and $v$.                               \r\n\r\n###Output\r\n\r\n- For each test case, print the sum of values, modulo $10^{9} + 7$.\r\n\r\n###Constraints\r\n\r\n- $1 \\leq T \\leq 15$                                     \r\n- $2 \\leq N \\leq 3 \\cdot 10^{5}$                                            \r\n- $1 \\leq X \\leq 10^{9}$                                    \r\n- $1 \\leq u, v \\leq N$ and $u \\neq v$  \r\n- The given edges form a tree\r\n- The sum of $N$ over all test cases doesn't exceed $3 \\cdot 10^{5}$.          \r\n\r\n###Subtasks\r\n**Subtask #1 (100 points):** Original Constraints          \r\n\r\n###Sample Input\r\n```\r\n2\r\n4 1\r\n1 2\r\n1 3\r\n1 4\r\n8 1\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n5 6\r\n5 7\r\n7 8\r\n```\r\n\r\n###Sample Output\r\n```\r\n7\r\n11\r\n```\r\n\r\n###Explanation\r\n\r\nIn test case $1$, we will give values $1$, $2$, $3$ to the nodes $2$, $3$ and $4$ respectively.\r\nSo, the total sum will be $1 + 1 + 2 + 3 = 7$.\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/MAY21\/bengali\/THOUSES.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MAY21\/mandarin\/THOUSES.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MAY21\/russian\/THOUSES.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MAY21\/vietnamese\/THOUSES.pdf) as well.\r\n\r\nThere is a large tree house in an unknown world. It is ruled by the great emperor KZS. It consists of $N$ nodes numbered from $1$ to $N$ in which the people of that world reside. The nodes are organized in a tree structure rooted at node $1$. You need to assign values to the nodes according to the wishes of emperor KZS which are as follows :-\r\n\r\n- The value of node $1$ is $X$.\r\n- All immediate children of any node have pairwise distinct values.                                   \r\n- For every node with at least one immediate child, the $\\gcd$ of the values of all immediate children is equal to the value of the node.                                                                                                                                           \r\n- The total sum of the values of all nodes should be minimum.\r\n\r\nThe greatest common divisor $\\gcd(a,b)$ of two positive integers $a$ and $b$ is equal to the largest integer $d$ such that both integers $a$ and $b$ are divisible by $d$.\r\n\r\nPrint the sum of all values, modulo $10^{9} + 7$.\r\n\r\n###Input\r\n\r\n- The first line contains an integer $T$, the number of test cases. $T$ testcases follow.  \r\n- The first line of each test contains two integers $N$ and $X$.\r\n- Each of the following $N-1$ lines contains two integers $u$ and $v$, denoting an edge between nodes $u$ and $v$.                               \r\n\r\n###Output\r\n\r\n- For each test case, print the sum of values, modulo $10^{9} + 7$.\r\n\r\n###Constraints\r\n\r\n- $1 \\leq T \\leq 15$                                     \r\n- $2 \\leq N \\leq 3 \\cdot 10^{5}$                                            \r\n- $1 \\leq X \\leq 10^{9}$                                    \r\n- $1 \\leq u, v \\leq N$ and $u \\neq v$  \r\n- The given edges form a tree\r\n- The sum of $N$ over all test cases doesn't exceed $3 \\cdot 10^{5}$.          \r\n\r\n###Subtasks\r\n**Subtask #1 (100 points):** Original Constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n4 1\r\n1 2\r\n1 3\r\n1 4\r\n8 1\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n5 6\r\n5 7\r\n7 8","output":"7\r\n11","explanation":"In test case $1$, we will give values $1$, $2$, $3$ to the nodes $2$, $3$ and $4$ respectively.\r\nSo, the total sum will be $1 + 1 + 2 + 3 = 7$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/8A113_2d7cU","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"zankanotachi","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>zankanotachi<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"14-04-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/greedy'>greedy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/may21'>may21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/zankanotachi'>zankanotachi<\/a>","problem_difficulty_level":"Easy-Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/THOUSES","time":{"view_start_date":1621243802,"submit_start_date":1621243802,"visible_start_date":1621243802,"end_date":1735669800,"current":1643797895},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=THOUSES","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}