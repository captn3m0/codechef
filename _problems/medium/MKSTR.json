
{"category_name":"medium","status":"success","problem_code":"MKSTR","problem_name":"Make a String","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME62\/hindi\/MKSTR.pdf\" target=\"_blank\">Hindi,<\/a>\n<a href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME62\/mandarin\/MKSTR.pdf\" target=\"_blank\">Mandarin chinese<\/a>\n, <a href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME62\/russian\/MKSTR.pdf\" target=\"_blank\">Russian<\/a> and <a href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME62\/vietnamese\/MKSTR.pdf\" target=\"_blank\">Vietnamese<\/a> as well.<\/h3>\n\n\nYou have an initially empty string $S$, a target string $T$ and a sequence of $n$ strings $p_1, p_2, \\dots, p_n$. You may perform any number of operations; let's denote by $|S|$ the length of the string $S$ before the current operation. Each operation should be of one of the following types:\n- insert a lowercase English letter $x$ at the beginning of the string $S$; the cost of this operation is $cl_x \\cdot |S|$\n- append a lowercase English letter $x$ to the end of $S$ with cost $cr_x \\cdot |S|$\n- choose a valid index $i$ and insert the string $p_i$ at the beginning of $S$ with cost $kl_i \\cdot |S|$\n- choose a valid index $i$ and append the string $p_i$ to the end of $S$ with cost $kr_i \\cdot |S|$\n\nNote that in the first two types of operations, $x$ refers to any English lower case letter. Not just the letter 'x'.\n\nYour task is to calculate the minimum total cost of building the target string $T$, i.e. the minimum sum of costs of operations needed to make $S$ equal to $T$.\n\n### Input\n- The first line of the input contains a single integer $n$.\n- $n$ lines follow. For each valid $i$, the $i$-th of these lines contains the string $p_i$.\n- The next line contains $26$ space-separated integers $cl_a, cl_b, \\dots, cl_z$.\n- The next line contains $26$ space-separated integers $cr_a, cr_b, \\dots, cr_z$.\n- The next line contains $n$ space-separated integers $kl_1, kl_2, \\dots, kl_n$.\n- The next line contains $n$ space-separated integers $kr_1, kr_2, \\dots, kr_n$.\n- The last line contains a single string $T$.\n\n### Output\nPrint a single line containing one integer \u2014 the minimum cost of building the target string.\n\n### Constraints \n- $1 \\le n \\le 10^4$\n- $1 \\le |p_i| \\le 100$ for each valid $i$\n- $1 \\le |T| \\le 1,000$\n- $1 \\le cl_i, cr_i \\le 10^9$ for each lowercase English letter $i$\n- $1 \\le kl_i, kr_i \\le 10^9$ for each valid $i$\n- all strings contain only lowercase English letters\n\n### Subtasks\n**Subtask #1 (30 points):**\n- $n \\le 10$\n- $|p_i| \\le 10$ for each valid $i$\n\n**Subtask #2 (70 points):** original constraints\n\n### Example Input\n```\n3\naba\nba\nxy\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26\n3 2 1 3 5 9 10 11 11 9 9 8 7 6 5 1 33 22 11 90 1 1 2 3 5 8\n1 2 3\n1 1 1\nabacaba\n```\n\n### Example Output\n```\n5\n```\n\n### Explanation\nFirst of all, we should perform an operation of the first or second type and add the letter \"c\" to the initial empty string $S$, with cost $0$ because $|S|=0$ currently. Next, we should perform an operation of the third type, inserting the string \"aba\" at the beginning of $S$ with cost $1 \\cdot 1 = 1$ (since $|S|=1$ currently); after this operation, $S$ is \"abac\". Finally, we should perform an operation of the fourth type, appending the string \"aba\" to $S$ with cost $1 \\cdot 4 = 4$ (since $|S|=4$ currently). After this operation, $S=T$, so the total cost is $0 + 4 + 1 = 5$.\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"fekete","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>fekete<\/span>","problem_tester":null,"problem_tester_html_handle":null,"date_added":"25-07-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fekete'>fekete<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fekete'>fekete<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/likecs'>likecs<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime62'>ltime62<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/string-hashing'>string-hashing<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tries'>tries<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MKSTR","time":{"view_start_date":1532797200,"submit_start_date":1532797200,"visible_start_date":1532797200,"end_date":1735669800,"current":1559472977},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}