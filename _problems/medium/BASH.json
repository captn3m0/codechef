{"category_name":"medium","status":"success","problem_code":"BASH","problem_name":"Bash Matrix","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/FEB21\/hindi\/BASH.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/FEB21\/bengali\/BASH.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/mandarin\/BASH.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/FEB21\/russian\/BASH.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/vietnamese\/BASH.pdf) as well.\r\n\r\nA Bash matrix is a matrix with $N$ rows (numbered $1$ through $N$) and $N$ columns (numbered $1$ through $N$), where for each row $r$ and column $c$, the cell in row $r$ and column $c$ (denoted by $(r, c)$) contains one of the characters 'U', 'D', 'L' or 'R'.\r\n\r\nWe can move in the matrix while treating the characters as instructions:\r\n- If the character in the cell $(r,c)$ is 'R', move to the right cell $(r,c+1)$.\r\n- If the character in the cell $(r,c)$ is 'L', move to the left cell $(r,c-1)$.\r\n- If the character in the cell $(r,c)$ is 'U', move to the top cell $(r-1,c)$.\r\n- If the character in the cell $(r,c)$ is 'D', move to the bottom cell $(r+1,c)$.\r\n\r\nIn addition, it must be impossible to leave the matrix by following these instructions regardless of the cell we start in.\r\n\r\nOnce in his childhood, Chef had chosen a Bash matrix and for each cell $(r,c)$ of this matrix, he did the following:\r\n- Mark all cells as not visited.\r\n- Start in the cell $(r,c)$.\r\n- While he has not previously visited the cell he is currently in, move in the matrix following the instructions. In other words, he stops moving as soon as he finds out that he is in a cell which he has visited before (possibly the starting cell).\r\n- Note the cell $(x_{r,c}, y_{r,c})$ where he stops, i.e. the first cell he visits twice during this process.\r\n\r\nFor example, consider the following Bash matrix:\r\n```\r\nRLD\r\nDLL\r\nRRU\r\n```\r\n\r\nThe corresponding notes for this matrix would be\r\n$$\r\n\\begin{bmatrix}\r\n(1,1) & (1,2) & (2,3)\\\\\r\n(2,1) & (2,2) & (2,3)\\\\\r\n(3,1) & (3,2) & (3,3)\\\\\r\n\\end{bmatrix}\r\n$$\r\n\r\n- Consider the starting cell $(1,1)$. He moves along the path $(1,1) \\rightarrow (1,2) \\rightarrow (1,1)$. At that point, since he has already visited $(1,1)$, he stops in this cell.\r\n- Next, consider the starting cell $(1,3)$. He moves along the path $(1,3) \\rightarrow (2,3) \\rightarrow (2,2) \\rightarrow (2,1) \\rightarrow (3,1) \\rightarrow (3,2) \\rightarrow (3,3) \\rightarrow (2,3)$. He had already visited $(2,3)$, so he stops moving in this cell.\r\n\r\nYears later, he found his notes, but he couldn't remember the Bash matrix for which he made the notes. Therefore, he is asking you to construct a Bash matrix that satifies his notes or determine that no such matrix exists.\r\n\r\nAdditionally, putting characters 'U', 'L', 'D' or 'R' in a Bash matrix costs $P_U$, $P_L$, $P_D$ or $P_R$ per character respectively. If there are multiple solutions, you should find one with the smallest possible cost. If there are multiple solutions with this cost, you may find any one of them.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $N$.\r\n- The second line contains four space-separated integers $P_U$, $P_L$, $P_D$ and $P_R$.\r\n- $N$ lines follow. For each valid $i$, the $i$-th of these lines contains $2N$ space-separated integers $x_{i,1},y_{i,1},x_{i,2},\\ldots,x_{i,N},y_{i,N}$.\r\n\r\n### Output\r\nIf there is no Bash matrix that satisfies Chef's notes, print a single line containing the integer $-1$.\r\n\r\nOtherwise, print $N+1$ lines. The first line should contain a single integer \u2014 the minimum cost of a Bash matrix that satisfies Chef's notes. For each valid $i$, the $i+1$-th line should contain a single string with length $N$ describing the $i$-th row of your matrix.\r\n\r\n### Constraints\r\n- $1 \\leq N \\leq 50$\r\n- $1 \\leq P_U,P_L,P_D,P_R \\leq 10^5$\r\n- $1 \\leq x_{i,j},y_{i,j} \\leq N$ for each valid $i,j$\r\n\r\n### Subtasks\r\n**Subtask #1 (30 points):** $P_U = P_L = P_D = P_R$\r\n\r\n**Subtask #2 (70 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n4\r\n5 6 7 6\r\n1 1 1 2 1 3 1 4\r\n2 1 2 1 2 4 2 4\r\n3 1 3 4 3 4 3 4\r\n4 1 4 2 4 3 4 4\r\n```\r\n\r\n### Example Output\r\n```\r\n96\r\nDLLL\r\nDLRU\r\nDRRU\r\nRRRU\r\n```\r\n\r\n### Explanation\r\nConsider any of the boundary cells as the starting cell. Chef is bound to follow the cyclic path along the boundary (either clockwise or counterclockwise). For the remaining starting cells:\r\n- Starting in the cell $(2,2)$, Chef moves to $(2,1)$ and then follows the cyclic path, stopping at $(2,1)$ again.\r\n- Starting in the cell $(2,3)$, Chef moves to $(2,4)$ and then follows the cyclic path, stopping at $(2,4)$ again.\r\n- Starting in the cell $(3,2)$, Chef moves to $(3,3) \\rightarrow (3,4)$ and then follows the cyclic path, stopping at $(3,4)$.\r\n- Starting in the cell $(3,3)$, Chef moves to $(3,4)$ and then follows the cyclic path, stopping at $(3,4)$ again.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/FEB21\/hindi\/BASH.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/FEB21\/bengali\/BASH.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/mandarin\/BASH.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/FEB21\/russian\/BASH.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/vietnamese\/BASH.pdf) as well.\r\n\r\nA Bash matrix is a matrix with $N$ rows (numbered $1$ through $N$) and $N$ columns (numbered $1$ through $N$), where for each row $r$ and column $c$, the cell in row $r$ and column $c$ (denoted by $(r, c)$) contains one of the characters 'U', 'D', 'L' or 'R'.\r\n\r\nWe can move in the matrix while treating the characters as instructions:\r\n- If the character in the cell $(r,c)$ is 'R', move to the right cell $(r,c+1)$.\r\n- If the character in the cell $(r,c)$ is 'L', move to the left cell $(r,c-1)$.\r\n- If the character in the cell $(r,c)$ is 'U', move to the top cell $(r-1,c)$.\r\n- If the character in the cell $(r,c)$ is 'D', move to the bottom cell $(r+1,c)$.\r\n\r\nIn addition, it must be impossible to leave the matrix by following these instructions regardless of the cell we start in.\r\n\r\nOnce in his childhood, Chef had chosen a Bash matrix and for each cell $(r,c)$ of this matrix, he did the following:\r\n- Mark all cells as not visited.\r\n- Start in the cell $(r,c)$.\r\n- While he has not previously visited the cell he is currently in, move in the matrix following the instructions. In other words, he stops moving as soon as he finds out that he is in a cell which he has visited before (possibly the starting cell).\r\n- Note the cell $(x_{r,c}, y_{r,c})$ where he stops, i.e. the first cell he visits twice during this process.\r\n\r\nFor example, consider the following Bash matrix:\r\n```\r\nRLD\r\nDLL\r\nRRU\r\n```\r\n\r\nThe corresponding notes for this matrix would be\r\n$$\r\n\\begin{bmatrix}\r\n(1,1) & (1,2) & (2,3)\\\\\r\n(2,1) & (2,2) & (2,3)\\\\\r\n(3,1) & (3,2) & (3,3)\\\\\r\n\\end{bmatrix}\r\n$$\r\n\r\n- Consider the starting cell $(1,1)$. He moves along the path $(1,1) \\rightarrow (1,2) \\rightarrow (1,1)$. At that point, since he has already visited $(1,1)$, he stops in this cell.\r\n- Next, consider the starting cell $(1,3)$. He moves along the path $(1,3) \\rightarrow (2,3) \\rightarrow (2,2) \\rightarrow (2,1) \\rightarrow (3,1) \\rightarrow (3,2) \\rightarrow (3,3) \\rightarrow (2,3)$. He had already visited $(2,3)$, so he stops moving in this cell.\r\n\r\nYears later, he found his notes, but he couldn't remember the Bash matrix for which he made the notes. Therefore, he is asking you to construct a Bash matrix that satifies his notes or determine that no such matrix exists.\r\n\r\nAdditionally, putting characters 'U', 'L', 'D' or 'R' in a Bash matrix costs $P_U$, $P_L$, $P_D$ or $P_R$ per character respectively. If there are multiple solutions, you should find one with the smallest possible cost. If there are multiple solutions with this cost, you may find any one of them.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $N$.\r\n- The second line contains four space-separated integers $P_U$, $P_L$, $P_D$ and $P_R$.\r\n- $N$ lines follow. For each valid $i$, the $i$-th of these lines contains $2N$ space-separated integers $x_{i,1},y_{i,1},x_{i,2},\\ldots,x_{i,N},y_{i,N}$.\r\n\r\n### Output\r\nIf there is no Bash matrix that satisfies Chef's notes, print a single line containing the integer $-1$.\r\n\r\nOtherwise, print $N+1$ lines. The first line should contain a single integer \u2014 the minimum cost of a Bash matrix that satisfies Chef's notes. For each valid $i$, the $i+1$-th line should contain a single string with length $N$ describing the $i$-th row of your matrix.\r\n\r\n### Constraints\r\n- $1 \\leq N \\leq 50$\r\n- $1 \\leq P_U,P_L,P_D,P_R \\leq 10^5$\r\n- $1 \\leq x_{i,j},y_{i,j} \\leq N$ for each valid $i,j$\r\n\r\n### Subtasks\r\n**Subtask #1 (30 points):** $P_U = P_L = P_D = P_R$\r\n\r\n**Subtask #2 (70 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n4\r\n5 6 7 6\r\n1 1 1 2 1 3 1 4\r\n2 1 2 1 2 4 2 4\r\n3 1 3 4 3 4 3 4\r\n4 1 4 2 4 3 4 4\r\n```\r\n\r\n### Example Output\r\n```\r\n96\r\nDLLL\r\nDLRU\r\nDRRU\r\nRRRU\r\n```\r\n\r\n### Explanation\r\nConsider any of the boundary cells as the starting cell. Chef is bound to follow the cyclic path along the boundary (either clockwise or counterclockwise). For the remaining starting cells:\r\n- Starting in the cell $(2,2)$, Chef moves to $(2,1)$ and then follows the cyclic path, stopping at $(2,1)$ again.\r\n- Starting in the cell $(2,3)$, Chef moves to $(2,4)$ and then follows the cyclic path, stopping at $(2,4)$ again.\r\n- Starting in the cell $(3,2)$, Chef moves to $(3,3) \\rightarrow (3,4)$ and then follows the cyclic path, stopping at $(3,4)$.\r\n- Starting in the cell $(3,3)$, Chef moves to $(3,4)$ and then follows the cyclic path, stopping at $(3,4)$ again.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"https:\/\/youtu.be\/RAsI0IYWkjs","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"shaanknight","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>shaanknight<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"31-01-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/feb21'>feb21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/mincut-maxflow'>mincut-maxflow<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/minimum-spanning-tree'>minimum-spanning-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/shaanknight'>shaanknight<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Minimum Spanning Tree","editorial_url":"https:\/\/discuss.codechef.com\/problems\/BASH","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797919},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=BASH","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}