---
{"category_name":"medium","problem_code":"GCDLEN","problem_name":"Maximal GCD","problemComponents":{"constraints":"- $1 \\le N, Q \\le 10^5$\n- $1 \\le A_i, x \\le 10^9$\n- $0\\le y\\le 10^9$\n- $1 \\le l \\le r \\le N$\n- It is guaranteed that after each update, no element of $A$ is greater than $10^9$.\n- The sum of $N$ over all test cases does not exceed $10^5$.\n- The sum of $Q$ over all test cases does not exceed $10^5$.\n","constraintsState":true,"subtasks":"","subtasksState":false,"inputFormat":"- The first line contains an integer $T$ - the number of test cases. Then the test cases follow. \n- The first line of each test case contains two integers $N$ and $Q$ - the length of the array and the number of updates.\n- The second line contains $N$ integers - the array $A$.\n- The next $Q$ lines each contains four integers $l$, $r$, $x$, $y$ - the description of an update: an arithmetic progression with the initial term $x$ and the common difference $y$ on the subsegment $[l, r]$.","inputFormatState":true,"outputFormat":"For each test case, output $Q+1$ lines. In the first line for each test case output the beauty of the initial array, in the $i$-th ($2 \\le i \\le Q + 1$) line for each test case output the beauty of the array after performing $i-1$ changes.\n","outputFormatState":true,"sampleTestCases":{"0":{"id":1,"input":"1\n6 5\n2 6 4 10 9 12\n4 5 12 6\n2 5 2 4\n2 6 6 3\n1 5 7 3\n1 6 4 0","output":"12\n18\n14\n18\n19\n24","explanation":"After the first operation $A = [2, 6, 4, 12, 18, 12]$. The maximum value is reached on the segment $[4, 6]$.\n\nAfter the second operation $A = [2, 2, 6, 10, 14, 12]$. The maximum value is reached on the segment $[5, 5]$.","isDeleted":false}}},"video_editorial_url":"","languages_supported":{"0":"CPP14","1":"C","2":"JAVA","3":"PYTH 3.6","4":"CPP17","5":"PYTH","6":"PYP3","7":"CS2","8":"ADA","9":"PYPY","10":"TEXT","11":"PAS fpc","12":"NODEJS","13":"RUBY","14":"PHP","15":"GO","16":"HASK","17":"TCL","18":"PERL","19":"SCALA","20":"LUA","21":"kotlin","22":"BASH","23":"JS","24":"LISP sbcl","25":"rust","26":"PAS gpc","27":"BF","28":"CLOJ","29":"R","30":"D","31":"CAML","32":"FORT","33":"ASM","34":"swift","35":"FS","36":"WSPC","37":"LISP clisp","38":"SQL","39":"SCM guile","40":"PERL6","41":"ERL","42":"CLPS","43":"ICK","44":"NICE","45":"PRLG","46":"ICON","47":"COB","48":"SCM chicken","49":"PIKE","50":"SCM qobi","51":"ST","52":"SQLQ","53":"NEM"},"max_timelimit":2.5,"source_sizelimit":50000,"problem_author":"karpovich","problem_tester":"","date_added":"15-07-2021","tags":{"0":"cook131","1":"gcdqueries","2":"greatest","3":"karpovich","4":"lazy","5":"medium","6":"segment"},"problem_difficulty_level":"Medium-Hard","best_tag":"Segment Tree","editorial_url":"https://discuss.codechef.com/problems/GCDLEN","time":{"view_start_date":1627492504,"submit_start_date":1627492504,"visible_start_date":1627492504,"end_date":1735669800},"is_direct_submittable":false,"problemDiscussURL":"https://discuss.codechef.com/search?q=GCDLEN","is_proctored":false,"visitedContests":{},"layout":"problem"}
---
### Read problems statements in [Mandarin Chinese](https://www.codechef.com/download/translated/COOK131/mandarin/GCDLEN.pdf), [Russian](https://www.codechef.com/download/translated/COOK131/russian/GCDLEN.pdf), [Vietnamese](https://www.codechef.com/download/translated/COOK131/vietnamese/GCDLEN.pdf) and [Bengali](https://www.codechef.com/download/translated/COOK131/bengali/GCDLEN.pdf) as well. 

Chef has found an integer array $A$ of length $N$. He defines the *beauty* of an array as the maximal value of $\gcd(A_l, A_{l+1}, \ldots, A_r) \cdot (r - l + 1)$ over all the subsegments $[l, r]$ of the array $A$.

Chef loves to explore, so aside from the beauty of the initial array, he wants to know the beauty of the array after performing each of $Q$ updates. Each update replaces a subsegment of the array with an arithmetic progression. Updates are cumulative.

Formally, in each update you are given four integers $l$, $r$, $x$, and $y$. Then for each $i\in [l, r]$, you must replace $A_i$ with $x+y(i-l)$.

<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.</div></aside>