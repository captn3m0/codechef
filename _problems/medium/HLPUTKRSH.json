{"category_name":"medium","status":"success","problem_code":"HLPUTKRSH","problem_name":"Help Utkarsh","body":"This is an example statement in markdown. This is the statement of the problem [TANDC](https:\/\/codechef.com\/problems\/TANDC) on CodeChef. The main statement starts with the next paragraph. Please make sure to remove this paragraph from your statement before publishing your problem. If your problem doesn't contain Subtasks, you should remove the section subtask too. We are using markdown the syntax of which can be seen [at](https:\/\/github.com\/showdownjs\/showdown\/wiki\/Showdown's-Markdown-syntax). We request you to not use any HTML tags in the statement, e.g. no p, ul, li, pre, br or b tags. If you face any issue, please contact admins or email us at help@codechef.com.\n\nTracy is teaching Charlie maths via a game called $N$-Cube, which involves three sections involving $N$.\n\nTracy gives Charlie a number $N$, and Charlie makes a list of $N$-th powers of integers in increasing order $1^N, 2^N, 3^N, \\dot, \\text{so on}$. This teaches him exponentiation.\n\nThen Charlie performs the following subtraction game $N$ times: Take all pairs of consecutive numbers in the list and take their difference. These differences then form the new list for the next iteration of the game. Eg, if $N$ was 6, the list proceeds as $[1, 64, 729, 4096 ... ]$ to $[63, 685, 3367 ...]$, and so on $5$ more times.\n\nAfter the subtraction game, Charlie has to correctly tell Tracy the $N$-th element of the list. This number is the *value of the game*.\n\nAfter practice Charlie became an expert in the game. To challenge him more, Tracy will give two numbers $M$ (where $M$ is a prime) and $R$ instead of just a single number $N$, and the game must start from $M_R - 1$ instead of $N$. Since the *value of the game* can now become large, Charlie just have to tell the largest integer $K$ such that $M_K$ divides this number. Since even $K$ can be large, output $K$ modulo 1000000007 ($10^9 + 7$).\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"- $1 \\leq T \\leq 10^3$\n- $1 \\leq N \\leq 10^5$\n- $1 \\leq |S_i| \\leq 3 \\cdot 10^5$\n- Sum of $|S_i|$ over all test cases doesn't exceed $2 \\cdot 10^6$.","constraintsState":true,"subtasks":"- 30 points : $1 \\leq R \\leq 10000$\n- 70 points : $1 \\leq R \\leq 10^9$\n","subtasksState":false,"statement":"### Read problem statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/SNCK1B21\/mandarin\/HLPUTKRSH.pdf) [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/SNCK1B21\/vietnamese\/HLPUTKRSH.pdf), and [Russian](https:\/\/www.codechef.com\/download\/translated\/SNCK1B21\/russian\/HLPUTKRSH.pdf)\n\nUtkarsh is a cool guy and had fun throughout the year. Now his exams are approaching and he hasn't studied for them at all! \n\nUtkarsh has to read several chapters for his exams, but he is smart and realized that he doesn't actually need to read each and every one of them thoroughly. Several chapters share the same content, so he can skip some parts of some chapters to save time.\n\nEach chapter is a non-empty string of lowercase characters. Utkarsh has to read $N$ distinct chapters for the exam, denoted by the set $S = \\{S_1,S_2,\\ldots,S_N\\}$. He will read all $N$ chapters in some order. \n\nFor each chapter $S_i$, he can skip reading some part of it by considering at most two other chapters that he has read already.\n\nFormally, he has $3$ options for the chapter $S_i:$ \n\n1. Suppose there exist two chapters $S_j,S_k \\in S$ ($j$ can be equal to $k$) that he has previously read, and three (possibly empty) strings of lowercase alphabets $A$, $B$, and $C$ such that \n$S_i = A + S_j + B + S_k + C$ (where $+$ denotes string concatenation). Then he has to read only $|A| + |B| + |C|$ characters. \n\n2. Suppose there exists a chapter $S_j \\in S$ that he has previously read, along with two (possibly empty) strings $A$ and $B$ of lowercase alphabets such that $S_i = A + S_j + B$. Then he has to read only $|A| + |B|$ characters.\n\n3. Finally, he can also choose to read chapter $S_i$ completely, requiring $|S_i|$ characters.\n\nNote that there is no forced hierarchy among the options, i.e, Utkarsh is free to choose how he reads $S_i$ chapter among all choices available to him.\n\nFind the minimum amount of characters Utkarsh has to read in total if he chooses an optimal ordering of the chapters.","inputFormat":"- The first line of input contains a single integer $T$, the number of test cases. The description of $T$ test cases follows.\n- Each test case consists of $N+1$ lines.\n- The first line contains a single integer $N$, the number of chapters.\n- Each of the following $N$ lines contains a non-empty lowercase string.\n","inputFormatState":true,"outputFormat":"For each test case, print a single line containing one integer denoting the minimum number of characters Utkarsh has to read over all chapters.\n","outputFormatState":true,"sampleTestCases":[{"id":"1","input":"3\n5\na\naba\naabc\nbc\nc\n2\naaa\nbb\n3\nz\nzz\nzzz\n","output":"5\n5\n1\n","explanation":"**Test case 1:**\n\nUkarsh reads the chapters in the following order :\n\n- $a$ (reads $1$ character)\n- $c$ (reads $1$ character)\n- $aba = a + b + a$ (first and last $a$ already read, reads $1$ character)\n- $bc = b + c$ ($c$ already read, reads $1$ character)\n- $aabc = a + a + bc$ (first $a$ and $bc$ already read, reads $1$ character)\n\nThus, $5$ characters are read in total.\n\n**Test case 2:** \n\nUkarsh reads the chapters in the following order :\n\n- $aaa$ (reads $3$ characters)\n- $bb$ (reads $2$ characters)\n\nThus $5$ characters are read in total.\n\n\n**Test case 3:**\n\nUkarsh reads the chapters in the following order :\n\n- $z$ (reads $1$ character)\n- $zz = z + z$ (first and last $z$ already read,reads $0$ characters)\n- $zzz = z + zz$ ($z$ and $zz$ are already read,reads $0$ characters)\n\nThus $1$ character is read in total.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"daanish_adm","problem_author_html_handle":"daanish_adm","problem_tester":"","problem_tester_html_handle":"","date_added":"26-10-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/aho-corasick'>aho-corasick<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/daanish_adm'>daanish_adm<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/snck1b21'>snck1b21<\/a>","problem_difficulty_level":"Unavailable","user_zen_mode":false,"best_tag":"Aho Corasick","editorial_url":"https:\/\/discuss.codechef.com\/problems\/HLPUTKRSH","time":{"view_start_date":1635694200,"submit_start_date":1635694200,"visible_start_date":1635694200,"end_date":1735669800,"current":1643797947},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=HLPUTKRSH","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}