{"category_name":"medium","status":"success","problem_code":"PARTN01","problem_name":"Even Odd Partition","body":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY21\/bengali\/PARTN01.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY21\/mandarin\/PARTN01.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY21\/russian\/PARTN01.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY21\/vietnamese\/PARTN01.pdf) as well.\n\nLet $f(n)$ be the number of ways to partition the array $[1, 2, 3, \\ldots, n]$ into contiguous subarrays such that every pair of adjacent subarrays in the partition have sums of different parity.\n\n<details>\n    <summary>What is a contiguous subarray?<\/summary>\n    A contiguous subarray of an array $A$ is an array that can be obtained by deleting some (possibly none) elements from the front of $A$ and some (possibly none) elements from the end of $A$. The subarrays of an array $A$ ($1$-indexed) of size $n$ are given by $[A_{i}, A_{i+1}, \\ldots, A_j]$ for each pair of integers $(i, j)$ such that $1\\leq i \\leq j \\leq n$.\n<\/details>\n\n\n<details>\n    <summary>What is a partition of an array into contiguous subarrays?<\/summary>\n    A partition of the array $A$ into contiguous subarrays is a set of subarrays of $A$, $\\{S_1, S_2, S_3, \\ldots, S_k\\}$, such that every element of the array belongs to exactly one of the subarrays $S_1, S_2, \\ldots, S_k$.\n<\/details>\n\n<details>\n    <summary>Which partitions are counted in $f(n)$?<\/summary>\n    Consider a partition $\\{S_1, S_2, \\ldots, S_k\\}$ of the array $[1, 2, \\ldots, n]$, where $S_i$ are in sorted order, i.e. every element in $S_i$ is smaller than every element in $S_{j}$ for all $i\\lt j$. Then $f(n)$ is the number of partitions such that $\\texttt{sum}(S_{i}) \\not\\equiv \\texttt{sum}(S_{i+1}) \\pmod{2} $ for all $1 \\leq i \\lt k$. $\\texttt{sum}(S_{i})$ is the sum of all elements in $S_i$.\n<\/details>\n\nLet $S_0(n) = f(n)$ and $S_{k+1}(n) = S_k(1) + S_k(2) + S_k(3) + \\cdots + S_k(n)$ for $k \\geq 0$.  \nGiven $n$ and $k$, find $S_k(n) \\bmod 998\\ 244\\ 353$.\n\n### Input\n\n- The first line contains a single integer $T$, the number of test cases.\n- The first and only line of each test case contains two integers $n$, $k$.\n\n### Output\n\n- For each test case print in a separate line, the value of $S_k(n) \\bmod 998\\ 244\\ 353$.\n\n### Constraints\n\n- $1\\leq T\\leq 3000$\n- $0\\leq k\\leq 3000$\n- $1 \\leq n \\leq 10^{18}$\n- The sum of $k$ over all test cases does not exceed $3000$.\n\n### Subtasks\n\n- **Subtask #1 (1 point):**\n    - $n \\leq 20$\n    - The time limit for this subtask is 1 second.\n\n- **Subtask #2 (4 points):**\n    - $n \\leq 1000$ (Time limit : 1 sec)\n    - The time limit for this subtask is 1 second.\n\n- **Subtask #3 (10 points):**\n    - $n \\leq 10^6$ \n    - $k = 0$ for all test cases. \n    - The time limit for this subtask is 2 seconds.\n\n- **Subtask #4 (20 points):**\n    - The sum of $k$ is at most $100$.\n    - The time limit for this subtask is 2 seconds.\n\n- **Subtask #5 (25 points):**\n    - The sum of $k$ is at most $3000$.\n    - $k \\leq 100$ and is same for all test cases.\n    - The time limit for this subtask is 2 seconds.\n\n- **Subtask #6 (40 points):** \n    - Original constraints\n    - The time limit for this subtask is 2 seconds.\n\n### Sample Input\n```\n12\n1 0\n2 0\n3 0\n4 0\n5 0\n2 1\n2 2\n3 3\n4 4\n5 5\n1000000000000000000 200\n1000000000000000000 2773\n```\n\n### Sample Output\n```\n1\n2\n2\n3\n6\n3\n4\n14\n51\n191\n13413678\n697825985\n```\n\n### Explanation\n\nWe first find $f(n)$ for $n = 1, 2, 3, 4, 5$.\n\nWhen $n = 1$, there is only one partition $[1]$. Since there is only one subarray, there are no adjacent subarrays in this partition and hence should be counted in $f(1)$, therefore $f(1) = 1$.\n\nWhen $n = 2$, there are $2$ partitions possible, $[1, 2]$ and $[1], [2]$. The first partition has no adjacent subarrays and so is counted in $f(2)$.  \nThe second partition has sums $1, 2$ which are alternating in parity and so is also counted in $f(2)$, therefore $f(2) = 2$.\n\nWhen $n = 3$, there are $4$ partitions possible. The partitions are shown below.\n\n<!-- |  Partition  | Sum of subarrays | Are the sum of subarrays alternating in parity ? |\n| ------------|-------------------|---------------------------------------------------|\n| $[1, 2, 3]$ |$\\{6\\}$|Yes|\n| $[1], [2, 3]$|$\\{1, 5\\}$|No|\n| $[1, 2], [3]$|$\\{3, 3\\}$|No|\n| $[1], [2], [3]$|$\\{1, 2, 3\\}$|Yes| -->\n\n<table>\n<thead>\n<tr>\n<th>Partition<\/th>\n<th>Sum of subarrays<\/th>\n<th>Are the sum of subarrays alternating in parity ?<\/th>\n<\/tr>\n<\/thead>\n<tbody>\n<tr>\n<td>[1, 2, 3]<\/td>\n<td>{6}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3]<\/td>\n<td>{1, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3]<\/td>\n<td>{3, 3}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3]<\/td>\n<td>{1, 2, 3}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n\nThere are in total $2$ partitions whose subarrays sums are alternating in parity, therefore $f(3) = 2$\n\nWhen $n = 4$, there are $8$ partitions. The partitions are shown below.\n\n\n<!-- |  Partition  | Sum of subarrays | Are the sum of subarrays alternating in parity ? |\n| ------------|-------------------|---------------------------------------------------|\n| [1, 2, 3, 4] |\\{10\\}|Yes|\n| [1], [2, 3, 4]|\\{1, 9\\}|No|\n| [1, 2], [3, 4]|\\{3, 7\\}|No|\n| [1], [2], [3, 4]|\\{1, 2, 7\\}|Yes|\n| [1, 2, 3], [4] |\\{6, 4\\}|No|\n| [1], [2, 3], [4]|\\{1, 5, 4\\}|No|\n| [1, 2], [3], [4]|\\{3, 3, 4\\}|No|\n| [1], [2], [3], [4]|\\{1, 2, 3, 4\\}|Yes| -->\n\n<table>\n<thead>\n<tr>\n<th>Partition<\/th>\n<th>Sum of subarrays<\/th>\n<th>Are the sum of subarrays alternating in parity ?<\/th>\n<\/tr>\n<\/thead>\n<tbody>\n<tr>\n<td>[1, 2, 3, 4]<\/td>\n<td>{10}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3, 4]<\/td>\n<td>{1, 9}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3, 4]<\/td>\n<td>{3, 7}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3, 4]<\/td>\n<td>{1, 2, 7}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1, 2, 3], [4]<\/td>\n<td>{6, 4}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3], [4]<\/td>\n<td>{1, 5, 4}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3], [4]<\/td>\n<td>{3, 3, 4}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3], [4]<\/td>\n<td>{1, 2, 3, 4}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n\n\nThere are in total $2$ partitions whose subarrays sums are alternating in parity, therefore $f(3) = 2$\n\nWhen $n = 5$, there are in total $16$ partitions. The partitions are shown below.\n\n\n<!-- |  Partition  | Sum of subarrays | Are the sum of subarrays alternating in parity ? |\n| ------------|-------------------|---------------------------------------------------|\n| [1, 2, 3, 4, 5] |\\{15\\}|Yes|\n| [1], [2, 3, 4, 5]|\\{1, 14\\}|Yes|\n| [1, 2], [3, 4, 5]|\\{3, 12\\}|Yes|\n| [1], [2], [3, 4, 5]|\\{1, 2, 12\\}|No|\n| [1, 2, 3], [4, 5] |\\{6, 9\\}|Yes|\n| [1], [2, 3], [4, 5]|\\{1, 5, 9\\}|No|\n| [1, 2], [3], [4, 5]|\\{3, 3, 9\\}|No|\n| [1], [2], [3], [4, 5]|\\{1, 2, 3, 9\\}|No|\n| [1, 2, 3, 4], [5] |\\{10, 5\\}|Yes|\n| [1], [2, 3, 4], [5]|\\{1, 9, 5\\}|No|\n| [1, 2], [3, 4], [5]|\\{3, 7, 5\\}|No|\n| [1], [2], [3, 4],[5]|\\{1, 2, 7, 5\\}|No|\n| [1, 2, 3], [4], [5] |\\{6, 4, 5\\}|No|\n| [1], [2, 3], [4], [5]|\\{1, 5, 4, 5\\}|No|\n| [1, 2], [3], [4], [5]|\\{3, 3, 4, 5\\}|No|\n| [1], [2], [3], [4], [5]|\\{1, 2, 3, 4, 5\\}|Yes| -->\n\n<table>\n<thead>\n<tr>\n<th>Partition<\/th>\n<th>Sum of subarrays<\/th>\n<th>Are the sum of subarrays alternating in parity ?<\/th>\n<\/tr>\n<\/thead>\n<tbody>\n<tr>\n<td>[1, 2, 3, 4, 5]<\/td>\n<td>{15}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3, 4, 5]<\/td>\n<td>{1, 14}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3, 4, 5]<\/td>\n<td>{3, 12}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3, 4, 5]<\/td>\n<td>{1, 2, 12}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2, 3], [4, 5]<\/td>\n<td>{6, 9}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3], [4, 5]<\/td>\n<td>{1, 5, 9}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3], [4, 5]<\/td>\n<td>{3, 3, 9}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3], [4, 5]<\/td>\n<td>{1, 2, 3, 9}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2, 3, 4], [5]<\/td>\n<td>{10, 5}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3, 4], [5]<\/td>\n<td>{1, 9, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3, 4], [5]<\/td>\n<td>{3, 7, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3, 4],[5]<\/td>\n<td>{1, 2, 7, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2, 3], [4], [5]<\/td>\n<td>{6, 4, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3], [4], [5]<\/td>\n<td>{1, 5, 4, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3], [4], [5]<\/td>\n<td>{3, 3, 4, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3], [4], [5]<\/td>\n<td>{1, 2, 3, 4, 5}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n\n\nThere are in total $6$ partitions whose subarray sums are alternating in parity, therefore $f(5) = 6$\n\n$S_0(n) = f(n)$ and is found as described above.\n\nTo find $S_1(n), S_2(n), \\ldots$, the given formula $S_{k+1}(n) = S_k(1) + S_k(2) + \\cdots + S_k(n)$ is used.  \nFor example $S_1(n) = S_0(1) + S_0(2) + \\cdots + S_0(n)$.\n\nThe values for $S_k(n)$ for $k \\leq 5$ and $n \\leq 5$ are tabulated below.\n\n<!-- | n | S_0(n) | S_1(n) | S_2(n) | S_3(n) | S_4(n) | S_5(n) |\n|---|-----|-----|-----|-----|-----|-----|\n| 1 |  1  | 1 | 1 | 1 | 1 | 1 |\n| 2 |  2  | 3 | 4 | 5 | 6 | 7 |\n| 3 |  2  | 5 | 9 |14 |20 |27 |\n| 4 |  3  | 8 |17 |31 |51 |78 |\n| 5 |  6  |14 |31 |62 |113|191| -->\n\n<table>\n<thead>\n<tr>\n<th>n<\/th>\n<th>S<sub>0<\/sub>(n)<\/th>\n<th>S<sub>1<\/sub>(n)<\/th>\n<th>S<sub>2<\/sub>(n)<\/th>\n<th>S<sub>3<\/sub>(n)<\/th>\n<th>S<sub>4<\/sub>(n)<\/th>\n<th>S<sub>5<\/sub>(n)<\/th>\n<\/tr>\n<\/thead>\n<tbody>\n<tr>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<\/tr>\n<tr>\n<td>2<\/td>\n<td>2<\/td>\n<td>3<\/td>\n<td>4<\/td>\n<td>5<\/td>\n<td>6<\/td>\n<td>7<\/td>\n<\/tr>\n<tr>\n<td>3<\/td>\n<td>2<\/td>\n<td>5<\/td>\n<td>9<\/td>\n<td>14<\/td>\n<td>20<\/td>\n<td>27<\/td>\n<\/tr>\n<tr>\n<td>4<\/td>\n<td>3<\/td>\n<td>8<\/td>\n<td>17<\/td>\n<td>31<\/td>\n<td>51<\/td>\n<td>78<\/td>\n<\/tr>\n<tr>\n<td>5<\/td>\n<td>6<\/td>\n<td>14<\/td>\n<td>31<\/td>\n<td>62<\/td>\n<td>113<\/td>\n<td>191<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY21\/bengali\/PARTN01.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY21\/mandarin\/PARTN01.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY21\/russian\/PARTN01.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY21\/vietnamese\/PARTN01.pdf) as well.\n\nLet $f(n)$ be the number of ways to partition the array $[1, 2, 3, \\ldots, n]$ into contiguous subarrays such that every pair of adjacent subarrays in the partition have sums of different parity.\n\n<details>\n    <summary>What is a contiguous subarray?<\/summary>\n    A contiguous subarray of an array $A$ is an array that can be obtained by deleting some (possibly none) elements from the front of $A$ and some (possibly none) elements from the end of $A$. The subarrays of an array $A$ ($1$-indexed) of size $n$ are given by $[A_{i}, A_{i+1}, \\ldots, A_j]$ for each pair of integers $(i, j)$ such that $1\\leq i \\leq j \\leq n$.\n<\/details>\n\n\n<details>\n    <summary>What is a partition of an array into contiguous subarrays?<\/summary>\n    A partition of the array $A$ into contiguous subarrays is a set of subarrays of $A$, $\\{S_1, S_2, S_3, \\ldots, S_k\\}$, such that every element of the array belongs to exactly one of the subarrays $S_1, S_2, \\ldots, S_k$.\n<\/details>\n\n<details>\n    <summary>Which partitions are counted in $f(n)$?<\/summary>\n    Consider a partition $\\{S_1, S_2, \\ldots, S_k\\}$ of the array $[1, 2, \\ldots, n]$, where $S_i$ are in sorted order, i.e. every element in $S_i$ is smaller than every element in $S_{j}$ for all $i\\lt j$. Then $f(n)$ is the number of partitions such that $\\texttt{sum}(S_{i}) \\not\\equiv \\texttt{sum}(S_{i+1}) \\pmod{2} $ for all $1 \\leq i \\lt k$. $\\texttt{sum}(S_{i})$ is the sum of all elements in $S_i$.\n<\/details>\n\nLet $S_0(n) = f(n)$ and $S_{k+1}(n) = S_k(1) + S_k(2) + S_k(3) + \\cdots + S_k(n)$ for $k \\geq 0$.  \nGiven $n$ and $k$, find $S_k(n) \\bmod 998\\ 244\\ 353$.\n\n### Input\n\n- The first line contains a single integer $T$, the number of test cases.\n- The first and only line of each test case contains two integers $n$, $k$.\n\n### Output\n\n- For each test case print in a separate line, the value of $S_k(n) \\bmod 998\\ 244\\ 353$.\n\n### Constraints\n\n- $1\\leq T\\leq 3000$\n- $0\\leq k\\leq 3000$\n- $1 \\leq n \\leq 10^{18}$\n- The sum of $k$ over all test cases does not exceed $3000$.\n\n### Subtasks\n\n- **Subtask #1 (1 point):**\n    - $n \\leq 20$\n    - The time limit for this subtask is 1 second.\n\n- **Subtask #2 (4 points):**\n    - $n \\leq 1000$ (Time limit : 1 sec)\n    - The time limit for this subtask is 1 second.\n\n- **Subtask #3 (10 points):**\n    - $n \\leq 10^6$ \n    - $k = 0$ for all test cases. \n    - The time limit for this subtask is 2 seconds.\n\n- **Subtask #4 (20 points):**\n    - The sum of $k$ is at most $100$.\n    - The time limit for this subtask is 2 seconds.\n\n- **Subtask #5 (25 points):**\n    - The sum of $k$ is at most $3000$.\n    - $k \\leq 100$ and is same for all test cases.\n    - The time limit for this subtask is 2 seconds.\n\n- **Subtask #6 (40 points):** \n    - Original constraints\n    - The time limit for this subtask is 2 seconds.\n\n### Sample Input\n```\n12\n1 0\n2 0\n3 0\n4 0\n5 0\n2 1\n2 2\n3 3\n4 4\n5 5\n1000000000000000000 200\n1000000000000000000 2773\n```\n\n### Sample Output\n```\n1\n2\n2\n3\n6\n3\n4\n14\n51\n191\n13413678\n697825985\n```\n\n### Explanation\n\nWe first find $f(n)$ for $n = 1, 2, 3, 4, 5$.\n\nWhen $n = 1$, there is only one partition $[1]$. Since there is only one subarray, there are no adjacent subarrays in this partition and hence should be counted in $f(1)$, therefore $f(1) = 1$.\n\nWhen $n = 2$, there are $2$ partitions possible, $[1, 2]$ and $[1], [2]$. The first partition has no adjacent subarrays and so is counted in $f(2)$.  \nThe second partition has sums $1, 2$ which are alternating in parity and so is also counted in $f(2)$, therefore $f(2) = 2$.\n\nWhen $n = 3$, there are $4$ partitions possible. The partitions are shown below.\n\n<!-- |  Partition  | Sum of subarrays | Are the sum of subarrays alternating in parity ? |\n| ------------|-------------------|---------------------------------------------------|\n| $[1, 2, 3]$ |$\\{6\\}$|Yes|\n| $[1], [2, 3]$|$\\{1, 5\\}$|No|\n| $[1, 2], [3]$|$\\{3, 3\\}$|No|\n| $[1], [2], [3]$|$\\{1, 2, 3\\}$|Yes| -->\n\n<table>\n<thead>\n<tr>\n<th>Partition<\/th>\n<th>Sum of subarrays<\/th>\n<th>Are the sum of subarrays alternating in parity ?<\/th>\n<\/tr>\n<\/thead>\n<tbody>\n<tr>\n<td>[1, 2, 3]<\/td>\n<td>{6}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3]<\/td>\n<td>{1, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3]<\/td>\n<td>{3, 3}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3]<\/td>\n<td>{1, 2, 3}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n\nThere are in total $2$ partitions whose subarrays sums are alternating in parity, therefore $f(3) = 2$\n\nWhen $n = 4$, there are $8$ partitions. The partitions are shown below.\n\n\n<!-- |  Partition  | Sum of subarrays | Are the sum of subarrays alternating in parity ? |\n| ------------|-------------------|---------------------------------------------------|\n| [1, 2, 3, 4] |\\{10\\}|Yes|\n| [1], [2, 3, 4]|\\{1, 9\\}|No|\n| [1, 2], [3, 4]|\\{3, 7\\}|No|\n| [1], [2], [3, 4]|\\{1, 2, 7\\}|Yes|\n| [1, 2, 3], [4] |\\{6, 4\\}|No|\n| [1], [2, 3], [4]|\\{1, 5, 4\\}|No|\n| [1, 2], [3], [4]|\\{3, 3, 4\\}|No|\n| [1], [2], [3], [4]|\\{1, 2, 3, 4\\}|Yes| -->\n\n<table>\n<thead>\n<tr>\n<th>Partition<\/th>\n<th>Sum of subarrays<\/th>\n<th>Are the sum of subarrays alternating in parity ?<\/th>\n<\/tr>\n<\/thead>\n<tbody>\n<tr>\n<td>[1, 2, 3, 4]<\/td>\n<td>{10}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3, 4]<\/td>\n<td>{1, 9}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3, 4]<\/td>\n<td>{3, 7}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3, 4]<\/td>\n<td>{1, 2, 7}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1, 2, 3], [4]<\/td>\n<td>{6, 4}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3], [4]<\/td>\n<td>{1, 5, 4}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3], [4]<\/td>\n<td>{3, 3, 4}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3], [4]<\/td>\n<td>{1, 2, 3, 4}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n\n\nThere are in total $2$ partitions whose subarrays sums are alternating in parity, therefore $f(3) = 2$\n\nWhen $n = 5$, there are in total $16$ partitions. The partitions are shown below.\n\n\n<!-- |  Partition  | Sum of subarrays | Are the sum of subarrays alternating in parity ? |\n| ------------|-------------------|---------------------------------------------------|\n| [1, 2, 3, 4, 5] |\\{15\\}|Yes|\n| [1], [2, 3, 4, 5]|\\{1, 14\\}|Yes|\n| [1, 2], [3, 4, 5]|\\{3, 12\\}|Yes|\n| [1], [2], [3, 4, 5]|\\{1, 2, 12\\}|No|\n| [1, 2, 3], [4, 5] |\\{6, 9\\}|Yes|\n| [1], [2, 3], [4, 5]|\\{1, 5, 9\\}|No|\n| [1, 2], [3], [4, 5]|\\{3, 3, 9\\}|No|\n| [1], [2], [3], [4, 5]|\\{1, 2, 3, 9\\}|No|\n| [1, 2, 3, 4], [5] |\\{10, 5\\}|Yes|\n| [1], [2, 3, 4], [5]|\\{1, 9, 5\\}|No|\n| [1, 2], [3, 4], [5]|\\{3, 7, 5\\}|No|\n| [1], [2], [3, 4],[5]|\\{1, 2, 7, 5\\}|No|\n| [1, 2, 3], [4], [5] |\\{6, 4, 5\\}|No|\n| [1], [2, 3], [4], [5]|\\{1, 5, 4, 5\\}|No|\n| [1, 2], [3], [4], [5]|\\{3, 3, 4, 5\\}|No|\n| [1], [2], [3], [4], [5]|\\{1, 2, 3, 4, 5\\}|Yes| -->\n\n<table>\n<thead>\n<tr>\n<th>Partition<\/th>\n<th>Sum of subarrays<\/th>\n<th>Are the sum of subarrays alternating in parity ?<\/th>\n<\/tr>\n<\/thead>\n<tbody>\n<tr>\n<td>[1, 2, 3, 4, 5]<\/td>\n<td>{15}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3, 4, 5]<\/td>\n<td>{1, 14}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3, 4, 5]<\/td>\n<td>{3, 12}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3, 4, 5]<\/td>\n<td>{1, 2, 12}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2, 3], [4, 5]<\/td>\n<td>{6, 9}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3], [4, 5]<\/td>\n<td>{1, 5, 9}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3], [4, 5]<\/td>\n<td>{3, 3, 9}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3], [4, 5]<\/td>\n<td>{1, 2, 3, 9}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2, 3, 4], [5]<\/td>\n<td>{10, 5}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3, 4], [5]<\/td>\n<td>{1, 9, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3, 4], [5]<\/td>\n<td>{3, 7, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3, 4],[5]<\/td>\n<td>{1, 2, 7, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2, 3], [4], [5]<\/td>\n<td>{6, 4, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2, 3], [4], [5]<\/td>\n<td>{1, 5, 4, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1, 2], [3], [4], [5]<\/td>\n<td>{3, 3, 4, 5}<\/td>\n<td>No<\/td>\n<\/tr>\n<tr>\n<td>[1], [2], [3], [4], [5]<\/td>\n<td>{1, 2, 3, 4, 5}<\/td>\n<td>Yes<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n\n\nThere are in total $6$ partitions whose subarray sums are alternating in parity, therefore $f(5) = 6$\n\n$S_0(n) = f(n)$ and is found as described above.\n\nTo find $S_1(n), S_2(n), \\ldots$, the given formula $S_{k+1}(n) = S_k(1) + S_k(2) + \\cdots + S_k(n)$ is used.  \nFor example $S_1(n) = S_0(1) + S_0(2) + \\cdots + S_0(n)$.\n\nThe values for $S_k(n)$ for $k \\leq 5$ and $n \\leq 5$ are tabulated below.\n\n<!-- | n | S_0(n) | S_1(n) | S_2(n) | S_3(n) | S_4(n) | S_5(n) |\n|---|-----|-----|-----|-----|-----|-----|\n| 1 |  1  | 1 | 1 | 1 | 1 | 1 |\n| 2 |  2  | 3 | 4 | 5 | 6 | 7 |\n| 3 |  2  | 5 | 9 |14 |20 |27 |\n| 4 |  3  | 8 |17 |31 |51 |78 |\n| 5 |  6  |14 |31 |62 |113|191| -->\n\n<table>\n<thead>\n<tr>\n<th>n<\/th>\n<th>S<sub>0<\/sub>(n)<\/th>\n<th>S<sub>1<\/sub>(n)<\/th>\n<th>S<sub>2<\/sub>(n)<\/th>\n<th>S<sub>3<\/sub>(n)<\/th>\n<th>S<sub>4<\/sub>(n)<\/th>\n<th>S<sub>5<\/sub>(n)<\/th>\n<\/tr>\n<\/thead>\n<tbody>\n<tr>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<\/tr>\n<tr>\n<td>2<\/td>\n<td>2<\/td>\n<td>3<\/td>\n<td>4<\/td>\n<td>5<\/td>\n<td>6<\/td>\n<td>7<\/td>\n<\/tr>\n<tr>\n<td>3<\/td>\n<td>2<\/td>\n<td>5<\/td>\n<td>9<\/td>\n<td>14<\/td>\n<td>20<\/td>\n<td>27<\/td>\n<\/tr>\n<tr>\n<td>4<\/td>\n<td>3<\/td>\n<td>8<\/td>\n<td>17<\/td>\n<td>31<\/td>\n<td>51<\/td>\n<td>78<\/td>\n<\/tr>\n<tr>\n<td>5<\/td>\n<td>6<\/td>\n<td>14<\/td>\n<td>31<\/td>\n<td>62<\/td>\n<td>113<\/td>\n<td>191<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1 - 2","source_sizelimit":"50000","problem_author":"admin3","problem_author_html_handle":"admin3","problem_tester":"","problem_tester_html_handle":"","date_added":"21-06-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/admin3'>admin3<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/berlekamp-massey'>berlekamp-massey<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/july21'>july21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Medium Hard","editorial_url":"https:\/\/discuss.codechef.com\/problems\/PARTN01","time":{"view_start_date":1626082200,"submit_start_date":1626082200,"visible_start_date":1626082200,"end_date":1735669800,"current":1643797966},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=PARTN01","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}