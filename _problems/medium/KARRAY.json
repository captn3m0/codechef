{"category_name":"medium","status":"success","problem_code":"KARRAY","problem_name":"The Gifting Problem","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK117\/hindi\/KARRAY.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK117\/mandarin\/KARRAY.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK117\/russian\/KARRAY.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK117\/vietnamese\/KARRAY.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK117\/bengali\/KARRAY.pdf) as well.\r\n\r\nConsider $N$ families (numbered $0$ through $N-1$). Each year, each family gives gifts to all other families based on the gifts they received in the previous year. Let's say that in some year, family $i$ received gifts with value $a_i$ (from all families in total). Then, for each valid $j$, the value of the gifts given by family $i$ to family $j$ in the next year is $G(i, j) \\cdot a_i$, where $G(i, j) = 2 \\cdot (i \\vee j) - (i+j)$; note that $\\vee$ denotes bitwise OR.\r\n\r\nFor each valid $i$, you are given the total value of gifts received by family $i$ in the year $0$. Find the total values of gifts received by each family in the year $K$. Since these values can be very large, compute them modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- The second line contains $N$ space-separated integers $a_0, a_1, \\ldots, a_{N-1}$. For each valid $i$, $a_i$ denotes the total value of gifts received by family $i$ in the year $0$.\r\n\r\n### Output\r\nFor each test case, print a single line containing $N$ integers. For each $i$ ($0 \\le i \\lt N$), the $i+1$-th of these integers should be the total value of gifts received by family $i$ in the year $K$, modulo $10^9 + 7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10$\r\n- $1 \\le N \\le 2^{18}$\r\n- $N$ is a power of $2$\r\n- $0 \\le K \\le 100,000$\r\n- $0 \\le a_i \\lt 10^9+7$ for each valid $i$\r\n\r\n### Example Input\r\n```\r\n1\r\n4 1\r\n3 2 5 7\r\n```\r\n\r\n### Example Output\r\n```\r\n33 32 19 18\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK117\/hindi\/KARRAY.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK117\/mandarin\/KARRAY.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK117\/russian\/KARRAY.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK117\/vietnamese\/KARRAY.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK117\/bengali\/KARRAY.pdf) as well.\r\n\r\nConsider $N$ families (numbered $0$ through $N-1$). Each year, each family gives gifts to all other families based on the gifts they received in the previous year. Let's say that in some year, family $i$ received gifts with value $a_i$ (from all families in total). Then, for each valid $j$, the value of the gifts given by family $i$ to family $j$ in the next year is $G(i, j) \\cdot a_i$, where $G(i, j) = 2 \\cdot (i \\vee j) - (i+j)$; note that $\\vee$ denotes bitwise OR.\r\n\r\nFor each valid $i$, you are given the total value of gifts received by family $i$ in the year $0$. Find the total values of gifts received by each family in the year $K$. Since these values can be very large, compute them modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- The second line contains $N$ space-separated integers $a_0, a_1, \\ldots, a_{N-1}$. For each valid $i$, $a_i$ denotes the total value of gifts received by family $i$ in the year $0$.\r\n\r\n### Output\r\nFor each test case, print a single line containing $N$ integers. For each $i$ ($0 \\le i \\lt N$), the $i+1$-th of these integers should be the total value of gifts received by family $i$ in the year $K$, modulo $10^9 + 7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10$\r\n- $1 \\le N \\le 2^{18}$\r\n- $N$ is a power of $2$\r\n- $0 \\le K \\le 100,000$\r\n- $0 \\le a_i \\lt 10^9+7$ for each valid $i$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n4 1\r\n3 2 5 7","output":"33 32 19 18","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1.5","source_sizelimit":"50000","problem_author":"smartnj","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>smartnj<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"4-04-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook117'>cook117<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fast-walsh-hadamard-transform'>fast-walsh-hadamard-transform<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rajarshi_basu'>rajarshi_basu<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/smartnj'>smartnj<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/xor-convolution'>xor-convolution<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Fast Walsh Hadamard Transform","editorial_url":"https:\/\/discuss.codechef.com\/problems\/KARRAY","time":{"view_start_date":1587407402,"submit_start_date":1587407402,"visible_start_date":1587407402,"end_date":1735669800,"current":1643797951},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=KARRAY","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}