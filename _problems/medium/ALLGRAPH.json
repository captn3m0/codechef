{"category_name":"medium","status":"success","problem_code":"ALLGRAPH","problem_name":"Weird full graph","body":"You are given a weighted directed graph of $N$ vertices and $N^2$ edges, and an array $A$ of length $N$. Initially, every ordered pair of vertices $(u, v)$ is connected by a directed edge $u \\to v$ of cost $A_u$ (this also includes self-loops). \r\n\r\nThen there were $M$ changes in edges' weights such that the weight of the directed edge $u\\to v$ is now equal to $c$. You are asked to find the sum of the lengths of the shortest paths over all ordered pairs of **distinct** vertices.\r\n\r\n###Input\r\n- The first line contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line of each test case contains a single integer $M$.\r\n- The next $M$ lines contain information about the changed edges in the $u$ $v$ $c$ format.\r\n\r\n###Output\r\nFor each test case, output the sum of the lengths of the shortest paths over all ordered pairs of vertices.\r\n\r\n###Constraints \r\n- $1 \\leq N \\leq 10^6$\r\n- $0 \\leq M \\leq 2000$\r\n- $0\\le A_i, c\\le 10^6$\r\n- $1\\le u, v\\le N$\r\n- The sum of $N$ over all tests does not exceed $10^6$.\r\n- The sum of $M$ over all tests does not exceed $2000$.\r\n- It is guaranteed that the weight of the edge $u\\to v$ was changed at most once.\r\n\r\n###Subtasks\r\n**Subtask #1 (8 points, time limit 1 second):** The sum $N$ for all tests does not exceed $500$.\r\n\r\n**Subtask #2 (22 points, time limit 1 second):** Each vertex belongs to at most one changed edge (in other words, the edges do not overlap).\r\n\r\n**Subtask #3 (30 points, time limit 1 second):** The sum $M$ for all tests does not exceed $500$.\r\n\r\n**Subtask #4 (40 points, time limit 4.5 seconds):** original constraints.\r\n\r\n###Sample Input\r\n```\r\n3\r\n3\r\n2 4 1\r\n0\r\n4\r\n1 2 3 4\r\n2\r\n1 2 1\r\n3 4 2\r\n5\r\n2 6 5 1 7\r\n5\r\n1 3 4\r\n2 4 3\r\n3 5 4\r\n4 1 2\r\n5 2 3\r\n```\r\n\r\n###Sample Output\r\n```\r\n14\r\n29\r\n72\r\n```\r\n\t\r\n###Explanation\r\n**Example case 1:** The lengths of the shortest paths between vertices $u$ and $v$ are $A_u$ and the answer is $2 \\cdot (2 + 4 + 1) = 14$.\r\n\r\n**Example case 2:** The lengths of the shortest paths between the vertices $u$ and $v$ are equal to $A_u$ except for the pair of vertices $(3, 4)$ for which the distance is $2$. \n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"You are given a weighted directed graph of $N$ vertices and $N^2$ edges, and an array $A$ of length $N$. Initially, every ordered pair of vertices $(u, v)$ is connected by a directed edge $u \\to v$ of cost $A_u$ (this also includes self-loops). \r\n\r\nThen there were $M$ changes in edges' weights such that the weight of the directed edge $u\\to v$ is now equal to $c$. You are asked to find the sum of the lengths of the shortest paths over all ordered pairs of **distinct** vertices.\r\n\r\n###Input\r\n- The first line contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line of each test case contains a single integer $M$.\r\n- The next $M$ lines contain information about the changed edges in the $u$ $v$ $c$ format.\r\n\r\n###Output\r\nFor each test case, output the sum of the lengths of the shortest paths over all ordered pairs of vertices.\r\n\r\n###Constraints \r\n- $1 \\leq N \\leq 10^6$\r\n- $0 \\leq M \\leq 2000$\r\n- $0\\le A_i, c\\le 10^6$\r\n- $1\\le u, v\\le N$\r\n- The sum of $N$ over all tests does not exceed $10^6$.\r\n- The sum of $M$ over all tests does not exceed $2000$.\r\n- It is guaranteed that the weight of the edge $u\\to v$ was changed at most once.\r\n\r\n###Subtasks\r\n**Subtask #1 (8 points, time limit 1 second):** The sum $N$ for all tests does not exceed $500$.\r\n\r\n**Subtask #2 (22 points, time limit 1 second):** Each vertex belongs to at most one changed edge (in other words, the edges do not overlap).\r\n\r\n**Subtask #3 (30 points, time limit 1 second):** The sum $M$ for all tests does not exceed $500$.\r\n\r\n**Subtask #4 (40 points, time limit 4.5 seconds):** original constraints.","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3\r\n3\r\n2 4 1\r\n0\r\n4\r\n1 2 3 4\r\n2\r\n1 2 1\r\n3 4 2\r\n5\r\n2 6 5 1 7\r\n5\r\n1 3 4\r\n2 4 3\r\n3 5 4\r\n4 1 2\r\n5 2 3","output":"14\r\n29\r\n72","explanation":"**Example case 1:** The lengths of the shortest paths between vertices $u$ and $v$ are $A_u$ and the answer is $2 \\cdot (2 + 4 + 1) = 14$.\r\n\r\n**Example case 2:** The lengths of the shortest paths between the vertices $u$ and $v$ are equal to $A_u$ except for the pair of vertices $(3, 4)$ for which the distance is $2$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1 - 4.5","source_sizelimit":"50000","problem_author":"karpovich","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>karpovich<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"28-04-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/dijkstra-algorithm'>dijkstra-algorithm<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/karpovich'>karpovich<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime95'>ltime95<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Dijkstra Algorithm","editorial_url":"https:\/\/discuss.codechef.com\/problems\/ALLGRAPH","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797915},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=ALLGRAPH","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}