{"category_name":"medium","status":"success","problem_code":"BORDER","problem_name":"Prefix borders","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/LTIME57\/mandarin\/BORDER.pdf\">Mandarin chinese<\/a>, <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/LTIME57\/russian\/BORDER.pdf\">Russian<\/a> and <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/LTIME57\/vietnamese\/BORDER.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Let's define a <i>border substring<\/i> of a string as a non-empty substring that's both a suffix and a prefix of this string.<\/p>\n\n<p>You are given a string <b>S<\/b> with length <b>N<\/b> and <b>Q<\/b> queries. In each query, you are given the <b>p<\/b>-th prefix of <b>S<\/b> (let's denote it by <b>S<sub>1..p<\/sub><\/b>) and an integer <b>k<\/b>. Consider the <b>k<\/b>-th shortest border of <b>S<sub>1..p<\/sub><\/b> (if it exists). Compute the length of this border substring or determine that it doesn't exist.<\/p>\n\n<h3>Input<\/h3>\n<ul>\n<li>The first line of the input contains a single integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/li>\n<li>The first line of each test case contains two space-separated integers <b>N<\/b> and <b>Q<\/b>.<\/li>\n<li>The second line contains a single string <b>S<\/b>.<\/li>\n<li>Each of the following <b>Q<\/b> lines contains two space-separated integers <b>p<\/b> and <b>k<\/b> describing one query.<\/li>\n<\/ul>\n\n<h3>Output<\/h3>\n<p>For each test case, print <b>Q<\/b> lines. For each <b>i<\/b> (1 \u2264 <b>i<\/b> \u2264 <b>Q<\/b>), the <b>i<\/b>-th of these lines should contain a single integer \u2014 the answer to the <b>i<\/b>-th query (the length of the <b>k<\/b>-th shortest border or -1 if it doesn't exist).<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>T<\/b> \u2264 100<\/li>\n<li>1 \u2264 <b>N<\/b>, <b>Q<\/b> \u2264 200,000<\/li>\n<li><b>|S|<\/b> = <b>N<\/b><\/li>\n<li>1 \u2264 sum of <b>N<\/b> over all test cases \u2264 200,000<\/li>\n<li>1 \u2264 sum of <b>Q<\/b> over all test cases \u2264 200,000<\/li>\n<li>1 \u2264 <b>p<\/b>, <b>k<\/b> \u2264 <b>N<\/b><\/li>\n<li><b>S<\/b> contains only lowercase English letters<\/li>\n<\/ul>\n\n<h3>Subtasks<\/h3>\n<p>\n<b>Subtask #1 (20 points):<\/b>\n<ul>\n<li><b>Q<\/b>, <b>N<\/b> \u2264 100<\/li>\n<li>sum of <b>N<\/b> over all test cases \u2264 500<\/li>\n<li>sum of <b>Q<\/b> over all test cases \u2264 500<\/li>\n<\/ul>\n<\/p>\n\n<p>\n<b>Subtask #2 (20 points):<\/b>\n<ul>\n<li><b>N<\/b> \u2264 100<\/li>\n<li>sum of <b>N<\/b> over all test cases \u2264 500<\/li>\n<\/ul>\n<\/p>\n\n<p>\n<b>Subtask #3 (60 points):<\/b> original constraints\n<\/p>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n\n1\n5 4\nabcab\n2 1\n5 1\n5 2\n5 3\n\n<b>Output:<\/b>\n\n2\n2\n5\n-1\n<\/pre>\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"kingofnumbers","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>kingofnumbers<\/span>","problem_tester":"mgch","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>mgch<\/span>","date_added":"21-02-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/binary-lifting'>binary-lifting<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kingofnumbers'>kingofnumbers<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kmp'>kmp<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime57'>ltime57<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tree'>tree<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/BORDER","time":{"view_start_date":1519491600,"submit_start_date":1519491600,"visible_start_date":1519491600,"end_date":1735669800,"current":1525198948},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}