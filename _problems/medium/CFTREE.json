{"category_name":"medium","status":"success","problem_code":"CFTREE","problem_name":"Chef And Fibonacci Tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK66\/mandarin\/CFTREE.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK66\/russian\/CFTREE.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK66\/vietnamese\/CFTREE.pdf\">Vietnamese<\/a> as well.<\/h3>\n<p>Chef likes to play with trees a lot. This time, he has a rooted tree <b>T<\/b> consisting of <b>N<\/b> nodes labelled uniquely with the integers from <b>{1, \u2026 N}<\/b>. The node labelled <b>1<\/b> is the root of the tree. Each node in the given tree <b>T<\/b> stores a non-negative integer, initially all of which are zeros. Chef wants to perform <b>2<\/b> types of operations over the tree accurately and efficiently.<\/p>\n<ul>\n<li><b>U X K:<\/b> Update the subtree rooted at node <b>X<\/b> such that the the root <b>X<\/b> will have <b>F<sub>K<\/sub><\/b> (the <b>K<sup>th<\/sup><\/b> Fibonacci number) added to it, all its children will have <b>F<sub>k+1<\/sub><\/b> (the <b>(K+1)<sup>th<\/sup><\/b> Fibonacci number) added to them, and so on. More formally, any node in the subtree rooted at <b>X<\/b> will have <b>(K+D)<sup>th<\/sup><\/b> fibonacci number added to them, where <b>D<\/b> is the distance of the node from <b>X<\/b>.<\/li>\n<li><b>Q X:<\/b> Report the value stored at the node <b>X<\/b>.<\/li>\n<\/ul>\n<p>Since the answer to each query can be very large, output it modulo <b>10<sup>9<\/sup> + 7<\/b>.<\/p>\n<p><b>NOTE:<\/b><\/p>\n<p><b>F<sub>K<\/sub><\/b> denotes the <b>K<sup>th<\/sup><\/b> Fibonacci number, and the series is generated as follows:<\/p>\n<ul>\n<li><b>F<sub>K<\/sub> = 1, if K \u2264 2 <\/b>.<\/li>\n<li><b>F<sub>K<\/sub> = F<sub>K-1<\/sub> + F<sub>K-2<\/sub>, otherwise.<\/b><\/li>\n<\/ul>\n<p>\nTo know more about Fibonacci numbers, click <a href=\"https:\/\/en.wikipedia.org\/wiki\/Fibonacci_number\">here<\/a>.\n<\/p>\n<h3>Input:<\/h3>\n<p>First line of input contains two integer <b>N<\/b> and <b>M<\/b> denoting the number of nodes in the tree <b>T<\/b>, and the number of queries to be processed, respectively. Next <b>N-1<\/b> lines of input contain an integer each, where the integer in the <b>i<sup>th<\/sup><\/b> line denotes the parent of the <b>(i+1)<sup>th<\/sup><\/b> node. Each of the next <b>M<\/b> lines contains one of the <b>2<\/b> types of queries mentioned above.<\/p>\n<h3>Output:<\/h3>\n<p>For each operation of type <b>Q<\/b>, output the required answer modulo <b>10<sup>9<\/sup> + 7<\/b>.<\/p>\n<h3>Constraints:<\/h3>\n<ul>\n<li><b>1 \u2264 N, M, K \u2264 10<sup>5<\/sup><\/b><\/li>\n<li><b>1 \u2264 U, V, X \u2264 N<\/b><\/li>\n<\/ul>\n<h3>Example<\/h3>\n<p><b>Input<\/b><\/p>\n<pre>\n5 10\n1\n1\n3\n3\nQ 3\nU 1 2\nQ 2\nQ 3\nQ 4\nQ 5\nU 3 1\nQ 3\nQ 4\nQ 5\n\n<b>Output<\/b>\n<pre>\n0\n2\n2\n3\n3\n3\n4\n4\n<\/pre><h3>Explanation<\/h3>\n<p>\n<img src=\"https:\/\/s3.amazonaws.com\/hr-challenge-images\/3194\/1452931833-352a82ea85-image7.jpg\" title=\"image7.jpg\" \/>\n<\/p>\n<\/pre>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"3","source_sizelimit":"50000","problem_author":"ma5termind","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>ma5termind<\/span>","problem_tester":"antoniuk1","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>antoniuk1<\/span>","date_added":"2-12-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook66'>\n                    cook66\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/data-structure'>\n                    data-structure\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/graph'>\n                    graph\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ma5termind'>\n                    ma5termind\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/sqrt-decomp'>\n                    sqrt-decomp\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/CFTREE","user":{"username":null},"time":{"view_start_date":1453660200,"submit_start_date":1453660200,"visible_start_date":1453660200,"end_date":1735669800,"current":1493557506},"todo":false,"problem_status":"unattempted"}