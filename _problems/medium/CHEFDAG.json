{"category_name":"medium","status":"success","problem_code":"CHEFDAG","problem_name":"Chef and DAG","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/hindi\/CHEFDAG.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/bengali\/CHEFDAG.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/mandarin\/CHEFDAG.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/russian\/CHEFDAG.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/vietnamese\/CHEFDAG.pdf) as well.\r\n\r\nYou are given $K$ permutations of integers $1$ through $N$. For each $i$ ($1 \\le i \\le K$), the $i$-th permutation is denoted by $A_{i,1}, A_{i,2}, \\ldots, A_{i,N}$.\r\n\r\nConstruct a directed acyclic graph with $N$ nodes (numbered $1$ through $N$) such that:\r\n- Each of the given permutations is a valid topological sort of the graph. Formally, for each valid $k$ and each $i, j$ ($1 \\le i \\lt j \\le N$), there is no edge from the node $A_{k,j}$ to the node $A_{k,i}$.\r\n- The outdegree of each node is at most $1$.\r\n- The number of nodes with indegree $0$ is the smallest possible.\r\n\r\nIf there are multiple solutions, you may find any one.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- $K$ lines follow. For each $i$ ($1 \\le i \\le K$), the $i$-th of these lines contains $N$ space-separated integers $A_{i,1}, A_{i,2}, \\ldots, A_{i,N}$.\r\n\r\n### Output\r\nFor each test case, print two lines.\r\n- The first of these lines should contain one integer \u2015 the minimum number of nodes with indegree $0$.\r\n- The second line should contain $N$ space-separated integers $v_1, v_2, \\ldots, v_N$ describing your graph in the following way: for each valid $i$, if $v_i = 0$, there is no outgoing edge from the $i$-th node; otherwise, there is an edge from the $i$-th node to the $v_i$-th node.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 100$\r\n- $1 \\le N \\le 500$\r\n- $1 \\le K \\le 100$\r\n- $1 \\le A_{i,j} \\le N$ for each valid $i,j$\r\n- the sum of $N$ over all test cases does not exceed $2,000$\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points):**\r\n- $N \\le 20$\r\n- $K \\le 10$\r\n\r\n**Subtask #2 (80 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n2\r\n2 2\r\n1 2\r\n2 1\r\n2 2\r\n1 2\r\n1 2\r\n```\r\n\r\n### Example Output\r\n```\r\n2\r\n0 0\r\n1\r\n2 0\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** The graph must consist of just two disconnected nodes, since no edges are allowed. Hence, there are two nodes with indegree $0$.\r\n\r\n**Example case 2:** The graph may contain an edge from node $1$ to node $2$. Then, there is only one node with indegree $0$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/hindi\/CHEFDAG.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/bengali\/CHEFDAG.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/mandarin\/CHEFDAG.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/russian\/CHEFDAG.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/vietnamese\/CHEFDAG.pdf) as well.\r\n\r\nYou are given $K$ permutations of integers $1$ through $N$. For each $i$ ($1 \\le i \\le K$), the $i$-th permutation is denoted by $A_{i,1}, A_{i,2}, \\ldots, A_{i,N}$.\r\n\r\nConstruct a directed acyclic graph with $N$ nodes (numbered $1$ through $N$) such that:\r\n- Each of the given permutations is a valid topological sort of the graph. Formally, for each valid $k$ and each $i, j$ ($1 \\le i \\lt j \\le N$), there is no edge from the node $A_{k,j}$ to the node $A_{k,i}$.\r\n- The outdegree of each node is at most $1$.\r\n- The number of nodes with indegree $0$ is the smallest possible.\r\n\r\nIf there are multiple solutions, you may find any one.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- $K$ lines follow. For each $i$ ($1 \\le i \\le K$), the $i$-th of these lines contains $N$ space-separated integers $A_{i,1}, A_{i,2}, \\ldots, A_{i,N}$.\r\n\r\n### Output\r\nFor each test case, print two lines.\r\n- The first of these lines should contain one integer \u2015 the minimum number of nodes with indegree $0$.\r\n- The second line should contain $N$ space-separated integers $v_1, v_2, \\ldots, v_N$ describing your graph in the following way: for each valid $i$, if $v_i = 0$, there is no outgoing edge from the $i$-th node; otherwise, there is an edge from the $i$-th node to the $v_i$-th node.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 100$\r\n- $1 \\le N \\le 500$\r\n- $1 \\le K \\le 100$\r\n- $1 \\le A_{i,j} \\le N$ for each valid $i,j$\r\n- the sum of $N$ over all test cases does not exceed $2,000$\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points):**\r\n- $N \\le 20$\r\n- $K \\le 10$\r\n\r\n**Subtask #2 (80 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n2 2\r\n1 2\r\n2 1\r\n2 2\r\n1 2\r\n1 2","output":"2\r\n0 0\r\n1\r\n2 0","explanation":"**Example case 1:** The graph must consist of just two disconnected nodes, since no edges are allowed. Hence, there are two nodes with indegree $0$.\r\n\r\n**Example case 2:** The graph may contain an edge from node $1$ to node $2$. Then, there is only one node with indegree $0$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"rahuldugar","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>rahuldugar<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"30-05-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/bipartite-matching'>bipartite-matching<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/graphs'>graphs<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/march20'>march20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rahuldugar'>rahuldugar<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tmwilliamlin'>tmwilliamlin<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Bipartite Matching","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CHEFDAG","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797926},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=CHEFDAG","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}