{"category_name":"medium","status":"success","problem_code":"EXPCH","problem_name":"Expected Change","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/FEB20\/hindi\/EXPCH.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/FEB20\/bengali\/EXPCH.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/FEB20\/mandarin\/EXPCH.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/FEB20\/russian\/EXPCH.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/FEB20\/vietnamese\/EXPCH.pdf) as well.\r\n\r\nChef has a string $A$ with length $N$. It contains only characters '(', ')' and '*'. Chef wants to perform the following process:\r\n- Uniformly randomly choose a pair of integers $(l, r)$ such that $1 \\le l \\le r \\le N$.\r\n- Consider the substring $S = [A_l, A_{l+1}, \\ldots, A_r]$. Process the characters of this string from left to right.\r\n- Let's denote the current number of closing brackets in $S$ up to the currently processed character (inclusive) by $n_c$. Similarly, let's denote the number of opening brackets by $n_o$. Note that the string $S$ may change; $n_c$ and $n_o$ correspond to the current state of $S$, not its initial state.\r\n- Whenever $n_c$ becomes greater than $n_o$, the currently processed character must be ')'. Then, change it from ')' to '(' and continue processing the remaining characters of $S$.\r\n\r\nChef would like to know the expected number of characters that he would change in this process. Can you help him?\r\n\r\nIt can be proved that this expected value can be expressed as a fraction $P\/Q$, where $P$ and $Q$ are non-negative integers and $Q$ is coprime to $10^9+7$. You should find $P \\cdot Q^{-1}$ modulo $10^9+7$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains a single string $A$ with length $N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $P \\cdot Q^{-1}$ modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10$\r\n- $1 \\le N \\le 10^7$\r\n- the sum of $N$ over all test cases does not exceed $10^7$\r\n\r\n### Subtasks\r\n**Subtask #1 (5 points):** $N \\le 100$\r\n\r\n**Subtask #2 (15 points):** $N \\le 5,000$\r\n\r\n**Subtask #3 (30 points):** $N \\le 10^5$\r\n\r\n**Subtask #4 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n1\r\n5\r\n((())\r\n```\r\n \r\n### Example Output\r\n```\r\n866666673\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/FEB20\/hindi\/EXPCH.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/FEB20\/bengali\/EXPCH.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/FEB20\/mandarin\/EXPCH.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/FEB20\/russian\/EXPCH.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/FEB20\/vietnamese\/EXPCH.pdf) as well.\r\n\r\nChef has a string $A$ with length $N$. It contains only characters '(', ')' and '*'. Chef wants to perform the following process:\r\n- Uniformly randomly choose a pair of integers $(l, r)$ such that $1 \\le l \\le r \\le N$.\r\n- Consider the substring $S = [A_l, A_{l+1}, \\ldots, A_r]$. Process the characters of this string from left to right.\r\n- Let's denote the current number of closing brackets in $S$ up to the currently processed character (inclusive) by $n_c$. Similarly, let's denote the number of opening brackets by $n_o$. Note that the string $S$ may change; $n_c$ and $n_o$ correspond to the current state of $S$, not its initial state.\r\n- Whenever $n_c$ becomes greater than $n_o$, the currently processed character must be ')'. Then, change it from ')' to '(' and continue processing the remaining characters of $S$.\r\n\r\nChef would like to know the expected number of characters that he would change in this process. Can you help him?\r\n\r\nIt can be proved that this expected value can be expressed as a fraction $P\/Q$, where $P$ and $Q$ are non-negative integers and $Q$ is coprime to $10^9+7$. You should find $P \\cdot Q^{-1}$ modulo $10^9+7$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains a single string $A$ with length $N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $P \\cdot Q^{-1}$ modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10$\r\n- $1 \\le N \\le 10^7$\r\n- the sum of $N$ over all test cases does not exceed $10^7$\r\n\r\n### Subtasks\r\n**Subtask #1 (5 points):** $N \\le 100$\r\n\r\n**Subtask #2 (15 points):** $N \\le 5,000$\r\n\r\n**Subtask #3 (30 points):** $N \\le 10^5$\r\n\r\n**Subtask #4 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n5\r\n((())","output":"866666673","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"0.5","source_sizelimit":"50000","problem_author":"foyaz05","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span class='m-username--link'>foyaz05<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"31-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/feb20'>feb20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/foyaz05'>foyaz05<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tmwilliamlin'>tmwilliamlin<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/EXPCH","time":{"view_start_date":1581931802,"submit_start_date":1581931802,"visible_start_date":1581931802,"end_date":1735669800,"current":1643797940},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=EXPCH","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}