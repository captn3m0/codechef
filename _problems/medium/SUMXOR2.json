{"category_name":"medium","status":"success","problem_code":"SUMXOR2","problem_name":"XOR Sums","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/FEB21\/hindi\/SUMXOR2.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/FEB21\/bengali\/SUMXOR2.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/mandarin\/SUMXOR2.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/FEB21\/russian\/SUMXOR2.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/vietnamese\/SUMXOR2.pdf) as well.\r\n\r\nYou are given a sequence of positive integers $A_1, A_2, \\ldots, A_N$. You should answer $Q$ queries. In each query:\r\n- You are given a positive integer $M$.\r\n- Consider all non-empty subsequences of $A$ with length $\\le M$. Recall that a subsequence is any sequence that can be created by deleting zero or more elements without changing the order of the remaining elements.\r\n- For each of these subsequences, compute the [bitwise XOR](https:\/\/en.wikipedia.org\/wiki\/Bitwise_operation#XOR) of its elements. Your task is to determine the sum of these values. Since this sum can be very large, compute it modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains a single integer $Q$.\r\n- $Q$ lines follow. Each of these lines contains a single integer $M$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the sum of bitwise XORs for all subsequences of $A$ with length $\\le M$, modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\leq N, Q \\leq 2 \\cdot 10^5$\r\n- $1 \\leq A_i \\lt 2^{30}$ for each valid $i$\r\n- $1 \\leq M \\leq N$\r\n\r\n### Subtask\r\n**Subtask #1 (10 points):** $1 \\leq N, Q \\leq 1,000$\r\n\r\n**Subtask #2 (90 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n4\r\n1 3 5 2\r\n2\r\n1\r\n2\r\n```\r\n\r\n### Example Output\r\n```\r\n11\r\n34\r\n```\r\n\r\n### Explanation\r\nIn the first query, the answer is just the sum of elements of $A$ (modulo $998,244,353$), which is $1+3+5+2 = 11$.\r\n\r\nIn the second query, the answer is the sum of bitwise XORs for all subsequences with length $1$ or $2$, which is $1+3+5+2 + (1 \\oplus 3) + (1 \\oplus 5) + (1 \\oplus 2) + (3 \\oplus 5) + (3 \\oplus 2) + (5 \\oplus 2) = 34$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/FEB21\/hindi\/SUMXOR2.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/FEB21\/bengali\/SUMXOR2.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/mandarin\/SUMXOR2.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/FEB21\/russian\/SUMXOR2.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/vietnamese\/SUMXOR2.pdf) as well.\r\n\r\nYou are given a sequence of positive integers $A_1, A_2, \\ldots, A_N$. You should answer $Q$ queries. In each query:\r\n- You are given a positive integer $M$.\r\n- Consider all non-empty subsequences of $A$ with length $\\le M$. Recall that a subsequence is any sequence that can be created by deleting zero or more elements without changing the order of the remaining elements.\r\n- For each of these subsequences, compute the [bitwise XOR](https:\/\/en.wikipedia.org\/wiki\/Bitwise_operation#XOR) of its elements. Your task is to determine the sum of these values. Since this sum can be very large, compute it modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains a single integer $Q$.\r\n- $Q$ lines follow. Each of these lines contains a single integer $M$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the sum of bitwise XORs for all subsequences of $A$ with length $\\le M$, modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\leq N, Q \\leq 2 \\cdot 10^5$\r\n- $1 \\leq A_i \\lt 2^{30}$ for each valid $i$\r\n- $1 \\leq M \\leq N$\r\n\r\n### Subtask\r\n**Subtask #1 (10 points):** $1 \\leq N, Q \\leq 1,000$\r\n\r\n**Subtask #2 (90 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"4\r\n1 3 5 2\r\n2\r\n1\r\n2","output":"11\r\n34","explanation":"In the first query, the answer is just the sum of elements of $A$ (modulo $998,244,353$), which is $1+3+5+2 = 11$.\r\n\r\nIn the second query, the answer is the sum of bitwise XORs for all subsequences with length $1$ or $2$, which is $1+3+5+2 + (1 \\oplus 3) + (1 \\oplus 5) + (1 \\oplus 2) + (3 \\oplus 5) + (3 \\oplus 2) + (5 \\oplus 2) = 34$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/SK3KhQhGiSs","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"samarth2017","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>samarth2017<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"22-01-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/bitwise-xor'>bitwise-xor<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/feb21'>feb21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/number-theoretic-transfmtn'>number-theoretic-transfmtn<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/samarth2017'>samarth2017<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Bitwise Xor","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SUMXOR2","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797982},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SUMXOR2","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}