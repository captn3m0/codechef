{"category_name":"medium","status":"success","problem_code":"PART","problem_name":"Partition Ways","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK126\/hindi\/PART.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK126\/mandarin\/PART.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK126\/russian\/PART.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK126\/vietnamese\/PART.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK126\/bengali\/PART.pdf) as well.\r\n\r\nLet's define a function $P(A)$ for a sequence $A$ as the number of ways to divide $A$ into contiguous subsequences such that each element of $A$ belongs to exactly one of these subsequences and the sum of elements of each subsequence is between $L$ and $R$ inclusive.\r\n\r\nFor each integer $n$ between $1$ and $N$ inclusive, solve the following problem: Consider a random sequence $A$ with length $n$ where each element is an integer between $1$ and $K$ chosen uniformly randomly and independently. Find the expected value of $P(A)$.\r\n\r\nFor each valid $n$, it can be proved that the expected value can be expressed as a fraction $P \/ Q$, where $P$ and $Q$ are positive integers and $Q$ is coprime with $998,244,353$. You should compute $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ is the multiplicative inverse of $Q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains four space-separated integers $N$, $K$, $L$ and $R$.\r\n\r\n### Output\r\nFor each test case, print a single line containing $N$ space-separated integers. For each valid $i$, the $i$-th of these integers should be $P \\cdot Q^{-1}$ modulo $998,244,353$ for $n = i$.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 20$\r\n- $1 \\leq N \\leq 5 \\cdot 10^5$\r\n- $1 \\leq L \\leq R \\leq K \\leq 10^6$\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n- the sum of $K$ over all test cases does not exceed $10^6$\r\n\r\n### Example Input\r\n```\r\n1\r\n2 2 1 2\r\n```\r\n\r\n### Example Output\r\n```\r\n1 748683266\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** For $n = 1$, we have $P([1]) = P([2]) = 1$ and $P(A) = 0$ for any other sequence. Hence, the expected value is $2 \/ 2 = 1$.\r\n\r\nFor $n = 2$, there are four valid sequences $[1,1]$, $[1,2]$, $[2,1]$ and $[2,2]$. Each of them can be split into one-element subsequences. In addition, $[1,1]$ can be left unchanged (split into only one subsequence), so $P([1,1]) = 2$. The expected value is $(2+1+1+1) \/ 4 = 5\/4 = 748,683,266$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK126\/hindi\/PART.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK126\/mandarin\/PART.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK126\/russian\/PART.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK126\/vietnamese\/PART.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK126\/bengali\/PART.pdf) as well.\r\n\r\nLet's define a function $P(A)$ for a sequence $A$ as the number of ways to divide $A$ into contiguous subsequences such that each element of $A$ belongs to exactly one of these subsequences and the sum of elements of each subsequence is between $L$ and $R$ inclusive.\r\n\r\nFor each integer $n$ between $1$ and $N$ inclusive, solve the following problem: Consider a random sequence $A$ with length $n$ where each element is an integer between $1$ and $K$ chosen uniformly randomly and independently. Find the expected value of $P(A)$.\r\n\r\nFor each valid $n$, it can be proved that the expected value can be expressed as a fraction $P \/ Q$, where $P$ and $Q$ are positive integers and $Q$ is coprime with $998,244,353$. You should compute $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ is the multiplicative inverse of $Q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains four space-separated integers $N$, $K$, $L$ and $R$.\r\n\r\n### Output\r\nFor each test case, print a single line containing $N$ space-separated integers. For each valid $i$, the $i$-th of these integers should be $P \\cdot Q^{-1}$ modulo $998,244,353$ for $n = i$.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 20$\r\n- $1 \\leq N \\leq 5 \\cdot 10^5$\r\n- $1 \\leq L \\leq R \\leq K \\leq 10^6$\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n- the sum of $K$ over all test cases does not exceed $10^6$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n2 2 1 2","output":"1 748683266","explanation":"**Example case 1:** For $n = 1$, we have $P([1]) = P([2]) = 1$ and $P(A) = 0$ for any other sequence. Hence, the expected value is $2 \/ 2 = 1$.\r\n\r\nFor $n = 2$, there are four valid sequences $[1,1]$, $[1,2]$, $[2,1]$ and $[2,2]$. Each of them can be split into one-element subsequences. In addition, $[1,1]$ can be left unchanged (split into only one subsequence), so $P([1,1]) = 2$. The expected value is $(2+1+1+1) \/ 4 = 5\/4 = 748,683,266$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/HW5N822GAgk","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1.5","source_sizelimit":"50000","problem_author":"krikti","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>krikti<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"18-01-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook126'>cook126<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fast-fourier-transform'>fast-fourier-transform<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/krikti'>krikti<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/number-theoretic-transfmtn'>number-theoretic-transfmtn<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/PART","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797966},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=PART","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}