{"category_name":"medium","status":"success","problem_code":"RESTCH","problem_name":"Chef, Chefina and Restoration","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME85\/hindi\/RESTCH.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME85\/bengali\/RESTCH.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME85\/mandarin\/RESTCH.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME85\/russian\/RESTCH.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME85\/vietnamese\/RESTCH.pdf) as well.\r\n\r\nChefina gave Chef a sequence $F_1, F_2, \\ldots, F_N$ as a birthday present. She constructed it from a sequence of positive integers $A_1, A_2, \\ldots, A_N$ in the following way: for each valid $i$, $F_i = \\sum_{j=1}^i (-1)^{(j+1)} \\cdot A_j$.\r\n\r\nUnfortunately, Chef was playing with the sequence $F$ and shuffled it. Now, he has a sequence denoted by $B$, but he does not remember $F$. The only things he knows are that $F$ is a permutation of $B$ and among all such permutations which Chefina could have constructed, her sequence $F$ was the lexicographically smallest.\r\n\r\nChef does not want to disappoint Chefina, but he is too busy in the kitchen, so he asked you to help him recover $F$. Find the sequence $F$ he got from Chefina or determine that he made another mistake and a sequence that satisfies the given conditions does not exist.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $B_1, B_2, \\ldots, B_N$.\r\n\r\n### Output\r\nFor each test case:\r\n- If there is no solution, print a single line containing the string `\"NO\"` (without quotes).\r\n- Otherwise, print two lines.\r\n- The first of these lines should contain the string `\"YES\"` (without quotes).\r\n- The second line should contain $N$ space-separated integers $F_1, F_2, \\ldots, F_N$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10,000$\r\n- $1 \\le N \\le 10^5$\r\n- $|B_i| \\le 10^9$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** $B_1, B_2, \\ldots, B_N$ are pairwise distinct\r\n\r\n**Subtask #2 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n4\r\n2\r\n1 2\r\n3\r\n-1 -2 -3\r\n4\r\n3 3 3 4\r\n4\r\n4 -4 4 -4\r\n```\r\n\r\n### Example Output\r\n```\r\nYES\r\n2 1\r\nNO\r\nNO\r\nYES\r\n4 -4 4 -4\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** The only two permutations of $B$ are $[1,2]$ and $[2,1]$. Out of them, $[1,2]$ could not have been generated by Chefina, since it would require $A = [1,-1]$, which contains a negative element. On the other hand, for $[2,1]$, we get $A = [2,1]$, so $F = [2,1]$ must be the sequence Chefina generated.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME85\/hindi\/RESTCH.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME85\/bengali\/RESTCH.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME85\/mandarin\/RESTCH.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME85\/russian\/RESTCH.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME85\/vietnamese\/RESTCH.pdf) as well.\r\n\r\nChefina gave Chef a sequence $F_1, F_2, \\ldots, F_N$ as a birthday present. She constructed it from a sequence of positive integers $A_1, A_2, \\ldots, A_N$ in the following way: for each valid $i$, $F_i = \\sum_{j=1}^i (-1)^{(j+1)} \\cdot A_j$.\r\n\r\nUnfortunately, Chef was playing with the sequence $F$ and shuffled it. Now, he has a sequence denoted by $B$, but he does not remember $F$. The only things he knows are that $F$ is a permutation of $B$ and among all such permutations which Chefina could have constructed, her sequence $F$ was the lexicographically smallest.\r\n\r\nChef does not want to disappoint Chefina, but he is too busy in the kitchen, so he asked you to help him recover $F$. Find the sequence $F$ he got from Chefina or determine that he made another mistake and a sequence that satisfies the given conditions does not exist.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $B_1, B_2, \\ldots, B_N$.\r\n\r\n### Output\r\nFor each test case:\r\n- If there is no solution, print a single line containing the string `\"NO\"` (without quotes).\r\n- Otherwise, print two lines.\r\n- The first of these lines should contain the string `\"YES\"` (without quotes).\r\n- The second line should contain $N$ space-separated integers $F_1, F_2, \\ldots, F_N$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10,000$\r\n- $1 \\le N \\le 10^5$\r\n- $|B_i| \\le 10^9$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** $B_1, B_2, \\ldots, B_N$ are pairwise distinct\r\n\r\n**Subtask #2 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"4\r\n2\r\n1 2\r\n3\r\n-1 -2 -3\r\n4\r\n3 3 3 4\r\n4\r\n4 -4 4 -4","output":"YES\r\n2 1\r\nNO\r\nNO\r\nYES\r\n4 -4 4 -4","explanation":"**Example case 1:** The only two permutations of $B$ are $[1,2]$ and $[2,1]$. Out of them, $[1,2]$ could not have been generated by Chefina, since it would require $A = [1,-1]$, which contains a negative element. On the other hand, for $[2,1]$, we get $A = [2,1]$, so $F = [2,1]$ must be the sequence Chefina generated.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"dean_student","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>dean_student<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"21-06-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/dean_student'>dean_student<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/greedy'>greedy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime85'>ltime85<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/order-statistic'>order-statistic<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Order Statistic","editorial_url":"https:\/\/discuss.codechef.com\/problems\/RESTCH","time":{"view_start_date":1593277202,"submit_start_date":1593277202,"visible_start_date":1593277202,"end_date":1735669800,"current":1643797973},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=RESTCH","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}