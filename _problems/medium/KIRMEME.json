{"category_name":"medium","status":"success","problem_code":"KIRMEME","problem_name":"Kirito in Memeland","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/mandarin\/KIRMEME.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/russian\/KIRMEME.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/vietnamese\/KIRMEME.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n\n<p>\nMemeland is a country consisting of <b>N<\/b> cities. There are exactly <b>N - 1<\/b> undirected roads connecting pairs of cities and there is exactly one path between each pair of cities (a path is a sequence of distinct cities where consecutive cities in the sequence are connected by a road).\n<\/p>\n\n<p>\nAs the country is located in mountains, cities may be at different heights. The heigh of <b>i-th<\/b> city is <b>a<sub>i<\/sub><\/b>.\n<\/p>\n\n<p>\nKirito is going to travel around Memeland. Kirito is an unusual man, thus he wants to travel only interesting routes. He calls a sequence of cities <b>i<sub>1<\/sub>, i<sub>2<\/sub>, ..., i<sub>K<\/sub><\/b> an <i>interesting route<\/i> if:\n<ul>\n<li> no two cities in the sequence are the same: i.e. <b>i<\/sub>j<\/sub><\/b> \u2260 <b>i<sub>j'<\/sub><\/b> for any two <b>j<\/b> \u2260 <b>j'<\/b>.\n<li> cities <b>i<sub>j<\/sub><\/b> and <b>i<sub>j+1<\/sub><\/b> are connected by a road for each <b>1<\/b> \u2264 <b>j<\/b> &lt; <b>K<\/b>.\n<li> the number of indices <b>j<\/b> with <b>1<\/b> &lt; <b>j<\/b> &lt; <b>K<\/b> with <b>a<sub>i<sub>j-1<\/sub><\/sub><\/b> &lt; <b>a<sub>i<sub>j<\/sub><\/sub><\/b> > <b>a<sub>i<sub>j+1<\/sub><\/sub><\/b> is at least <b>L<\/b> and at most <b>R<\/b> for some given <b>L<\/b> and <b>R<\/b>.\n<\/ul>\n<\/p>\n\n<p>\nHelp Kirito count the number of interesting routes in Memeland.\n<\/p>\n\n<p><\/p>\n\n\n<h3>Input<\/h3>\n\n<p>\nThe first line of the input contains an integer <b>T<\/b> denoting the number of test cases.\n<\/p>\n\n<p>\nThe first line of each test case contains one integer <b>N<\/b> denoting the number of cities in Memeland.\nThe second line of each test case contains two integers: <b>L<\/b> and <b>R<\/b> described in the statement.\n<\/p>\n\n<p>The third line of each test case contains <b>N<\/b> integers where <b>i-th<\/b> integer is <b>a<sub>i<\/sub><\/b>, the height of <b>i-th<\/b> city. The final <b>N - 1<\/b> lines contain two integers denoting pairs of cities that are connected by roads.<\/p>\n\n<p><\/p>\n\n<h3>Output<\/h3>\n\n<p>\nFor each test case, output a single line containing one integer denoting amount of interesting routes.\n<\/p>\n\n<p><\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>20<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>5*10<sup>4<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>L<\/b> \u2264 <b>R<\/b> \u2264 <b>10<sup>7<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>a<sub>i<\/sub><\/b> \u2264 <b>10<sup>7<\/sup><\/b><\/li>\n<\/ul>\n\n\n<h3>Subtasks<\/h3>\n<p>\n<ul>\n<li><b>Subtask 1:<\/b>  <b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>10<sup>3<\/sup><\/b> - <b>20 points<\/b><\/li>\n<li><b>Subtask 2:<\/b> <b>Original constraints<\/b> - <b>80 points<\/b><\/li>\n<\/ul>\n<\/p>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n<tt>3\n3\n1 2\n1 3 1\n1 2\n2 3\n7\n2 2\n1 8 2 3 4 8 1\n1 2\n2 3\n3 4\n3 5\n3 6\n6 7\n9\n1 7\n5 1 1 1 1 1 1 1 1\n1 2\n2 3\n1 4\n4 5\n1 6\n6 7\n1 8\n8 9<\/tt>\n<b>Output:<\/b>\n<tt>1\n1\n24<\/tt>\n<\/pre>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1.5","source_sizelimit":"50000","problem_author":"maestr0","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>maestr0<\/span>","problem_tester":"xcwgf666","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","date_added":"4-07-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/divide-and-conq'>\n                    divide-and-conq\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/maestr0'>\n                    maestr0\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/nov16'>\n                    nov16\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/tree'>\n                    tree\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/KIRMEME","user":{"username":null},"time":{"view_start_date":1479115800,"submit_start_date":1479115800,"visible_start_date":1479115800,"end_date":1735669800,"current":1493557709},"todo":false,"problem_status":"unattempted"}