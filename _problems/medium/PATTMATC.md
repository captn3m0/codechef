---
{"category_name":"medium","problem_code":"PATTMATC","problem_name":"Pattern matching","languages_supported":{"0":"ADA","1":"ASM","2":"BASH","3":"BF","4":"C","5":"C99 strict","6":"CAML","7":"CLOJ","8":"CLPS","9":"CPP 4.3.2","10":"CPP 4.9.2","11":"CPP14","12":"CS2","13":"D","14":"ERL","15":"FORT","16":"FS","17":"GO","18":"HASK","19":"ICK","20":"ICON","21":"JAVA","22":"JS","23":"LISP clisp","24":"LISP sbcl","25":"LUA","26":"NEM","27":"NICE","28":"NODEJS","29":"PAS fpc","30":"PAS gpc","31":"PERL","32":"PERL6","33":"PHP","34":"PIKE","35":"PRLG","36":"PYPY","37":"PYTH","38":"PYTH 3.4","39":"RUBY","40":"SCALA","41":"SCM chicken","42":"SCM guile","43":"SCM qobi","44":"ST","45":"TCL","46":"TEXT","47":"WSPC"},"max_timelimit":2,"source_sizelimit":50000,"problem_author":"xcwgf666","problem_tester":"logic_iu","date_added":"24-08-2015","tags":{"0":"kmp","1":"ltime28","2":"medium","3":"pattern","4":"string","5":"xcwgf666"},"editorial_url":"http://discuss.codechef.com/problems/PATTMATC","time":{"view_start_date":1440923400,"submit_start_date":1440923400,"visible_start_date":1440923400,"end_date":1735669800},"layout":"problem"}
---
<span class="solution-visible-txt">All submissions for this problem are available.</span><h3> Read problems statements in <a target="_blank" href="http://www.codechef.com/download/translated/LTIME28/mandarin/PATTMATC.pdf">Mandarin Chinese </a> , <a target="_blank" href="http://www.codechef.com/download/translated/LTIME28/russian/PATTMATC.pdf">Russian</a> and <a target="_blank" href="http://www.codechef.com/download/translated/LTIME28/vietnamese/PATTMATC.pdf">Vietnamese</a></h3>
<p>You are given a string <b>S</b>, made of lowercase Latin letters.</p>
<p>You are also given a <i>wildcard</i> string <b>T</b>, containing lowercase latin letters and asterisks (symbol <tt>*</tt>).</p>
<p>Both the strings are 1-indexed.</p>
<p><i>Wildcard</i> string <b>T</b> is said to <i>generate</i> a string <b>P</b> if and only if <b>P</b> can be obtained from <b>T</b> by replacing <b>all</b> the asterisks with arbitrary (possibly empty) lowercase Latin letter strings.</p>
<p>Consider the <b>i</b><sup>th</sup> symbol of the string <b>S</b>. Let's calculate the smallest index <b>p<sub>i</sub> ≥ i</b> such that the substring <b>S<sub>i</sub></b>...<b>S<sub>p<sub>i</sub></sub></b> contains at least one of the strings generated by <i>wildcard</i> string <b>T</b>. In case any such index <b>p<sub>i</sub></b> doesn't exist, then <b>p<sub>i</sub> = -1</b>.</p>
<p>Your goal is to calculate all the values <b>p<sub>1</sub></b>, <b>p<sub>2</sub></b>, ... , <b>p<sub>|S|</sub></b>.</p>
<h3>Input</h3>
<p>The first line of input contains an integer <b>Tn</b> denoting the number of test cases. The description of <b>Tn</b> test cases follows.</p>
<p>The first line of each test case contains a <i>wildcard</i> string <b>T</b>.</p>
<p>The second line of the test case contains a lowercase Latin string <b>S</b>.</p>
<h3>Output</h3>
<p>For each test case, output a single line containing <b>|S|</b> space-separated integers, denoting <b>p<sub>1</sub></b>, <b>p<sub>2</sub></b>, ..., <b>p<sub>|S|</sub></b>.</p>
<h3>Constraints</h3>
<ul>
<li><b>1</b> ≤ <b>T</b> ≤ <b>10<sup>2</sup></b></li>
<li>Subtask 1 (33 points) : <b>1</b> ≤ sum of all <b>|S|</b>, sum of all <b>|T|</b> over a single test case ≤ <b>10<sup>3</sup></b>, <b>1</b> ≤ <b>|S|</b>, <b>|T|</b> ≤ <b>10<sup>2</sup></b></li>
<li>Subtask 2 (33 points) : <b>1</b> ≤ sum of all <b>|S|</b>, sum of all <b>|T|</b> over a single test case ≤ <b>10<sup>5</sup></b>, <b>1</b> ≤ <b>|S|</b>, <b>|T|</b> ≤ <b>10<sup>3</sup></b></li>
<li>Subtask 3 (34 points) : <b>1</b> ≤ sum of all <b>|S|</b>, sum of all <b>|T|</b> over a single test case ≤ <b>10<sup>5</sup></b>, <b>1</b> ≤ <b>|S|</b>, <b>|T|</b> ≤ <b>10<sup>5</sup></b></li>
<li>Total number of asterisks over all the test cases is at most <b>500</b>.</li>
</ul>
<h3>Example</h3>
<pre><b>Input:</b>
<tt>2
*a*
abacaba
*a*b*
abacaba</tt>

<b>Output:</b>
<tt>1 3 3 5 5 7 7
2 6 6 6 6 -1 -1</tt>
</pre><h3>Explanation</h3>
<p><b>Example case 1.</b> Let us show that for every index <b>i</b> the value of <b>p<sub>i</sub></b> is correct:</p>
<ul>
<li><b>p<sub>1</sub></b> = 1. The corresponding substring <b>a</b> contains the string <b>a</b>. String <b>a</b> can be generated by replacing both asterisks with empty strings.</li>
<li><b>p<sub>2</sub></b> = 3. The corresponding substring <b>ba</b> contains the string <b>a</b>.</li>
<li><b>p<sub>3</sub></b> = 3. The corresponding substring <b>a</b> contains the string <b>a</b>.</li>
<li><b>p<sub>4<sub></sub></sub></b> = 5. The corresponding substring <b>ca</b> contains the string <b>ca</b>. The string <b>ca</b> can be obtained if we replace the first asterisk with <b>c</b> and the second one with an empty string.</li>
<li><b>p<sub>5<sub></sub></sub></b> = 5. The corresponding substring <b>a</b> contains the string <b>a</b>.</li>
<li><b>p<sub>6<sub></sub></sub></b> = 7. The corresponding substring <b>ba</b> contains the string <b>ba</b>. The string <b>ba</b> can be obtained if we replace the first asterisk with <b>b</b> and the second one with an empty string.</li>
<li><b>p<sub>7<sub></sub></sub></b> = 7. The corresponding substring <b>a</b> contains the string <b>a</b>.</li>
</ul>

<p><b>Example case 2.</b> Again, let's check for every <b>i</b>.</p>
<ul>
<li><b>p<sub>1</sub></b> = 2. The corresponding substring <b>ab</b> contains <b>ab</b>. The string <b>ab</b> can be obtained if we replace all the asterisks with empty strings.</li>
<li><b>p<sub>2</sub></b> = 6. The corresponding substring <b>bacab</b> contains <b>acab</b>. The string <b>acab</b> can be obtained if we replace the first asterisk with an empty string, the second one with the string <b>ca</b> and the third one with an empty string.</li>
<li><b>p<sub>3<sub></sub></sub></b> = 6. The corresponding substring <b>acab</b> contains <b>ab</b>. </li>
<li><b>p<sub>4<sub></sub></sub></b> = 6. The corresponding substring <b>cab</b> contains <b>cab</b>. The string <b>cab</b> can be obtained if you replace the first asterisk with <b>c</b>, and the rest with empty strings. </li>
<li><b>p<sub>5<sub></sub></sub></b> = 6. The corresponding substring <b>ab</b> contains <b>ab</b>.</li>
<li><b>p<sub>6<sub></sub></sub></b> = <b>p<sub>7<sub></sub></sub></b> = -1. Neither <b>ba</b> nor <b>a</b> doesn't contain any substring, generated by <tt>*a*b*</tt>.</li>
</ul>

<p>You may have noted that in the explanation for the second test case, <b>ab</b> is also a correct substring generated by <b>T</b> for some positions, but some other string is listed. This is done on purpose, in order to show how the string <b>T</b> can generate various strings.
</p>
