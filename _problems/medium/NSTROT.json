{"category_name":"medium","status":"success","problem_code":"NSTROT","problem_name":"Nested Rotation","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/hindi\/NSTROT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/bengali\/NSTROT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/mandarin\/NSTROT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/russian\/NSTROT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/vietnamese\/NSTROT.pdf) as well.\r\n\r\nChef is feeling tired after his birthday party, so he decided to ask you to compute the result of the following pseudocode rather than explain this problem. The input for the code consists of an integer $V$ and two permutations $P_1, P_2, \\ldots, P_N$ and $Q_1, Q_2, \\ldots, Q_N$ of the integers $1$ through $N$. Don't worry, Chef will give you this input.\r\n\r\n```\r\nfunction Log2(x):\r\n    if x is at most 1:\r\n        return 0\r\n    else:\r\n        return Log2(floor(x \/ 2)) + 1\r\n\r\nfunction F(A[1...N], B[1...N]):\r\n    posA[i] = index j such that A[j] == i\r\n    posB[i] = index j such that B[j] == i\r\n    ret = 0\r\n    for i = 1 to N:\r\n        ret += Log2(absolute_value(posA[i] - posB[i]))\r\n    return ret\r\n\r\nresult = 1\r\nFor i = 0 to v - 1:\r\n    R = cyclic right shift of Q by i\r\n    result *= F(P, R)\r\nresult %= 998244353        \r\n```\r\n\u00a0 \r\n\r\nFor each $i$  ( $0 \\le i \\lt N$), the cyclic right shift of the permutation $Q$ by $i$ is the permutation created by moving the last $i$ elements of $Q$ to the beginning, i.e. the sequence $Q_{N-i+1}, Q_{N-i+2}, \\ldots, Q_N, Q_1, Q_2, \\ldots, Q_{N-i}$. For example, if we perform a cyclic right shift by $1$ on the permutation $(4, 1, 2, 3)$, it becomes $(3, 4, 1, 2)$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $V$.\r\n- The second line contains $N$ space-separated integers $P_1, P_2, \\ldots, P_N$.\r\n- The third line contains $N$ space-separated integers $Q_1, Q_2, \\ldots, Q_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the result of the code.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10$\r\n- $1 \\le V \\le N \\le 10^5$\r\n- $1 \\le P_i, Q_i \\le N$ for each valid $i$\r\n- $P_1, P_2, \\ldots, P_N$ are pairwise distinct\r\n- $Q_1, Q_2, \\ldots, Q_N$ are pairwise distinct\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** $N \\le 5 \\cdot 10^3$\r\n\r\n**Subtask #2 (50 points):**: original constraints\r\n\r\n### Example Input\r\n```\r\n1\r\n4 2\r\n4 1 2 3\r\n3 2 4 1\r\n```\r\n\r\n### Example Output\r\n```\r\n6\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/hindi\/NSTROT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/bengali\/NSTROT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/mandarin\/NSTROT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/russian\/NSTROT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/vietnamese\/NSTROT.pdf) as well.\r\n\r\nChef is feeling tired after his birthday party, so he decided to ask you to compute the result of the following pseudocode rather than explain this problem. The input for the code consists of an integer $V$ and two permutations $P_1, P_2, \\ldots, P_N$ and $Q_1, Q_2, \\ldots, Q_N$ of the integers $1$ through $N$. Don't worry, Chef will give you this input.\r\n\r\n```\r\nfunction Log2(x):\r\n    if x is at most 1:\r\n        return 0\r\n    else:\r\n        return Log2(floor(x \/ 2)) + 1\r\n\r\nfunction F(A[1...N], B[1...N]):\r\n    posA[i] = index j such that A[j] == i\r\n    posB[i] = index j such that B[j] == i\r\n    ret = 0\r\n    for i = 1 to N:\r\n        ret += Log2(absolute_value(posA[i] - posB[i]))\r\n    return ret\r\n\r\nresult = 1\r\nFor i = 0 to v - 1:\r\n    R = cyclic right shift of Q by i\r\n    result *= F(P, R)\r\nresult %= 998244353        \r\n```\r\n\u00a0 \r\n\r\nFor each $i$  ( $0 \\le i \\lt N$), the cyclic right shift of the permutation $Q$ by $i$ is the permutation created by moving the last $i$ elements of $Q$ to the beginning, i.e. the sequence $Q_{N-i+1}, Q_{N-i+2}, \\ldots, Q_N, Q_1, Q_2, \\ldots, Q_{N-i}$. For example, if we perform a cyclic right shift by $1$ on the permutation $(4, 1, 2, 3)$, it becomes $(3, 4, 1, 2)$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $V$.\r\n- The second line contains $N$ space-separated integers $P_1, P_2, \\ldots, P_N$.\r\n- The third line contains $N$ space-separated integers $Q_1, Q_2, \\ldots, Q_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the result of the code.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10$\r\n- $1 \\le V \\le N \\le 10^5$\r\n- $1 \\le P_i, Q_i \\le N$ for each valid $i$\r\n- $P_1, P_2, \\ldots, P_N$ are pairwise distinct\r\n- $Q_1, Q_2, \\ldots, Q_N$ are pairwise distinct\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** $N \\le 5 \\cdot 10^3$\r\n\r\n**Subtask #2 (50 points):**: original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n4 2\r\n4 1 2 3\r\n3 2 4 1","output":"6","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"ezio_26","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>ezio_26<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"24-03-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/contribution'>contribution<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ezio_26'>ezio_26<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime82'>ltime82<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/observation'>observation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/NSTROT","time":{"view_start_date":1585408500,"submit_start_date":1585408500,"visible_start_date":1585408500,"end_date":1735669800,"current":1643797964},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=NSTROT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}