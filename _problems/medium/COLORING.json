{"category_name":"medium","status":"success","problem_code":"COLORING","problem_name":"Tree Coloring","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME35\/mandarin\/COLORING.pdf\">Mandarin Chinese <\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME35\/russian\/COLORING.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME35\/vietnamese\/COLORING.pdf\">Vietnamese<\/a> as well.<\/h3>\n<p>Chef has recently learnt about binary trees and immediately fell in love with them. His best friend Shasha has promised him to gift a binary tree only if he is able to show his love for binary trees by solving the following problem about binary trees.<\/p>\n<p>Given a complete binary tree <b>T<\/b> consisting of <b>N<\/b> nodes labelled from 1 to <b>N<\/b>. The node with label <b>1<\/b> is the root of the tree. For a node labelled <b>v<\/b>, its' left child will be labelled as <b>2*v<\/b> (provided it exists) and right child as <b>2*v+1<\/b> (provided it exists).<\/p>\n<p>Initially, all the nodes of tree are uncolored.<\/p>\n<p>Chef has to perform <b>Q<\/b> queries on tree <b>T<\/b> where each query can have one of the following three types:<\/p>\n<ul>\n<li><b>1 X K<\/b>\n<p>Update the tree <b>T<\/b> such that node <b>X<\/b> becomes uncolored, all the nodes at distance <b>1<\/b> from <b>X<\/b> get colored with color <b>1<\/b>, all nodes at distance <b>2<\/b> from <b>X<\/b> get colored with color <b>2<\/b>, and so on up to nodes at distance <b>K<\/b> from <b>X<\/b>.<\/p>\n<p>Formally, color all nodes that are at distance <b>(1 \u2264 D \u2264 K)<\/b> units from node <b>X<\/b> with color <b>D<\/b> and make node <b>X<\/b> colourless.<\/p>\n<p>Please note that when we say node at distance <b>D<\/b> from node <b>X<\/b>, <i>you have to consider all the nodes in the tree, not just the ones in the subtree of <b>X<\/b><\/i>.<\/p>\n<\/li>\n<li><b>2 X Y<\/b>\n<p>Count the number of distinct colors on the unique simple path from node <b>X<\/b> to node <b>Y<\/b>.<\/p>\n<\/li>\n<li><b>3 X<\/b>\n<p>Count the number of distinct colors in the subtree rooted at node <b>X<\/b>.<\/p>\n<\/li>\n<\/ul>\n\n<h3>Input<\/h3>\n<p>The first line of input contains two space separated integer numbers <b>N<\/b> and <b>Q<\/b> denoting the number of  nodes in the tree <b>T<\/b> and number of queries to be processed respectively.<\/p>\n<p>Each of the following <b>Q<\/b> lines contains a query of one of the above mentioned three types.<\/p>\n<h3>Output<\/h3>\n<p>For each query of type <b>2<\/b> and <b>3<\/b>, print the sought answer.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1 \u2264 N \u2264 10<sup>5<\/sup><\/b><\/li>\n<li><b>1 \u2264 Q \u2264 50000<\/b><\/li>\n<li><b>1 \u2264 X, Y \u2264 N<\/b><\/li>\n<li><b>0 \u2264 K \u2264 10<sup>5<\/sup><\/b><\/li>\n<\/ul>\n<h3>Subtasks<\/h3>\n<ul>\n<li>Subtask 1 (32 pts) : <b>1 \u2264 N, Q \u2264 1000<\/b><\/li>\n<li>Subtask 2 (68 pts) : <b>original constraints<\/b><\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre>\n<b>Input<\/b>\n<tt>10 10\n2 3 5\n3 1\n1 2 2\n2 3 5\n1 3 2\n2 3 5\n3 1\n1 7 5\n3 1\n2 3 5<\/tt>\n\n<b>output<\/b>\n<tt>0\n0\n2\n2\n2\n5\n4<\/tt>\n<\/pre>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"3","source_sizelimit":"50000","problem_author":"ma5termind","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>ma5termind<\/span>","problem_tester":"xcwgf666","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","date_added":"29-03-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/data-structure'>\n                    data-structure\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ltime35'>\n                    ltime35\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ma5termind'>\n                    ma5termind\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/queries'>\n                    queries\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/segment'>\n                    segment\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/tree'>\n                    tree\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/COLORING","user":{"username":null},"time":{"view_start_date":1462036200,"submit_start_date":1462036200,"visible_start_date":1462036200,"end_date":1735669800,"current":1493557596},"todo":false,"problem_status":"unattempted"}