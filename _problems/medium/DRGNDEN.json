{"category_name":"medium","status":"success","problem_code":"DRGNDEN","problem_name":"Chef and Dragon Dens","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JULY20\/hindi\/DRGNDEN.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY20\/bengali\/DRGNDEN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY20\/mandarin\/DRGNDEN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY20\/russian\/DRGNDEN.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY20\/vietnamese\/DRGNDEN.pdf) as well.\r\n\r\nChef is on an adventure to find the tastiest exotic spices. Everyone knows that the best spices are guarded by several ancient dragons that dwell within mountains.\r\n\r\nThe mountain range can be modeled by a polyline in the 2D $xz$ plane that passes through $N$ points $p_1 = (1,h_1), p_2 = (2, h_2), \\ldots, p_N = (N, h_N)$, in this order, where $h_i$ is a positive integer for each valid $i$. This polyline divides the set of points $\\{(x, z): 1 \\le x \\le N\\}$ into two regions. The \"solid\" part of the mountain range is the \"bottom\" region, i.e. the region that contains the $x$-axis (the x-axis is the line $z=0$).\r\n\r\nA dragon's den is located at each of the $N$ points. For each valid $i$, the den at the point $p_i$ initially contains a pile of spices with tastiness $a_i$. With a technique he learned from dragons, Chef can glide from den to den, tasting all of the spices along the way. The tastiness of an entire journey is the summed up tastiness of spices over all dens visited during the journey. However, there are some restrictions:\r\n- Chef can only glide from a higher den to a strictly lower den, i.e. if he glides from a den at $p_i$ to a den at $p_j$, then $h_i \\gt h_j$ must hold.\r\n- Chef can only glide in one direction and never look back, i.e. if he starts travelling in the direction of decreasing $x$, he must keep travelling in that direction until the end of the journey, and if he starts travelling in the direction of increasing $x$, he must keep travelling in that direction until the end of the journey too.\r\n- Chef cannot travel through solid mountain, i.e. he can only glide from a den at $p_i$ to a den at $p_j$ if the line segment connecting the points $p_i$ and $p_j$ does not intersect the \"solid\" part of the mountain range. However, it may touch the border of the mountain range, i.e. the polyline itself.\r\n\r\nNote that gliding is the **only** way for Chef to travel between dens.  It is valid for a journey to begin and end at the same den, in which case Chef tastes the spices at the den and nothing else.\r\n\r\nSee the explanation of the sample test case for a concrete example.\r\n\r\nWith that in mind, Chef needs you to process $Q$ queries. There are two types of queries:\r\n- `1 b k`: Chef changes his mind and decides that the tastiness of the spices in the den at the point $p_b$ should be changed to $k$ instead.\r\n- `2 b c`: Chef wants to start a journey at the den located at $p_b$ and end it at the den located at $p_c$. Find the maximum possible tastiness of such a journey or determine that no such journey exists. \r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $h_1, h_2, \\ldots, h_N$.\r\n- The third line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$.\r\n- Then, $Q$ lines follow. Each of these lines contains three space-separated integers describing a query in the above format.\r\n\r\n### Output\r\nFor each query of the second type, print a single line containing one integer \u2015 the maximum tastiness of a journey or $-1$ if no valid journey exists.\r\n\r\n### Constraints\r\n- $1 \\le N,Q \\le 2 \\cdot 10^5$\r\n- $1 \\le h_i \\le 10^9$ for each valid $i$\r\n- $1 \\le a_i \\le 10^9$ for each valid $i$\r\n- $1 \\le b, c \\le N$\r\n- $1 \\le k \\le 10^9$\r\n\r\n### Subtasks\r\n**Subtask 1 (10 points):** $N, Q \\le 1,000$\r\n\r\n**Subtask 2 (35 points):** there are no queries of the first type\r\n\r\n**Subtask 3 (55 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n5 4\r\n3 1 4 1 5\r\n1 2 4 8 16\r\n2 5 2\r\n1 3 5\r\n2 3 4\r\n2 1 4\r\n```\r\n\r\n### Example Output\r\n```\r\n22\r\n13\r\n-1\r\n```\r\n\r\n### Explanation\r\n\r\nHere is an illustration of the mountain range described in the first sample test case.\r\n\r\n![fig1](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/JULY20\/DRGNDEN\/picture.png)\r\n\r\n- Query 1: Starting at $p_5$ (height $5$), Chef can glide to $p_3$ (height 4) and then to $p_2$ (height $1$). The total tastiness of this journey is $a_5+a_3+a_2=16+4+2=22$.\r\n\r\n![fig2](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/JULY20\/DRGNDEN\/picture1.png) \r\n\r\n- Query 2: The value of $a_3$ is set to $5$.\r\n- Query 3: Chef glides from $p_3$ to $p_4$. The tastiness is $a_3+a_4=5+8=13$.\r\n- Query 4: It is impossible to get from $p_1$ to $p_4$. Even if $h_1 \\gt h_4$, to reach $p_4$, Chef would need to fly either upwards or through the mountain, both of which are impossible.\r\n\r\n![fig3](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/JULY20\/DRGNDEN\/picture3.png)\r\n\r\n![fig4](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/JULY20\/DRGNDEN\/unnamed.png)\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JULY20\/hindi\/DRGNDEN.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY20\/bengali\/DRGNDEN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY20\/mandarin\/DRGNDEN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY20\/russian\/DRGNDEN.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY20\/vietnamese\/DRGNDEN.pdf) as well.\r\n\r\nChef is on an adventure to find the tastiest exotic spices. Everyone knows that the best spices are guarded by several ancient dragons that dwell within mountains.\r\n\r\nThe mountain range can be modeled by a polyline in the 2D $xz$ plane that passes through $N$ points $p_1 = (1,h_1), p_2 = (2, h_2), \\ldots, p_N = (N, h_N)$, in this order, where $h_i$ is a positive integer for each valid $i$. This polyline divides the set of points $\\{(x, z): 1 \\le x \\le N\\}$ into two regions. The \"solid\" part of the mountain range is the \"bottom\" region, i.e. the region that contains the $x$-axis (the x-axis is the line $z=0$).\r\n\r\nA dragon's den is located at each of the $N$ points. For each valid $i$, the den at the point $p_i$ initially contains a pile of spices with tastiness $a_i$. With a technique he learned from dragons, Chef can glide from den to den, tasting all of the spices along the way. The tastiness of an entire journey is the summed up tastiness of spices over all dens visited during the journey. However, there are some restrictions:\r\n- Chef can only glide from a higher den to a strictly lower den, i.e. if he glides from a den at $p_i$ to a den at $p_j$, then $h_i \\gt h_j$ must hold.\r\n- Chef can only glide in one direction and never look back, i.e. if he starts travelling in the direction of decreasing $x$, he must keep travelling in that direction until the end of the journey, and if he starts travelling in the direction of increasing $x$, he must keep travelling in that direction until the end of the journey too.\r\n- Chef cannot travel through solid mountain, i.e. he can only glide from a den at $p_i$ to a den at $p_j$ if the line segment connecting the points $p_i$ and $p_j$ does not intersect the \"solid\" part of the mountain range. However, it may touch the border of the mountain range, i.e. the polyline itself.\r\n\r\nNote that gliding is the **only** way for Chef to travel between dens.  It is valid for a journey to begin and end at the same den, in which case Chef tastes the spices at the den and nothing else.\r\n\r\nSee the explanation of the sample test case for a concrete example.\r\n\r\nWith that in mind, Chef needs you to process $Q$ queries. There are two types of queries:\r\n- `1 b k`: Chef changes his mind and decides that the tastiness of the spices in the den at the point $p_b$ should be changed to $k$ instead.\r\n- `2 b c`: Chef wants to start a journey at the den located at $p_b$ and end it at the den located at $p_c$. Find the maximum possible tastiness of such a journey or determine that no such journey exists. \r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $h_1, h_2, \\ldots, h_N$.\r\n- The third line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$.\r\n- Then, $Q$ lines follow. Each of these lines contains three space-separated integers describing a query in the above format.\r\n\r\n### Output\r\nFor each query of the second type, print a single line containing one integer \u2015 the maximum tastiness of a journey or $-1$ if no valid journey exists.\r\n\r\n### Constraints\r\n- $1 \\le N,Q \\le 2 \\cdot 10^5$\r\n- $1 \\le h_i \\le 10^9$ for each valid $i$\r\n- $1 \\le a_i \\le 10^9$ for each valid $i$\r\n- $1 \\le b, c \\le N$\r\n- $1 \\le k \\le 10^9$\r\n\r\n### Subtasks\r\n**Subtask 1 (10 points):** $N, Q \\le 1,000$\r\n\r\n**Subtask 2 (35 points):** there are no queries of the first type\r\n\r\n**Subtask 3 (55 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"5 4\r\n3 1 4 1 5\r\n1 2 4 8 16\r\n2 5 2\r\n1 3 5\r\n2 3 4\r\n2 1 4","output":"22\r\n13\r\n-1","explanation":"Here is an illustration of the mountain range described in the first sample test case.\r\n\r\n![fig1](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/JULY20\/DRGNDEN\/picture.png)\r\n\r\n- Query 1: Starting at $p_5$ (height $5$), Chef can glide to $p_3$ (height 4) and then to $p_2$ (height $1$). The total tastiness of this journey is $a_5+a_3+a_2=16+4+2=22$.\r\n\r\n![fig2](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/JULY20\/DRGNDEN\/picture1.png) \r\n\r\n- Query 2: The value of $a_3$ is set to $5$.\r\n- Query 3: Chef glides from $p_3$ to $p_4$. The tastiness is $a_3+a_4=5+8=13$.\r\n- Query 4: It is impossible to get from $p_1$ to $p_4$. Even if $h_1 \\gt h_4$, to reach $p_4$, Chef would need to fly either upwards or through the mountain, both of which are impossible.\r\n\r\n![fig3](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/JULY20\/DRGNDEN\/picture3.png)\r\n\r\n![fig4](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/JULY20\/DRGNDEN\/unnamed.png)","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"shisuko","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span class='m-username--link'>shisuko<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"23-03-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/data-structure'>data-structure<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/greedy'>greedy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/july20'>july20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/shisuko'>shisuko<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/shisuko'>shisuko<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/stack'>stack<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/trees'>trees<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Segment Tree","editorial_url":"https:\/\/discuss.codechef.com\/problems\/DRGNDEN","time":{"view_start_date":1594632600,"submit_start_date":1594632600,"visible_start_date":1594632600,"end_date":1735669800,"current":1643797938},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=DRGNDEN","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}