{"category_name":"medium","status":"success","problem_code":"FRICAN","problem_name":"Friends and Candies","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK109\/hindi\/FRICAN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK109\/mandarin\/FRICAN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK109\/russian\/FRICAN.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK109\/vietnamese\/FRICAN.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK109\/bengali\/FRICAN.pdf) as well.\n\nHasan is preparing a party for his $M$ friends (numbered $1$ through $M$). He bought $N$ baskets of candies (numbered $1$ through $N$); for each valid $i$, the $i$-th basket contains $a_i$ candies.\n\nEach friend should get at most one candy. For each valid $i$, the $i$-th friend would like to get a candy either from one of the first $L_i$ baskets or one of the last $R_i$ baskets, i.e. a from basket $b$ ($1 \\le b \\le N$) such that $b \\le L_i$ or $b \\ge N+1-R_i$.\n\nHasan loves his friends, so he wants as many of them as possible to get the candies they want. If he distributes the candies optimally, what is the maximum number of his friends who will get the candies they want?\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains two space-separated integers $N$ and $M$.\n- The second line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$.\n- $M$ lines follow. For each $i$ ($1 \\le i \\le M$), the $i$-th of these lines contains two space-separated integers $L_i$ and $R_i$.\n\n### Output\nFor each test case, print a single line containing one integer \u2014 the maximum number of Hasan's friends who can get the candies they want.\n\n### Constraints\n- $1 \\le T \\le 10^3$\n- $1 \\le N, M \\le 10^6$\n- $0 \\le a_i \\le 10^6$ for each valid $i$\n- $0 \\le L_i, R_i \\le N$ for each valid $i$\n- $0 \\le L_i + R_i \\le N$ for each valid $i$\n- the sum of $N$ over all test cases does not exceed $10^6$\n- the sum of $M$ over all test cases does not exceed $10^6$\n\n### Example Input\n```\n2\n3 3\n1 1 1\n0 2\n1 1\n0 2\n3 3\n1 1 1\n1 1\n1 1\n1 1\n```\n\n### Example Output\n```\n3\n2\n```\n\n### Explanation\n**Example case 1:** We can give a candy from basket $1$ to the $2$-nd friend, a candy from basket $2$ to the $1$-st friend and a candy from basket $3$ to the $3$-rd friend.\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK109\/hindi\/FRICAN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK109\/mandarin\/FRICAN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK109\/russian\/FRICAN.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK109\/vietnamese\/FRICAN.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK109\/bengali\/FRICAN.pdf) as well.\n\nHasan is preparing a party for his $M$ friends (numbered $1$ through $M$). He bought $N$ baskets of candies (numbered $1$ through $N$); for each valid $i$, the $i$-th basket contains $a_i$ candies.\n\nEach friend should get at most one candy. For each valid $i$, the $i$-th friend would like to get a candy either from one of the first $L_i$ baskets or one of the last $R_i$ baskets, i.e. a from basket $b$ ($1 \\le b \\le N$) such that $b \\le L_i$ or $b \\ge N+1-R_i$.\n\nHasan loves his friends, so he wants as many of them as possible to get the candies they want. If he distributes the candies optimally, what is the maximum number of his friends who will get the candies they want?\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains two space-separated integers $N$ and $M$.\n- The second line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$.\n- $M$ lines follow. For each $i$ ($1 \\le i \\le M$), the $i$-th of these lines contains two space-separated integers $L_i$ and $R_i$.\n\n### Output\nFor each test case, print a single line containing one integer \u2014 the maximum number of Hasan's friends who can get the candies they want.\n\n### Constraints\n- $1 \\le T \\le 10^3$\n- $1 \\le N, M \\le 10^6$\n- $0 \\le a_i \\le 10^6$ for each valid $i$\n- $0 \\le L_i, R_i \\le N$ for each valid $i$\n- $0 \\le L_i + R_i \\le N$ for each valid $i$\n- the sum of $N$ over all test cases does not exceed $10^6$\n- the sum of $M$ over all test cases does not exceed $10^6$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\n3 3\n1 1 1\n0 2\n1 1\n0 2\n3 3\n1 1 1\n1 1\n1 1\n1 1","output":"3\n2","explanation":"**Example case 1:** We can give a candy from basket $1$ to the $2$-nd friend, a candy from basket $2$ to the $1$-st friend and a candy from basket $3$ to the $3$-rd friend.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"i_love_islam","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>i_love_islam<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"17-08-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook109'>cook109<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/greedy'>greedy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/i_love_islam'>i_love_islam<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/observation'>observation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/FRICAN","time":{"view_start_date":1566153002,"submit_start_date":1566153002,"visible_start_date":1566153002,"end_date":1735669800,"current":1643797944},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=FRICAN","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}