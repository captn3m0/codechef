{"category_name":"medium","status":"success","problem_code":"MAXSEG","problem_name":"MAX-SEG","body":"Given two arrays $A$ and $B$ of size $N$, array $B$ contains only ${0,1}$. You are given $Q$ queries,in each query you are given $i,j$.\nFor each query you have to partition sub array $A[i,..,j]$ into some contiguous segments such that, segments are non-intersecting and each element must belong to exactly one segment and each segment must follow the given condition:\n<br \/>\n<br \/>\nLet [l,r] be one of such a segment then $B[l]$ + $B[l+1]$ + $B[l+2]$ +..+ $B[r]$ should be equal to 1.\n<br \/>\n<br \/>\nLet's define sum(l,r) = $A[l]$+$A[l+1]$+$A[l+2]$+..+$A[r]$. Your goal is to partition  sub array $A[i,..,j]$ into segments such that it must follow the given condition and you have to maximize the number of segments with non-negative sum. \n<br \/>\n<br \/>\nFinally for each query print the maximum number of segments with non-negative sum, without violating the above condition.\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"- $1\\le T  \\le 10$ \n- $1\\le N, Q  \\le 5 \\cdot10^5$ \n- $|A_i| \\le 10^9 $\n- $0\\le B_i \\le1$\n- $1 \\le L \\le R \\le N$\n- Sum of $N$ over all test cases does not exceed $5\\cdot10^5$\n- Sum of $Q$ over all test cases does not exceed $5\\cdot10^5$\n","constraintsState":true,"subtasks":"**Subtask #1 (5 points)**\n- $1\\le N \\le 1000$\n- $Q = 1$\n- Sum of $N$ over all test cases does not exceed $10^3$\n\n**Subtask #2 (30 points)**\n- $1\\le N \\le 5 \\cdot 10^5$\n- $Q = 1$\n- Sum of $N$ over all test cases does not exceed $5\\cdot10^5$\n\n**Subtask #3 (65 points)**\n- Original constraints\n","subtasksState":true,"statement":"### Read problem statements in [Mandarin](https:\/\/www.codechef.com\/download\/translated\/LTIME101\/mandarin\/MAXSEG.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME101\/russian\/MAXSEG.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME101\/vietnamese\/MAXSEG.pdf) as well.\n\nYou are given two arrays $A$ and $B$ of length $N$. The array $B$ contains only zeros and ones. \n\nYou are given $Q$ queries, each of which consists of two integers $L$ and $R$, $L\\leq R$.\nConsider a partition of the interval $[L, R]$ into some $k \\geq 1$ subintervals $[l_1, r_1], [l_2, r_2], \\dots, [l_k, r_k]$ satisfying the following conditions:\n* $l_1 = L$ and $r_k = R$\n* $l_i \\leq r_i$ for every $1 \\leq i \\leq k$\n* $r_i + 1 = l_{i+1}$ for every $1 \\leq i < k$\n* $B_{l_i} + B_{l_i + 1} + \\dots + B_{r_i} = 1$ for every $1\\leq i\\leq k$\n\nNote that you are free to choose any $k\\geq 1$.\n\nDefine the *sum* of a subinterval $[l_i, r_i]$ to be $sum(l_i, r_i) = A_{l_i} + A_{l_i + 1} + \\dots + A_{r_i}$.\nGiven a partition of $[L, R]$ into subintervals, define its *goodness* to be the number of subintervals in the partition with non-negative sum.\nFind and print the maximum goodness over all partitions satisfying the given conditions.","inputFormat":"- The first line contains an integer $T$, denoting the number of test cases. The $T$ test cases then follow:\n- The first line of each test case contains two space-separated integers $N, Q$.\n- The second line contains $N$ space-separated integers $A_1, A_2,\\dots, A_N$.\n- The third line contains $N$ space-separated integers $B_1, B_2,\\dots, B_N$.\n- $Q$ lines follow, each containing two space-separated integers $L, R$.","inputFormatState":true,"outputFormat":"For each query, output in a single line the maximum goodness of a partition of $[L, R]$. If there is no possible partition, print $0$. ","outputFormatState":true,"sampleTestCases":[{"id":"1","input":"1\n5 1\n1 1 1 1 2\n1 1 0 1 1\n2 5","output":"3","explanation":"**Test Case $1$:** We can divide the subarray $[2, 5]$ into $[2,3], [4,4] ,[5,5]$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"tle_99","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>tle_99<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"19-10-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/binary-lifting'>binary-lifting<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/binary-search'>binary-search<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime101'>ltime101<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tle_99'>tle_99<\/a>","problem_difficulty_level":"Unavailable","user_zen_mode":false,"best_tag":"Binary Search","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MAXSEG","time":{"view_start_date":1635354000,"submit_start_date":1635354000,"visible_start_date":1635354000,"end_date":1735669800,"current":1643797957},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=MAXSEG","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}