{"category_name":"medium","status":"success","problem_code":"TREEP","problem_name":"Period on tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV15\/mandarin\/TREEP.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV15\/russian\/TREEP.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV15\/vietnamese\/TREEP.pdf\">Vietnamese<\/a> as well.<\/h3>\n<p>\nYou are given an undirected tree of <b>N<\/b> vertices, each of which edges is marked with some lowercase Latin letter between <b>a<\/b> and <b>z<\/b>.<\/p>\n<p>\nIt's easy to notice that, if you select some distinct vertices <b>u<\/b> and <b>v<\/b> and write down a sequence of characters on the shortest path from <b>u<\/b> to <b>v<\/b>, you will get a lowercase string corresponding to this path.<\/p>\n<p>\nLet's call any string <b>t<\/b> a period of some string <b>s<\/b> if <b>s<\/b> can be obtained by concatenating the string <b>t<\/b> to itself one or more times.<\/p>\n<p>\nYour task is to process, on a given tree, the following two types of queries: <\/p>\n<ul>\n<li> <b>1 u v<\/b> - output the length of the <b>shortest<\/b> period of the string corresponding to the path from <b>u<\/b> to <b>v<\/b>.<\/li>\n<li> <b>2 u v c<\/b> - replace the character marked on the edge between <b>u<\/b> and <b>v<\/b> with the character <b>c<\/b>.<\/li>\n<\/ul>\n\n<h3>Input<\/h3>\n<p>\nThe first line of each test case contains a single integer <b>T<\/b> denoting the number of tests in input. The description of <b>T<\/b> test cases follows.<br \/>\nThe first line of a test case contains an integer <b>N<\/b> \u2014 the number of vertices in the tree.<br \/>\nThe next <b>N - 1<\/b> lines contains 2 space-separated entities: integer <b>u<sub>i<\/sub>, integer v<sub>i<\/sub><\/b> and a character c<sub>i<\/sub> denoting the edge between <b>u<sub>i<\/sub><\/b> and <b>v<sub>i<\/sub><\/b> marked with character <b>c<sub>i<\/sub><\/b> on it.<br \/>\nThe next line contains one integer <b>M<\/b> denoting the number of queries.<br \/>\nEach of the next <b>M<\/b> lines contains three space-separated integers <b>type<sub>i<\/sub>, v<sub>i<\/sub>, u<sub>i<\/sub><\/b>.<br \/>\nIf <b>type<sub>i<\/sub>=2<\/b>, then character <b>c<sub>i<\/sub><\/b> follows these integers.\n<\/p>\n<h3>Output<\/h3>\n<p>For each query of type 1 you should output minimal period of string corresponding to this query.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>10<\/b><\/li>\n<li><b>2<\/b> \u2264 <b>N, M<\/b> \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>u<sub>i<\/sub> \u2260 v<sub>i<\/sub><\/b>, 1 \u2264 v<sub>i<\/sub>, u<sub>i<\/sub>,\u2264 <b>N<\/b><\/li>\n<li>For each query of second type, it is guaranteed that <b>u<sub>i<\/sub><\/b> is adjacent to <b>v<sub>i<\/sub><\/b><\/li>\n<li>Sum of N over all test cases in a single file will not be greater then <b>5*10<sup>5<\/sup><\/b><\/li>\n<li>Sum of M over all test cases in a single file will not be greater then <b>5*10<sup>5<\/sup><\/b><\/li>\n<\/ul>\n<h3>Subtasks<\/h3>\n<p><i>Subtask 1 (15 points):<\/i> <b>N, M<\/b> \u2264 <b>1*10<sup>4<\/sup><\/b>, sum of <b>N \u2264 5*10<sup>4<\/sup><\/b>, sum of <b>M \u2264 5*10<sup>4<\/sup><\/b> in a single file.<br \/>\n<i>Subtask 2 (25 points):<\/i> <b>N, M<\/b> \u2264 <b>5*10<sup>4<\/sup><\/b>, sum of <b>N \u2264 10<sup>5<\/sup><\/b>, sum of <b>M \u2264 10<sup>5<\/sup><\/b> in a single file.<br \/>\nAll the queries in this subtask have the first type<br \/>\n<i>Subtask 3 (60 points):<\/i> Original constraints<\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\n3\n1 2 a\n1 3 b\n4\n1 1 2\n1 2 3\n2 1 3 a\n1 2 3\n4\n1 2 a\n2 3 b\n3 4 a\n3\n1 1 4\n2 2 3 a\n1 1 4\n<b>Output:<\/b>\n1\n2\n1\n3\n1\n<\/pre><h3>Explanation<\/h3>\n<p>\nIn first test case, period of strings \"a\", \"aa\" is \"a\", and period of \"ab\" is \"ab\". <br \/>\nIn second test case, the only period of string \"aba\" is \"aba\" itself. Note that not \"ab\" is not a period, as \"aba\" is a prefix of \"abab\", but is not the same.\n<\/p>\n<p><b>Since input file can be fairly large (about 15 MB), it's recommended to use fast I\/O (for example, in C++, use scanf\/printf instead of cin\/cout).<\/b><\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1 - 4","source_sizelimit":"50000","problem_author":"tehnar","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>tehnar<\/span>","problem_tester":"iscsi","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>iscsi<\/span>","date_added":"22-09-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/bit'>\n                    bit\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/decomposition'>\n                    decomposition\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/fenwick'>\n                    fenwick\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hashing'>\n                    hashing\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/lca'>\n                    lca\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/nov15'>\n                    nov15\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/tehnar'>\n                    tehnar\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/TREEP","user":{"username":null},"time":{"view_start_date":1447666200,"submit_start_date":1447666200,"visible_start_date":1447666200,"end_date":1735669800,"current":1493557949},"todo":false,"problem_status":"unattempted"}