{"category_name":"medium","status":"success","problem_code":"MMNN01","problem_name":"Expected Number of Customers ","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK112\/hindi\/MMNN01.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK112\/mandarin\/MMNN01.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK112\/russian\/MMNN01.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK112\/vietnamese\/MMNN01.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK112\/bengali\/MMNN01.pdf) as well.\r\n\r\nA cake consists of $N$ pieces arranged in a row. Each piece has one of $M$ distinct flavours (numbered $1$ through $M$) which are available in Chef's kitchen. For each valid $i$, the cost of the $i$-th flavour is $i$ rupees.\r\n\r\nWhen Chef bakes a cake, he chooses the flavour of each piece independently and uniformly randomly from these $M$ flavours. After baking the cake, he splits it into several contiguous segments (each piece must belong to exactly one segment) and sells each segment to a different customer.\r\n\r\nThe price of a segment is the sum of costs of all distinct flavours of the pieces in that segment. For example, the cost of a segment with flavours $(1, 2, 1, 5)$ is $1+2+5=8$. Chef's profit is the sum of prices of all segments. Chef is very greedy, so he wants to maximise his profit, but he is also a perfectionist, so he wants to split the cake into the minimum number of segments such that his profit is still the largest possible.\r\n\r\nChef is wondering about the number of customers he would be able to serve. Help him find the expected value of the number of segments he would split a cake into.\r\n\r\nIt can be proved that this expected value can be expressed as a fraction $p\/q$, where $p$ and $q$ are positive integers and $q$ is coprime to $10^9+7$. You should find $p \\cdot q^{-1}$ modulo $10^9+7$, where $q^{-1}$ denotes the multiplicative inverse of $q$ modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains two space-separated integers $N$ and $M$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $p \\cdot q^{-1}$ modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 2 \\cdot 10^5$\r\n- $1 \\le N \\le 2 \\cdot 10^5$\r\n- $1 \\le M \\le 10^9$\r\n- the sum of $N$ over all test cases does not exceed $2 \\cdot 10^5$\r\n\r\n### Example Input\r\n```\r\n2\r\n4 2\r\n5 6\r\n```\r\n\r\n### Example Output\r\n```\r\n875000009\r\n948302478\r\n```\r\n\r\n### Explanation\r\n**Example case 1:**\r\nFor the following sequences of flavours, the cake can be divided into:\r\n- 2 segments: $(1,2,1,2),(1,2,2,1),(2,1,1,2),(2,1,2,1)$\r\n- 3 segments: $(1,1,1,2),(1,1,2,1),(1,1,2,2),(1,2,1,1),(1,2,2,2),(2,1,1,1),(2,1,2,2),(2,2,1,1),(2,2,1,2),(2,2,2,1)$\r\n- 4 segments: $(1,1,1,1),(2,2,2,2)$\r\n\r\nThe expected value of the number of segments is $(2 \\cdot 4 + 3 \\cdot 10 + 4 \\cdot 2) \/ 16 = 23\/8$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK112\/hindi\/MMNN01.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK112\/mandarin\/MMNN01.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK112\/russian\/MMNN01.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK112\/vietnamese\/MMNN01.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK112\/bengali\/MMNN01.pdf) as well.\r\n\r\nA cake consists of $N$ pieces arranged in a row. Each piece has one of $M$ distinct flavours (numbered $1$ through $M$) which are available in Chef's kitchen. For each valid $i$, the cost of the $i$-th flavour is $i$ rupees.\r\n\r\nWhen Chef bakes a cake, he chooses the flavour of each piece independently and uniformly randomly from these $M$ flavours. After baking the cake, he splits it into several contiguous segments (each piece must belong to exactly one segment) and sells each segment to a different customer.\r\n\r\nThe price of a segment is the sum of costs of all distinct flavours of the pieces in that segment. For example, the cost of a segment with flavours $(1, 2, 1, 5)$ is $1+2+5=8$. Chef's profit is the sum of prices of all segments. Chef is very greedy, so he wants to maximise his profit, but he is also a perfectionist, so he wants to split the cake into the minimum number of segments such that his profit is still the largest possible.\r\n\r\nChef is wondering about the number of customers he would be able to serve. Help him find the expected value of the number of segments he would split a cake into.\r\n\r\nIt can be proved that this expected value can be expressed as a fraction $p\/q$, where $p$ and $q$ are positive integers and $q$ is coprime to $10^9+7$. You should find $p \\cdot q^{-1}$ modulo $10^9+7$, where $q^{-1}$ denotes the multiplicative inverse of $q$ modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains two space-separated integers $N$ and $M$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $p \\cdot q^{-1}$ modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 2 \\cdot 10^5$\r\n- $1 \\le N \\le 2 \\cdot 10^5$\r\n- $1 \\le M \\le 10^9$\r\n- the sum of $N$ over all test cases does not exceed $2 \\cdot 10^5$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n4 2\r\n5 6","output":"875000009\r\n948302478","explanation":"**Example case 1:**\r\nFor the following sequences of flavours, the cake can be divided into:\r\n- 2 segments: $(1,2,1,2),(1,2,2,1),(2,1,1,2),(2,1,2,1)$\r\n- 3 segments: $(1,1,1,2),(1,1,2,1),(1,1,2,2),(1,2,1,1),(1,2,2,2),(2,1,1,1),(2,1,2,2),(2,2,1,1),(2,2,1,2),(2,2,2,1)$\r\n- 4 segments: $(1,1,1,1),(2,2,2,2)$\r\n\r\nThe expected value of the number of segments is $(2 \\cdot 4 + 3 \\cdot 10 + 4 \\cdot 2) \/ 16 = 23\/8$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"2.5","source_sizelimit":"50000","problem_author":"mamnoonsiam","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span class='m-username--link'>mamnoonsiam<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"16-10-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook112'>cook112<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fast-fourier-transform'>fast-fourier-transform<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/generating-functions'>generating-functions<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/mamnoonsiam'>mamnoonsiam<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Generating Functions","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MMNN01","time":{"view_start_date":1574015400,"submit_start_date":1574015400,"visible_start_date":1574015400,"end_date":1735669800,"current":1643797961},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=MMNN01","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}