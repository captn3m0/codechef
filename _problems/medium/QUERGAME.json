{"category_name":"medium","status":"success","problem_code":"QUERGAME","problem_name":"Query Game","body":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/bengali\/QUERGAME.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/mandarin\/QUERGAME.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/russian\/QUERGAME.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/vietnamese\/QUERGAME.pdf) as well.\r\n\r\nYou are given a sequence of positive integers $A_1, A_2, \\ldots, A_N$ and a fraction $p = x\/y$. Chef and Chefina play a game on this sequence. They alternate turns; Chef plays first.\r\n\r\nIn each turn, the current player must choose either the first element (with probability $p$) or the last element (with probability $1-p$) of the current sequence and delete that element. The game continues for $K$ turns (e.g. if $K = N$, it continues until the sequence becomes empty).\r\n\r\nChef wants to know the expected value of the sum of integers he deletes and the expected value of the sum of integers Chefina deletes. It can be proved that each expected sum can be represented as a fraction $\\frac{P}{Q}$, where $P$ and $Q$ are non-negative integers and $Q$ is coprime with $998,244,353$. You need to compute $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ denotes the multiplicative inverse of $Q^{-1}$ modulo $998,244,353$.\r\n\r\nYou need to answer $Q$ queries. In each query, you are given a different value of $K$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains two space-separated integers $x$ and $y$.\r\n- $Q$ lines follow. Each of these lines contains a single integer $K$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing two space-separated integers \u2015 the values of $P \\cdot Q^{-1}$ modulo $998,244,353$ for the expected sums of numbers deleted by Chef and Chefina respectively.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 1,000$\r\n- $1 \\leq N, Q \\leq 5 \\cdot 10^5$\r\n- $1 \\leq A_i \\lt 998,244,353$ for each valid $i$\r\n- $0 \\leq x \\leq y \\lt 998,244,353$\r\n- $y \\gt 0$\r\n- $1 \\leq K \\leq N$\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n- the sum of $Q$ over all test cases does not exceed $5 \\cdot 10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (2 points):** $N, Q \\leq 15$\r\n\r\n**Subtask #2 (3 points):** $N, Q \\leq 100$\r\n\r\n**Subtask #3 (5 points):** $N, Q \\leq 1,000$\r\n\r\n**Subtask #4 (20 points):** $N, Q \\leq 10^5$\r\n\r\n**Subtask #5 (70 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n2\r\n3 2\r\n3 2 1\r\n1 2\r\n1\r\n2\r\n1 1\r\n4\r\n1 5\r\n1\r\n```\r\n\r\n### Example Output\r\n```\r\n2 0\r\n2 2\r\n4 0\r\n```\r\n\t\r\n### Explanation\r\n**Example case 1:** In the first turn, the sequence is $A = [3, 2, 1]$ and Chef can delete the first or last element with equal probability $\\frac{1}{2}$. Therefore, Chef's expected sum for $K = 1$ is $\\frac{1}{2} \\cdot 3 + \\frac{1}{2} \\cdot 1 = 2$. Also, since Chefina has not done anything yet, her expected sum is $0$.\r\n\r\nIn the next turn, Chefina has to choose an element. Since Chef could have chosen $3$ or $1$ in the first turn, we have $2$ possible sequences for Chefina now: $[2, 1]$ or $[3, 2]$, each with the same probability $\\frac{1}{2}$. Chefina's expected sums after this turn individually for these two sequences are $\\frac{3}{2}$ and $\\frac{5}{2}$ respectively. Therefore, the expected sum of elements deleted by Chefina for $K = 2$ is $\\frac{1}{2} \\cdot (\\frac{3}{2} + \\frac{5}{2}) = 2$. Also, Chef's expected sum for $K = 2$ is the same as for $K = 1$.\r\n\r\n**Example case 2:** We have only $1$ element, so Chef deletes it in the first turn. The expected sum is $4$ for Chef and $0$ for Chefina.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/bengali\/QUERGAME.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/mandarin\/QUERGAME.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/russian\/QUERGAME.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/vietnamese\/QUERGAME.pdf) as well.\r\n\r\nYou are given a sequence of positive integers $A_1, A_2, \\ldots, A_N$ and a fraction $p = x\/y$. Chef and Chefina play a game on this sequence. They alternate turns; Chef plays first.\r\n\r\nIn each turn, the current player must choose either the first element (with probability $p$) or the last element (with probability $1-p$) of the current sequence and delete that element. The game continues for $K$ turns (e.g. if $K = N$, it continues until the sequence becomes empty).\r\n\r\nChef wants to know the expected value of the sum of integers he deletes and the expected value of the sum of integers Chefina deletes. It can be proved that each expected sum can be represented as a fraction $\\frac{P}{Q}$, where $P$ and $Q$ are non-negative integers and $Q$ is coprime with $998,244,353$. You need to compute $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ denotes the multiplicative inverse of $Q^{-1}$ modulo $998,244,353$.\r\n\r\nYou need to answer $Q$ queries. In each query, you are given a different value of $K$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains two space-separated integers $x$ and $y$.\r\n- $Q$ lines follow. Each of these lines contains a single integer $K$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing two space-separated integers \u2015 the values of $P \\cdot Q^{-1}$ modulo $998,244,353$ for the expected sums of numbers deleted by Chef and Chefina respectively.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 1,000$\r\n- $1 \\leq N, Q \\leq 5 \\cdot 10^5$\r\n- $1 \\leq A_i \\lt 998,244,353$ for each valid $i$\r\n- $0 \\leq x \\leq y \\lt 998,244,353$\r\n- $y \\gt 0$\r\n- $1 \\leq K \\leq N$\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n- the sum of $Q$ over all test cases does not exceed $5 \\cdot 10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (2 points):** $N, Q \\leq 15$\r\n\r\n**Subtask #2 (3 points):** $N, Q \\leq 100$\r\n\r\n**Subtask #3 (5 points):** $N, Q \\leq 1,000$\r\n\r\n**Subtask #4 (20 points):** $N, Q \\leq 10^5$\r\n\r\n**Subtask #5 (70 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n3 2\r\n3 2 1\r\n1 2\r\n1\r\n2\r\n1 1\r\n4\r\n1 5\r\n1","output":"2 0\r\n2 2\r\n4 0","explanation":"**Example case 1:** In the first turn, the sequence is $A = [3, 2, 1]$ and Chef can delete the first or last element with equal probability $\\frac{1}{2}$. Therefore, Chef's expected sum for $K = 1$ is $\\frac{1}{2} \\cdot 3 + \\frac{1}{2} \\cdot 1 = 2$. Also, since Chefina has not done anything yet, her expected sum is $0$.\r\n\r\nIn the next turn, Chefina has to choose an element. Since Chef could have chosen $3$ or $1$ in the first turn, we have $2$ possible sequences for Chefina now: $[2, 1]$ or $[3, 2]$, each with the same probability $\\frac{1}{2}$. Chefina's expected sums after this turn individually for these two sequences are $\\frac{3}{2}$ and $\\frac{5}{2}$ respectively. Therefore, the expected sum of elements deleted by Chefina for $K = 2$ is $\\frac{1}{2} \\cdot (\\frac{3}{2} + \\frac{5}{2}) = 2$. Also, Chef's expected sum for $K = 2$ is the same as for $K = 1$.\r\n\r\n**Example case 2:** We have only $1$ element, so Chef deletes it in the first turn. The expected sum is $4$ for Chef and $0$ for Chefina.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"samarth2017","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>samarth2017<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"27-02-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/march21'>march21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/number-theoretic-transfmtn'>number-theoretic-transfmtn<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/samarth2017'>samarth2017<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/QUERGAME","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797971},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=QUERGAME","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}