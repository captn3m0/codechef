{"category_name":"medium","status":"success","problem_code":"COOLSBST","problem_name":"Cool Subsets","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN21\/hindi\/COOLSBST.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN21\/bengali\/COOLSBST.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/mandarin\/COOLSBST.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN21\/russian\/COOLSBST.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/vietnamese\/COOLSBST.pdf) as well.\r\n\r\nAn integer $X$ is *cool* if it has a <a href=\"https:\/\/en.wikipedia.org\/wiki\/Primitive_root_modulo_n\">primitive root<\/a> modulo $X$.\r\n\r\nThe *coolness* of a non-empty set of $N$ distinct integers $S = \\{x_1, x_2, \\ldots, x_N\\}$ is the number of cool divisors of $\\prod_{i=1}^N x_i$.\r\n\r\nYou are given four integers $L$, $R$, $A$ and $B$. Let $S$ be the set containing all integers between $L$ and $R$ (inclusive). Consider all non-empty subsets of $S$ with size between $A$ and $B$ (inclusive). Find the sum of values of coolness of all these subsets. Since this sum can be huge, compute it modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains four space-separated integers $L$, $R$, $A$ and $B$. \r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the total coolness modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 100,000$\r\n- $1 \\leq L \\leq R \\leq 100,000$\r\n- $1 \\leq A \\leq B \\leq 100,000$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $R \\leq 16$\r\n- $B \\leq 16$ \r\n\r\n**Subtask #2 (35 points):** $A = B$\r\n\r\n**Subtask #3 (55 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n3\r\n3 4 1 2\r\n1 10 15 20\r\n1 8 1 8\r\n```\r\n\r\n### Example Output\r\n```\r\n10\r\n0\r\n1703\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** We have S = $\\{3,4\\}$, which has the following $3$ non-empty subsets with sizes in the range $[1,2]$:\r\n- $\\{3\\}$: coolness $2$, the cool divisors are $\\{1,3\\}$\r\n- $\\{4\\}$: coolness $3$, the cool divisors are $\\{1,2,4\\}$\r\n- $\\{3,4\\}$: coolness $5$, the cool divisors are $\\{1,2,3,4,6\\}$\r\n\r\n**Example case 2:** There are no subsets with size in the range $[15,20]$, so the sum is $0$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN21\/hindi\/COOLSBST.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN21\/bengali\/COOLSBST.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/mandarin\/COOLSBST.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN21\/russian\/COOLSBST.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/vietnamese\/COOLSBST.pdf) as well.\r\n\r\nAn integer $X$ is *cool* if it has a <a href=\"https:\/\/en.wikipedia.org\/wiki\/Primitive_root_modulo_n\">primitive root<\/a> modulo $X$.\r\n\r\nThe *coolness* of a non-empty set of $N$ distinct integers $S = \\{x_1, x_2, \\ldots, x_N\\}$ is the number of cool divisors of $\\prod_{i=1}^N x_i$.\r\n\r\nYou are given four integers $L$, $R$, $A$ and $B$. Let $S$ be the set containing all integers between $L$ and $R$ (inclusive). Consider all non-empty subsets of $S$ with size between $A$ and $B$ (inclusive). Find the sum of values of coolness of all these subsets. Since this sum can be huge, compute it modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains four space-separated integers $L$, $R$, $A$ and $B$. \r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the total coolness modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 100,000$\r\n- $1 \\leq L \\leq R \\leq 100,000$\r\n- $1 \\leq A \\leq B \\leq 100,000$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $R \\leq 16$\r\n- $B \\leq 16$ \r\n\r\n**Subtask #2 (35 points):** $A = B$\r\n\r\n**Subtask #3 (55 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3\r\n3 4 1 2\r\n1 10 15 20\r\n1 8 1 8","output":"10\r\n0\r\n1703","explanation":"**Example case 1:** We have S = $\\{3,4\\}$, which has the following $3$ non-empty subsets with sizes in the range $[1,2]$:\r\n- $\\{3\\}$: coolness $2$, the cool divisors are $\\{1,3\\}$\r\n- $\\{4\\}$: coolness $3$, the cool divisors are $\\{1,2,4\\}$\r\n- $\\{3,4\\}$: coolness $5$, the cool divisors are $\\{1,2,3,4,6\\}$\r\n\r\n**Example case 2:** There are no subsets with size in the range $[15,20]$, so the sum is $0$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/l2U13VciTPQ","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"nishant403","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>nishant403<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"24-03-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jan21'>jan21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nishant403'>nishant403<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/number-theory'>number-theory<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/square-root-decomposition'>square-root-decomposition<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Number Theory","editorial_url":"https:\/\/discuss.codechef.com\/problems\/COOLSBST","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797934},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=COOLSBST","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}