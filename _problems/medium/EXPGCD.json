{"category_name":"medium","status":"success","problem_code":"EXPGCD","problem_name":"Expected GCD","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/SEPT19\/hindi\/EXPGCD.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/SEPT19\/bengali\/EXPGCD.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/SEPT19\/mandarin\/EXPGCD.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/SEPT19\/russian\/EXPGCD.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/SEPT19\/vietnamese\/EXPGCD.pdf) as well.\n\nChef loves to make dishes. Currently, he has $N$ ingredients (numbered $1$ through $N$) which he can use to cook various dishes.\n\nTo make a dish, Chef must use exactly $K$ ingredients in a correct order. Therefore, a dish is a sequence of $K$ distinct integers between $1$ and $N$. The tastiness of that dish is defined as the GCD of these integers (all the ingredients in that dish). Chef wants to choose a dish uniformly randomly and cook it.\n\nYou should answer $Q$ queries. $K$ is the same for all queries. In each query, you are given $N$ and you should find the expected value of the tastiness of Chef's dish or determine that Chef cannot cook any dish.\n\nIf Chef can cook at least one dish, it can be proven that this expected value is a fraction in the form $P\/D$, where $P$ and $D$ are coprime positive integers and $D$ is coprime with $10^9+7$. You should compute $P \\cdot D^{-1}$ modulo $10^9+7$, where $D^{-1}$ denotes the multiplicative inverse of $D$ modulo $10^9+7$.\n\n### Input\n- The first line of the input contains two space-separated integers $Q$ and $K$.\n- Each of the next $Q$ lines contains a single integer $N$ describing a query.\n\n### Output\n- For each query, print a single line containing one integer \u2015 $P \\cdot D^{-1}$ modulo $10^9+7$, or $0$ if Chef cannot cook any dish.\n\n### Constraints\n- $1 \\le Q, N \\le 2 \\cdot 10^5$\n- $2 \\le K \\le 10^5$\n\n### Subtasks\n**Subtask #1 (10 points):**\n- $K = 2$ \n- $1 \\le N \\le 1,000$\n\n**Subtask #2 (15 points):** $K = 2$\n\n**Subtask #3 (75 points):** original constraints\n\n### Example Input\n```\n3 2\n1\n2\n4\n```\n\n### Example Output\n```\n0\n1\n166666669\n```\n\n### Explanation\nIn the first query, it is impossible to cook a dish with two ingredients if $N = 1$.\n\nIn the second query, Chef can cook two dishes: $(1, 2)$ and $(2, 1)$. The tastiness of each of these dishes is $1$, so the expected value of tastiness is $1$.\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/SEPT19\/hindi\/EXPGCD.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/SEPT19\/bengali\/EXPGCD.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/SEPT19\/mandarin\/EXPGCD.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/SEPT19\/russian\/EXPGCD.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/SEPT19\/vietnamese\/EXPGCD.pdf) as well.\n\nChef loves to make dishes. Currently, he has $N$ ingredients (numbered $1$ through $N$) which he can use to cook various dishes.\n\nTo make a dish, Chef must use exactly $K$ ingredients in a correct order. Therefore, a dish is a sequence of $K$ distinct integers between $1$ and $N$. The tastiness of that dish is defined as the GCD of these integers (all the ingredients in that dish). Chef wants to choose a dish uniformly randomly and cook it.\n\nYou should answer $Q$ queries. $K$ is the same for all queries. In each query, you are given $N$ and you should find the expected value of the tastiness of Chef's dish or determine that Chef cannot cook any dish.\n\nIf Chef can cook at least one dish, it can be proven that this expected value is a fraction in the form $P\/D$, where $P$ and $D$ are coprime positive integers and $D$ is coprime with $10^9+7$. You should compute $P \\cdot D^{-1}$ modulo $10^9+7$, where $D^{-1}$ denotes the multiplicative inverse of $D$ modulo $10^9+7$.\n\n### Input\n- The first line of the input contains two space-separated integers $Q$ and $K$.\n- Each of the next $Q$ lines contains a single integer $N$ describing a query.\n\n### Output\n- For each query, print a single line containing one integer \u2015 $P \\cdot D^{-1}$ modulo $10^9+7$, or $0$ if Chef cannot cook any dish.\n\n### Constraints\n- $1 \\le Q, N \\le 2 \\cdot 10^5$\n- $2 \\le K \\le 10^5$\n\n### Subtasks\n**Subtask #1 (10 points):**\n- $K = 2$ \n- $1 \\le N \\le 1,000$\n\n**Subtask #2 (15 points):** $K = 2$\n\n**Subtask #3 (75 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3 2\n1\n2\n4","output":"0\n1\n166666669","explanation":"In the first query, it is impossible to cook a dish with two ingredients if $N = 1$.\n\nIn the second query, Chef can cook two dishes: $(1, 2)$ and $(2, 1)$. The tastiness of each of these dishes is $1$, so the expected value of tastiness is $1$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"kharyusuf","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>kharyusuf<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"31-07-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/anand20'>anand20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/inclusion-exclusion'>inclusion-exclusion<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kharyusuf'>kharyusuf<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/mobius-function'>mobius-function<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/number-theory'>number-theory<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sept19'>sept19<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/EXPGCD","time":{"view_start_date":1568626202,"submit_start_date":1568626202,"visible_start_date":1568626202,"end_date":1735669800,"current":1643797940},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=EXPGCD","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}