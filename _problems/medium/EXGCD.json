{"category_name":"medium","status":"success","problem_code":"EXGCD","problem_name":"Expected Greatest Common Divisor","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>Several integers <b>X<sub>0<\/sub><\/b>, <b>X<sub>1<\/sub><\/b>, ..., <b>X<sub>K-1<\/sub><\/b> are randomly chosen from some intervals.  Namely, <b>X<sub>0<\/sub><\/b> is randomly chosen between <b>A<sub>0<\/sub><\/b> and <b>B<sub>0<\/sub><\/b>, inclusive, <b>X<sub>1<\/sub><\/b> is randomly chosen between <b>A<sub>1<\/sub><\/b> and <b>B<sub>1<\/sub><\/b>, inclusive, and so on.  We are interested in the expected value of the greatest common divisor of the <b>X<sub>i<\/sub><\/b> which is the average of <b>GCD(X<sub>0<\/sub>, X<sub>1<\/sub>, ..., X<sub>K-1<\/sub>)<\/b> over all possible choices of <b>X<sub>0<\/sub><\/b>, <b>X<sub>1<\/sub><\/b>, ..., <b>X<sub>K-1<\/sub><\/b>. In order to avoid floating-point precision issues, we instead use the following output method. Suppose the expected value of the greatest common divisor of all the <b>X<sub>i<\/sub><\/b> is <b>P<\/b>\/<b>Q<\/b>, where <b>P<\/b> and <b>Q<\/b> are relatively prime positive integers.  Find an integer <b>N<\/b> between 0 and 1000000006, inclusive, for which (<b>P<\/b> + <b>Q<\/b> * <b>N<\/b>) is divisible by 1000000007 = 10<sup>9<\/sup> + 7.<\/p>\n<h3>Input<\/h3>\n<p>Input will begin with an integer <b>T<\/b>, the number of test cases. Each test case begins with an integer <b>K<\/b>, the number of integers to be chosen.  <b>K<\/b> pairs of integers <b>A<sub>i<\/sub><\/b> <b>B<sub>i<\/sub><\/b> follow.<\/p>\n<h3>Output<\/h3>\n<p>For each test case, output the value <b>N<\/b> according to the problem statement.  If multiple such values exist, print any one of them.  If no such value exists, print -1.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>T<\/b> \u2264 50<\/li>\n<li>2 \u2264 <b>K<\/b> \u2264 5<\/li>\n<li>1 \u2264 <b>A<sub>i<\/sub><\/b> \u2264 <b>B<sub>i<\/sub><\/b> \u2264 200000 (2 * 10<sup>5<\/sup>)<\/li>\n<\/ul>\n<h3>Sample Input<\/h3>\n<pre>4\n2\n2 4\n3 5\n3\n1 2\n1 2\n1 2\n3\n1 12\n1 12\n1 12\n2\n2700 2701\n2612 2724\n<\/pre><h3>Sample Output<\/h3>\n<pre>333333334\n875000005\n722222226\n314159265\n<\/pre><h3>Explanation<\/h3>\n<p><b>Sample test 1.<\/b> Here <b>X<sub>0<\/sub><\/b> is randomly chosen between 2 and 4, inclusive, and <b>X<sub>1<\/sub><\/b> is randomly chosen between 3 and 5, inclusive. The distribution of the greatest common divisor of <b>X<sub>0<\/sub><\/b> and <b>X<sub>1<\/sub><\/b> can be seen from the following table:<\/p>\n<p>\n<table>\n<tbody>\n<tr>\n<td><\/td>\n<td>2<\/td>\n<td>3<\/td>\n<td>4<\/td>\n<\/tr>\n<tr>\n<td>3<\/td>\n<td>1<\/td>\n<td>3<\/td>\n<td>1<\/td>\n<\/tr>\n<tr>\n<td>4<\/td>\n<td>2<\/td>\n<td>1<\/td>\n<td>4<\/td>\n<\/tr>\n<tr>\n<td>5<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<\/p>\n<p>The expected value is therefore (1 + 3 + 1 + 2 + 1 + 4 + 1 + 1 + 1) \/ 9 = 15 \/ 9 = 5 \/ 3.<br \/>\nSince 5 + 3 * 333333334 = 1000000007, the answer is 333333334.<\/p>\n<p><b>Sample test 2.<\/b> Here each of <b>X<sub>0<\/sub><\/b>, <b>X<sub>1<\/sub><\/b>, <b>X<sub>2<\/sub><\/b> is randomly chosen between 1 and 2, inclusive. So we have 8 possibilities in all.  The greatest common divisor is 2 when <b>X<sub>0<\/sub><\/b> = <b>X<sub>1<\/sub><\/b> = <b>X<sub>2<\/sub><\/b> = 2 and it is 1 in the 7 remaining cases. The expected value is therefore (1 * 7 + 2 * 1) \/ 8 = 9 \/ 8.  Since 9 + 8 * 875000005 = 7000000049 = 7 * 1000000007, the answer is 875000005.<\/p>\n<p><b>Sample test 3.<\/b> Here <b>P<\/b> is 23 and <b>Q<\/b> is 18.<\/p>\n<p><b>Sample test 4.<\/b> Just enjoy the answer :)<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"3","source_sizelimit":"50000","problem_author":"pieguy","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>pieguy<\/span>","problem_tester":"anton_lunyov","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>anton_lunyov<\/span>","date_added":"26-11-2012","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook29'>\n                    cook29\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>\n                    easy-medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/number-theory'>\n                    number-theory\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/pieguy'>\n                    pieguy\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/EXGCD","user":{"username":null},"time":{"view_start_date":1356288289,"submit_start_date":1356288289,"visible_start_date":1356288262,"end_date":1735669800,"current":1493557641},"todo":false,"problem_status":"unattempted"}