{"category_name":"medium","status":"success","problem_code":"MOBCNT","problem_name":"Counting Mobiles","body":"A **mobile** is a rooted tree with weighted leaves that satisfies the following property: each non-leaf vertex $v$ has exactly two children $L(v)$ and $R(v)$, and the total weight of leaves in the subtree of $L(v)$ is equal to the total weight of leaves in the subtree of $R(v)$.\r\n\r\nWe have $n$ positive integer weights $a_1, \\ldots, a_n$. You have to count the number of **suitable** mobiles. A mobile is **suitable** if the multiset of weights in its leaves is equal to the multiset $\\{a_1, \\ldots, a_n\\}$. Two mobiles are considered different if they are not **equal**. Two mobiles $T_1$ and $T_2$ are **equal** in one of two cases:\r\n\r\n- $T_1$ and $T_2$ each consist of a single leaf vertex, and the leaves' weights are equal;\r\n- Respective roots $r_1$ and $r_2$ of $T_1$ and $T_2$ are both not leaves, and subtrees of $L(r_1)$ and $L(r_2)$ are equal mobiles, as well as subtrees of $R(r_1)$ and $R(r_2)$.\r\nSince the answer can be large, print it modulo $10^9 + 7$.\r\n\r\n###Input:\r\n- The first line contains a single integer $T$, the number of test cases. $T$ test case descriptions follow.\r\n- Each test case description starts with a line containing a single integer $n$, the number of weights. The next line contains $n$ integers $a_1, \\ldots, a_n$ .\r\n\r\n###Output:\r\nPrint answers for each test case in a new line, in the order of appearance in the input. For each test case print a single integer, the number of different suitable mobiles modulo $10^9 + 7$.\r\n\r\n###Constraints:\r\n- $1 \\leq T \\leq 10^5$\r\n- $1 \\leq n \\leq 10^5$\r\n- $1 \\leq a_i \\leq 10^9$\r\n- The sum of all $n$ does not exceed $5 \\cdot 10^5$.\r\n\r\n###Sample Input:\r\n    5\r\n    1\r\n    7\r\n    3\r\n    1 1 2\r\n    4\r\n    3 3 3 3\r\n    4\r\n    5 5 10 20\r\n    3\r\n    1 2 3\r\n\r\n###Sample Output:\r\n    1\r\n    2\r\n    1\r\n    4\r\n    0\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"A **mobile** is a rooted tree with weighted leaves that satisfies the following property: each non-leaf vertex $v$ has exactly two children $L(v)$ and $R(v)$, and the total weight of leaves in the subtree of $L(v)$ is equal to the total weight of leaves in the subtree of $R(v)$.\r\n\r\nWe have $n$ positive integer weights $a_1, \\ldots, a_n$. You have to count the number of **suitable** mobiles. A mobile is **suitable** if the multiset of weights in its leaves is equal to the multiset $\\{a_1, \\ldots, a_n\\}$. Two mobiles are considered different if they are not **equal**. Two mobiles $T_1$ and $T_2$ are **equal** in one of two cases:\r\n\r\n- $T_1$ and $T_2$ each consist of a single leaf vertex, and the leaves' weights are equal;\r\n- Respective roots $r_1$ and $r_2$ of $T_1$ and $T_2$ are both not leaves, and subtrees of $L(r_1)$ and $L(r_2)$ are equal mobiles, as well as subtrees of $R(r_1)$ and $R(r_2)$.\r\nSince the answer can be large, print it modulo $10^9 + 7$.\r\n\r\n###Input:\r\n- The first line contains a single integer $T$, the number of test cases. $T$ test case descriptions follow.\r\n- Each test case description starts with a line containing a single integer $n$, the number of weights. The next line contains $n$ integers $a_1, \\ldots, a_n$ .\r\n\r\n###Output:\r\nPrint answers for each test case in a new line, in the order of appearance in the input. For each test case print a single integer, the number of different suitable mobiles modulo $10^9 + 7$.\r\n\r\n###Constraints:\r\n- $1 \\leq T \\leq 10^5$\r\n- $1 \\leq n \\leq 10^5$\r\n- $1 \\leq a_i \\leq 10^9$\r\n- The sum of all $n$ does not exceed $5 \\cdot 10^5$.\r\n\r\n###Sample Input:\r\n    5\r\n    1\r\n    7\r\n    3\r\n    1 1 2\r\n    4\r\n    3 3 3 3\r\n    4\r\n    5 5 10 20\r\n    3\r\n    1 2 3\r\n\r\n###Sample Output:\r\n    1\r\n    2\r\n    1\r\n    4\r\n    0","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"jtnydv25","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>jtnydv25<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"24-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/jtnydv25'>jtnydv25<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"","time":{"view_start_date":1577730600,"submit_start_date":1577730600,"visible_start_date":1577730600,"end_date":1735669800,"current":1643797963},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=MOBCNT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}