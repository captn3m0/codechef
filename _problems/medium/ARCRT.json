{"category_name":"medium","status":"success","problem_code":"ARCRT","problem_name":"Sequence Creation","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN21\/hindi\/ARCRT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN21\/bengali\/ARCRT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/mandarin\/ARCRT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN21\/russian\/ARCRT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/vietnamese\/ARCRT.pdf) as well.\r\n\r\nChef has two sequences of integers $(A_1, A_2, \\ldots, A_N)$ and $(B_1, B_2, \\ldots, B_N)$.\r\n\r\nA sequence of integers is *beautiful* if it contains only distinct integers. For each valid $i$:\r\n- Chef wants to create a beautiful sequence $S_i$. Let's denote the length of this sequence by $L_i$ and the sequence by $S_{i,1}, S_{i,2}, \\ldots, S_{i,L_i}$.\r\n- The sequence $S_i$ is *good* if for each valid $j$, $S_{i,j}$ is either equal to $A_{i+j-1}$ or $B_{i+j-1}$. Note that this means $L_i$ must be at most $N-i+1$.\r\n- Let's denote the maximum possible value of $L_i$ (the maximum value such that some good sequence $S_i$ with this length exists) by $M_i$.\r\n- Help Chef find the number of good sequences $S_i$ that have the maximum possible length $M_i$. Since this number may be enormous, compute it modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains $N$ space-separated integers $B_1, B_2, \\ldots, B_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing $N$ space-separated integers. For each valid $i$, the $i$-th of these integers should be the number of possible sequences $S_i$ modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 1,000$\r\n- $1 \\leq N \\leq 10^5$\r\n- $|A_i|, |B_i| \\leq 10^9$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n \r\n### Subtasks\r\n**Subtask #1 (20 points):** \r\n- $N \\le 1,000$\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^3$\r\n\r\n**Subtask #2 (80 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n2\r\n4\r\n2 2 3 2\r\n2 3 4 4\r\n5\r\n1 2 2 3 3\r\n2 1 2 3 1\r\n```\r\n\r\n### Example Output\r\n```\r\n1 2 3 2\r\n2 1 1 1 2\r\n```\r\n\r\n### Explanation\r\n**Example case 1:**\r\n- $S_1$ can only be $(2, 3, 4)$.\r\n- $S_2$ can be $(2, 3, 4) $ or $(3, 4, 2)$.\r\n- $S_3$ can be $(3, 2)$, $(3, 4)$ or $(4, 2)$.\r\n- $S_4$ can be $(2)$ or $(4)$.\r\n\r\n**Example case 2:**\r\n- $S_1$ can be $(1, 2)$ or $(2, 1)$.\r\n- $S_2$ can only be $(1, 2, 3)$.\r\n- $S_3$ can only be $(2, 3, 1)$.\r\n- $S_4$ can only be $(3, 1)$.\r\n- $S_5$ can be $(3)$ or $(1)$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN21\/hindi\/ARCRT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN21\/bengali\/ARCRT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/mandarin\/ARCRT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN21\/russian\/ARCRT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/vietnamese\/ARCRT.pdf) as well.\r\n\r\nChef has two sequences of integers $(A_1, A_2, \\ldots, A_N)$ and $(B_1, B_2, \\ldots, B_N)$.\r\n\r\nA sequence of integers is *beautiful* if it contains only distinct integers. For each valid $i$:\r\n- Chef wants to create a beautiful sequence $S_i$. Let's denote the length of this sequence by $L_i$ and the sequence by $S_{i,1}, S_{i,2}, \\ldots, S_{i,L_i}$.\r\n- The sequence $S_i$ is *good* if for each valid $j$, $S_{i,j}$ is either equal to $A_{i+j-1}$ or $B_{i+j-1}$. Note that this means $L_i$ must be at most $N-i+1$.\r\n- Let's denote the maximum possible value of $L_i$ (the maximum value such that some good sequence $S_i$ with this length exists) by $M_i$.\r\n- Help Chef find the number of good sequences $S_i$ that have the maximum possible length $M_i$. Since this number may be enormous, compute it modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains $N$ space-separated integers $B_1, B_2, \\ldots, B_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing $N$ space-separated integers. For each valid $i$, the $i$-th of these integers should be the number of possible sequences $S_i$ modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 1,000$\r\n- $1 \\leq N \\leq 10^5$\r\n- $|A_i|, |B_i| \\leq 10^9$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n \r\n### Subtasks\r\n**Subtask #1 (20 points):** \r\n- $N \\le 1,000$\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^3$\r\n\r\n**Subtask #2 (80 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n4\r\n2 2 3 2\r\n2 3 4 4\r\n5\r\n1 2 2 3 3\r\n2 1 2 3 1","output":"1 2 3 2\r\n2 1 1 1 2","explanation":"**Example case 1:**\r\n- $S_1$ can only be $(2, 3, 4)$.\r\n- $S_2$ can be $(2, 3, 4) $ or $(3, 4, 2)$.\r\n- $S_3$ can be $(3, 2)$, $(3, 4)$ or $(4, 2)$.\r\n- $S_4$ can be $(2)$ or $(4)$.\r\n\r\n**Example case 2:**\r\n- $S_1$ can be $(1, 2)$ or $(2, 1)$.\r\n- $S_2$ can only be $(1, 2, 3)$.\r\n- $S_3$ can only be $(2, 3, 1)$.\r\n- $S_4$ can only be $(3, 1)$.\r\n- $S_5$ can be $(3)$ or $(1)$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/PdCnYQqadlQ","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2.5","source_sizelimit":"50000","problem_author":"theabd1234","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>theabd1234<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"21-12-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/connectivity'>connectivity<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/disjoint-set-union'>disjoint-set-union<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jan21'>jan21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/link-cut-tree'>link-cut-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/theabd1234'>theabd1234<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Disjoint Set Union","editorial_url":"https:\/\/discuss.codechef.com\/problems\/ARCRT","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797917},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=ARCRT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}