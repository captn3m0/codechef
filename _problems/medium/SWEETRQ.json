{"category_name":"medium","status":"success","problem_code":"SWEETRQ","problem_name":"Sweet Rectangles","body":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK125\/mandarin\/SWEETRQ.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK125\/russian\/SWEETRQ.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK125\/vietnamese\/SWEETRQ.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK125\/bengali\/SWEETRQ.pdf) as well.\r\n\r\nChef recently finished a birthday cake, which can be represented by a grid with $N$ rows (numbered $1$ through $N$) and $M$ columns (numbered $1$ through $M$). For each valid $i$, Chef placed a candle with height $a_{i,j}$ in the cell in row $i$ and column $j$.\r\n\r\nA rectangle with the top left corner in row $r_1$ and column $c_1$ and the bottom right corner in row $r_2$ and column $c_2$ ($1 \\le r_1 \\lt r_2 \\le N$; $1 \\le c_1 \\lt c_2 \\le M$) is called *sweet* if the minimum of heights of candles on some two opposite corners is greater than the maximum of heights of candles on the other two opposite corners. Formally, one of the following conditions should hold:\r\n- $\\min(a_{r_1,c_1}, a_{r_2,c_2}) \\gt \\max(a_{r_1,c_2}, a_{r_2,c_1})$\r\n- $\\min(a_{r_2,c_1}, a_{r_1,c_2}) \\gt \\max(a_{r_1,c_1}, a_{r_2,c_2})$\r\n\r\nThe *quality* of the candle placement is defined as the number of sweet rectangles.\r\n\r\nFind the quality of the initial cake and then process $Q$ queries. In each query, we replace the candle currently placed in a row $x$ and a column $y$ by a new candle with height $h$. The queries are not independent, i.e. each such change affects all subsequent queries. After each query, find the quality of the current candle placement.\r\n\r\nIt is guaranteed that initially and after each query, the heights of the candles are pairwise distinct.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $M$.\r\n- $N$ lines follow. For each valid $i$, the $i$-th of these lines contains $M$ space-separated integers $a_{i,1}, a_{i,2}, \\ldots, a_{i,M}$.\r\n- The next line contains a single integer $Q$.\r\n- Each of the next $Q$ lines contains three space-separated integers $x$, $y$ and $h$ describing a query.\r\n\r\n### Output\r\nFirst, print a line containing a single integer \u2015 the quality of the initial placement. Then, for each query, print a line containing a single integer \u2015 the quality of the placement after this query.\r\n\r\n### Constraints\r\n- $2 \\le N, M \\le 1,000$\r\n- $0 \\le Q \\le 10,000$\r\n- $0 \\le a_{i,j} \\le 10^9$ for each valid $i$ and $j$\r\n- $1 \\le x \\le N$\r\n- $1 \\le y \\le M$\r\n- $0 \\le h \\le 10^9$\r\n\r\n### Example Input\r\n```\r\n3 3\r\n3 5 1\r\n2 9 6\r\n8 7 4\r\n4\r\n2 2 0\r\n2 1 10\r\n3 2 11\r\n1 3 9\r\n```\r\n\r\n### Example Output\r\n```\r\n3\r\n4\r\n3\r\n4\r\n6\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK125\/mandarin\/SWEETRQ.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK125\/russian\/SWEETRQ.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK125\/vietnamese\/SWEETRQ.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK125\/bengali\/SWEETRQ.pdf) as well.\r\n\r\nChef recently finished a birthday cake, which can be represented by a grid with $N$ rows (numbered $1$ through $N$) and $M$ columns (numbered $1$ through $M$). For each valid $i$, Chef placed a candle with height $a_{i,j}$ in the cell in row $i$ and column $j$.\r\n\r\nA rectangle with the top left corner in row $r_1$ and column $c_1$ and the bottom right corner in row $r_2$ and column $c_2$ ($1 \\le r_1 \\lt r_2 \\le N$; $1 \\le c_1 \\lt c_2 \\le M$) is called *sweet* if the minimum of heights of candles on some two opposite corners is greater than the maximum of heights of candles on the other two opposite corners. Formally, one of the following conditions should hold:\r\n- $\\min(a_{r_1,c_1}, a_{r_2,c_2}) \\gt \\max(a_{r_1,c_2}, a_{r_2,c_1})$\r\n- $\\min(a_{r_2,c_1}, a_{r_1,c_2}) \\gt \\max(a_{r_1,c_1}, a_{r_2,c_2})$\r\n\r\nThe *quality* of the candle placement is defined as the number of sweet rectangles.\r\n\r\nFind the quality of the initial cake and then process $Q$ queries. In each query, we replace the candle currently placed in a row $x$ and a column $y$ by a new candle with height $h$. The queries are not independent, i.e. each such change affects all subsequent queries. After each query, find the quality of the current candle placement.\r\n\r\nIt is guaranteed that initially and after each query, the heights of the candles are pairwise distinct.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $M$.\r\n- $N$ lines follow. For each valid $i$, the $i$-th of these lines contains $M$ space-separated integers $a_{i,1}, a_{i,2}, \\ldots, a_{i,M}$.\r\n- The next line contains a single integer $Q$.\r\n- Each of the next $Q$ lines contains three space-separated integers $x$, $y$ and $h$ describing a query.\r\n\r\n### Output\r\nFirst, print a line containing a single integer \u2015 the quality of the initial placement. Then, for each query, print a line containing a single integer \u2015 the quality of the placement after this query.\r\n\r\n### Constraints\r\n- $2 \\le N, M \\le 1,000$\r\n- $0 \\le Q \\le 10,000$\r\n- $0 \\le a_{i,j} \\le 10^9$ for each valid $i$ and $j$\r\n- $1 \\le x \\le N$\r\n- $1 \\le y \\le M$\r\n- $0 \\le h \\le 10^9$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3 3\r\n3 5 1\r\n2 9 6\r\n8 7 4\r\n4\r\n2 2 0\r\n2 1 10\r\n3 2 11\r\n1 3 9","output":"3\r\n4\r\n3\r\n4\r\n6","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1.5","source_sizelimit":"50000","problem_author":"demidenko","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>demidenko<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"14-12-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook125'>cook125<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/demidenko'>demidenko<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rajarshi_basu'>rajarshi_basu<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Medium Hard","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SWEETRQ","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797982},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SWEETRQ","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}