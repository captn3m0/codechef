{"category_name":"medium","status":"success","problem_code":"GPHLBL","problem_name":"Graph Labelling","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK122\/hindi\/GPHLBL.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK122\/mandarin\/GPHLBL.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK122\/russian\/GPHLBL.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK122\/vietnamese\/GPHLBL.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK122\/bengali\/GPHLBL.pdf) as well.\r\n\r\nYou are given a directed graph $G$ with $N$ vertices (numbered $1$ through $N$) and $M$ edges. Let's denote the set of its vertices by $V$, the set of its edges by $E$ and an edge from a vertex $u$ to a vertex $v$ by $(u, v)$. Then, let's define:\r\n- For each $u, v \\in V$, $R(u, v)$ is true if $v$ can be reached from $u$ or false otherwise. Specifically, if $u = v$, it is always true.\r\n- For each $v \\in V$, a set of vertices $N(v) = \\{u \\in V \\mid R(u, v) \\wedge R(v, u)\\}$.\r\n- For each subset $U \\subseteq V$, two sets of edges $Out(U) = \\{(u,v) \\in E \\mid u \\in U\\}$ and $In(U) = \\{(v,u) \\in E \\mid u \\in U\\}$.\r\n\r\nYou need to assign a label to each edge in $E$; you may only use labels $1$ and $2$. The costs of labelling an edge are $c_1$ and $c_2$ for the labels $1$ and $2$ respectively.\r\n\r\nIn the resulting graph, $Q$ constraints (numbered $1$ through $Q$) need to be satisfied. For each valid $i$, the $i$-th constraint is that the number of edges in a set $S_i$ with the label $x_i$ should be between $l_i$ and $r_i$ (inclusive); $S_i$ is determined by a given vertex $w_i$ and the type of this constraint $t_i$ as follows:\r\n- $t_i = 1$: $S_i = Out(N(w_i))$\r\n- $t_i = 2$: $S_i = In(N(w_i))$\r\n- $t_i = 3$: $S_i = Out(\\{w_i\\})$\r\n- $t_i = 4$: $S_i = In(\\{w_i\\})$\r\n\r\nFind the smallest cost of labelling all the edges in such a way that these $Q$ constraints are satisfied or determine that there is no solution satisfying all constraints.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains three space-separated integers $N$, $M$ and $Q$.\r\n- Each of the following $M$ lines contains two space-separated integers $u$ and $v$ denoting a directed edge $(u, v)$.\r\n- The next line contains two space-separated integers $c_1$ and $c_2$.\r\n- $Q$ lines follow. For each valid $i$, the $i$-th of these lines contains five space-separated integers $t_i$, $w_i$, $x_i$, $l_i$ and $r_i$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the smallest cost of labelling the edges or $-1$ if it is impossible to label the edges in such a way that all constraints are satisfied.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 100$\r\n- $1 \\le N \\le 3 \\cdot 10^4$\r\n- $0 \\le M \\le 3 \\cdot 10^4$\r\n- $0 \\le Q \\le 3 \\cdot 10^5$\r\n- $1 \\le u, v \\le N$\r\n- $1 \\le c_1, c_2 \\le 10^9$\r\n- $1 \\le t_i \\le 4$ for each valid $i$\r\n- $1 \\le w_i \\le N$ for each valid $i$\r\n- $x_i \\in \\{1, 2\\}$ for each valid $i$\r\n- $0 \\le l_i \\le r_i \\le M$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $6 \\cdot 10^4$\r\n- the sum of $M$ over all test cases does not exceed $6 \\cdot 10^4$\r\n- the sum of $Q$ over all test cases does not exceed $6 \\cdot 10^5$\r\n\r\n### Example Input\r\n```\r\n1\r\n4 4 1\r\n1 2\r\n2 3\r\n1 3\r\n3 4\r\n10 20\r\n3 1 1 1 1\r\n```\r\n\r\n### Example Output\r\n```\r\n50\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK122\/hindi\/GPHLBL.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK122\/mandarin\/GPHLBL.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK122\/russian\/GPHLBL.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK122\/vietnamese\/GPHLBL.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK122\/bengali\/GPHLBL.pdf) as well.\r\n\r\nYou are given a directed graph $G$ with $N$ vertices (numbered $1$ through $N$) and $M$ edges. Let's denote the set of its vertices by $V$, the set of its edges by $E$ and an edge from a vertex $u$ to a vertex $v$ by $(u, v)$. Then, let's define:\r\n- For each $u, v \\in V$, $R(u, v)$ is true if $v$ can be reached from $u$ or false otherwise. Specifically, if $u = v$, it is always true.\r\n- For each $v \\in V$, a set of vertices $N(v) = \\{u \\in V \\mid R(u, v) \\wedge R(v, u)\\}$.\r\n- For each subset $U \\subseteq V$, two sets of edges $Out(U) = \\{(u,v) \\in E \\mid u \\in U\\}$ and $In(U) = \\{(v,u) \\in E \\mid u \\in U\\}$.\r\n\r\nYou need to assign a label to each edge in $E$; you may only use labels $1$ and $2$. The costs of labelling an edge are $c_1$ and $c_2$ for the labels $1$ and $2$ respectively.\r\n\r\nIn the resulting graph, $Q$ constraints (numbered $1$ through $Q$) need to be satisfied. For each valid $i$, the $i$-th constraint is that the number of edges in a set $S_i$ with the label $x_i$ should be between $l_i$ and $r_i$ (inclusive); $S_i$ is determined by a given vertex $w_i$ and the type of this constraint $t_i$ as follows:\r\n- $t_i = 1$: $S_i = Out(N(w_i))$\r\n- $t_i = 2$: $S_i = In(N(w_i))$\r\n- $t_i = 3$: $S_i = Out(\\{w_i\\})$\r\n- $t_i = 4$: $S_i = In(\\{w_i\\})$\r\n\r\nFind the smallest cost of labelling all the edges in such a way that these $Q$ constraints are satisfied or determine that there is no solution satisfying all constraints.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains three space-separated integers $N$, $M$ and $Q$.\r\n- Each of the following $M$ lines contains two space-separated integers $u$ and $v$ denoting a directed edge $(u, v)$.\r\n- The next line contains two space-separated integers $c_1$ and $c_2$.\r\n- $Q$ lines follow. For each valid $i$, the $i$-th of these lines contains five space-separated integers $t_i$, $w_i$, $x_i$, $l_i$ and $r_i$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the smallest cost of labelling the edges or $-1$ if it is impossible to label the edges in such a way that all constraints are satisfied.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 100$\r\n- $1 \\le N \\le 3 \\cdot 10^4$\r\n- $0 \\le M \\le 3 \\cdot 10^4$\r\n- $0 \\le Q \\le 3 \\cdot 10^5$\r\n- $1 \\le u, v \\le N$\r\n- $1 \\le c_1, c_2 \\le 10^9$\r\n- $1 \\le t_i \\le 4$ for each valid $i$\r\n- $1 \\le w_i \\le N$ for each valid $i$\r\n- $x_i \\in \\{1, 2\\}$ for each valid $i$\r\n- $0 \\le l_i \\le r_i \\le M$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $6 \\cdot 10^4$\r\n- the sum of $M$ over all test cases does not exceed $6 \\cdot 10^4$\r\n- the sum of $Q$ over all test cases does not exceed $6 \\cdot 10^5$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n4 4 1\r\n1 2\r\n2 3\r\n1 3\r\n3 4\r\n10 20\r\n3 1 1 1 1","output":"50","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"manishtanwar","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>manishtanwar<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"7-09-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook122'>cook122<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/manishtanwar'>manishtanwar<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/manishtanwar'>manishtanwar<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/maximum-flow'>maximum-flow<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rahuldugar'>rahuldugar<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rishup_nitdgp'>rishup_nitdgp<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/strongly-connected-components'>strongly-connected-components<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Strongly Connected Components","editorial_url":"https:\/\/discuss.codechef.com\/problems\/GPHLBL","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797946},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=GPHLBL","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}