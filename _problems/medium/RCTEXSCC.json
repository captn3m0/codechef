{"category_name":"medium","status":"success","problem_code":"RCTEXSCC","problem_name":"Expected Number of SCCs","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN21\/hindi\/RCTEXSCC.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN21\/bengali\/RCTEXSCC.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/mandarin\/RCTEXSCC.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN21\/russian\/RCTEXSCC.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/vietnamese\/RCTEXSCC.pdf) as well.\r\n\r\nChef has a matrix $A$ with size $M \\times N$. He wants to fill each of its cells with a random integer between $1$ and $K$ (inclusive); these integers are independent.\r\n\r\nThen, Chef builds a directed graph on this matrix: for each ordered pair of side-adjacent cells of the matrix such that the value in the first cell is greater than or equal to the value in the second cell, he adds an edge from the first cell to the second cell.\r\n\r\nFind the expected value of the number of strongly connected components (SCC) in this graph. It can be proved that the answer can be represented as a fraction $P\/Q$, where $P$ and $Q$ are positive integers and $Q$ is coprime with $998,244,353$. You should compute $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first and only line of the input contains three space-separated integers $M$, $N$ and $K$.\r\n\r\n### Output\r\nPrint a single line containing one integer $P \\cdot Q^{-1}$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le M \\le 2$\r\n- $1 \\le N \\le 10^5$\r\n- $1 \\le K \\le 10^8$\r\n\r\n### Subtasks\r\n**Subtask #1 (5 points, time limit 1s):**\r\n- $N \\le 4$\r\n- $K \\le 5$ \r\n\r\n**Subtask #2 (10 points, time limit 2s):** $M = 1$\r\n\r\n**Subtask #3 (10 points, time limit 2s):**\r\n- $M = 2$\r\n- $N \\le 500$\r\n- $K \\le 500$\r\n\r\n**Subtask #4 (75 points, time limit 3s):** original constraints\r\n\r\n### Example Input\r\n```\r\n2 2 2\r\n```\r\n\r\n### Example Output\r\n```\r\n873463811\r\n```\r\n\r\n### Explanation\r\nThe total number of ways to fill the matrix is $16$. We get:\r\n- $1$ SCC with a probability $2\/16$\r\n- $2$ SCCs with a probability $12\/16$\r\n- $3$ SCCs with a probability $0\/16$\r\n- $4$ SCCs with a probability $2\/16$\r\n\r\nThe expected number of SCCs is $2\/16 + 24\/16 + 8\/16 = 34\/16 = 34 \\cdot 16^{-1} = 873463811$. We can check that indeed, $873463811 \\cdot 16 = 34$ modulo $998244353$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN21\/hindi\/RCTEXSCC.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN21\/bengali\/RCTEXSCC.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/mandarin\/RCTEXSCC.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN21\/russian\/RCTEXSCC.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/vietnamese\/RCTEXSCC.pdf) as well.\r\n\r\nChef has a matrix $A$ with size $M \\times N$. He wants to fill each of its cells with a random integer between $1$ and $K$ (inclusive); these integers are independent.\r\n\r\nThen, Chef builds a directed graph on this matrix: for each ordered pair of side-adjacent cells of the matrix such that the value in the first cell is greater than or equal to the value in the second cell, he adds an edge from the first cell to the second cell.\r\n\r\nFind the expected value of the number of strongly connected components (SCC) in this graph. It can be proved that the answer can be represented as a fraction $P\/Q$, where $P$ and $Q$ are positive integers and $Q$ is coprime with $998,244,353$. You should compute $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first and only line of the input contains three space-separated integers $M$, $N$ and $K$.\r\n\r\n### Output\r\nPrint a single line containing one integer $P \\cdot Q^{-1}$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le M \\le 2$\r\n- $1 \\le N \\le 10^5$\r\n- $1 \\le K \\le 10^8$\r\n\r\n### Subtasks\r\n**Subtask #1 (5 points, time limit 1s):**\r\n- $N \\le 4$\r\n- $K \\le 5$ \r\n\r\n**Subtask #2 (10 points, time limit 2s):** $M = 1$\r\n\r\n**Subtask #3 (10 points, time limit 2s):**\r\n- $M = 2$\r\n- $N \\le 500$\r\n- $K \\le 500$\r\n\r\n**Subtask #4 (75 points, time limit 3s):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2 2 2","output":"873463811","explanation":"The total number of ways to fill the matrix is $16$. We get:\r\n- $1$ SCC with a probability $2\/16$\r\n- $2$ SCCs with a probability $12\/16$\r\n- $3$ SCCs with a probability $0\/16$\r\n- $4$ SCCs with a probability $2\/16$\r\n\r\nThe expected number of SCCs is $2\/16 + 24\/16 + 8\/16 = 34\/16 = 34 \\cdot 16^{-1} = 873463811$. We can check that indeed, $873463811 \\cdot 16 = 34$ modulo $998244353$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/CitIf168mYk","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1 - 3","source_sizelimit":"50000","problem_author":"bthero","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>bthero<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"6-12-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/bthero'>bthero<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/euler'>euler<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jan21'>jan21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/probability'>probability<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/RCTEXSCC","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797971},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=RCTEXSCC","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}