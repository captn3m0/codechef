{"category_name":"medium","status":"success","problem_code":"LUCKYCOM","problem_name":"Little Elephant and CNSes","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>A Little Elephant from the Zoo of Lviv likes <i>lucky strings<\/i>, i.e., the strings that consist only of the lucky digits <b>4<\/b> and <b>7<\/b>.<\/p>\n\n<p> The Little Elephant has <b>N<\/b> favorite strings <b>S<sub>1<\/sub>, S<sub>2<\/sub>, ..., S<sub>N<\/sub><\/b> and the favorite number <b>K<\/b>. Each character in <b>S<sub>i<\/sub><\/b> (<b>1 \u2264 i \u2264 N<\/b>) is either the lucky digit (<b>4<\/b> or <b>7<\/b>) or the question mark <b>?<\/b>.<\/p>\n\n<p>Consider some non-decreasing lucky string <b>S<\/b>. In other words, <b>S<\/b> has one of the following forms: <b>444...444<\/b>, <b>777...777<\/b>, <b>444...444777...777<\/b>. The string <b>S<\/b> is called a <i> CNS<\/i> (plural form is CNSes) if we can replace some (possibly zero) number of question marks with the lucky digits in each of the string <b>S<sub>1<\/sub>, S<sub>2<\/sub>, ..., S<sub>N<\/sub><\/b> in a such way that the total number of replacements for all strings does not exceed <b>K<\/b> and <b>S<\/b> is a subsequence of each of the strings derived after the replacement.<\/p>\n\n<p>The Little Elephant wants to know the total number of all different non-empty CNSes. Help him to find this number.\n\n<\/p><p><b>Notes.<\/b><\/p>\n\nLet <b>S<\/b> be some string (possibly not lucky). Then\n\n<ul>\n\n<li><b>|S|<\/b> denotes the length of the string <b>S<\/b>;\n\n<\/li><li><b>S[i]<\/b> (<b>1 \u2264 i \u2264 |S|<\/b>) denotes the <b>i<\/b><sup>th<\/sup> character of <b>S<\/b> (the numeration of characters starts from <b>1<\/b>);\n\n<\/li><\/ul>\n<br \/>\n\n<p>The string <b>T<\/b> is called a <i>subsequence<\/i> of the string <b>S<\/b> if <b>T<\/b> can be derived from <b>S<\/b> by deleting some (possibly zero) number of characters without changing the order of the remaining characters. For example, <b>T = 474<\/b> is a subsequence of <b>S = 74477747??<\/b> since after deleting characters at positions <b>1, 2, 5, 6, 8, 9, 10<\/b> from <b>S<\/b> we obtain <b>T<\/b>. Note that, the empty string and the string <b>S<\/b> itself are always the subsequences of <b>S<\/b>.<\/p>\n\n<h3>Input<\/h3>\n<p>The first line of the input file contains two space separated integers <b>N<\/b> and <b>K<\/b>, the number of strings in the set and the favorite number of the Little Elephant. Each of the following <b>N<\/b> lines contains one favorite string of the Little Elephant. Namely, <b>i<\/b><sup>th<\/sup> line among these <b>N<\/b> lines contains the string <b>S<sub>i<\/sub><\/b>.\n\n<h3>Output<\/h3>\n<\/p><p> For each test case output a single line containing the answer for this test case.<\/p>\n\n<h3>Constraints<\/h3>\n\n<p>1 \u2264 <b>N<\/b> \u2264 7474<\/p>\n\n<p>0 \u2264 <b>K<\/b> \u2264 10<sup>9<\/sup><\/p>\n\n<p><b>S<sub>i<\/sub><\/b> is non-empty for <b>1 \u2264 i \u2264 N<\/b>.<\/p>\n\n<p><b>|S<sub>1<\/sub>| + |S<sub>2<\/sub>| + ... + |S<sub>N<\/sub>|<\/b> \u2264 100000. In other words, the total length of all <b>N<\/b> strings does not exceed 100000.<\/p>\n\n<p> Each character in <b>S<sub>i<\/sub><\/b> (<b>1 \u2264 i \u2264 N<\/b>) is either the lucky digit (<b>4<\/b> or <b>7<\/b>) or the question mark <b>?<\/b>.<\/p>\n\n<h3>Example<\/h3>\n\n<pre>\n<b>Input:<\/b>\n3 2\n4447\n47???74\n4?77?\n\n<b>Output:<\/b>\n5\n\n<\/pre>\n\n<h3>Explanation<\/h3>\nFor the sample input all different CNSes are <b>4<\/b>, <b>7<\/b>, <b>44<\/b>, <b>47<\/b> and <b>447<\/b>. Note, that <b>444<\/b> is not a CNS since it requires at least 3 replacements of the question marks.","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"3","source_sizelimit":"50000","problem_author":"witua","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>witua<\/span>","problem_tester":"anton_lunyov","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>anton_lunyov<\/span>","date_added":"1-03-2012","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook22'>\n                    cook22\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/witua'>\n                    witua\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/LUCKYCOM","user":{"username":null},"time":{"view_start_date":1337540997,"submit_start_date":1337540997,"visible_start_date":1337539200,"end_date":1735669800,"current":1493557770},"todo":false,"problem_status":"unattempted"}