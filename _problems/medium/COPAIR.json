{"category_name":"medium","status":"success","problem_code":"COPAIR","problem_name":"Coloured Pairings","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/hindi\/COPAIR.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/bengali\/COPAIR.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/mandarin\/COPAIR.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/russian\/COPAIR.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/vietnamese\/COPAIR.pdf) as well.\r\n\r\nYou are given two sequences $A_1, A_2, \\ldots, A_N$ and $C_1, C_2, \\ldots, C_N$. For each valid $i$, $C_i$ is the colour of $A_i$.\r\n\r\nYou should answer $Q$ queries. In each query:\r\n- You are given two colours $x$ and $y$.\r\n- Consider the subsequence of $A$ which contains only elements $A_i$ such that $C_i = x$ or $C_i = y$ (in the original order). Let's denote it by $B$.\r\n- For each contiguous subsequence of $B$ (including empty subsequence), consider the sum of all its elements. Find the maximum of these sums. \r\n\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains $N$ space-separated integers $C_1, C_2, \\ldots, C_N$.\r\n- $Q$ lines follow. Each of these lines contains two space-separated integers $x$ and $y$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2014 the maximum sum of a contiguous subsequence of $B$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10^2$\r\n- $1 \\le N, Q \\le 3*10^5$\r\n- $|A_i| \\le 10^9$ for each valid $i$\r\n- $1 \\le C_i \\le N$ for each valid $i$\r\n- $1 \\le x \\ne y \\le N$\r\n- the sum of $N$ over all test cases does not exceed $3*10^5$\r\n- the sum of $Q$ over all test cases does not exceed $3*10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** Every color except the color $1$ occurs in at most $1$ query.  \r\n\r\n**Subtask #2 (50 points):** Original constraints\r\n\r\n### Example Input\r\n```\r\n2\r\n6 4\r\n4 -2 5 3 -6 7\r\n1 2 2 3 1 3\r\n1 2\r\n2 3\r\n1 3\r\n5 6\r\n4 4\r\n-1 -1 5 -3\r\n1 1 1 2\r\n1 2\r\n1 3\r\n1 4\r\n2 4\r\n```\r\n\r\n### Example Output\r\n```\r\n7\r\n15\r\n8\r\n0\r\n5\r\n5\r\n5\r\n0\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/hindi\/COPAIR.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/bengali\/COPAIR.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/mandarin\/COPAIR.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/russian\/COPAIR.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME86\/vietnamese\/COPAIR.pdf) as well.\r\n\r\nYou are given two sequences $A_1, A_2, \\ldots, A_N$ and $C_1, C_2, \\ldots, C_N$. For each valid $i$, $C_i$ is the colour of $A_i$.\r\n\r\nYou should answer $Q$ queries. In each query:\r\n- You are given two colours $x$ and $y$.\r\n- Consider the subsequence of $A$ which contains only elements $A_i$ such that $C_i = x$ or $C_i = y$ (in the original order). Let's denote it by $B$.\r\n- For each contiguous subsequence of $B$ (including empty subsequence), consider the sum of all its elements. Find the maximum of these sums. \r\n\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains $N$ space-separated integers $C_1, C_2, \\ldots, C_N$.\r\n- $Q$ lines follow. Each of these lines contains two space-separated integers $x$ and $y$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2014 the maximum sum of a contiguous subsequence of $B$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10^2$\r\n- $1 \\le N, Q \\le 3*10^5$\r\n- $|A_i| \\le 10^9$ for each valid $i$\r\n- $1 \\le C_i \\le N$ for each valid $i$\r\n- $1 \\le x \\ne y \\le N$\r\n- the sum of $N$ over all test cases does not exceed $3*10^5$\r\n- the sum of $Q$ over all test cases does not exceed $3*10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** Every color except the color $1$ occurs in at most $1$ query.  \r\n\r\n**Subtask #2 (50 points):** Original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n6 4\r\n4 -2 5 3 -6 7\r\n1 2 2 3 1 3\r\n1 2\r\n2 3\r\n1 3\r\n5 6\r\n4 4\r\n-1 -1 5 -3\r\n1 1 1 2\r\n1 2\r\n1 3\r\n1 4\r\n2 4","output":"7\r\n15\r\n8\r\n0\r\n5\r\n5\r\n5\r\n0","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"10","source_sizelimit":"50000","problem_author":"shashwatchandr","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span class='m-username--link'>shashwatchandr<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"22-07-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/ltime86'>ltime86<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rajarshi_basu'>rajarshi_basu<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/shashwatchandr'>shashwatchandr<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sqrt-decomp'>sqrt-decomp<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Medium Hard","editorial_url":"https:\/\/discuss.codechef.com\/problems\/COPAIR","time":{"view_start_date":1595696400,"submit_start_date":1595696400,"visible_start_date":1595696400,"end_date":1735669800,"current":1643797934},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=COPAIR","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}