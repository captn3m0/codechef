{"category_name":"medium","status":"success","problem_code":"DFNC","problem_name":"D-Function","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK111\/hindi\/DFNC.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK111\/mandarin\/DFNC.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK111\/russian\/DFNC.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK111\/vietnamese\/DFNC.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK111\/bengali\/DFNC.pdf) as well.\n\nDr.D is tired of making up stories, so here is the formal description of this problem :\n\nYou are given a set $S = \\{S_1, S_2, \\ldots, S_K\\}$, an integer $X$ and a sequence $A_1, A_2, \\ldots, A_M$. Let's define an infinite sequence $W_1, W_2, \\ldots$: for each valid $i$, $W_i = A_{((i-1) \\% M) + 1}$. Then, let's define a function $F(i)$ for any non-negative integer $i$ in the following way:\n- $F(0) = X$\n- if $i \\in S$, $F(i) = 0$\n- otherwise, for $i \\neq 0$, $F(i) = \\left(\\sum_{j=1}^i F(i-j) \\cdot W_j \\right) \\% (10^9+7)$\n\nFind the value of $F(N)$.\n\n### Input\n- The first line of the input contains four space-separated integers $X$, $K$, $M$ and $N$.\n- The second line contains $K$ space-separated integers $S_1, S_2, \\ldots, S_K$.\n- The third line contains $M$ space-separated integers $A_1, A_2, \\ldots, A_M$.\n\n### Output\nPrint a single line containing one integer $F(N)$.\n\n### Constraints\n- $0 \\le X \\lt 10^9+7$\n- $0 \\le K \\le 200$\n- $1 \\le M \\le 200$\n- $0 \\le N \\le 10^{18}$\n- $0 \\le A_i \\lt 10^9+7$ for each valid $i$\n- $1 \\le S_i \\le N$ for each valid $i$\n\n### Example Input\n```\n3 1 3 5\n4\n2 3 1\n```\n\n### Example Output\n```\n231\n```\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK111\/hindi\/DFNC.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK111\/mandarin\/DFNC.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK111\/russian\/DFNC.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK111\/vietnamese\/DFNC.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK111\/bengali\/DFNC.pdf) as well.\n\nDr.D is tired of making up stories, so here is the formal description of this problem :\n\nYou are given a set $S = \\{S_1, S_2, \\ldots, S_K\\}$, an integer $X$ and a sequence $A_1, A_2, \\ldots, A_M$. Let's define an infinite sequence $W_1, W_2, \\ldots$: for each valid $i$, $W_i = A_{((i-1) \\% M) + 1}$. Then, let's define a function $F(i)$ for any non-negative integer $i$ in the following way:\n- $F(0) = X$\n- if $i \\in S$, $F(i) = 0$\n- otherwise, for $i \\neq 0$, $F(i) = \\left(\\sum_{j=1}^i F(i-j) \\cdot W_j \\right) \\% (10^9+7)$\n\nFind the value of $F(N)$.\n\n### Input\n- The first line of the input contains four space-separated integers $X$, $K$, $M$ and $N$.\n- The second line contains $K$ space-separated integers $S_1, S_2, \\ldots, S_K$.\n- The third line contains $M$ space-separated integers $A_1, A_2, \\ldots, A_M$.\n\n### Output\nPrint a single line containing one integer $F(N)$.\n\n### Constraints\n- $0 \\le X \\lt 10^9+7$\n- $0 \\le K \\le 200$\n- $1 \\le M \\le 200$\n- $0 \\le N \\le 10^{18}$\n- $0 \\le A_i \\lt 10^9+7$ for each valid $i$\n- $1 \\le S_i \\le N$ for each valid $i$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3 1 3 5\n4\n2 3 1","output":"231","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"kmaaszraa","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>kmaaszraa<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"14-10-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook111'>cook111<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kmaaszraa'>kmaaszraa<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/matrix-exponentiation'>matrix-exponentiation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Matrix Exponentiation","editorial_url":"https:\/\/discuss.codechef.com\/problems\/DFNC","time":{"view_start_date":1571596202,"submit_start_date":1571596202,"visible_start_date":1571596202,"end_date":1735669800,"current":1643797938},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=DFNC","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}