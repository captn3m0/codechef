{"category_name":"medium","status":"success","problem_code":"DIGITLIS","problem_name":"Digit Longest Increasing Subsequences","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK78\/mandarin\/DIGITLIS.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK78\/russian\/DIGITLIS.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK78\/vietnamese\/DIGITLIS.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n\n<p>Recently Chef learned about <a href=\"https:\/\/en.wikipedia.org\/wiki\/Longest_increasing_subsequence\">Longest Increasing Subsequence<\/a>. To be precise, he means longest <b>strictly<\/b> increasing subsequence, when he talks of longest increasing subsequence.  To check his understanding, he took his favorite <b>n<\/b>-digit number and for each of its <b>n<\/b> digits, he computed the length of the longest increasing subsequence of digits ending with that digit. Then he stored these lengths in an array named <b>LIS<\/b>.<\/p>\n\n<p>For example, let us say that Chef's favourite <b>4<\/b>-digit number is <b>1531<\/b>, then the <b>LIS<\/b> array would be <b>[1, 2, 2, 1]<\/b>. The length of longest increasing subsequence ending at first digit is <b>1<\/b> (the digit <b>1<\/b> itself) and at the second digit is <b>2<\/b> (<b>[1, 5]<\/b>), at third digit is also <b>2<\/b> (<b>[1, 3]<\/b>), and at the <b>4<\/b>th digit is <b>1<\/b> (the digit <b>1<\/b> itself).<\/p>\n\n<p>Now Chef is wondering, how many different <b>n<\/b>-digit numbers (without leading zeros) are there that have exactly the given <b>LIS<\/b> array? As this number could be very large, output it modulo <b>(10<sup>9<\/sup> + 7)<\/b>.<\/p>\n\n<h3>Input<\/h3>\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. <\/p>\n<p>For each test case, the first line contains an integer <b>n<\/b> denoting the number of digits in Chef's favourite number.<\/p>\n<p>The second line will contain <b>n<\/b> space separated integers denoting <b>LIS<\/b> array, i.e. <b>LIS<sub>1<\/sub>, LIS<sub>2<\/sub>, ..., LIS<sub>n<\/sub><\/b>.<\/p>\n\n<h3>Output<\/h3>\n<p>For each test case, output a single integer \u2015 count of different <b>n<\/b>-digit numbers having the given <b>LIS<\/b> array, modulo <b>(10<sup>9<\/sup> + 7)<\/b>.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n    <li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>2 000<\/b><\/li>\n    <li><b>1<\/b> \u2264 <b>n<\/b> \u2264 <b>1 000<\/b><\/li>\n    <li>Sum of <b>n<\/b> over all <b>T<\/b> testcases is denoted by <b>S<\/b><\/li>\n    <li><b>1<\/b> \u2264 <b>S<\/b> \u2264 <b>10 000<\/b><\/li>\n    <li>It is guaranteed that at least one <b>n<\/b>-digit number having the given <b>LIS<\/b> array exists.\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n4\n1 \n1\n2 \n1 2\n2 \n1 1\n3 \n1 2 3\n\n<b>Output:<\/b>\n10\n36\n54\n84\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p><b>Example case 1.<\/b> All one-digit numbers have the same <b>LIS<\/b> array, so the answer is <b>10<\/b>: <b>0, 1, 2, 3, ..., 9<\/b>.<\/p>\n\n<p><b>Example cases 2 & 3.<\/b> Overall we have <b>90<\/b> two-digit numbers (from <b>10<\/b> to <b>99<\/b>). Numbers with second digit strictly greater than first digit have <b>LIS<\/b> array <b>[1, 2]<\/b> and there are <b>36<\/b> such numbers. All the other two-digit numbers have <b>LIS<\/b> array <b>[1, 1]<\/b>.<\/p>\n\n<p><font size=\"3\" color=\"#656565\">An example of how array <b>LIS<\/b> is constructed<\/font><\/p>\n<p>We will take <b>7<\/b>-digit number <b>1730418<\/b>, its <b>LIS<\/b> array is <b>[1, 2, 2, 1, 3, 2, 4]<\/b>:\n<center><table>\n    <tr align=\"center\">\n        <td>index<\/td>\n        <td>LIS<\/td>\n        <td>length<\/td>\n    <\/tr>\n    <tr align=\"center\">\n        <td>1<\/td>\n        <td><font color=\"#578fb2\"><b>1<\/b><\/font>730418<\/td>\n        <td>1<\/td>\n    <\/tr>\n    <tr align=\"center\">\n        <td>2<\/td>\n        <td><font color=\"#578fb2\"><b>17<\/b><\/font>30418<\/td>\n        <td>2<\/td>\n    <\/tr>\n    <tr align=\"center\">\n        <td>3<\/td>\n        <td><font color=\"#578fb2\"><b>1<\/b><\/font>7<font color=\"#578fb2\"><b>3<\/b><\/font>0418<\/td>\n        <td>2<\/td>\n    <\/tr>\n    <tr align=\"center\">\n        <td>4<\/td>\n        <td>173<font color=\"#578fb2\"><b>0<\/b><\/font>418<\/td>\n        <td>1<\/td>\n    <\/tr>\n    <tr align=\"center\">\n        <td>5<\/td>\n        <td><font color=\"#578fb2\"><b>1<\/b><\/font>7<font color=\"#578fb2\"><b>3<\/b><\/font>0<font color=\"#578fb2\"><b>4<\/b><\/font>18<\/td>\n        <td>3<\/td>\n    <\/tr>\n    <tr align=\"center\">\n        <td>6<\/td>\n        <td>173<font color=\"#578fb2\"><b>0<\/b><\/font>4<font color=\"#578fb2\"><b>1<\/b><\/font>8<\/td>\n        <td>2<\/td>\n    <\/tr>\n    <tr align=\"center\">\n        <td>7<\/td>\n        <td><font color=\"#578fb2\"><b>1<\/b><\/font>7<font color=\"#578fb2\"><b>3<\/b><\/font>0<font color=\"#578fb2\"><b>4<\/b><\/font>1<font color=\"#578fb2\"><b>8<\/b><\/font><\/td>\n        <td>4<\/td>\n    <\/tr>\n<\/table><\/center>\n<\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"alex_2oo8","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>alex_2oo8<\/span>","problem_tester":"kingofnumbers","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>kingofnumbers<\/span>","date_added":"5-08-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alex_2oo8'>\n                    alex_2oo8\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/cook78'>\n                    cook78\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/dp+bitmask'>\n                    dp+bitmask\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>\n                    easy-medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/lis'>\n                    lis\n                <\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/DIGITLIS","user":{"username":null},"time":{"view_start_date":1485109800,"submit_start_date":1485109800,"visible_start_date":1485109800,"end_date":1735669800,"current":1493557625},"todo":false,"problem_status":"unattempted"}