{"category_name":"medium","status":"success","problem_code":"PALMACH","problem_name":"Palindromes Machine","body":"Dr. Hasan is one of the most famous inventors in the world. One day, he invented a wonderful machine in order to examine the possibility of generating new palindrome strings by merging other strings.\r\n\r\nHasan's machine takes a sequence of strings $(A_1, A_2, \\ldots, A_K)$ as the input; $K$ may be any positive integer. The length of each of these strings must be exactly $N$; for each valid $j$, let's denote the $j$-th character of the $i$-th string by $A_{i, j}$. The machine magically generates a string $B$ by merging these strings and it determines if $B$ is a palindrome. The string $B$ is generated as follows:\r\n- $B_1 = A_{1, 1}, B_2 = A_{2, 1}, \\ldots, B_K = A_{K, 1}$\r\n- $B_{K+1} = A_{1, 2}, B_{K+2} = A_{2, 2}, \\ldots, B_{2 \\cdot K} = A_{K, 2}$\r\n- ...\r\n- $B_{(N-1) \\cdot K + 1} = A_{1, N}, B_{(N-1) \\cdot K + 2} = A_{2, N}, \\ldots, B_{N \\cdot K} = A_{K, N}$\r\n\r\nHasan wants to test his new machine, so he prepared $N$ strings $S_1, S_2, \\ldots, S_N$. Each of these strings has length $N$. Now, he wants to choose a sequence of $K$ pairwise distinct indices $i_1, i_2, \\ldots, i_K$, where $1 \\le K \\le M$, and run the machine with strings $(S_{i_1}, S_{i_2}, \\ldots, S_{i_K})$. His goal is to make the machine report that the string it generated is a palindrome.\r\n\r\nCan you help Hasan with testing his machine and tell him the number of sequences of indices he can choose? Since the answer could be very large, compute it modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and  $M$.\r\n- $N$ lines follow. For each $i$ ($1 \\le i \\le N$), the $i$-th of these lines contains a single string $S_i$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2014 the number of sequences Hasan can choose, modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 100$\r\n- $1 \\le N \\le 10^3$\r\n- $1 \\le M \\le N$\r\n- $|S_i| = N$ for each valid $i$\r\n- $S_1, S_2, \\ldots, S_N$ contain only lowercase English letters\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^3$\r\n\r\n### Example Input\r\n```\r\n1\r\n4 2\r\naaaa\r\nabcb\r\nabcb\r\nbcba\r\n```\r\n\r\n### Example Output\r\n```\r\n5\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** Hasan can choose the following sequences of indices:\r\n- $(1)$: the input of the machine is (\"aaaa\") and the generated string $B$ is \"aaaa\"\r\n- $(2, 4)$: the input is (\"abcb\", \"bcba\") and $B$ is \"abbccbba\"\r\n- $(3, 4)$: the input is (\"abcb\", \"bcba\") and $B$ is \"abbccbba\"\r\n- $(4, 2)$: the input is (\"bcba\", \"abcb\") and $B$ is \"bacbbcab\"\r\n- $(4, 3)$: the input is (\"bcba\", \"abcb\") and $B$ is \"bacbbcab\"\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"Dr. Hasan is one of the most famous inventors in the world. One day, he invented a wonderful machine in order to examine the possibility of generating new palindrome strings by merging other strings.\r\n\r\nHasan's machine takes a sequence of strings $(A_1, A_2, \\ldots, A_K)$ as the input; $K$ may be any positive integer. The length of each of these strings must be exactly $N$; for each valid $j$, let's denote the $j$-th character of the $i$-th string by $A_{i, j}$. The machine magically generates a string $B$ by merging these strings and it determines if $B$ is a palindrome. The string $B$ is generated as follows:\r\n- $B_1 = A_{1, 1}, B_2 = A_{2, 1}, \\ldots, B_K = A_{K, 1}$\r\n- $B_{K+1} = A_{1, 2}, B_{K+2} = A_{2, 2}, \\ldots, B_{2 \\cdot K} = A_{K, 2}$\r\n- ...\r\n- $B_{(N-1) \\cdot K + 1} = A_{1, N}, B_{(N-1) \\cdot K + 2} = A_{2, N}, \\ldots, B_{N \\cdot K} = A_{K, N}$\r\n\r\nHasan wants to test his new machine, so he prepared $N$ strings $S_1, S_2, \\ldots, S_N$. Each of these strings has length $N$. Now, he wants to choose a sequence of $K$ pairwise distinct indices $i_1, i_2, \\ldots, i_K$, where $1 \\le K \\le M$, and run the machine with strings $(S_{i_1}, S_{i_2}, \\ldots, S_{i_K})$. His goal is to make the machine report that the string it generated is a palindrome.\r\n\r\nCan you help Hasan with testing his machine and tell him the number of sequences of indices he can choose? Since the answer could be very large, compute it modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and  $M$.\r\n- $N$ lines follow. For each $i$ ($1 \\le i \\le N$), the $i$-th of these lines contains a single string $S_i$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2014 the number of sequences Hasan can choose, modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 100$\r\n- $1 \\le N \\le 10^3$\r\n- $1 \\le M \\le N$\r\n- $|S_i| = N$ for each valid $i$\r\n- $S_1, S_2, \\ldots, S_N$ contain only lowercase English letters\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^3$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n4 2\r\naaaa\r\nabcb\r\nabcb\r\nbcba","output":"5","explanation":"**Example case 1:** Hasan can choose the following sequences of indices:\r\n- $(1)$: the input of the machine is (\"aaaa\") and the generated string $B$ is \"aaaa\"\r\n- $(2, 4)$: the input is (\"abcb\", \"bcba\") and $B$ is \"abbccbba\"\r\n- $(3, 4)$: the input is (\"abcb\", \"bcba\") and $B$ is \"abbccbba\"\r\n- $(4, 2)$: the input is (\"bcba\", \"abcb\") and $B$ is \"bacbbcab\"\r\n- $(4, 3)$: the input is (\"bcba\", \"abcb\") and $B$ is \"bacbbcab\"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"i_love_islam","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>i_love_islam<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"18-09-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/cook110'>cook110<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fast-fourier-transform'>fast-fourier-transform<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/i_love_islam'>i_love_islam<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/PALMACH","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797966},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=PALMACH","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}