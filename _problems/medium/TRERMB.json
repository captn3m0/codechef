{"category_name":"medium","status":"success","problem_code":"TRERMB","problem_name":"A Tree to Remember","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK116\/hindi\/TRERMB.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK116\/mandarin\/TRERMB.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK116\/russian\/TRERMB.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK116\/vietnamese\/TRERMB.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK116\/bengali\/TRERMB.pdf) as well.\r\n\r\nChef finished inviting all of his friends. Now it is time to get a tree in his house and decorate it for the party. He wants to use the most beautiful tree ever.\r\n\r\nThe tree Chef chose has $N$ nodes (numbered $1$ through $N$) and it is rooted at node $1$. For each valid $i$, the initial colour of the $i$-th node is $C_i$ and there is a value $A_i$ written in that node. Chef calculates the *beauty* of his tree as $\\sum_{i=1}^N A_i \\cdot F_i$, where $F_i$ denotes the number of distinct colours of nodes in the subtree of the $i$-th node (including this node).\r\n\r\nNow, Chef is trying to improve the beauty of the tree \u2015 he wants to make $Q$ updates, where in each update, he chooses a node $a$ and an integer $x$ and changes the colour of the node $a$ to $x$. After each update, find the beauty of the tree. Note that the updates are permanent, i.e. they affect all subsequent updates.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $Q$.\r\n- Each of the following $N-1$ lines contains two space-separated integers $u$ and $v$ denoting an edge between nodes $u$ and $v$.\r\n- The next line contains $N$ space-separated integers $C_1, C_2, \\ldots, C_N$.\r\n- The next line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- Each of the following $Q$ lines contains two space-separated integers $a$ and $x$ describing a query.\r\n\r\n### Output\r\nFor each update, print a single line containing one integer \u2015 the beauty of the tree after this update is performed.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 2$\r\n- $1 \\le N, Q \\le 10^5$\r\n- $1 \\le A_i, C_i \\le N$ for each valid $i$\r\n- $1 \\le u, v, a, x \\le N$\r\n- the graph described on the input is a tree\r\n\r\n### Example Input\r\n```\r\n1\r\n10 6\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n3 6\r\n3 7\r\n3 10\r\n7 8\r\n7 9\r\n1 2 2 1 1 3 4 4 3 4\r\n1 2 2 1 1 3 4 4 3 4\r\n1 1\r\n2 3\r\n4 2\r\n2 1\r\n8 2\r\n10 3\r\n```\r\n\r\n### Example Output\r\n```\r\n38\r\n38\r\n40\r\n38\r\n42\r\n42\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK116\/hindi\/TRERMB.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK116\/mandarin\/TRERMB.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK116\/russian\/TRERMB.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK116\/vietnamese\/TRERMB.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK116\/bengali\/TRERMB.pdf) as well.\r\n\r\nChef finished inviting all of his friends. Now it is time to get a tree in his house and decorate it for the party. He wants to use the most beautiful tree ever.\r\n\r\nThe tree Chef chose has $N$ nodes (numbered $1$ through $N$) and it is rooted at node $1$. For each valid $i$, the initial colour of the $i$-th node is $C_i$ and there is a value $A_i$ written in that node. Chef calculates the *beauty* of his tree as $\\sum_{i=1}^N A_i \\cdot F_i$, where $F_i$ denotes the number of distinct colours of nodes in the subtree of the $i$-th node (including this node).\r\n\r\nNow, Chef is trying to improve the beauty of the tree \u2015 he wants to make $Q$ updates, where in each update, he chooses a node $a$ and an integer $x$ and changes the colour of the node $a$ to $x$. After each update, find the beauty of the tree. Note that the updates are permanent, i.e. they affect all subsequent updates.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $Q$.\r\n- Each of the following $N-1$ lines contains two space-separated integers $u$ and $v$ denoting an edge between nodes $u$ and $v$.\r\n- The next line contains $N$ space-separated integers $C_1, C_2, \\ldots, C_N$.\r\n- The next line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- Each of the following $Q$ lines contains two space-separated integers $a$ and $x$ describing a query.\r\n\r\n### Output\r\nFor each update, print a single line containing one integer \u2015 the beauty of the tree after this update is performed.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 2$\r\n- $1 \\le N, Q \\le 10^5$\r\n- $1 \\le A_i, C_i \\le N$ for each valid $i$\r\n- $1 \\le u, v, a, x \\le N$\r\n- the graph described on the input is a tree","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n10 6\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n3 6\r\n3 7\r\n3 10\r\n7 8\r\n7 9\r\n1 2 2 1 1 3 4 4 3 4\r\n1 2 2 1 1 3 4 4 3 4\r\n1 1\r\n2 3\r\n4 2\r\n2 1\r\n8 2\r\n10 3","output":"38\r\n38\r\n40\r\n38\r\n42\r\n42","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"ezio_26","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>ezio_26<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"13-03-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook116'>cook116<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dfs-order'>dfs-order<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ezio_26'>ezio_26<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/lowest-common-ancestor'>lowest-common-ancestor<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/prefix-sum'>prefix-sum<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tmwilliamlin'>tmwilliamlin<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/trees'>trees<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Lowest Common Ancestor","editorial_url":"https:\/\/discuss.codechef.com\/problems\/TRERMB","time":{"view_start_date":1584901802,"submit_start_date":1584901802,"visible_start_date":1584901802,"end_date":1735669800,"current":1643797986},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=TRERMB","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}