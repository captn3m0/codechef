{"category_name":"medium","status":"success","problem_code":"DISTNUM3","problem_name":"Primitive Queries","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB17\/mandarin\/DISTNUM3.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB17\/russian\/DISTNUM3.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB17\/vietnamese\/DISTNUM3.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Given a tree <b>T<\/b> consisting of <b>N<\/b>  nodes and <b>Q<\/b> queries on it. Each node <b>v<\/b> have some value <b>C<sub>v<\/sub><\/b> assigned to it. The queries can be of two types: <\/p>\n<ul>\n<li><b>1 u v<\/b> - find number of distinct numbers on path between <b>u<\/b> and <b>v<\/b> <\/li>\n<li><b>2 v y<\/b> - assign the value <b>y<\/b> to the node with index <b>v<\/b>. <\/li>\n<\/ul>\n<br \/>\n<p>All the indices in the queries are 1-based.<\/p>\n\n<h3>Input<\/h3>\n<p>The first line of input contains two integers <b>N<\/b> and <b>Q<\/b> denoting the number of elements in <b>T<\/b>, and the number of queries to be executed.<\/p>\n<p>The second line of input contains <b>N<\/b> integers denoting the assigned values <b>C<\/b> to <b>T<\/b>. <\/p>\n<p>Each of the next <b>N - 1<\/b> lines contains two integers<b>u<\/b> and <b>v<\/b> nodes which connected by edge.<\/p>\n<p>Each of the next <b>Q<\/b> lines contains one query. All the numbers in input are integers. <\/p>\n\n<h3>Output<\/h3>\n<p>For each query of <b>type 1<\/b>, output the answer to the query in a single line.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>N, Q<\/b> \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>0<\/b> \u2264 <b>C<\/b><sub>i<\/sub>, <b>y<\/b> \u2264 <b>10<sup>9<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>u, v <\/b> \u2264 <b>N<\/b><\/li>\n<\/ul>\n\n\n<h3>Subtasks<\/h3>\n<ul>\n <li><b>Subtask 1:<\/b> <b>Q<\/b>x<b>N <\/b>\u2264 2*10<sup>7<\/sup>,  <b>Points - 23, TL = 2 sec<\/b><\/li>\n <li><b>Subtask 2:<\/b> Original constraints. <b>Points - 77, TL = 6 sec<\/b><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n6 7\n1 2 3 4 5 6\n1 2\n1 3\n2 4\n2 5\n3 6\n1 5 6\n2 5 6\n1 1 5\n1 5 6\n2 1 6\n1 5 6\n1 2 6\n\n<b>Output:<\/b>\n5\n3\n4\n3\n3\n<\/pre>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"2 - 6","source_sizelimit":"50000","problem_author":"mgch","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>mgch<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"24-05-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/mgch'>\n                    mgch\n                <\/a>","user":{"username":null},"time":{"view_start_date":1487496600,"submit_start_date":1487496600,"visible_start_date":1487496600,"end_date":1735669800,"current":1493557918},"todo":false,"problem_status":"unattempted"}