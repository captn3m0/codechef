{"category_name":"medium","status":"success","problem_code":"ATWNT","problem_name":"Another Tree with Number Theory","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/FEB21\/hindi\/ATWNT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/FEB21\/bengali\/ATWNT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/mandarin\/ATWNT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/FEB21\/russian\/ATWNT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/vietnamese\/ATWNT.pdf) as well.\r\n\r\nYou are given a rooted tree with $N$ nodes (numbered $1$ through $N$; node $1$ is the root). For each $i$ ($1 \\le i \\le N-1$), the parent of the node $i+1$ is $p_i$.\r\n\r\nYou need to answer $Q$ queries. (Sounds quite familiar!) For each query, first, $W$ tasks are given to node $V$. These tasks are processed in the tree in the following way:\r\n- When a node receives $a$ tasks and it has no children, all $a$ tasks are executed by this node.\r\n- Otherwise, i.e. if the node has $K \\gt 0$ children, where $K$ is a divisor of $a$, then this node gives $a\/K$ of these tasks to each of its children. This process is performed recursively by each child on the tasks it receives.\r\n- Otherwise, i.e. if the node has $K \\gt 0$ children, but $K$ is not a divisor of $a$, all $a$ tasks are ignored and none of this node's children receive any tasks.\r\n\r\nFor each query, find the number of tasks that are not executed, i.e. end up ignored, possibly after passing down the tree.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $N$.\r\n- The second line contains $N-1$ space-separated integers $p_1, p_2, \\ldots, p_{N-1}$.\r\n- The third line contains a single integer $Q$.\r\n- $Q$ lines follow. Each of these lines contains two space-separated integers $V$ and $W$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the number of tasks that are not executed.\r\n\r\n### Constraints\r\n- $1 \\leq N, Q \\leq 10^5$\r\n- $1 \\le p_i \\le N$ for each valid $i$\r\n- the graph described on the input is a tree\r\n- $1 \\leq V \\leq N$\r\n- $1 \\leq W \\leq 10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points):** $N \\leq 100$\r\n\r\n**Subtask #2 (80 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n5\r\n1 1 2 2\r\n2\r\n1 10\r\n1 20\r\n```\r\n\r\n### Example Output\r\n```\r\n5\r\n0\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/FEB21\/hindi\/ATWNT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/FEB21\/bengali\/ATWNT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/mandarin\/ATWNT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/FEB21\/russian\/ATWNT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/vietnamese\/ATWNT.pdf) as well.\r\n\r\nYou are given a rooted tree with $N$ nodes (numbered $1$ through $N$; node $1$ is the root). For each $i$ ($1 \\le i \\le N-1$), the parent of the node $i+1$ is $p_i$.\r\n\r\nYou need to answer $Q$ queries. (Sounds quite familiar!) For each query, first, $W$ tasks are given to node $V$. These tasks are processed in the tree in the following way:\r\n- When a node receives $a$ tasks and it has no children, all $a$ tasks are executed by this node.\r\n- Otherwise, i.e. if the node has $K \\gt 0$ children, where $K$ is a divisor of $a$, then this node gives $a\/K$ of these tasks to each of its children. This process is performed recursively by each child on the tasks it receives.\r\n- Otherwise, i.e. if the node has $K \\gt 0$ children, but $K$ is not a divisor of $a$, all $a$ tasks are ignored and none of this node's children receive any tasks.\r\n\r\nFor each query, find the number of tasks that are not executed, i.e. end up ignored, possibly after passing down the tree.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $N$.\r\n- The second line contains $N-1$ space-separated integers $p_1, p_2, \\ldots, p_{N-1}$.\r\n- The third line contains a single integer $Q$.\r\n- $Q$ lines follow. Each of these lines contains two space-separated integers $V$ and $W$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the number of tasks that are not executed.\r\n\r\n### Constraints\r\n- $1 \\leq N, Q \\leq 10^5$\r\n- $1 \\le p_i \\le N$ for each valid $i$\r\n- the graph described on the input is a tree\r\n- $1 \\leq V \\leq N$\r\n- $1 \\leq W \\leq 10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points):** $N \\leq 100$\r\n\r\n**Subtask #2 (80 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"5\r\n1 1 2 2\r\n2\r\n1 10\r\n1 20","output":"5\r\n0","explanation":"","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/EvQo8UNGM8E","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"dimash241","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>dimash241<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"29-12-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/depth-first-search'>depth-first-search<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dimash241'>dimash241<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/feb21'>feb21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/graphs'>graphs<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sieve'>sieve<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/trees'>trees<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/vichitr'>vichitr<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Depth First Search","editorial_url":"https:\/\/discuss.codechef.com\/problems\/ATWNT","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797919},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=ATWNT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}