{"category_name":"medium","status":"success","problem_code":"QTRAGAIN","problem_name":"Queries on tree again","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>You have a rooted tree with <b>N<\/b> nodes which are numbered from 1 to <b>N<\/b>. It is rooted at node 1. Each node has a value associated with it, which is 0 initially. The distance between two nodes is the number of edges in the unique path between them. You need to support the following two operations:<\/p>\n\n<ul>\n<li>Update operation at node <b>x<\/b> with value <b>y<\/b>:\n\t<ul>\n\t\t<li>Add 2<sup><b>y<\/b><\/sup> to node <b>x<\/b>.<\/li>\n\t\t<li>Consider every node in the subtree of <b>x<\/b>, and suppose d is distance from <b>x<\/b> to the node. If <b>y<\/b> - d \u2265 0, add 2<sup>(<b>y<\/b> - d)<\/sup> to the value associated with that node.<\/li>\n\t\t<li>Consider all the ancestors of <b>x<\/b>, and suppose d is distance from <b>x<\/b> to the ancestor. If <b>y<\/b> - d \u2265 0, add 2<sup>(<b>y<\/b> - d)<\/sup> to the value associated with that ancestor.<\/li>\n\t<\/ul>\n<\/li>\n<li>Query operation at node <b>x<\/b>:\n       <ul>\n\t<li>Output the current value associated with node <b>x<\/b>, modulo 10<sup>9<\/sup> + 7.<\/li>\n        <\/ul>\n<\/li>\n<\/ul>\n\n<h3>Input<\/h3>\n<ul>\n<li>The first line of the input contains a single integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/li>\n\n<li>The first line of each test case contains two space-separated integers <b>N, Q<\/b> denoting the number of nodes, and the number of operations respectively. <\/li>\n<li>Each of the next <b>N<\/b> - 1 lines contains two space-separated integers: <b>u<\/b>, <b>v<\/b>, denoting that there is an edge between nodes <b>u<\/b> and <b>v<\/b> in the tree.<\/li>\n<li>Each of the next <b>Q<\/b> lines contain description of an operation, which will be of one of these formats: \n\t<ul>\n\t\t<li>Update operation: You will be given three space-separated integers: 1, <b>x<\/b>, <b>y<\/b>. <\/li>\n\t\t<li>Query operation: You will be given two space-separated integers: 2, <b>x<\/b>. <\/li>\n\t<\/ul>\n<\/li>\n<\/ul>\n\n<h3>Output<\/h3>\n<p>For each Query operation, output a single integer in a new line corresponding to the answer of the query.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>T<\/b> \u2264 10<sup>6<\/sup><\/li>\n<li>1 \u2264 <b>N<\/b> \u2264 10<sup>5<\/sup><\/li>\n<li>1 \u2264 <b>Q<\/b> \u2264 1.5 * 10<sup>6<\/sup><\/li>\n<li>1 \u2264 <b>u<\/b>, <b>v<\/b>, <b>x<\/b> \u2264 <b>N<\/b><\/li>\n<li>1 \u2264 <b>y<\/b> \u2264 60<\/li>\n<li>Sum of <b>N<\/b> over all test cases in a single file \u2264 10<sup>6<\/sup><\/li>\n<li>Sum of <b>Q<\/b> over all test cases in a single file \u2264 1.5 * 10<sup>6<\/sup><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre>\n<b>Input<\/b>\n1\n4 8\n1 2\n2 3\n2 4\n1 1 2\n1 2 3\n1 3 1\n1 4 2\n2 1\n2 2\n2 3\n2 4\n\n<b>Output<\/b>\n9\n13\n7\n9\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>Let the values associated with the nodes be v<sub>1<\/sub>, v<sub>2<\/sub>, v<sub>3<\/sub>, and v<sub>4<\/sub>.<\/p>\n<ul>\n<li>Initially, v<sub>1<\/sub> = 0, v<sub>2<\/sub>= 0, v<sub>3<\/sub> = 0, and v<sub>4<\/sub> = 0<\/li>\n\n<li>After first update operation, v<sub>1<\/sub> = 4, v<sub>2<\/sub>= 2, v<sub>3<\/sub> = 1, and v<sub>4<\/sub> = 1<\/li>\n\n<li>After second update operation, v<sub>1<\/sub> = 4 + 4, v<sub>2<\/sub>= 2 + 8, v<sub>3<\/sub> = 1 + 4, and v<sub>4<\/sub> = 1 + 4<\/li>\n\n<li>After third update operation, v<sub>1<\/sub> = 4 + 4, v<sub>2<\/sub>= 2 + 8 + 1, v<sub>3<\/sub> = 1 + 4 + 2, and v<sub>4<\/sub> = 1 + 4<\/li>\n\n<li>After fourth update operation, v<sub>1<\/sub> = 4 + 4 + 1, v<sub>2<\/sub>= 2 + 8 + 1 + 2, v<sub>3<\/sub> = 1 + 4 + 2, and v<sub>4<\/sub> = 1 + 4 + 4<\/li>\n<\/ul>\n<\/p>\n\n<p>So after this, we have v<sub>1<\/sub> = 9, v<sub>2<\/sub> = 13, v<sub>3<\/sub> = 7, and v<sub>4<\/sub> = 9, and this is outputted in the following query operations.<\/p>","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY","max_timelimit":"3","source_sizelimit":"50000","problem_author":"admin2","problem_author_html_handle":"admin2","problem_tester":null,"problem_tester_html_handle":"","date_added":"25-11-2017","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/admin2'>admin2<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/data-structure'>data-structure<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/gwr17rol'>gwr17rol<\/a>","time":{"view_start_date":1516482000,"submit_start_date":1516482000,"visible_start_date":1516482000,"end_date":1735669800,"current":1525454400},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}