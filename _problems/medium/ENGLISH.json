{"category_name":"medium","status":"success","problem_code":"ENGLISH","problem_name":"English","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN20\/hindi\/ENGLISH.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN20\/bengali\/ENGLISH.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/mandarin\/ENGLISH.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN20\/russian\/ENGLISH.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/vietnamese\/ENGLISH.pdf) as well.\r\n\r\nChef is learning English. So far, he knows $N$ words, and he wants to write a verse.\r\n\r\nLet's call a pair of English words a *stanza*. A *verse* is a list of stanzas. The *prefixal rhyme* of a stanza is the longest common prefix of the words in it. Similarly, the *suffixal rhyme* of a stanza is the longest common suffix of the words in it. The *beauty* of a stanza whose prefixal and suffixal rhymes have lengths $l_p$ and $l_s$ respectively is $\\mathrm{min}(l_p, l_s)^2$.\r\n\r\nFor example, a stanza formed by the words \"abcdefghijkl\" and \"abcxyzhijkl\" has a prefixal rhyme \"abc\" (with length $3$), suffixal rhyme \"hijkl\" (with length $5$) and beauty $\\mathrm{min}(3,5)^2 = 3^2 = 9$.\r\n\r\nThe beauty of a verse is the sum of beauties of all its stanzas. For example, the beauty of the verse ((\"abcdefghijkl\", \"abcxyzhijkl\"), (\"world\", \"word\"), (\"code\", \"chef\")) is $9+1+0=10$.\r\n\r\nYou are given $N$ words $W_1, W_2, \\ldots, W_N$ (they are not necessarily distinct). Help Chef write the most beautiful verse. It is not necessary to use all the words, but each word may be used at most once in the whole verse (more precisely, each element of the sequence $W$ may be used only once, but if some word appears $k$ times in $W$, we can use it up to $k$ times).\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- $N$ lines follow. For each $i$ ($1 \\le i \\le N$), the $i$-th of these lines contains a single string $W_i$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the greatest possible beauty of Chef's verse.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10^5$\r\n- $1 \\le N \\le 10^5$\r\n- $1 \\le |W_i| \\le 10^5$ for each valid $i$\r\n- all words contain only lowercase English letters\r\n- the sum of $|W_1|+|W_2|+\\ldots+|W_N|$ over all test cases does not exceed $10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** all words are palindromes\r\n\r\n**Subtask #2 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n3\r\n6\r\nabcdefghijkl\r\nchef\r\nworld\r\ncode\r\nabcxyzhijkl\r\nword\r\n4\r\nproblem\r\npoem\r\nproblem\r\nproblem\r\n3\r\ncontest\r\ncoolest\r\nunused\r\n```\r\n\r\n### Example Output\r\n```\r\n10\r\n50\r\n4\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** The best verse is ((\"abcdefghijkl\", \"abcxyzhijkl\"), (\"world\", \"word\"), (\"code\", \"chef\")), which was described above.\r\n\r\n**Example case 2:** The best verse is ((\"problem\", \"problem\"), (\"problem\", \"poem\")). Its beauty is $7^2+1^2 = 49+1 = 50$. Note that we have three copies of the word \"problem\", so we can use it three times.\r\n\r\n**Example case 3:** The best verse is ((\"coolest\", \"contest\")), which contains only one stanza. Its beauty is $2^2=4$. Note that it is not necessary to use all the words \u2015 the word \"unused\" is left unused.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN20\/hindi\/ENGLISH.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN20\/bengali\/ENGLISH.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/mandarin\/ENGLISH.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN20\/russian\/ENGLISH.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/vietnamese\/ENGLISH.pdf) as well.\r\n\r\nChef is learning English. So far, he knows $N$ words, and he wants to write a verse.\r\n\r\nLet's call a pair of English words a *stanza*. A *verse* is a list of stanzas. The *prefixal rhyme* of a stanza is the longest common prefix of the words in it. Similarly, the *suffixal rhyme* of a stanza is the longest common suffix of the words in it. The *beauty* of a stanza whose prefixal and suffixal rhymes have lengths $l_p$ and $l_s$ respectively is $\\mathrm{min}(l_p, l_s)^2$.\r\n\r\nFor example, a stanza formed by the words \"abcdefghijkl\" and \"abcxyzhijkl\" has a prefixal rhyme \"abc\" (with length $3$), suffixal rhyme \"hijkl\" (with length $5$) and beauty $\\mathrm{min}(3,5)^2 = 3^2 = 9$.\r\n\r\nThe beauty of a verse is the sum of beauties of all its stanzas. For example, the beauty of the verse ((\"abcdefghijkl\", \"abcxyzhijkl\"), (\"world\", \"word\"), (\"code\", \"chef\")) is $9+1+0=10$.\r\n\r\nYou are given $N$ words $W_1, W_2, \\ldots, W_N$ (they are not necessarily distinct). Help Chef write the most beautiful verse. It is not necessary to use all the words, but each word may be used at most once in the whole verse (more precisely, each element of the sequence $W$ may be used only once, but if some word appears $k$ times in $W$, we can use it up to $k$ times).\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- $N$ lines follow. For each $i$ ($1 \\le i \\le N$), the $i$-th of these lines contains a single string $W_i$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the greatest possible beauty of Chef's verse.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10^5$\r\n- $1 \\le N \\le 10^5$\r\n- $1 \\le |W_i| \\le 10^5$ for each valid $i$\r\n- all words contain only lowercase English letters\r\n- the sum of $|W_1|+|W_2|+\\ldots+|W_N|$ over all test cases does not exceed $10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** all words are palindromes\r\n\r\n**Subtask #2 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3\r\n6\r\nabcdefghijkl\r\nchef\r\nworld\r\ncode\r\nabcxyzhijkl\r\nword\r\n4\r\nproblem\r\npoem\r\nproblem\r\nproblem\r\n3\r\ncontest\r\ncoolest\r\nunused","output":"10\r\n50\r\n4","explanation":"**Example case 1:** The best verse is ((\"abcdefghijkl\", \"abcxyzhijkl\"), (\"world\", \"word\"), (\"code\", \"chef\")), which was described above.\r\n\r\n**Example case 2:** The best verse is ((\"problem\", \"problem\"), (\"problem\", \"poem\")). Its beauty is $7^2+1^2 = 49+1 = 50$. Note that we have three copies of the word \"problem\", so we can use it three times.\r\n\r\n**Example case 3:** The best verse is ((\"coolest\", \"contest\")), which contains only one stanza. Its beauty is $2^2=4$. Note that it is not necessary to use all the words ? the word \"unused\" is left unused.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"vladprog","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>vladprog<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"4-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/hashing'>hashing<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jan20'>jan20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/observation'>observation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/trie'>trie<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/vijju123'>vijju123<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/vladprog'>vladprog<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/vladprog'>vladprog<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/ENGLISH","time":{"view_start_date":1578907800,"submit_start_date":1578907800,"visible_start_date":1578907800,"end_date":1735669800,"current":1643797940},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=ENGLISH","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}