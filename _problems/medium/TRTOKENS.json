{"category_name":"medium","status":"success","problem_code":"TRTOKENS","problem_name":"Tokens On A Tree","body":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME96\/bengali\/TRTOKENS.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME96\/mandarin\/TRTOKENS.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME96\/russian\/TRTOKENS.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME96\/vietnamese\/TRTOKENS.pdf) as well.\r\n\r\nYou are given a rooted tree with $N$ nodes numbered $1, 2, \\ldots, N$. Node $1$ is the root node. Some of the nodes have a token in them. In one move, you can choose a non-root node that has a token, but its parent doesn't, and move the token from this node to its parent. What is the maximum number of moves you can make?\r\n\r\n**Note:** When a token is moved out of a node, the node becomes empty, and other tokens will be able to move there.\r\n\r\n###Input\r\n\r\n- The first line contains an integer $T$, the number of test cases. Each test case contains three lines.\r\n- The first line of each test case contains an integer $N$, the number of nodes in the tree.\r\n- The second line contains a string $s$ of length $N$. The character $s_i$ is $1$ if node has a token, and $0$ otherwise.\r\n- The third line contains $N - 1$ space separated integers, $p_2, p_3, \\ldots p_N$, where $p_i$ is the parent of node $i$.\r\n\r\n###Output\r\nFor each test case, print the maximum number of moves that can be made on a new line.\r\n\r\n###Constraints \r\n- $1 \\le N\\le 10^6$\r\n- For each valid $i$,  $1\\le p_i < i$.\r\n- The sum of $N$ over all test cases doesn't exceed $10^6$.\r\n\r\n###Subtasks\r\n- **Subtask 1 (13 points)**: $T \\le 10, N \\le 17$.\r\n- **Subtask 2 (18 points)**: The sum of $N$ over all test cases doesn't exceed $2000$.\r\n- **Subtask 3 (41 points)**: The sum of $N$ over all test cases doesn't exceed $10^5$.\r\n- **Subtask 4 (28 points)**: No additional constraints.\r\n\r\n###Sample Input\r\n```\r\n2\r\n5\r\n01010\r\n1 1 3 3\r\n5\r\n10101\r\n1 1 3 3\r\n```\r\n\r\n###Sample Output\r\n```\r\n2\r\n0\r\n```\r\n\t\r\n###Explanation\r\nIn the first test case, you can first move a token from node $4$ to node $3$, and then move a token from node $2$ to node $1$.\r\n\r\nIn the second test case, there are no possible valid moves.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME96\/bengali\/TRTOKENS.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME96\/mandarin\/TRTOKENS.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME96\/russian\/TRTOKENS.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME96\/vietnamese\/TRTOKENS.pdf) as well.\r\n\r\nYou are given a rooted tree with $N$ nodes numbered $1, 2, \\ldots, N$. Node $1$ is the root node. Some of the nodes have a token in them. In one move, you can choose a non-root node that has a token, but its parent doesn't, and move the token from this node to its parent. What is the maximum number of moves you can make?\r\n\r\n**Note:** When a token is moved out of a node, the node becomes empty, and other tokens will be able to move there.\r\n\r\n###Input\r\n\r\n- The first line contains an integer $T$, the number of test cases. Each test case contains three lines.\r\n- The first line of each test case contains an integer $N$, the number of nodes in the tree.\r\n- The second line contains a string $s$ of length $N$. The character $s_i$ is $1$ if node has a token, and $0$ otherwise.\r\n- The third line contains $N - 1$ space separated integers, $p_2, p_3, \\ldots p_N$, where $p_i$ is the parent of node $i$.\r\n\r\n###Output\r\nFor each test case, print the maximum number of moves that can be made on a new line.\r\n\r\n###Constraints \r\n- $1 \\le N\\le 10^6$\r\n- For each valid $i$,  $1\\le p_i < i$.\r\n- The sum of $N$ over all test cases doesn't exceed $10^6$.\r\n\r\n###Subtasks\r\n- **Subtask 1 (13 points)**: $T \\le 10, N \\le 17$.\r\n- **Subtask 2 (18 points)**: The sum of $N$ over all test cases doesn't exceed $2000$.\r\n- **Subtask 3 (41 points)**: The sum of $N$ over all test cases doesn't exceed $10^5$.\r\n- **Subtask 4 (28 points)**: No additional constraints.","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n5\r\n01010\r\n1 1 3 3\r\n5\r\n10101\r\n1 1 3 3","output":"2\r\n0","explanation":"In the first test case, you can first move a token from node $4$ to node $3$, and then move a token from node $2$ to node $1$.\r\n\r\nIn the second test case, there are no possible valid moves.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"jtnydv25","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>jtnydv25<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"27-05-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/depth-first-search'>depth-first-search<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/eulerian-tour'>eulerian-tour<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jtnydv25'>jtnydv25<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime96'>ltime96<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/trees'>trees<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Segment Tree","editorial_url":"https:\/\/discuss.codechef.com\/problems\/TRTOKENS","time":{"view_start_date":1622482204,"submit_start_date":1622482204,"visible_start_date":1622482204,"end_date":1735669800,"current":1643797985},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=TRTOKENS","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}