{"category_name":"medium","status":"success","problem_code":"MGICMENU","problem_name":"Magical Menu","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK108\/hindi\/MGICMENU.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK108\/mandarin\/MGICMENU.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK108\/russian\/MGICMENU.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK108\/vietnamese\/MGICMENU.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK108\/bengali\/MGICMENU.pdf) as well.\n\nIn Chefland, there are $M$ types of cookies, numbered $1$ through $M$. There is an infinite supply of cookies of each type. \n\nEach morning, the Master Chef of Chefland prepares a menu \u2014 a sequence of cookies. There may be multiple cookies with identical types in a menu. Two menus are considered different if the total number of cookies in one menu is different from their total number in the other menu or there is a valid index $x$ such that the type of the $x$-th cookie in one menu is different from the type of the $x$-th cookie in the other menu. For example, menus $(1, 2, 1)$, $(1, 2, 1, 2)$ are different, and $(1, 1, 2, 3)$, $(1, 2, 1, 3)$ are also different.\n\nTo make things interesting, each morning, Master Chef receives three integers $L$, $R$ and $K$. To prepare a menu on that morning, he may use a cookie of type $x$ only if $L \\le x \\le R$ and he may not use more than $K$ cookies in total in this menu. For example, when $L = 3$, $R = 5$ and $K = 4$, then $(5, 4, 3, 5)$ and $(3, 5, 5)$ are possible menus, while $(5, 4, 3, 5, 4)$ and $(3, 5, 6)$ are not.\n\nMoreover, a menu becomes *special* only if there is no integer $x \\gt 1$ that divides the type of each cookie in the menu, i.e. a menu $S = (s_1, s_2, \\ldots, s_n)$ is special if $\\mathrm{gcd}\\,(s_1, s_2, \\ldots, s_n) = 1$.\n\nYou should process $Q$ queries. In each query, you are given the parameters $L$, $R$ and $K$ for one morning. Master Chef wonders how many different special menus are possible. Can you help him calculate the number of possible special menus on each morning modulo $2^{30}$?\n\n### Input\n- The first line of the input contains two space-separated integers $M$ and $Q$.\n- Each of the next $Q$ lines contains three space-separated integers $L$, $R$ and $K$ describing a query.\n\n### Output\nFor each query, print a single line containing one integer \u2014 the number of possible special menus modulo $2^{30}$.\n\n### Constraints \n- $1 \\le M \\le 10^5$\n- $1 \\le Q \\le 10,000$\n- $1 \\le L \\le R \\le M$\n- $1 \\le K \\le 10^9$\n\n### Example Input\n```\n5 3\n3 4 3\n2 2 7\n3 5 7\n```\n\n### Example Output\n```\n8   \n0   \n3258\n```\n\n### Explanation\nThe eight possible menus for the first morning (first query) are $(3, 4)$, $(4, 3)$, $(3, 3, 4)$, $(3, 4, 3)$, $(3, 4, 4)$, $(4, 3, 4)$, $(4, 3, 3)$, $(4, 4, 3)$.\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK108\/hindi\/MGICMENU.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK108\/mandarin\/MGICMENU.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK108\/russian\/MGICMENU.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK108\/vietnamese\/MGICMENU.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK108\/bengali\/MGICMENU.pdf) as well.\n\nIn Chefland, there are $M$ types of cookies, numbered $1$ through $M$. There is an infinite supply of cookies of each type. \n\nEach morning, the Master Chef of Chefland prepares a menu \u2014 a sequence of cookies. There may be multiple cookies with identical types in a menu. Two menus are considered different if the total number of cookies in one menu is different from their total number in the other menu or there is a valid index $x$ such that the type of the $x$-th cookie in one menu is different from the type of the $x$-th cookie in the other menu. For example, menus $(1, 2, 1)$, $(1, 2, 1, 2)$ are different, and $(1, 1, 2, 3)$, $(1, 2, 1, 3)$ are also different.\n\nTo make things interesting, each morning, Master Chef receives three integers $L$, $R$ and $K$. To prepare a menu on that morning, he may use a cookie of type $x$ only if $L \\le x \\le R$ and he may not use more than $K$ cookies in total in this menu. For example, when $L = 3$, $R = 5$ and $K = 4$, then $(5, 4, 3, 5)$ and $(3, 5, 5)$ are possible menus, while $(5, 4, 3, 5, 4)$ and $(3, 5, 6)$ are not.\n\nMoreover, a menu becomes *special* only if there is no integer $x \\gt 1$ that divides the type of each cookie in the menu, i.e. a menu $S = (s_1, s_2, \\ldots, s_n)$ is special if $\\mathrm{gcd}\\,(s_1, s_2, \\ldots, s_n) = 1$.\n\nYou should process $Q$ queries. In each query, you are given the parameters $L$, $R$ and $K$ for one morning. Master Chef wonders how many different special menus are possible. Can you help him calculate the number of possible special menus on each morning modulo $2^{30}$?\n\n### Input\n- The first line of the input contains two space-separated integers $M$ and $Q$.\n- Each of the next $Q$ lines contains three space-separated integers $L$, $R$ and $K$ describing a query.\n\n### Output\nFor each query, print a single line containing one integer \u2014 the number of possible special menus modulo $2^{30}$.\n\n### Constraints \n- $1 \\le M \\le 10^5$\n- $1 \\le Q \\le 10,000$\n- $1 \\le L \\le R \\le M$\n- $1 \\le K \\le 10^9$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"5 3\n3 4 3\n2 2 7\n3 5 7","output":"8   \n0   \n3258","explanation":"The eight possible menus for the first morning (first query) are $(3, 4)$, $(4, 3)$, $(3, 3, 4)$, $(3, 4, 3)$, $(3, 4, 4)$, $(4, 3, 4)$, $(4, 3, 3)$, $(4, 4, 3)$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"imanik","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>imanik<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"12-07-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook108'>cook108<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/divide-and-conquer'>divide-and-conquer<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/imanik'>imanik<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/inclusion-exclusion'>inclusion-exclusion<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/mobius-inveresion'>mobius-inveresion<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/prefix-sum'>prefix-sum<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Divide And Conquer","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MGICMENU","time":{"view_start_date":1563733802,"submit_start_date":1563733802,"visible_start_date":1563733802,"end_date":1735669800,"current":1643797959},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=MGICMENU","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}