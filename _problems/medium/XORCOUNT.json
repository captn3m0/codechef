{"category_name":"medium","status":"success","problem_code":"XORCOUNT","problem_name":"Xor Counting","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK124\/hindi\/XORCOUNT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK124\/mandarin\/XORCOUNT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK124\/russian\/XORCOUNT.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK124\/vietnamese\/XORCOUNT.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK124\/bengali\/XORCOUNT.pdf) as well.\r\n\r\nFind the number of sequences with $K$ elements which satisfy the following conditions:\r\n- Each element is an integer between $L$ and $R$ inclusive.\r\n- The bitwise XOR of all elements is between $A$ and $B$ inclusive.\r\n  \r\nSince the number of sequences satisfying the given conditions can be quite large, compute it modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains five space-separated integers $L$, $R$, $A$, $B$ and $K$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2014 the number of valid sequences modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10$\r\n- $0 \\le L \\le R \\lt 2^{60}$\r\n- $0 \\le A \\le B \\lt 2^{60}$\r\n- $1 \\le K \\le 50$\r\n\r\n### Example Input\r\n```\r\n3\r\n26 54 18 34 1\r\n3 5 4 7 2\r\n2 9 0 100 3\r\n```\r\n\r\n### Example Output\r\n```\r\n9\r\n4\r\n512\r\n```\r\n\r\n###EXPLANATION:\r\nIn the first testcase, we have to choose one integer in $[26, 54] \\cap [18, 34] = [26, 34]$. So, there are 9 ways.\r\n\r\nIn the second testcase, we have to choose two integers in $[3, 5]$ with bitwise xor in $[4, 7]$. There are 4 possible ways:\r\n- $3 \\oplus 4= 7$\r\n- $3 \\oplus 5 = 6$\r\n- $4 \\oplus 3 = 7$\r\n- $5 \\oplus 3 = 6$.\r\n\r\nIn the third testcase all $8^3$ possible sequences are valid, hence the answer is $512$.\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK124\/hindi\/XORCOUNT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK124\/mandarin\/XORCOUNT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK124\/russian\/XORCOUNT.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK124\/vietnamese\/XORCOUNT.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK124\/bengali\/XORCOUNT.pdf) as well.\r\n\r\nFind the number of sequences with $K$ elements which satisfy the following conditions:\r\n- Each element is an integer between $L$ and $R$ inclusive.\r\n- The bitwise XOR of all elements is between $A$ and $B$ inclusive.\r\n  \r\nSince the number of sequences satisfying the given conditions can be quite large, compute it modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains five space-separated integers $L$, $R$, $A$, $B$ and $K$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2014 the number of valid sequences modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10$\r\n- $0 \\le L \\le R \\lt 2^{60}$\r\n- $0 \\le A \\le B \\lt 2^{60}$\r\n- $1 \\le K \\le 50$\r\n\r\n### Example Input\r\n```\r\n3\r\n26 54 18 34 1\r\n3 5 4 7 2\r\n2 9 0 100 3\r\n```\r\n\r\n### Example Output\r\n```\r\n9\r\n4\r\n512\r\n```\r\n\r\n###EXPLANATION:\r\nIn the first testcase, we have to choose one integer in $[26, 54] \\cap [18, 34] = [26, 34]$. So, there are 9 ways.\r\n\r\nIn the second testcase, we have to choose two integers in $[3, 5]$ with bitwise xor in $[4, 7]$. There are 4 possible ways:\r\n- $3 \\oplus 4= 7$\r\n- $3 \\oplus 5 = 6$\r\n- $4 \\oplus 3 = 7$\r\n- $5 \\oplus 3 = 6$.\r\n\r\nIn the third testcase all $8^3$ possible sequences are valid, hence the answer is $512$.","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"https:\/\/youtu.be\/uwVCqapaRbU","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"nishant403","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>nishant403<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"8-04-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/cook124'>cook124<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nishant403'>nishant403<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/XORCOUNT","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797989},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=XORCOUNT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}