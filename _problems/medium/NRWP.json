{"category_name":"medium","status":"success","problem_code":"NRWP","problem_name":"Not a Real World Problem","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MAY20\/hindi\/NRWP.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MAY20\/bengali\/NRWP.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/mandarin\/NRWP.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MAY20\/russian\/NRWP.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/vietnamese\/NRWP.pdf) as well.\r\n\r\nConsider a grid with $H$ rows (numbered $1$ through $H$) and $W$ columns (numbered $1$ through $W$). Let's denote the value in a cell in row $i$ and column $j$ by $h_{i,j}$. $N$ particles (numbered $1$ through $N$) are distributed in the cells in such a way that there is at most one particle in each cell. For each valid $i$, the $i$-th particle has a value $p_i$ and it is placed in the cell in row $y_i$ and column $x_i$.\r\n\r\nLet's denote the set of all particles by $P$ and the set of all unordered pairs of particles that are located in side-adjacent cells by $E$. We define the value of the grid as\r\n$$V = \\sum_{i \\in P} p_i \\cdot h_{y_i,x_i} + \\sum_{(i,j) \\in E} p_i \\cdot p_j \\,.$$\r\n\r\nYou are given the grid and the locations of all particles, but not their exact values \u2015 only $\\lvert p_1 \\rvert, \\lvert p_2 \\rvert, \\ldots, \\lvert p_N \\rvert$. Your task is to choose the sign of each value $p_i$ in such a way that the value $V$ is maximum possible. Each sign may be chosen independently from all other signs.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains three space-separated integers $H$, $W$ and $N$.\r\n- $H$ lines follow. For each valid $i$, the $i$-th of these lines contains $W$ space-separated integers $h_{i,1}, h_{i,2}, \\ldots, h_{i,W}$.\r\n- $N$ more lines follow. For each valid $i$, the $i$-th of these lines contains three space-separated integers $y_i$, $x_i$ and $\\lvert p_i \\rvert$.\r\n\r\n### Output\r\nFor each test case, print two lines.\r\n- The first of these lines should contain a single integer \u2015 the maximum value of $V$.\r\n- The second line should contain $N$ space-separated integers. For each valid $i$, the $i$-th of these integers should be $1$ if you choose a positive sign for the value of the $i$-th particle (i.e. its value should be $\\lvert p_i \\rvert$) or $-1$ if you choose a negative sign (i.e. its value should be $-\\lvert p_i \\rvert$).\r\n\r\nIf there are multiple solutions, you may find any one.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10$\r\n- $1 \\le H, W \\le 1,000$\r\n- $1 \\le N \\le 200$\r\n- $\\lvert h_{i,j} \\rvert \\le 1,000$ for each valid $i, j$\r\n- $1 \\le y_i \\le H$ for each valid $i$\r\n- $1 \\le x_i \\le W$ for each valid $i$\r\n- $\\lvert p_i \\rvert \\le 100$ for each valid $i$\r\n- no two particles are located in the same cell\r\n- the sum of $H \\cdot W$ over all test cases does not exceed $10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** $N \\le 15$\r\n\r\n**Subtask #2 (20 points):** $H \\le 2$\r\n\r\n**Subtask #3 (70 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n1\r\n2 2 3\r\n1 4\r\n-1 -2\r\n1 1 3\r\n1 2 1\r\n2 2 2\r\n```\r\n\r\n### Example Output\r\n```\r\n12\r\n1 1 -1\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MAY20\/hindi\/NRWP.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MAY20\/bengali\/NRWP.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/mandarin\/NRWP.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MAY20\/russian\/NRWP.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/vietnamese\/NRWP.pdf) as well.\r\n\r\nConsider a grid with $H$ rows (numbered $1$ through $H$) and $W$ columns (numbered $1$ through $W$). Let's denote the value in a cell in row $i$ and column $j$ by $h_{i,j}$. $N$ particles (numbered $1$ through $N$) are distributed in the cells in such a way that there is at most one particle in each cell. For each valid $i$, the $i$-th particle has a value $p_i$ and it is placed in the cell in row $y_i$ and column $x_i$.\r\n\r\nLet's denote the set of all particles by $P$ and the set of all unordered pairs of particles that are located in side-adjacent cells by $E$. We define the value of the grid as\r\n$$V = \\sum_{i \\in P} p_i \\cdot h_{y_i,x_i} + \\sum_{(i,j) \\in E} p_i \\cdot p_j \\,.$$\r\n\r\nYou are given the grid and the locations of all particles, but not their exact values \u2015 only $\\lvert p_1 \\rvert, \\lvert p_2 \\rvert, \\ldots, \\lvert p_N \\rvert$. Your task is to choose the sign of each value $p_i$ in such a way that the value $V$ is maximum possible. Each sign may be chosen independently from all other signs.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains three space-separated integers $H$, $W$ and $N$.\r\n- $H$ lines follow. For each valid $i$, the $i$-th of these lines contains $W$ space-separated integers $h_{i,1}, h_{i,2}, \\ldots, h_{i,W}$.\r\n- $N$ more lines follow. For each valid $i$, the $i$-th of these lines contains three space-separated integers $y_i$, $x_i$ and $\\lvert p_i \\rvert$.\r\n\r\n### Output\r\nFor each test case, print two lines.\r\n- The first of these lines should contain a single integer \u2015 the maximum value of $V$.\r\n- The second line should contain $N$ space-separated integers. For each valid $i$, the $i$-th of these integers should be $1$ if you choose a positive sign for the value of the $i$-th particle (i.e. its value should be $\\lvert p_i \\rvert$) or $-1$ if you choose a negative sign (i.e. its value should be $-\\lvert p_i \\rvert$).\r\n\r\nIf there are multiple solutions, you may find any one.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10$\r\n- $1 \\le H, W \\le 1,000$\r\n- $1 \\le N \\le 200$\r\n- $\\lvert h_{i,j} \\rvert \\le 1,000$ for each valid $i, j$\r\n- $1 \\le y_i \\le H$ for each valid $i$\r\n- $1 \\le x_i \\le W$ for each valid $i$\r\n- $\\lvert p_i \\rvert \\le 100$ for each valid $i$\r\n- no two particles are located in the same cell\r\n- the sum of $H \\cdot W$ over all test cases does not exceed $10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** $N \\le 15$\r\n\r\n**Subtask #2 (20 points):** $H \\le 2$\r\n\r\n**Subtask #3 (70 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n2 2 3\r\n1 4\r\n-1 -2\r\n1 1 3\r\n1 2 1\r\n2 2 2","output":"12\r\n1 1 -1","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"carre","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>carre<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"18-03-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/carre'>carre<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/carre'>carre<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/may20'>may20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/mincut-maxflow'>mincut-maxflow<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/physics'>physics<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Medium Hard","editorial_url":"https:\/\/discuss.codechef.com\/problems\/NRWP","time":{"view_start_date":1589189402,"submit_start_date":1589189402,"visible_start_date":1589189402,"end_date":1735669800,"current":1643797964},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=NRWP","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}