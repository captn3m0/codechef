{"category_name":"medium","status":"success","problem_code":"CUPACO","problem_name":"Cumulative Palindrome Count","body":"Gru has been ordering the minions to do a lot of work lately. Minions don't want to trust Gru anymore. So, they propose a problem to Gru. They will only help Gru if he can answer the problem correctly. The minions  generate an endless string $s$ by following these steps:\r\n\r\n1. Let $s$ be an empty string.\r\n2. $i = 1$.\r\n3. Append $i$ *a* s to the back of $s$.\r\n4. Append $i$ *b* s to the back of $s$.\r\n5. Multiply $i$ by $2$ and go back to the third step.\r\n\r\nSo $s$ will be *abaabbaaaabbbb...*. Now let's define $f(x)$ as number of distinct palindrome substring segments in $s[1 \\ldots x]$. For example, $f(3) = 4$ because *a* (which is $s[1 \\ldots 1]$), *b* (which is $s[2 \\ldots 2]$), *a* (which is $s[3 \\ldots 3]$) and *aba* (which is $s[1 \\ldots 3]$) are possible palindrome substrings of $s[1 \\ldots 3]$.\r\n\r\nThe minions will give an integer $N$. Help Gru calculate ($\\sum_{i=1}^{N} f(i)) \\bmod{({10}^9 + 7)}$.\r\n\r\nNote: We are using 1-indexing.\r\n\r\n###Input:\r\n\r\n- First line will contain $T$, number of testcases. Then the testcases follow. \r\n- Each testcase contains a single line of input, which has one integer, $N$. \r\n\r\n###Output:\r\n\r\nFor each testcase, output in a single line, the answer modulo $({10}^9 + 7)$.\r\n\r\n###Constraints \r\n\r\n- $1 \\leq T \\leq 10^3$\r\n- $1 \\leq N \\leq 10^{18}$\r\n\r\n###Sample Input:\r\n\t1\r\n\t3\r\n\r\n###Sample Output:\r\n\t7\r\n\t\r\n###EXPLANATION:\r\n$f(1) = 1$, $f(2) = 2$, $f(3) = 4$. And so, the answer for $N = 3$ is $1+2+4 = 7$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"Gru has been ordering the minions to do a lot of work lately. Minions don't want to trust Gru anymore. So, they propose a problem to Gru. They will only help Gru if he can answer the problem correctly. The minions  generate an endless string $s$ by following these steps:\r\n\r\n1. Let $s$ be an empty string.\r\n2. $i = 1$.\r\n3. Append $i$ *a* s to the back of $s$.\r\n4. Append $i$ *b* s to the back of $s$.\r\n5. Multiply $i$ by $2$ and go back to the third step.\r\n\r\nSo $s$ will be *abaabbaaaabbbb...*. Now let's define $f(x)$ as number of distinct palindrome substring segments in $s[1 \\ldots x]$. For example, $f(3) = 4$ because *a* (which is $s[1 \\ldots 1]$), *b* (which is $s[2 \\ldots 2]$), *a* (which is $s[3 \\ldots 3]$) and *aba* (which is $s[1 \\ldots 3]$) are possible palindrome substrings of $s[1 \\ldots 3]$.\r\n\r\nThe minions will give an integer $N$. Help Gru calculate ($\\sum_{i=1}^{N} f(i)) \\bmod{({10}^9 + 7)}$.\r\n\r\nNote: We are using 1-indexing.\r\n\r\n###Input:\r\n\r\n- First line will contain $T$, number of testcases. Then the testcases follow. \r\n- Each testcase contains a single line of input, which has one integer, $N$. \r\n\r\n###Output:\r\n\r\nFor each testcase, output in a single line, the answer modulo $({10}^9 + 7)$.\r\n\r\n###Constraints \r\n\r\n- $1 \\leq T \\leq 10^3$\r\n- $1 \\leq N \\leq 10^{18}$\r\n\r\n###Sample Input:\r\n\t1\r\n\t3\r\n\r\n###Sample Output:\r\n\t7\r\n\t\r\n###EXPLANATION:\r\n$f(1) = 1$, $f(2) = 2$, $f(3) = 4$. And so, the answer for $N = 3$ is $1+2+4 = 7$.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"mcdic","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span class='m-username--link'>mcdic<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"18-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/math'>math<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/mcdic'>mcdic<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/plit2020'>plit2020<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CUPACO","time":{"view_start_date":1578942000,"submit_start_date":1578942000,"visible_start_date":1578942000,"end_date":1735669800,"current":1643797936},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=CUPACO","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}