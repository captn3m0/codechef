---
{"category_name":"medium","problem_code":"STQ","problem_name":"Strange Queries","problemComponents":{"constraints":"- $1 \\leq N \\leq 10^{6}$\n- $1 \\leq Q \\leq 2 \\cdot 10^{5}$\n- $1 \\leq L_{i} \\leq R_{i} \\leq N$\n- $1 \\leq A_i \\leq 10^{6}$\n","constraintsState":true,"subtasks":"- 30 points : $1 \\leq R \\leq 10000$\n- 70 points : $1 \\leq R \\leq 10^9$\n","subtasksState":false,"inputFormat":"- The first line contains $N$ and $Q$ denoting the number of elements in the array and number of queries.\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$ denoting the given array.\n- $Q$ lines follow. The $i$-th line contains two space-separated integers $L_{i}$ and $R_{i}$ denoting the $i$-th query.\n","inputFormatState":true,"outputFormat":"For each query, output the value $S$ for the subarray on a single line.\n","outputFormatState":true,"sampleTestCases":{"0":{"id":1,"input":"4 2\n19 7 11 77\n2 4\n3 4","output":"77\n11","explanation":"- For the first query, there is only one sequence of operations that uses $2$ operations:\n\n    - Choose $i = 2$ and $p = 11$, assign $A_2 \\times 11 = 77$ to $A_2$.\n    - Choose $i = 3$ and $p = 7$, assign $A_3 \\times 7 = 77$ to $A_3$.\n\nWe can prove that there aren\u0027t any sequence of operations that uses $1$ operation, so the above sequence uses the least number of operations. The final $S$ value is $77$.\n\n- For the second query, there are two sequences of operations that uses $2$ operations. Those are:\n\n    - Choose $i = 3$ and $p = 7$, assign $A_3 \\times 7 = 77$ to $A_3$.\n    - Choose $i = 4$ and $p = 7$, assign $A_4 \\div 7 = 11$ to $A_4$.\n\nBoth of them are optimal in terms of number of operations. The first sequence of operations has the final value $S$ to be $77$, and the second sequence of operations has the final value $S$ to be $11$. Therefore, the answer to this query is $11$ (we need to minimize the final value $S$).","isDeleted":false}}},"video_editorial_url":"","languages_supported":{"0":"CPP14","1":"C","2":"JAVA","3":"PYTH 3.6","4":"CPP17","5":"PYTH","6":"PYP3","7":"CS2","8":"ADA","9":"PYPY","10":"TEXT","11":"PAS fpc","12":"NODEJS","13":"RUBY","14":"PHP","15":"GO","16":"HASK","17":"TCL","18":"PERL","19":"SCALA","20":"LUA","21":"kotlin","22":"BASH","23":"JS","24":"LISP sbcl","25":"rust","26":"PAS gpc","27":"BF","28":"CLOJ","29":"R","30":"D","31":"CAML","32":"FORT","33":"ASM","34":"swift","35":"FS","36":"WSPC","37":"LISP clisp","38":"SQL","39":"SCM guile","40":"PERL6","41":"ERL","42":"CLPS","43":"ICK","44":"NICE","45":"PRLG","46":"ICON","47":"COB","48":"SCM chicken","49":"PIKE","50":"SCM qobi","51":"ST","52":"SQLQ","53":"NEM"},"max_timelimit":3,"source_sizelimit":50000,"problem_author":"nots0fast","problem_tester":"","date_added":"14-09-2021","tags":{"0":"cook133","1":"cook133","2":"hard","3":"hard","4":"nots0fast","5":"number","6":"number","7":"probability","8":"probability"},"problem_difficulty_level":"Unavailable","best_tag":"Number Theory","editorial_url":"https://discuss.codechef.com/problems/STQ","time":{"view_start_date":1632078002,"submit_start_date":1632078002,"visible_start_date":1632078002,"end_date":1735669800},"is_direct_submittable":false,"problemDiscussURL":"https://discuss.codechef.com/search?q=STQ","is_proctored":false,"visitedContests":{},"layout":"problem"}
---
### Read problems statements in [Russian](https://www.codechef.com/download/translated/COOK133/russian/STQ.pdf).

You are given an array $A$ of $N$ positive integers. You are allowed to perform any of the following operations any number of times:

- Pick an index $i$ ($1 \le i \le n$), and a prime number $p$. Assign $A_i \times p$ to $A_i$.
- Pick an index $i$ ($1 \le i \le n$), and a prime number $p$ such that $A_i$ is divisible by $p$. Assign $A_i \div p$ to $a_i$.

The goal is to make all the numbers in array equal using the minimum number of operations. Among all sequences of operations using the minimum number of operations, denote $S$ to be the **smallest** final value of all elements in $A$. You are given $Q$ queries of the form $(L_{i}, R_{i})$. For each query, you need to calculate the $S$ value of the contiguous subarray $A_{L_i \ldots R_i}$.
<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.</div></aside>