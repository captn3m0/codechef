{"category_name":"medium","status":"success","problem_code":"HILLARR","problem_name":"Hill Sequence","body":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK127\/mandarin\/HILLARR.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK127\/russian\/HILLARR.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK127\/vietnamese\/HILLARR.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK127\/bengali\/HILLARR.pdf) as well.\r\n\r\nChef has met up with his friend Isaac recently. Isaac told Chef that his team needs to solve the following problem to win ACPC and qualify to ICPC 2021. However, no one in the team is good at expected value problems \u2015 can you help them qualify?\r\n\r\nA sequence $a_1, a_2, \\ldots, a_N$ is said to be a *hill sequence* if there is an integer $p$ ($1 \\leq p \\leq N$) such that $0 \\leq a_1 \\leq a_2 \\ldots \\leq a_p \\geq a_{p+1} \\ge \\ldots \\geq a_N \\geq 0$. For example, the sequences $[1,2,2,3]$, $[1,2,5,5,2,0]$ and $[5,4,3,3]$ are hill sequences, but $[1,2,2,1,3]$ is not.\r\n\r\nConsider all hill sequences $a_1, a_2, \\ldots, a_N$ such that $\\sum_{i=1}^N a_i = M$. We choose one of them uniformly randomly. Then, we define $F(a,K) = \\sum_{i=1}^N a_i^K$. For the purposes of this problem, $0^0 = 1$. What is the expected value of $F(a,K)$ modulo $10^9 + 7$?\r\n\r\nThe answer can be expressed as a fraction $\\frac{p}{q}$, where $p$ and $q$ are non-negative integers and $q$ is coprime with $10^9 + 7$ for the given constraints. You should compute $p \\cdot q^{-1}$ modulo $10^9 + 7$, where $q^{-1}$ denotes the multiplicative inverse of $q$ modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains three space-separated integers $N$, $M$ and $K$.\r\n \r\n### Output\r\nFor each test case, print a single line containing one integer $p \\cdot q^{-1}$ modulo $10^9+7$.\r\n \r\n### Constraints\r\n- $1 \\leq T \\leq 10^6$\r\n- $1 \\leq N \\leq 1,000$\r\n- $0 \\leq M \\leq 1,000$\r\n- $0 \\leq K \\leq 20$\r\n \r\n### Example Input\r\n```\r\n2\r\n4 1 2\r\n4 2 4\r\n```\r\n\r\n### Example Output\r\n```\r\n1\r\n10\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** There are four hill sequences we can choose: $[1,0,0,0]$, $[0,1,0,0]$, $[0,0,1,0]$ and $[0,0,0,1]$. For each of them, $F(a,1) = 1$, so the expected value is $1$.\r\n\r\n**Example case 2:** There are 7 hill sequences we can choose:\r\n- $[2,0,0,0]$, $[0,2,0,0]$, $[0,0,2,0]$ and $[0,0,0,2]$, each with $F(a,2) = 16$\r\n- $[1,1,0,0]$, $[0,1,1,0]$ and $[0,0,1,1]$, each with $F(a,2) = 2$\r\n\r\nThe expected value is $\\frac{4 \\cdot 16 + 3 \\cdot 2}{7} = 10$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK127\/mandarin\/HILLARR.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK127\/russian\/HILLARR.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK127\/vietnamese\/HILLARR.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK127\/bengali\/HILLARR.pdf) as well.\r\n\r\nChef has met up with his friend Isaac recently. Isaac told Chef that his team needs to solve the following problem to win ACPC and qualify to ICPC 2021. However, no one in the team is good at expected value problems \u2015 can you help them qualify?\r\n\r\nA sequence $a_1, a_2, \\ldots, a_N$ is said to be a *hill sequence* if there is an integer $p$ ($1 \\leq p \\leq N$) such that $0 \\leq a_1 \\leq a_2 \\ldots \\leq a_p \\geq a_{p+1} \\ge \\ldots \\geq a_N \\geq 0$. For example, the sequences $[1,2,2,3]$, $[1,2,5,5,2,0]$ and $[5,4,3,3]$ are hill sequences, but $[1,2,2,1,3]$ is not.\r\n\r\nConsider all hill sequences $a_1, a_2, \\ldots, a_N$ such that $\\sum_{i=1}^N a_i = M$. We choose one of them uniformly randomly. Then, we define $F(a,K) = \\sum_{i=1}^N a_i^K$. For the purposes of this problem, $0^0 = 1$. What is the expected value of $F(a,K)$ modulo $10^9 + 7$?\r\n\r\nThe answer can be expressed as a fraction $\\frac{p}{q}$, where $p$ and $q$ are non-negative integers and $q$ is coprime with $10^9 + 7$ for the given constraints. You should compute $p \\cdot q^{-1}$ modulo $10^9 + 7$, where $q^{-1}$ denotes the multiplicative inverse of $q$ modulo $10^9+7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains three space-separated integers $N$, $M$ and $K$.\r\n \r\n### Output\r\nFor each test case, print a single line containing one integer $p \\cdot q^{-1}$ modulo $10^9+7$.\r\n \r\n### Constraints\r\n- $1 \\leq T \\leq 10^6$\r\n- $1 \\leq N \\leq 1,000$\r\n- $0 \\leq M \\leq 1,000$\r\n- $0 \\leq K \\leq 20$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n4 1 2\r\n4 2 4","output":"1\r\n10","explanation":"**Example case 1:** There are four hill sequences we can choose: $[1,0,0,0]$, $[0,1,0,0]$, $[0,0,1,0]$ and $[0,0,0,1]$. For each of them, $F(a,1) = 1$, so the expected value is $1$.\r\n\r\n**Example case 2:** There are 7 hill sequences we can choose:\r\n- $[2,0,0,0]$, $[0,2,0,0]$, $[0,0,2,0]$ and $[0,0,0,2]$, each with $F(a,2) = 16$\r\n- $[1,1,0,0]$, $[0,1,1,0]$ and $[0,0,1,1]$, each with $F(a,2) = 2$\r\n\r\nThe expected value is $\\frac{4 \\cdot 16 + 3 \\cdot 2}{7} = 10$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/WYptW9cdhmQ","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"isaacmoris","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span class='m-username--link'>isaacmoris<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"16-03-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/binomial-theorem'>binomial-theorem<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/cook127'>cook127<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/expected-value'>expected-value<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/isaacmoris'>isaacmoris<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/probability'>probability<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Binomial Theorem","editorial_url":"https:\/\/discuss.codechef.com\/problems\/HILLARR","time":{"view_start_date":1616351402,"submit_start_date":1616351402,"visible_start_date":1616351402,"end_date":1735669800,"current":1643797947},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=HILLARR","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}