{"category_name":"medium","status":"success","problem_code":"MDSWIN2","problem_name":"Winning Ways 2","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/hindi\/MDSWIN2.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/bengali\/MDSWIN2.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/mandarin\/MDSWIN2.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/russian\/MDSWIN2.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/vietnamese\/MDSWIN2.pdf) as well.\r\n\r\nChef's Combinatorial Games Competition is starting again this year, and the qualification round is happening right now! This time, Chef is keeping it simple \u2015 there will be two-player games with the following rules:\r\n- Initially, the players are given an integer sequence $S$.\r\n- The players alternate turns.\r\n- In each turn, the current player must choose one or more elements of the current sequence $S$ such that the values of all chosen elements are identical, and erase these elements from $S$.\r\n- When a player cannot choose anything (the sequence $S$ is already empty), this player loses the game.\r\n\r\nSince Chef is currently busy planning for the finals, he does not have time to prepare sequences for all qualification games. Instead, he chose a large sequence $A_1, A_2, \\ldots, A_N$ and he wants to use its contiguous subsequences for the games. To get a idea of how these games will turn out, Chef wants you to answer $Q$ queries. In each query, you are given a subsequence $A_L, A_{L+1}, \\ldots, A_R$, and you have to find the number of winning moves the first player can play on the first turn. Since this number can be quite large, compute it modulo $998,244,353$.\r\n\r\nAssume that both players play optimally. The queries are independent \u2015 the sequence $A$ does not change.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains a single integer $Q$.\r\n- Each of the next $Q$ lines contains two space-separated integers $L$ and $R$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the number of winning moves of the first player modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 5$\r\n- $1 \\le N, Q \\le 10^5$\r\n- $1 \\le A_i \\le 10^9$ for each valid $i$\r\n- $1 \\le L \\le R \\le N$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $N, Q \\le 100$\r\n- $A_i \\le 10^5$ for each valid $i$\r\n\r\n**Subtask #2 (20 points):** $N, Q \\le 10^3$\r\n\r\n**Subtask #3 (70 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n1\r\n5\r\n1 2 1 2 2\r\n3\r\n1 1\r\n2 3\r\n2 5\r\n```\r\n### Example Output\r\n```\r\n1\r\n0\r\n3\r\n```\r\n\r\n### Explanation\r\n**Example case 1:**\r\n- In the first game, there is only one move and it is a winning move for the first player.\r\n- In the second game, the second player can always win regardless of the first player's move.\r\n- In the third game, the first player can choose the subset of elements with indices $\\{2, 4\\}$, $\\{2, 5\\}$ or $\\{4, 5\\}$ (in the input sequence $A$) to ensure his victory in the future.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/hindi\/MDSWIN2.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/bengali\/MDSWIN2.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/mandarin\/MDSWIN2.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/russian\/MDSWIN2.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/vietnamese\/MDSWIN2.pdf) as well.\r\n\r\nChef's Combinatorial Games Competition is starting again this year, and the qualification round is happening right now! This time, Chef is keeping it simple \u2015 there will be two-player games with the following rules:\r\n- Initially, the players are given an integer sequence $S$.\r\n- The players alternate turns.\r\n- In each turn, the current player must choose one or more elements of the current sequence $S$ such that the values of all chosen elements are identical, and erase these elements from $S$.\r\n- When a player cannot choose anything (the sequence $S$ is already empty), this player loses the game.\r\n\r\nSince Chef is currently busy planning for the finals, he does not have time to prepare sequences for all qualification games. Instead, he chose a large sequence $A_1, A_2, \\ldots, A_N$ and he wants to use its contiguous subsequences for the games. To get a idea of how these games will turn out, Chef wants you to answer $Q$ queries. In each query, you are given a subsequence $A_L, A_{L+1}, \\ldots, A_R$, and you have to find the number of winning moves the first player can play on the first turn. Since this number can be quite large, compute it modulo $998,244,353$.\r\n\r\nAssume that both players play optimally. The queries are independent \u2015 the sequence $A$ does not change.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n- The third line contains a single integer $Q$.\r\n- Each of the next $Q$ lines contains two space-separated integers $L$ and $R$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the number of winning moves of the first player modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 5$\r\n- $1 \\le N, Q \\le 10^5$\r\n- $1 \\le A_i \\le 10^9$ for each valid $i$\r\n- $1 \\le L \\le R \\le N$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $N, Q \\le 100$\r\n- $A_i \\le 10^5$ for each valid $i$\r\n\r\n**Subtask #2 (20 points):** $N, Q \\le 10^3$\r\n\r\n**Subtask #3 (70 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n5\r\n1 2 1 2 2\r\n3\r\n1 1\r\n2 3\r\n2 5","output":"1\r\n0\r\n3","explanation":"**Example case 1:**\r\n- In the first game, there is only one move and it is a winning move for the first player.\r\n- In the second game, the second player can always win regardless of the first player's move.\r\n- In the third game, the first player can choose the subset of elements with indices $\\{2, 4\\}$, $\\{2, 5\\}$ or $\\{4, 5\\}$ (in the input sequence $A$) to ensure his victory in the future.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"5","source_sizelimit":"50000","problem_author":"upobir","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>upobir<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"6-01-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/basic'>basic<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/march20'>march20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/mos-algorithm'>mos-algorithm<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nim'>nim<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tmwilliamlin'>tmwilliamlin<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/upobir'>upobir<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Mos Algorithm","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MDSWIN2","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797957},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=MDSWIN2","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}