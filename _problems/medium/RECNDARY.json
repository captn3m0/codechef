{"category_name":"medium","status":"success","problem_code":"RECNDARY","problem_name":"Chef and Array","body":"Chef has a circular array $A$ of $N$ integers $A_1, A_2 \\ldots A_N$ where $A_N$ and $A_1$ are considered adjacent. \r\n\r\nThe subarray $A_{i,j}$ defined as an array formed using elements of $A$ from $i^{th}$ index element to $j^{th}$ index element (both inclusive). Formally, $A_{i, j}$ is defined as:\r\n- If $i \\leq j$, then the subarray of $A$ from the index $i$ to index $j$, both inclusive.\r\n- If $i > j$, then it denotes the subarray of $A$ from index $i$ to index $N$, followed by subarray of $A$ from index $1$ to index $j$.\r\n\r\nA function $f(B)$ is defined on an array $B$ as the number of subarrays of $B$ which have sum less than $K$.\r\n\r\nLet $S = \\sum_{i = 1}^N \\sum_{j = 1}^N f(A_{i, j})$. Find the value of $S$ modulo $1,000,000,007$.\r\n\r\n###Input:\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two integers $N$ and $K$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n###Output:\r\nFor each test case, print a single line containing one integer \u2015 the value of $S$ modulo $1,000,000,007$.\r\n\r\n###Constraints \r\n- $1 \\le T \\le 10$\r\n- $1 \\le N \\le 2*10^5$\r\n- $|K| \\le 10^{15}$\r\n- $|A_i| \\le 10^9$ for each valid $i$\r\n\r\n###Sample Input:\r\n```\r\n3\r\n3 1\r\n0 0 0\r\n2 1\r\n1 -1\r\n1 1\r\n-1\r\n```\r\n\r\n###Sample Output:\r\n```\r\n30\r\n5\r\n1\r\n```\r\n\r\n###Explanation\r\nIn the second test case, the array is $[1, -1]$ and $K = 1$.\r\n\r\n$f(A_{1, 1})= 0$\r\n\r\n$f(A_{1, 2}) = 2$, because both the subarrays $[1, -1]$ and $[-1]$ have sum $< K$.\r\n\r\n$f(A_{2, 1}) = 2$, because the array we are considering now is $[-1, 1]$, and both the subarrays $[1, -1]$ and $[-1]$ have sum $< K$.\r\n\r\n$f(A_{2, 2}) = 1$\r\n\r\nThe sum of these is 5, which is the answer.\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"Chef has a circular array $A$ of $N$ integers $A_1, A_2 \\ldots A_N$ where $A_N$ and $A_1$ are considered adjacent. \r\n\r\nThe subarray $A_{i,j}$ defined as an array formed using elements of $A$ from $i^{th}$ index element to $j^{th}$ index element (both inclusive). Formally, $A_{i, j}$ is defined as:\r\n- If $i \\leq j$, then the subarray of $A$ from the index $i$ to index $j$, both inclusive.\r\n- If $i > j$, then it denotes the subarray of $A$ from index $i$ to index $N$, followed by subarray of $A$ from index $1$ to index $j$.\r\n\r\nA function $f(B)$ is defined on an array $B$ as the number of subarrays of $B$ which have sum less than $K$.\r\n\r\nLet $S = \\sum_{i = 1}^N \\sum_{j = 1}^N f(A_{i, j})$. Find the value of $S$ modulo $1,000,000,007$.\r\n\r\n###Input:\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two integers $N$ and $K$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n###Output:\r\nFor each test case, print a single line containing one integer \u2015 the value of $S$ modulo $1,000,000,007$.\r\n\r\n###Constraints \r\n- $1 \\le T \\le 10$\r\n- $1 \\le N \\le 2*10^5$\r\n- $|K| \\le 10^{15}$\r\n- $|A_i| \\le 10^9$ for each valid $i$\r\n\r\n###Sample Input:\r\n```\r\n3\r\n3 1\r\n0 0 0\r\n2 1\r\n1 -1\r\n1 1\r\n-1\r\n```\r\n\r\n###Sample Output:\r\n```\r\n30\r\n5\r\n1\r\n```\r\n\r\n###Explanation\r\nIn the second test case, the array is $[1, -1]$ and $K = 1$.\r\n\r\n$f(A_{1, 1})= 0$\r\n\r\n$f(A_{1, 2}) = 2$, because both the subarrays $[1, -1]$ and $[-1]$ have sum $< K$.\r\n\r\n$f(A_{2, 1}) = 2$, because the array we are considering now is $[-1, 1]$, and both the subarrays $[1, -1]$ and $[-1]$ have sum $< K$.\r\n\r\n$f(A_{2, 2}) = 1$\r\n\r\nThe sum of these is 5, which is the answer.","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"rishup_nitdgp","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>rishup_nitdgp<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"20-03-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/fenwick-tree'>fenwick-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rc122020'>rc122020<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rishup_nitdgp'>rishup_nitdgp<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rishup_nitdgp'>rishup_nitdgp<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Segment Tree","editorial_url":"https:\/\/discuss.codechef.com\/problems\/RECNDARY","time":{"view_start_date":1588010400,"submit_start_date":1588010400,"visible_start_date":1588010400,"end_date":1735669800,"current":1643797971},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=RECNDARY","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}