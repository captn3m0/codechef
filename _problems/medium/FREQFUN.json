{"category_name":"medium","status":"success","problem_code":"FREQFUN","problem_name":"Frequency Function","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/hindi\/FREQFUN.pdf),[Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/bengali\/FREQFUN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/mandarin\/FREQFUN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/russian\/FREQFUN.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/vietnamese\/FREQFUN.pdf) as well.\r\n\r\nChef had a sequence $S_0, S_1, \\ldots, S_{N-1}$; each element of this sequence was an integer between $0$ and $N-1$ (inclusive). Unfortunately, he forgot some (possibly zero or all) elements of this sequence. You are given a sequence $A_0, A_1, \\ldots, A_{N-1}$, where for each valid $i$, $A_i = -1$ denotes an element Chef forgot and if $A_i \\neq -1$, then $A_i = S_i$.\r\n\r\nBefore Chef forgot any elements of $S$, he created a sequence $B_0, B_1, \\ldots, B_{N-1}$, where for each valid $i$, $B_i$ is the number of occurrences of the value $i$ in $S$ (the number of valid indices $j$ such that $S_j = i$), and then, he created a third sequence $G_0, G_1, \\ldots, G_N$, where for each valid $i$, $G_i$ is the number of occurrences of the value $i$ in $B$. (Note that the elements of $B$ are between $0$ and $N$ inclusive.) Unfortunately, Chef also forgot the sequence $B$, but he remembers $G$.\r\n\r\nHelp Chef restore the missing elements of the sequence $S$. Precisely, find the lexicographically smallest sequence $S$ which is consistent with all the given information or determine that there is no such sequence.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_0, A_1, \\ldots, A_{N-1}$.\r\n- The third line contains $N+1$ space-separated integers $G_0, G_1, \\ldots, G_N$.\r\n\r\n### Output\r\nFor each test case:\r\n- If there is no sequence $S$ consistent with all the given information, print a single line containing the string `\"impossible\"`.\r\n- Otherwise, print a single line containing $N$ space-separated integers $S_0, S_1, \\ldots, S_{N-1}$ - the lexicographically smallest valid sequence $S$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 1,000$\r\n- $2 \\le N \\le 10^5$\r\n- $-1 \\le A_i \\le N-1$ for each valid $i$\r\n- $0 \\le G_i \\le N$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):**\r\n- $1 \\le N \\le 50$\r\n- the sum of $N$ over all test cases does not exceed $500$\r\n\r\n**Subtask #2 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n4\r\n3\r\n-1 0 -1\r\n0 3 0 0\r\n3\r\n2 2 1\r\n3 0 0 0\r\n3\r\n-1 2 -1\r\n1 1 1 0\r\n3\r\n-1 2 2\r\n0 1 1 0\r\n```\r\n\r\n### Example Output\r\n```\r\n1 0 2\r\nimpossible\r\n0 2 0\r\nimpossible\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/hindi\/FREQFUN.pdf),[Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/bengali\/FREQFUN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/mandarin\/FREQFUN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/russian\/FREQFUN.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/vietnamese\/FREQFUN.pdf) as well.\r\n\r\nChef had a sequence $S_0, S_1, \\ldots, S_{N-1}$; each element of this sequence was an integer between $0$ and $N-1$ (inclusive). Unfortunately, he forgot some (possibly zero or all) elements of this sequence. You are given a sequence $A_0, A_1, \\ldots, A_{N-1}$, where for each valid $i$, $A_i = -1$ denotes an element Chef forgot and if $A_i \\neq -1$, then $A_i = S_i$.\r\n\r\nBefore Chef forgot any elements of $S$, he created a sequence $B_0, B_1, \\ldots, B_{N-1}$, where for each valid $i$, $B_i$ is the number of occurrences of the value $i$ in $S$ (the number of valid indices $j$ such that $S_j = i$), and then, he created a third sequence $G_0, G_1, \\ldots, G_N$, where for each valid $i$, $G_i$ is the number of occurrences of the value $i$ in $B$. (Note that the elements of $B$ are between $0$ and $N$ inclusive.) Unfortunately, Chef also forgot the sequence $B$, but he remembers $G$.\r\n\r\nHelp Chef restore the missing elements of the sequence $S$. Precisely, find the lexicographically smallest sequence $S$ which is consistent with all the given information or determine that there is no such sequence.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_0, A_1, \\ldots, A_{N-1}$.\r\n- The third line contains $N+1$ space-separated integers $G_0, G_1, \\ldots, G_N$.\r\n\r\n### Output\r\nFor each test case:\r\n- If there is no sequence $S$ consistent with all the given information, print a single line containing the string `\"impossible\"`.\r\n- Otherwise, print a single line containing $N$ space-separated integers $S_0, S_1, \\ldots, S_{N-1}$ - the lexicographically smallest valid sequence $S$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 1,000$\r\n- $2 \\le N \\le 10^5$\r\n- $-1 \\le A_i \\le N-1$ for each valid $i$\r\n- $0 \\le G_i \\le N$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):**\r\n- $1 \\le N \\le 50$\r\n- the sum of $N$ over all test cases does not exceed $500$\r\n\r\n**Subtask #2 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"4\r\n3\r\n-1 0 -1\r\n0 3 0 0\r\n3\r\n2 2 1\r\n3 0 0 0\r\n3\r\n-1 2 -1\r\n1 1 1 0\r\n3\r\n-1 2 2\r\n0 1 1 0","output":"1 0 2\r\nimpossible\r\n0 2 0\r\nimpossible","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"kingofnumbers","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>kingofnumbers<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"27-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/deadwing97'>deadwing97<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/greedy'>greedy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kingofnumbers'>kingofnumbers<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime79'>ltime79<\/a>","problem_difficulty_level":"Easy-Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/FREQFUN","time":{"view_start_date":1577552402,"submit_start_date":1577552402,"visible_start_date":1577552402,"end_date":1735669800,"current":1643797944},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=FREQFUN","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}