{"category_name":"medium","status":"success","problem_code":"LOTERY","problem_name":"LCM equation","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/OCT15\/mandarin\/LOTERY.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/OCT15\/russian\/LOTERY.pdf\">Russian<\/a> <\/h3>\n<p>Chef is exploring a new mathematical problem, which can be stated as follows:<\/p>\n<p>\n<img src =\"http:\/\/mathurl.com\/ok7rd4a.png\" \/><br \/>\n<br \/>\n<img src=\"http:\/\/mathurl.com\/nz4fycw.png\" \/> <\/p>\n<p>where <b>[x]<\/b> means greatest integer which doesn't exceed <b>x<\/b>.\n<\/p>\n<p>\nChef wants you to answer some questions for a given pair of integers <b>N<\/b>, <b>K<\/b>:<br \/>\nWhat is the <a href = \"https:\/\/en.wikipedia.org\/wiki\/Least_common_multiple\"> <b> least common multiple<\/b><\/a> of <b>F(N, 1)<\/b>, <b>F(N, 2)<\/b>, ... , <b>F(N, K)<\/b> modulo <b>10<sup>9<\/sup> + 7<\/b>.\n<\/p>\n<p>Chef is not willing to give you all queries at once. Instead, he gives you the first query and suggests you generate all the following queries in this way:<\/p>\n<p>\n<b>N<sub>i<\/sub> = 1 + (A * Answer<sub>i-1<\/sub> + C<sub>i<\/sub>) mod M <\/b>,<br \/>\n<b>K<sub>i<\/sub> = 1 + (B * Answer<sub>i-1<\/sub> + D<sub>i<\/sub>) mod N<sub>i<\/sub><\/b>, <br \/>\nwhere <b>Answer<sub>i<\/sub><\/b> is the answer for the <b>i<\/b><sup>th<\/sup> query.\n<\/p>\n<h3>Input<\/h3>\n<p>\nThe first line of input contains an integer <b>T<\/b> denoting the number of questions Chef wants to ask you. <br \/>\nSecond line contains two space-separated integers <b>N<sub>1<\/sub>, K<sub>1<\/sub><\/b>.<br \/>\nThird line contains three space-separated integers <b>A<\/b>, <b>B<\/b>, and <b>M<\/b>, described in the statement.<br \/>\nNext line contains <b>T-1<\/b> space-separated integers: <b>C<sub>2<\/sub><\/b>, <b>C<sub>3<\/sub><\/b>, ... , <b>C<sub>T<\/sub><\/b><br \/>\nNext line contains <b>T-1<\/b> space-separated integers: <b>D<sub>2<\/sub><\/b>, <b>D<sub>3<\/sub><\/b>, ... , <b>D<sub>T<\/sub><\/b>\n<\/p>\n<h3>Output<\/h3>\n<p>\nFor each test case, output a single integer \u2014 the answer for the given query.\n<\/p>\n<h3>Constraints and Subtasks<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>10<sup>6<\/sup><\/b><\/li>\n<li><b>0<\/b> \u2264 <b>A<\/b>, <b>B<\/b>, <b>C<sub>i<\/sub><\/b>, <b>D<sub>i<\/sub><\/b> &lt; <b>M<\/b> \u2264  <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>K<sub>1<\/sub><\/b> \u2264 <b>N<sub>1<\/sub><\/b>&lt; <b>M<\/b><\/li>\n<\/ul>\n<p><\/p>\n<p><b>Subtask1:(10 points) <\/b><\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>M<\/b> \u2264 <b>10<\/b><\/li>\n<li>Time Limit is <b>1<\/b> second<\/li>\n<\/ul>\n<p><\/p>\n<p><b>Subtask2: (20 points)<\/b><\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>10<sup>2<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>M<\/b> \u2264 <b>10<sup>3<\/sup><\/b><\/li>\n<li>Time Limit is <b>1<\/b> second<\/li>\n<\/ul>\n<p><\/p>\n<p><b>Subtask3: (30 points)<\/b><\/p>\n<ul>\n<li><b>A = B = 0<\/b><\/li>\n<li>Time Limit is <b>4<\/b> seconds<\/li>\n<\/ul>\n<p><\/p>\n<p><b>Subtask4: (40 points)<\/b><\/p>\n<ul>\n<li>No additional constraints<\/li>\n<li>Time Limit is <b>4<\/b> seconds<\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n<tt>3\n2 1\n0 0 3\n2 2\n0 1<\/tt>\n<b>Output:<\/b>\n<tt>2\n3\n6<\/tt>\n<\/pre><p><\/p>\n<pre><b>Input:<\/b>\n<tt>4\n5 2\n2 3 6\n4 2 3\n2 4 2<\/tt>\n<b>Output:<\/b>\n<tt>20\n6\n6\n4<\/tt>\n\n<h3>Explanation<\/h3>\n<p><b>Example case 1.<\/b> \n<b>F(2,1) = F(2,2) = 2,  F(3,1) = 3, F(3,2) = 6, F(3,3) = 3<\/b>\n<b>1st query<\/b> - (2,1). <b>Answer<\/b> = 2.\n<b>2nd query<\/b> - (3,1). <b>Answer<\/b> = 3\n<b>3rd query<\/b> - (3,2). <b>Answer<\/b> = 6\n<\/p>\n\n<p><b>Example case 2.<\/b> \n<b>F(4,1) = 4, F(5,2) = 20<\/b>\n<b>1st query<\/b> - (5,2). \n      <b>Answer<\/b> = lcm(F(5,1), F(5,2)) = lcm(5,20) = 20\n<b>2nd query<\/b> - (1 + (20 * 2 + 4) mod 6, 1 + (20 * 3 + 2) mod n) = (3, 3). \n      <b>Answer<\/b> = lcm(F(3,1), F(3,2), F(3,3)) = lcm(3,6,3) = 6\n<b>3rd query<\/b> - (1 + (6*2 + 2) mod 6, 1 + (6*3 + 4) mod n) = (3,2). \n      <b>Answer<\/b> = lcm(F(3,1), F(3,2)) = 6\n<b>4th query<\/b> - (1 + (6*2 + 3) mod 6, 1 + (6*3 + 2) mod n) = (4,1).\n      <b>Answer<\/b> = lcm(F(4,1)) = 4\n<\/p><\/pre>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1 - 4","source_sizelimit":"50000","problem_author":"kaizer","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>kaizer<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"5-09-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/kaizer'>\n                    kaizer\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/lcm'>\n                    lcm\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/oct15'>\n                    oct15\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>\n                    segment-tree\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/LOTERY","user":{"username":null},"time":{"view_start_date":1444642200,"submit_start_date":1444642200,"visible_start_date":1444642200,"end_date":1735669800,"current":1493557755},"todo":false,"problem_status":"unattempted"}