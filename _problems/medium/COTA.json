{"category_name":"medium","status":"success","problem_code":"COTA","problem_name":"Chef of The Ancient","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK43\/mandarin\/COTA.pdf\">Mandarin Chinese<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK43\/russian\/COTA.pdf\">Russian<\/a> as well.<\/h3>\n<p>Chef likes to play computer games very much. Recently he played a new game, Dota 2.<br \/>\nChef is thinking to start a new game called Cota (Chef of the ancient).<br \/>\nThere will be two teams in Cota, Radiant and Dire. <\/p>\n<p>\nThere are <b>2*N<\/b> players in Cota and the players are numbered by integers from <b>0<\/b> to <b>2*N \u2013 1<\/b>.<br \/>\nEach team will have <b>N<\/b> players. One team will have all the players with even numbers <b>(0, 2, \u2026, 2*N - 2)<\/b><br \/>\nand other team will have all the odd numbered players <b>(1, 3, \u2026, 2*N \u2013 1)<\/b>. <\/p>\n<p>\nSome of the players are friends and the power of their friendship can be expressed by an integer number.<br \/>\nIf player <b>u<\/b> and player <b>v<\/b> are friends, their power of friendship is <b>P<sub>u,v<\/sub><\/b> (or <b>P<sub>v,u<\/sub><\/b>).\n<\/p>\n<p>Chef wants to select some players(at least one) as elite players.<br \/>\nAn elite player can be a member of Radiant or Dire.<br \/>\nBut each Radiant member (maybe non-elite) should have odd number of elite friends and each Dire member (maybe non-elite) should have even number of elite friends (possibly zero).<br \/>\nSo Chef has to break some friendships( possible zero) to make that happen.<br \/>\nChef can break up friendships between any two players but cannot build any new friendship.<br \/>\nAs Chef can break up any pair of friendships and he is quite rude, so he breaks up all friendships that are between a elite and a non-elite player ie. there cannot be a friendship between a elite and a non-elite player at all.<br \/><br \/>\nHe will break the other friendships in such a way that the total power of remaining friendships between elite players<br \/>\nis minimized and also the restriction above is maintained.\n<\/p>\n<p>Chef has not yet decided which team will be Radiant and which one will be Dire. It is your task to assign teams such that the total power of remaining friendships between elite players is minimized.<\/p>\n<h3>Input<\/h3>\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows. <\/p>\n<p>First line contains two space separated integers <b>N<\/b> and <b>M<\/b>. Each of the next <b>M<\/b> lines contain three space separated integers <b>u<\/b>, <b>v<\/b> and <b>P<sub>u,v<\/sub><\/b>, means <b>u<\/b> and <b>v<\/b> are friends and the power of their friendship is <b>P<sub>u,v<\/sub><\/b>. No friendship will be mentioned twice in a test case<\/p>\n<h3>Output<\/h3>\n<p>For each test case print the minimum total power of friendship between elite players after assigning the teams<br \/>\nand breaking up the friendships.<\/p>\n<p>There will always be a valid answer.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>50<\/b><\/li>\n<li><b>2<\/b> \u2264 <b>N<\/b> \u2264 <b>18<\/b><\/li>\n<li><b>N<\/b> is divisible by <b>2<\/b><\/li>\n<li><b>2*N-1<\/b> \u2264 <b>M<\/b> \u2264 <b>2*N(2*N-1)\/2<\/b><\/li>\n<li><b>0<\/b> \u2264 <b>u, v<\/b> \u2264 <b>2*N-1<\/b> and <b>u<\/b> \u2260 <b>v<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>P<sub>u,v<\/sub><\/b> \u2264 <b>10<sup>6<\/sup><\/b><\/li>\n<li>For each player <b>u<\/b> and <b>v (u\u2260v)<\/b> , there is a sequence <b>x<sub>0<\/sub>, x<sub>1<\/sub>, ... x<sub>k<\/sub><\/b>, where <b>x<sub>0<\/sub> = u<\/b> and <b>x<sub>k<\/sub> = v<\/b> and player <b>x<sub>i<\/sub><\/b> and <b>x<sub>i+1<\/sub><\/b> (<b>0\u2264i&lt;k<\/b>) are friends of each other.<\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\n2 5\n1 2 6\n0 3 1\n2 0 7\n0 1 4\n3 1 8\n4 11\n1 6 6\n4 3 1\n6 4 7\n4 5 4\n0 3 2\n5 7 7\n0 2 8\n2 6 6\n3 7 8\n6 0 9\n6 5 5\n\n<b>Output:<\/b>\n5\n9\n<\/pre>\n<h3>Explanation<\/h3>\n<p><b>Example case 1.<\/b>  If the odd numbered players are assigned as Radiant and even numbered players as Dire, and Chef assigns players {0, 1, 3} as elite players and keeps only the friendships between (0, 1) and (0, 3) and breaks up any other pair of friendships. So the total power of friendship is 1 + 4 = 5. Elite player 1 and 3 have friendship with only elite player 0. So each Radiant player has odd number of elite friends. Similarly player 0 has friendship with 1 and 3, and players 2 do not have any friend(0 elite friends). So each Dire player has even number of elite friends.<\/p>\n<p><b>Example case 2.<\/b><\/p>\n<p><img src=\"\/\/www.codechef.com\/download\/sample2.png\" \/><\/p>\n<p>\nSay the odd numbered players are assigned as Radiant and even numbered players as Dire.<br \/>\nAnd Chef assigns players {1, 3, 5, 6,  7} as elite players and keeps only the friendships between (1, 6), (3, 7) and (5, 6) and breaks up any other pair of friendships.<br \/>\nSo the total power of friendship is 6 + 5 + 8 = 19. <\/p>\n<p>Elite player 1 and 5 have friendship with only elite player 6 and player 3 and 7 have mutual friendship.<br \/>\nSo each Radiant player has odd number of elite friends. <\/p>\n<p>Similarly player 6 has friendship with 1 and 5, and players 0, 2 and 4 do not have any friend(0 elite friends).<br \/>\nSo each Dire player has even number of elite friends.\n<\/p>\n<p><img src=\"\/\/www.codechef.com\/download\/Even.png\" \/><\/p>\n<p>\nNow say the even numbered players are assigned as Radiant and odd numbered players as Dire.<br \/>\nAnd Chef assigns players {0, 2, 3, 4, 6} as elite players and keeps only the friendships between (0, 3), (3, 4) and (2, 6) and breaks up any other pair of friendships.<br \/>\nSo the total power of friendship is 2 + 1 + 6 = 9.<br \/>\nElite player 0 and 4 have friendship with only elite player 3 and player 2 and 6 have mutual friendship.<br \/>\nSo each Radiant player has odd number of elite friends. <\/p>\n<p>Similarly player 3 has friendship with 0 and 4, and player 1, 5 and 7 do not have any friend(0 elite friends).<br \/>\nSo each Dire player has even number of elite friends.<\/p>\n<p><img src=\"\/\/www.codechef.com\/download\/Odd.png\" \/><\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"shiplu","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #1E7D22;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>2&#9733;<\/span><span>shiplu<\/span>","problem_tester":"rustinpiece\u200e","problem_tester_html_handle":null,"date_added":"31-01-2014","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/bitmasking'>\n                    bitmasking\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/cook43'>\n                    cook43\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/graph'>\n                    graph\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/shiplu'>\n                    shiplu\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/shortest-path'>\n                    shortest-path\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/COTA","user":{"username":null},"time":{"view_start_date":1392575400,"submit_start_date":1392575400,"visible_start_date":1392575400,"end_date":1735669800,"current":1493557603},"todo":false,"problem_status":"unattempted"}