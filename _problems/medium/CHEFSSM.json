{"category_name":"medium","status":"success","problem_code":"CHEFSSM","problem_name":"Chef and the Combination Lock","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/NOV20\/hindi\/CHEFSSM.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/NOV20\/bengali\/CHEFSSM.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/mandarin\/CHEFSSM.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/NOV20\/russian\/CHEFSSM.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/vietnamese\/CHEFSSM.pdf) as well.\r\n\r\nChef has a combination lock with $N$ wheels (numbered $1$ through $N$). For each valid $i$, on the $i$-th wheel, the integers from $0$ to $A_i$ (inclusive) are written in ascending order ($0$ and $A_i$ are also adjacent). Initially, one value on each wheel is selected uniformly randomly and independently.\r\n\r\nThe lock operates in a very peculiar way: it opens when there is at least one wheel where either $0$ or the largest value on that wheel is selected. Chef wants to open the lock using the smallest possible number of operations; in one operation, he may choose one wheel and rotate it clockwise or counterclockwise by $1$ unit (i.e. select a value that is adjacent to the previously selected value on that wheel).\r\n\r\nFind the [expected value](https:\/\/en.wikipedia.org\/wiki\/Expected_value) of the number of operations which Chef needs to perform to open the lock.\r\n\r\nThe expected number of operations can be represented as a fraction $\\frac{P}{Q}$, where $P$ is a non-negative integer and $Q$ a positive integer coprime with $998,244,353$. You should calculate $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $P \\cdot Q^{-1}$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10^3$\r\n- $1 \\le N \\le 10^5$\r\n- $0 \\le A_i \\lt 998,244,352$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $N \\le 5,000$\r\n- $A_i \\le 5,000$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $5,000$\r\n\r\n**Subtask #2 (20 points):**\r\n- $N \\le 5,000$\r\n- the sum of $N$ over all test cases does not exceed $5,000$\r\n\r\n**Subtask #3 (70 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n3\r\n2\r\n2 2\r\n2\r\n5 5\r\n3\r\n3 4 5\r\n```\r\n\r\n### Example Output\r\n```\r\n443664157\r\n221832079\r\n598946612\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/NOV20\/hindi\/CHEFSSM.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/NOV20\/bengali\/CHEFSSM.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/mandarin\/CHEFSSM.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/NOV20\/russian\/CHEFSSM.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/vietnamese\/CHEFSSM.pdf) as well.\r\n\r\nChef has a combination lock with $N$ wheels (numbered $1$ through $N$). For each valid $i$, on the $i$-th wheel, the integers from $0$ to $A_i$ (inclusive) are written in ascending order ($0$ and $A_i$ are also adjacent). Initially, one value on each wheel is selected uniformly randomly and independently.\r\n\r\nThe lock operates in a very peculiar way: it opens when there is at least one wheel where either $0$ or the largest value on that wheel is selected. Chef wants to open the lock using the smallest possible number of operations; in one operation, he may choose one wheel and rotate it clockwise or counterclockwise by $1$ unit (i.e. select a value that is adjacent to the previously selected value on that wheel).\r\n\r\nFind the [expected value](https:\/\/en.wikipedia.org\/wiki\/Expected_value) of the number of operations which Chef needs to perform to open the lock.\r\n\r\nThe expected number of operations can be represented as a fraction $\\frac{P}{Q}$, where $P$ is a non-negative integer and $Q$ a positive integer coprime with $998,244,353$. You should calculate $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $P \\cdot Q^{-1}$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10^3$\r\n- $1 \\le N \\le 10^5$\r\n- $0 \\le A_i \\lt 998,244,352$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $N \\le 5,000$\r\n- $A_i \\le 5,000$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $5,000$\r\n\r\n**Subtask #2 (20 points):**\r\n- $N \\le 5,000$\r\n- the sum of $N$ over all test cases does not exceed $5,000$\r\n\r\n**Subtask #3 (70 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3\r\n2\r\n2 2\r\n2\r\n5 5\r\n3\r\n3 4 5","output":"443664157\r\n221832079\r\n598946612","explanation":"","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/zq45DyxIoUk","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"choudhary463","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>choudhary463<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"23-07-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/choudhary463'>choudhary463<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/math'>math<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nov20'>nov20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/polynomial'>polynomial<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Medium Hard","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CHEFSSM","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797928},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=CHEFSSM","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}