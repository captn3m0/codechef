{"category_name":"medium","status":"success","problem_code":"SHUFGRID","problem_name":"Grid Shuffle","body":"You are given a square grid $G$ with $N$ rows (numbered $1$ through $N$) and $N$ columns (numbered $1$ through $N$). Let's denote the element in the $i$-th row and $j$-th column by $G_{i, j}$. Initially, for each valid $i, j$, the element $G_{i, j}$ is equal to $i \\cdot N+j$.\r\n\r\nThe grid is changing in steps. In one step, either one row or one column of the grid is selected uniformly randomly and then, all the elements in the selected row or column are shuffled uniformly randomly.\r\n\r\nFor a given cell in row $r$ and column $c$, find the probability that after $K$ steps, $G_{r, c}$ is equal to $r \\cdot N + c$. It can be proved that this probability can be expressed as an irreducible fraction $p\/q$, where $q$ is a positive integer coprime to $998,244,353$. You should compute $p \\cdot q^{-1}$ modulo $998,244,353$, where $q^{-1}$ denotes the multiplicative inverse of $q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains four space-separated integers $N$, $K$, $r$ and $c$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $p \\cdot q^{-1}\\, \\%\\, 998,244,353$.\r\n\r\n### Constraints \r\n- $1 \\le T \\le 5$\r\n- $1 \\le N, K \\le 1,000$\r\n- $1 \\le r, c \\le N$\r\n\r\n### Example Input\r\n```\r\n2\r\n1 2 1 1\r\n2 1 1 1\r\n```\r\n\r\n### Example Output\r\n```\r\n1\r\n249561089\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** Since there is only one row and one column, both with just one element, the grid after each step is the same as the initial grid.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"You are given a square grid $G$ with $N$ rows (numbered $1$ through $N$) and $N$ columns (numbered $1$ through $N$). Let's denote the element in the $i$-th row and $j$-th column by $G_{i, j}$. Initially, for each valid $i, j$, the element $G_{i, j}$ is equal to $i \\cdot N+j$.\r\n\r\nThe grid is changing in steps. In one step, either one row or one column of the grid is selected uniformly randomly and then, all the elements in the selected row or column are shuffled uniformly randomly.\r\n\r\nFor a given cell in row $r$ and column $c$, find the probability that after $K$ steps, $G_{r, c}$ is equal to $r \\cdot N + c$. It can be proved that this probability can be expressed as an irreducible fraction $p\/q$, where $q$ is a positive integer coprime to $998,244,353$. You should compute $p \\cdot q^{-1}$ modulo $998,244,353$, where $q^{-1}$ denotes the multiplicative inverse of $q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains four space-separated integers $N$, $K$, $r$ and $c$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $p \\cdot q^{-1}\\, \\%\\, 998,244,353$.\r\n\r\n### Constraints \r\n- $1 \\le T \\le 5$\r\n- $1 \\le N, K \\le 1,000$\r\n- $1 \\le r, c \\le N$\r\n\r\n### Example Input\r\n```\r\n2\r\n1 2 1 1\r\n2 1 1 1\r\n```\r\n\r\n### Example Output\r\n```\r\n1\r\n249561089\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** Since there is only one row and one column, both with just one element, the grid after each step is the same as the initial grid.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"rumblefool","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>rumblefool<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"13-10-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/rumblefool'>rumblefool<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"","time":{"view_start_date":1136053800,"submit_start_date":1136053800,"visible_start_date":1136053800,"end_date":1735669800,"current":1643797977},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SHUFGRID","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}