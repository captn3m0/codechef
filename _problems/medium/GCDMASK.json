{"category_name":"medium","status":"success","problem_code":"GCDMASK","problem_name":"GCD of the Submasks","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME84\/hindi\/GCDMASK.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME84\/bengali\/GCDMASK.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME84\/mandarin\/GCDMASK.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME84\/russian\/GCDMASK.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME84\/vietnamese\/GCDMASK.pdf) as well.\r\n\r\nFor a non-negative integer $X$, the function $G(X)$ is defined as the greatest common divisor of all the integers generated by all submasks of the binary representation of $X$, i.e. integers obtained by replacing some (possibly none or all) $1$-s in this binary representation by $0$-s.\r\n\r\nYou are given an integer $N$. Find $S = \\sum_{X=1}^N X^{G(X)}$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains an integer $N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $S$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 200,000$\r\n- $1 \\le N \\le 10^9$\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points):** $N \\le 10^6$\r\n\r\n**Subtask #2 (80 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n5\r\n3\r\n7\r\n69\r\n2016\r\n331051\r\n```\r\n\r\n### Example Output\r\n```\r\n8\r\n312\r\n181039055\r\n148008009\r\n230394751\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME84\/hindi\/GCDMASK.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME84\/bengali\/GCDMASK.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME84\/mandarin\/GCDMASK.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME84\/russian\/GCDMASK.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME84\/vietnamese\/GCDMASK.pdf) as well.\r\n\r\nFor a non-negative integer $X$, the function $G(X)$ is defined as the greatest common divisor of all the integers generated by all submasks of the binary representation of $X$, i.e. integers obtained by replacing some (possibly none or all) $1$-s in this binary representation by $0$-s.\r\n\r\nYou are given an integer $N$. Find $S = \\sum_{X=1}^N X^{G(X)}$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains an integer $N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $S$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 200,000$\r\n- $1 \\le N \\le 10^9$\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points):** $N \\le 10^6$\r\n\r\n**Subtask #2 (80 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"5\r\n3\r\n7\r\n69\r\n2016\r\n331051","output":"8\r\n312\r\n181039055\r\n148008009\r\n230394751","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"sjshohag","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>sjshohag<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"12-05-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/lagrange-interpolation'>lagrange-interpolation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime84'>ltime84<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/number-theory'>number-theory<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sjshohag'>sjshohag<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Number Theory","editorial_url":"https:\/\/discuss.codechef.com\/problems\/GCDMASK","time":{"view_start_date":1590858002,"submit_start_date":1590858002,"visible_start_date":1590858002,"end_date":1735669800,"current":1643797944},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=GCDMASK","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}