{"category_name":"medium","status":"success","problem_code":"WGTNKLC","problem_name":"Weighted Necklace","body":"You are given $K$ different colors of beads. A bead of the $i$-th color has a weight $w_i$. You have infinitely many beads of each color. All the beads of the same color have the same weight.  \r\n\r\nYou have to answer $q$ independent queries. For each query, you will be given $S$. You have to form a necklace consisting of $n$ beads such that the total weight of the necklace is $S$. You can use any number of beads of a single color (possibly zero). Count the number of distinct possible necklaces you can make. Two necklaces will be considered the same if one can be rotated to another.\r\n\r\n### Input\r\n- First line contains $n$, denoting the size of the necklace.\r\n- Second line contains $K$, denoting the number of different colors.\r\n- Third line contains $K$ space separated integers, where the $i$-th integer $w_i$ denotes the weight of a bead of color $i$.\r\n- Fourth line contains $q$, denoting the number of queries.\r\n- Each of the next $q$ lines will contain a single integer $S$, denoting the total weight of the necklace for this query.\r\n\r\n### Output\r\n For each query, output in a new line, the number of valid necklaces mod $998244353$.\r\n\r\n### Constraints \r\n- $1 \\le n, q, K, w_i, S \\le 10^5$\r\n- $n$ will be a power of two\r\n\r\n### Example Input\r\n```\r\n4\r\n4\r\n1 2 3 4\r\n4\r\n5\r\n6\r\n7\r\n8\r\n```\r\n\r\n### Example Output\r\n```\r\n1\r\n3\r\n5\r\n9\r\n```\r\n\r\n### Explanation\r\nFor S = 6, three ways to form the necklace are:\r\n- 1 -> 1 -> 1 -> 3\r\n- 1 -> 1 -> 2 -> 2\r\n- 1 -> 2 -> 1 -> 2  \r\nPlease note, we do not count 2 -> 1 -> 1 -> 2 because it is just a rotation of 1 -> 1 -> 2 -> 2.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"You are given $K$ different colors of beads. A bead of the $i$-th color has a weight $w_i$. You have infinitely many beads of each color. All the beads of the same color have the same weight.  \r\n\r\nYou have to answer $q$ independent queries. For each query, you will be given $S$. You have to form a necklace consisting of $n$ beads such that the total weight of the necklace is $S$. You can use any number of beads of a single color (possibly zero). Count the number of distinct possible necklaces you can make. Two necklaces will be considered the same if one can be rotated to another.\r\n\r\n### Input\r\n- First line contains $n$, denoting the size of the necklace.\r\n- Second line contains $K$, denoting the number of different colors.\r\n- Third line contains $K$ space separated integers, where the $i$-th integer $w_i$ denotes the weight of a bead of color $i$.\r\n- Fourth line contains $q$, denoting the number of queries.\r\n- Each of the next $q$ lines will contain a single integer $S$, denoting the total weight of the necklace for this query.\r\n\r\n### Output\r\n For each query, output in a new line, the number of valid necklaces mod $998244353$.\r\n\r\n### Constraints \r\n- $1 \\le n, q, K, w_i, S \\le 10^5$\r\n- $n$ will be a power of two\r\n\r\n### Example Input\r\n```\r\n4\r\n4\r\n1 2 3 4\r\n4\r\n5\r\n6\r\n7\r\n8\r\n```\r\n\r\n### Example Output\r\n```\r\n1\r\n3\r\n5\r\n9\r\n```\r\n\r\n### Explanation\r\nFor S = 6, three ways to form the necklace are:\r\n- 1 -> 1 -> 1 -> 3\r\n- 1 -> 1 -> 2 -> 2\r\n- 1 -> 2 -> 1 -> 2  \r\nPlease note, we do not count 2 -> 1 -> 1 -> 2 because it is just a rotation of 1 -> 1 -> 2 -> 2.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"msi_cse_buet","problem_author_html_handle":"msi_cse_buet","problem_tester":null,"problem_tester_html_handle":"","date_added":"5-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/msi_cse_buet'>msi_cse_buet<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"","time":{"view_start_date":1578249000,"submit_start_date":1578249000,"visible_start_date":1578249000,"end_date":1735669800,"current":1643797989},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=WGTNKLC","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}