{"category_name":"medium","status":"success","problem_code":"MATBEAUT","problem_name":"Make the Matrix Beautiful","body":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK131\/mandarin\/MATBEAUT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK131\/russian\/MATBEAUT.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK131\/vietnamese\/MATBEAUT.pdf) and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK131\/bengali\/MATBEAUT.pdf) as well.\n\nYou are given an $N \\times M$ matrix where each element of the matrix consists of an integer color. Let $A[i][j]$ be the color on the matrix in the $i$-th row from the top and $j$-th column from the left. You need to make the matrix *beautiful*.\n\nBy definition, a matrix is *beautiful* if all the elements of the $i$-th row have color $i$. \nThat is, all the elements of the first row have color $1$, all elements of the second row have color $2$, so on.\n\nIn an operation, you can do the following:\n\n- Choose four integers $x_1, y_1, x_2, y_2$ ($1\\le x_1, x_2\\le N$, $1\\le y_1, y_2\\le M$, $x_1\\ne x_2, y_1\\ne y_2$)\n- Swap the values $A[x_1][y_1]$ and $A[x_2][y_1]$.\n- Swap the values $A[x_1][y_2]$ and $A[x_2][y_2]$.\n\nIf you can make the matrix beautiful, then give a sequence of at most $(N+3)\\cdot (M+3)$ operations to do so. Otherwise, print $-1$.\n\nWe have a proof that if it is possible to make the matrix beautiful in a finite number of operations, then it can be done in at most $(N+3)\\cdot (M+3)$ operations.\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"- $1 \\leq T \\leq 100$\n- $1 \\leq N, M \\leq 50$\n- Each column contains a permutation of the integers $1,\\ldots, N$.","constraintsState":true,"subtasks":"- 30 points : $1 \\leq R \\leq 10000$\n- 70 points : $1 \\leq R \\leq 10^9$\n","subtasksState":false,"statement":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK131\/mandarin\/MATBEAUT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK131\/russian\/MATBEAUT.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK131\/vietnamese\/MATBEAUT.pdf) and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK131\/bengali\/MATBEAUT.pdf) as well.\n\nYou are given an $N \\times M$ matrix where each element of the matrix consists of an integer color. Let $A[i][j]$ be the color on the matrix in the $i$-th row from the top and $j$-th column from the left. You need to make the matrix *beautiful*.\n\nBy definition, a matrix is *beautiful* if all the elements of the $i$-th row have color $i$. \nThat is, all the elements of the first row have color $1$, all elements of the second row have color $2$, so on.\n\nIn an operation, you can do the following:\n\n- Choose four integers $x_1, y_1, x_2, y_2$ ($1\\le x_1, x_2\\le N$, $1\\le y_1, y_2\\le M$, $x_1\\ne x_2, y_1\\ne y_2$)\n- Swap the values $A[x_1][y_1]$ and $A[x_2][y_1]$.\n- Swap the values $A[x_1][y_2]$ and $A[x_2][y_2]$.\n\nIf you can make the matrix beautiful, then give a sequence of at most $(N+3)\\cdot (M+3)$ operations to do so. Otherwise, print $-1$.\n\nWe have a proof that if it is possible to make the matrix beautiful in a finite number of operations, then it can be done in at most $(N+3)\\cdot (M+3)$ operations.","inputFormat":"- The first line contains a single integer $T$ - the number of test cases. Then the test cases follow.\n- The first line of each test case contains two integers $N$ and $M$.\n- The next $N$ lines have $M$ integers each. The $j$-th integer in the $i$-th line denotes $A[i][j]$","inputFormatState":true,"outputFormat":"For each test case:\n\n- If it is possible to make the matrix beautiful:\n    - Print the number of operations you perform in a new line. This number has to be less than or equal to $(N+3) \\cdot (M+3)$.\n    - For each operation print four integers: $x_1$, $y_1$, $x_2$, $y_2$ in a new line. \n- If it is not possible to make the matrix beautiful:\n    - Print $-1$ in a new line.\n\nIf there are multiple ways to make the matrix beautiful with at most $(N+3) \\cdot (M+3)$ operations, you may print any of them.","outputFormatState":true,"sampleTestCases":[{"id":"1","input":"2\n3 3\n1 1 1\n2 3 3\n3 2 2\n3 3\n1 1 1\n2 3 2\n3 2 3","output":"1\n2 2 3 3\n-1","explanation":"- For the first test case, we can swap $A[2][2], A[3][2]$ and swap $A[2][3],A[3][3]$ to make the matrix beautiful.\n- For the second test case it is not possible to make the matrix beautiful.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/9-CEWG5Ed2A","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"smarth297","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>smarth297<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"25-07-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/constructive'>constructive<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/cook131'>cook131<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/matrices'>matrices<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/smarth297'>smarth297<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MATBEAUT","time":{"view_start_date":1627492504,"submit_start_date":1627492504,"visible_start_date":1627492504,"end_date":1735669800,"current":1643797955},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=MATBEAUT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}