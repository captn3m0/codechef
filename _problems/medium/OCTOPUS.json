{"category_name":"medium","status":"success","problem_code":"OCTOPUS","problem_name":"5 - Ideal octopuses","body":"You are given a rooted tree with $n$ vertices and root vertex $1$. Each other vertex $2 \\leq i \\leq n$ has parent vertex $1 \\leq p_i < i$.\r\n\r\nDefine a **descending path** starting at the vertex $v$ as a sequence of $k \\geq 2$ vertices $v=v_1, v_2, \\ldots, v_k$ where for all $1 \\leq i \\leq k - 1$, the vertex $v_i$ is the parent of $v_{i+1}$. Define the **length** of such a path as $k - 1$.\r\n\r\nLet's define an **octopus** with root $v$ as the union of any non-negative number of descending paths starting at the vertex $v$, where each pair of such paths only has $v$ in common. It is possible that an octopus contains no paths; in such case, the octopus consists of only one vertex $v$.\r\n\r\nLet's call an octopus with root $v$ **ideal** if the **bitwise XOR** of the lengths of all the descending paths starting at $v$ it contains is equal to $0$. If the number of paths is equal to $0$, the XOR is defined as $0$.\r\n\r\nFind the number of ideal octopuses with root $v$ for all vertices $v$ of the tree. Two octopuses are considered different if the sets of vertices that they contain are different. As these numbers can be very large, you should find their remainders modulo $998\\,244\\,353$.\r\n\r\n###Input:\r\n\r\nThe first line contains one integer $t$ - the number of test cases. The next $2t$ lines describe test cases.\r\n\r\nThe first line of each test case contains one integer $n$ - the number of vertices in the tree.\r\n\r\nThe second line  of each test case contains $n-1$ integers $p_2, p_3, \\ldots, p_n$ - the parent vertices for each of $i\\in [2,n]$.\r\n\r\n###Output:\r\n\r\nFor each test case print $n$ integers. The $i$-th of them should be the remainder of the number of ideal octopuses with vertex $i$ as the root modulo $998\\,244\\,353$.\r\n\r\n###Constraints \r\n\r\n- $1 \\leq t \\leq 10^5$\r\n- $2 \\leq n \\leq 500\\,000$\r\n- $1 \\leq p_i < i$ for all $2 \\leq i \\leq n$\r\n- the sum of $n$ for all test cases does not exceed $10^6$\r\n\r\n###Subtasks\r\n\r\n**Subtask #1 (15 points):**\r\n- $t \\leq 100$\r\n- $n \\leq 16$\r\n\r\n**Subtask #2 (30 points):**\r\n- $n \\leq 2000$\r\n- the sum of $n$ for all test cases does not exceed $10^5$\r\n\r\n**Subtask #3 (55 points):** original constraints\r\n\r\n###Sample Input:\r\n    2\r\n    5\r\n    1 1 1 1\r\n    18\r\n    1 2 2 1 5 5 5 7 7 8 11 8 13 1 15 16 17\r\n\r\n###Sample Output:\r\n    8 1 1 1 1 \r\n    38 2 1 1 12 1 2 3 1 1 1 1 1 1 1 1 1 1 \r\n\r\n\t\r\n###EXPLANATION:\r\n\r\nIn the first test case, for each vertex from $2$ to $5$, there exists only one octopus with it as the root, and that octopus is ideal. For vertex $1$, the number of ideal octopuses with vertex $1$ as the root is equal to the number of subsets of $\\{2, 3, 4, 5\\}$ with even size, which is equal to $8$.\r\n\r\nThe picture of the tree in the second test case:\r\n\r\n<img src=\"https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/BENDSP02\/OCTOPUS\/OCTOPUS.png\" alt=\"sample 2 picture\" height=\"100%\" width=\"100%\">\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"You are given a rooted tree with $n$ vertices and root vertex $1$. Each other vertex $2 \\leq i \\leq n$ has parent vertex $1 \\leq p_i < i$.\r\n\r\nDefine a **descending path** starting at the vertex $v$ as a sequence of $k \\geq 2$ vertices $v=v_1, v_2, \\ldots, v_k$ where for all $1 \\leq i \\leq k - 1$, the vertex $v_i$ is the parent of $v_{i+1}$. Define the **length** of such a path as $k - 1$.\r\n\r\nLet's define an **octopus** with root $v$ as the union of any non-negative number of descending paths starting at the vertex $v$, where each pair of such paths only has $v$ in common. It is possible that an octopus contains no paths; in such case, the octopus consists of only one vertex $v$.\r\n\r\nLet's call an octopus with root $v$ **ideal** if the **bitwise XOR** of the lengths of all the descending paths starting at $v$ it contains is equal to $0$. If the number of paths is equal to $0$, the XOR is defined as $0$.\r\n\r\nFind the number of ideal octopuses with root $v$ for all vertices $v$ of the tree. Two octopuses are considered different if the sets of vertices that they contain are different. As these numbers can be very large, you should find their remainders modulo $998\\,244\\,353$.\r\n\r\n###Input:\r\n\r\nThe first line contains one integer $t$ - the number of test cases. The next $2t$ lines describe test cases.\r\n\r\nThe first line of each test case contains one integer $n$ - the number of vertices in the tree.\r\n\r\nThe second line  of each test case contains $n-1$ integers $p_2, p_3, \\ldots, p_n$ - the parent vertices for each of $i\\in [2,n]$.\r\n\r\n###Output:\r\n\r\nFor each test case print $n$ integers. The $i$-th of them should be the remainder of the number of ideal octopuses with vertex $i$ as the root modulo $998\\,244\\,353$.\r\n\r\n###Constraints \r\n\r\n- $1 \\leq t \\leq 10^5$\r\n- $2 \\leq n \\leq 500\\,000$\r\n- $1 \\leq p_i < i$ for all $2 \\leq i \\leq n$\r\n- the sum of $n$ for all test cases does not exceed $10^6$\r\n\r\n###Subtasks\r\n\r\n**Subtask #1 (15 points):**\r\n- $t \\leq 100$\r\n- $n \\leq 16$\r\n\r\n**Subtask #2 (30 points):**\r\n- $n \\leq 2000$\r\n- the sum of $n$ for all test cases does not exceed $10^5$\r\n\r\n**Subtask #3 (55 points):** original constraints\r\n\r\n###Sample Input:\r\n    2\r\n    5\r\n    1 1 1 1\r\n    18\r\n    1 2 2 1 5 5 5 7 7 8 11 8 13 1 15 16 17\r\n\r\n###Sample Output:\r\n    8 1 1 1 1 \r\n    38 2 1 1 12 1 2 3 1 1 1 1 1 1 1 1 1 1 \r\n\r\n\t\r\n###EXPLANATION:\r\n\r\nIn the first test case, for each vertex from $2$ to $5$, there exists only one octopus with it as the root, and that octopus is ideal. For vertex $1$, the number of ideal octopuses with vertex $1$ as the root is equal to the number of subsets of $\\{2, 3, 4, 5\\}$ with even size, which is equal to $8$.\r\n\r\nThe picture of the tree in the second test case:\r\n\r\n<img src=\"https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/BENDSP02\/OCTOPUS\/OCTOPUS.png\" alt=\"sample 2 picture\" height=\"100%\" width=\"100%\">\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1.5","source_sizelimit":"50000","problem_author":"isaf27","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>isaf27<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"7-08-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/isaf27'>isaf27<\/a>","problem_difficulty_level":"Unavailable","user_zen_mode":false,"best_tag":"","editorial_url":"","time":{"view_start_date":1607770800,"submit_start_date":1607770800,"visible_start_date":1607770800,"end_date":1735669800,"current":1643797964},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=OCTOPUS","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}