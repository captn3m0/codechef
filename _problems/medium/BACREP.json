{"category_name":"medium","status":"success","problem_code":"BACREP","problem_name":"Bacterial Reproduction","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/OCT19\/hindi\/BACREP.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/OCT19\/bengali\/BACREP.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/OCT19\/mandarin\/BACREP.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/OCT19\/russian\/BACREP.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/OCT19\/vietnamese\/BACREP.pdf) as well.\r\n\r\nChef has a rooted tree with $N$ vertices (numbered $1$ through $N$); vertex $1$ is the root of the tree. Initially, there are some bacteria in its vertices. Let's denote the number of sons of vertex $v$ by $s_v$; a leaf is a vertex without sons. During each second, the following events happen:\r\n- For each non-leaf vertex $v$, if there are $x$ bacteria in this vertex at the start of this second, they divide into $s_v \\cdot x$ bacteria. At the end of this second, $x$ of these bacteria instantly move to each of its sons (none of them stay in vertex $v$). The original $x$ bacteria do not exist any more.\r\n- Zero or more bacteria appear in one vertex. These bacteria do not divide or move at this second.\r\n\r\nInitially, we are at the start of second $0$. You should process $Q$ queries \u2015 one query during each of the seconds $0$ through $Q-1$. There are two types of queries:\r\n- `+ v k`: During this second, $k$ bacteria appear in vertex $v$.\r\n- `? v`: Find the number of bacteria in vertex $v$ at the end of this second \u2015 after the divided bacteria have moved.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $Q$.\r\n- Each of the next $N-1$ lines contains two space-separated integers $x$ and $y$ denoting that vertices $x$ and $y$ are connected by an edge.\r\n- The next line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$ denoting the initial numbers of bacteria in vertices $1$ through $N$.\r\n- $Q$ lines follow. Each of these lines describes a query in the format `+ v k` or `? v`.\r\n\r\n### Output\r\nFor each query of the second type, print a single line containing one integer \u2015 the number of bacteria in the given vertex.\r\n\r\n### Constraints\r\n- $1 \\le N, Q \\le 5 \\cdot 10^5$\r\n- $1 \\le a_i \\le 10^9$ for each valid $i$\r\n- $1 \\le x, y \\le N$\r\n- the graph described on the input is a tree\r\n- $1 \\le v \\le N$\r\n- $1 \\le k \\le 10^9$\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points):** $1 \\le N, Q \\le 5,000$\r\n\r\n**Subtask #2 (30 points):** $1 \\le N, Q \\le 10^5$\r\n\r\n**Subtask #3 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n5 8\r\n4 3\r\n3 1\r\n5 2\r\n1 2\r\n1 10 4 9 4\r\n+ 1 6\r\n? 3\r\n+ 3 5\r\n? 3\r\n+ 2 2\r\n+ 5 10\r\n? 5\r\n? 4\r\n```\r\n\r\n### Example Output\r\n```\r\n6\r\n0\r\n33\r\n25\r\n```\r\n\r\n### Explanation\r\nThe numbers of bacteria in all vertices at the end of each second are:\r\n- $0$-th second: $6, 1, 1, 13, 14$\r\n- $1$-st second: $0, 6, 6, 14, 15$\r\n- $2$-nd second: $0, 0, 5, 20, 21$\r\n- $3$-rd second: $0, 0, 0, 25, 21$\r\n- $4$-th second: $0, 2, 0, 25, 21$\r\n- $5$-th second: $0, 0, 0, 25, 33$\r\n- $6$-th second: $0, 0, 0, 25, 33$\r\n- $7$-th second: $0, 0, 0, 25, 33$\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/OCT19\/hindi\/BACREP.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/OCT19\/bengali\/BACREP.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/OCT19\/mandarin\/BACREP.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/OCT19\/russian\/BACREP.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/OCT19\/vietnamese\/BACREP.pdf) as well.\r\n\r\nChef has a rooted tree with $N$ vertices (numbered $1$ through $N$); vertex $1$ is the root of the tree. Initially, there are some bacteria in its vertices. Let's denote the number of sons of vertex $v$ by $s_v$; a leaf is a vertex without sons. During each second, the following events happen:\r\n- For each non-leaf vertex $v$, if there are $x$ bacteria in this vertex at the start of this second, they divide into $s_v \\cdot x$ bacteria. At the end of this second, $x$ of these bacteria instantly move to each of its sons (none of them stay in vertex $v$). The original $x$ bacteria do not exist any more.\r\n- Zero or more bacteria appear in one vertex. These bacteria do not divide or move at this second.\r\n\r\nInitially, we are at the start of second $0$. You should process $Q$ queries \u2015 one query during each of the seconds $0$ through $Q-1$. There are two types of queries:\r\n- `+ v k`: During this second, $k$ bacteria appear in vertex $v$.\r\n- `? v`: Find the number of bacteria in vertex $v$ at the end of this second \u2015 after the divided bacteria have moved.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $Q$.\r\n- Each of the next $N-1$ lines contains two space-separated integers $x$ and $y$ denoting that vertices $x$ and $y$ are connected by an edge.\r\n- The next line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$ denoting the initial numbers of bacteria in vertices $1$ through $N$.\r\n- $Q$ lines follow. Each of these lines describes a query in the format `+ v k` or `? v`.\r\n\r\n### Output\r\nFor each query of the second type, print a single line containing one integer \u2015 the number of bacteria in the given vertex.\r\n\r\n### Constraints\r\n- $1 \\le N, Q \\le 5 \\cdot 10^5$\r\n- $1 \\le a_i \\le 10^9$ for each valid $i$\r\n- $1 \\le x, y \\le N$\r\n- the graph described on the input is a tree\r\n- $1 \\le v \\le N$\r\n- $1 \\le k \\le 10^9$\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points):** $1 \\le N, Q \\le 5,000$\r\n\r\n**Subtask #2 (30 points):** $1 \\le N, Q \\le 10^5$\r\n\r\n**Subtask #3 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"5 8\r\n4 3\r\n3 1\r\n5 2\r\n1 2\r\n1 10 4 9 4\r\n+ 1 6\r\n? 3\r\n+ 3 5\r\n? 3\r\n+ 2 2\r\n+ 5 10\r\n? 5\r\n? 4","output":"6\r\n0\r\n33\r\n25","explanation":"The numbers of bacteria in all vertices at the end of each second are:\r\n- $0$-th second: $6, 1, 1, 13, 14$\r\n- $1$-st second: $0, 6, 6, 14, 15$\r\n- $2$-nd second: $0, 0, 5, 20, 21$\r\n- $3$-rd second: $0, 0, 0, 25, 21$\r\n- $4$-th second: $0, 2, 0, 25, 21$\r\n- $5$-th second: $0, 0, 0, 25, 33$\r\n- $6$-th second: $0, 0, 0, 25, 33$\r\n- $7$-th second: $0, 0, 0, 25, 33$","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"mikaeel","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>mikaeel<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"1-08-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/fenwick-tree'>fenwick-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/mikaeel'>mikaeel<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/oct19'>oct19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/r_64'>r_64<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/trees'>trees<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Segment Tree","editorial_url":"https:\/\/discuss.codechef.com\/problems\/BACREP","time":{"view_start_date":1571045400,"submit_start_date":1571045400,"visible_start_date":1571045400,"end_date":1735669800,"current":1643797919},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=BACREP","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}