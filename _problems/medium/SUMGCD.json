{"category_name":"medium","status":"success","problem_code":"SUMGCD","problem_name":"GCD Sums","body":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK128\/mandarin\/SUMGCD.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK128\/russian\/SUMGCD.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK128\/bengali\/SUMGCD.pdf) as well.\r\n\r\nChef has an array $a_1,\\ldots, a_n$ of $n$ elements. He wants you to answer queries of the following type: \r\n\r\nCompute $f(L, R)$, where $$f(L, R) = \\sum_{i = L}^{R} \\sum_{j= i}^{R} \\gcd(a_i, a_{i+1}, \\dots a_j).$$ In other words, we want to compute the sum of the greatest common divisors over all subarrays of some range $[L, R]$. \r\nHelp Chef answer $q$ queries of the described type. \r\n\r\n\r\n###Input:\r\n\r\nThe first line contains two integers $n$ and $q$ - the size of the array and the number of queries.\r\n\r\nThe second line contains $n$ integers $a_1,\\ldots,a_n$.\r\n\r\nEach of the following $q$ lines contains two integers $l$, $r$.\r\n\r\nThe queries are encrypted. Let the answer to the previous query be $x$ (or $0$ if there is none). The query is decrypted as follows: $L=((l+x)\\mod n)+1$ and $R=((r+x) \\mod n)+1$.\r\n\r\n###Output:\r\n\r\nPrint $q$ integers - the answer to each query modulo $10^9+7$.\r\n\r\n###Constraints \r\n\r\n$1 \\leq n \\le 2\\cdot 10^5$\r\n\r\n$1 \\leq q \\le 10^6$\r\n\r\n$1 \\leq a_{i} \\le 10^9$\r\n\r\n$0 \\leq l, r \\le n$\r\n\r\n###Sample Input:\r\n5 6\r\n\r\n18 12 30 35 63\r\n\r\n0 4\r\n\r\n4 5\r\n\r\n1 4\r\n\r\n1 3\r\n\r\n4 1\r\n\r\n3 5\r\n\r\n###Sample Output:\r\n193\r\n\r\n70\r\n\r\n161\r\n\r\n141\r\n\r\n78\r\n\r\n89\r\n\t\r\n###EXPLANATION:\r\nThe decoded queries are respectively $f(1, 5)$; $f(3, 4)$; $f(2, 5)$; $f(3, 5)$; $f(1, 3)$; $f(2, 4)$\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK128\/mandarin\/SUMGCD.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK128\/russian\/SUMGCD.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK128\/bengali\/SUMGCD.pdf) as well.\r\n\r\nChef has an array $a_1,\\ldots, a_n$ of $n$ elements. He wants you to answer queries of the following type: \r\n\r\nCompute $f(L, R)$, where $$f(L, R) = \\sum_{i = L}^{R} \\sum_{j= i}^{R} \\gcd(a_i, a_{i+1}, \\dots a_j).$$ In other words, we want to compute the sum of the greatest common divisors over all subarrays of some range $[L, R]$. \r\nHelp Chef answer $q$ queries of the described type. \r\n\r\n\r\n###Input:\r\n\r\nThe first line contains two integers $n$ and $q$ - the size of the array and the number of queries.\r\n\r\nThe second line contains $n$ integers $a_1,\\ldots,a_n$.\r\n\r\nEach of the following $q$ lines contains two integers $l$, $r$.\r\n\r\nThe queries are encrypted. Let the answer to the previous query be $x$ (or $0$ if there is none). The query is decrypted as follows: $L=((l+x)\\mod n)+1$ and $R=((r+x) \\mod n)+1$.\r\n\r\n###Output:\r\n\r\nPrint $q$ integers - the answer to each query modulo $10^9+7$.\r\n\r\n###Constraints \r\n\r\n$1 \\leq n \\le 2\\cdot 10^5$\r\n\r\n$1 \\leq q \\le 10^6$\r\n\r\n$1 \\leq a_{i} \\le 10^9$\r\n\r\n$0 \\leq l, r \\le n$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"5 6\r\n\r\n18 12 30 35 63\r\n\r\n0 4\r\n\r\n4 5\r\n\r\n1 4\r\n\r\n1 3\r\n\r\n4 1\r\n\r\n3 5","output":"193\r\n\r\n70\r\n\r\n161\r\n\r\n141\r\n\r\n78\r\n\r\n89","explanation":"The decoded queries are respectively $f(1, 5)$; $f(3, 4)$; $f(2, 5)$; $f(3, 5)$; $f(1, 3)$; $f(2, 4)$","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"martin53","problem_author_html_handle":"martin53","problem_tester":"","problem_tester_html_handle":"","date_added":"14-04-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook128'>cook128<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/divide-and-conquer'>divide-and-conquer<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/greatest-common-divisor'>greatest-common-divisor<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/martin53'>martin53<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sparse-table'>sparse-table<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Divide And Conquer","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SUMGCD","time":{"view_start_date":1618772404,"submit_start_date":1618772404,"visible_start_date":1618772404,"end_date":1735669800,"current":1643797982},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SUMGCD","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}