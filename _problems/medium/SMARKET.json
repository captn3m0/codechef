{"category_name":"medium","status":"success","problem_code":"SMARKET","problem_name":"Stable market","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/APRIL17\/mandarin\/SMARKET.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/APRIL17\/russian\/SMARKET.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/APRIL17\/vietnamese\/SMARKET.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Sometimes, the stability of a stock market is at least as important as rapid price changes.<\/p>\n\n<p>Let a <b>stable block<\/b> be a maximal consecutive block of days with same stock prices.<\/p>\n\n<p>Moreover, let a <b>stable block of order K<\/b> be a stable block of length <b>at least K<\/b>.<\/p>\n\nFor example, if stock prices for 7 consecutive days are: 20, 10, 10, 7, 7, 7, 10, then there are 4 stable blocks there: [20], [10, 10], [7, 7, 7] and [10]. Moreover, there are:\n<p><\/p>\n<ul>\n<li>0 stable blocks of order 4 or higher\n<li>1 stable block of order 3: [7, 7, 7]\n<li>2 stable block of order 2: [10, 10], [7, 7, 7]\n<li>4 stable block of order 1: [20], [10, 10], [7, 7, 7] and [10]\n<\/ul>\n<p><\/p>\n\n<p>Given historical prices of a stock across <b>N<\/b> days, the goal is to answer <b>Q<\/b> customers' questions.<\/p>\n\n<p>The <b>i<\/b>-th question contains three integers <b>L<sub>i<\/sub>, R<sub>i<\/sub><\/b> and <b>K<sub>i<\/sub><\/b>. It asks for the number of stable blocks of order <b>K<sub>i<\/sub><\/b>, if only the stock prices of the days in the range <b>L<sub>i<\/sub>, R<sub>i<\/sub><\/b> are considered.\n\n<h3>Input<\/h3>\n<ul>\n<li>In the first line there is a single integer <b>T<\/b>, denoting the number of test cases to handle. After that the description of <b>T<\/b> test cases follow.<\/li>\n\n<li>The first line of each test case contains two space-separated integers <b>N<\/b> and <b>Q<\/b>, denoting respectively, the number of days for which the stock prices are given, and the number of questions to answer.<\/li>\n\n<li>\nThe second line contains <b>N<\/b> space-separated integers <b>A<sub>1<\/sub>, A<sub>2<\/sub>, ..., A<sub>N<\/sub><\/b>, where <b>A<sub>i<\/sub><\/b> denotes the price of the stock on the <b>i<\/b>-th day. \n<\/li>\n<li>\n<b>Q<\/b> lines follow. In the <b>i<\/b>-th of them there are three space-separated integers <b>L<sub>i<\/sub>, R<sub>i<\/sub><\/b> and <b>K<sub>i<\/sub><\/b> denoting the <b>i<\/b>-th query.\n<\/li>\n<\/ul>\n\n<h3>Output<\/h3>\n<p>\nFor each test case, print answers to all queries in the test case, one per line.\n<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>T<\/b> \u2264 5<\/li> \n<li>1 \u2264 <b>N, Q<\/b> \u2264 10<sup>5<\/li> \n<li>1 \u2264 <b>A<sub>i<\/sub><\/b> \u2264 10<sup>6<\/li> \n<li>1 \u2264 <b>L<sub>i<\/sub><\/b> \u2264 <b>R<sub>i<\/sub><\/b> \u2264 <b>N<\/b><\/li> \n<li>1 \u2264 <b>K<sub>i<\/sub><\/b> \u2264 <b>R<sub>i<\/sub> - L<sub>i<\/sub> + 1<\/b><\/li> \n<\/ul>\n\n<h3>Subtasks<\/h3>\n<p>\n<b>Subtask #1: (10 points)<\/b>\n<ul>\n<li>1 \u2264 <b>N, Q<\/b> \u2264 3000<\/li> \n<\/ul>\n<\/p>\n\n<p>\n<b>Subtask #2: (90 points)<\/b>\n<ul>\n<li>original constraints<\/li>\n<\/ul>\n<\/p>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\n8 5\n20 10 10 10 7 7 7 10\n2 6 2\n3 6 2\n3 6 3\n3 8 3\n3 8 1\n3 2\n27 27 27\n1 3 1\n2 2 1\n\n\n<b>Output:<\/b>\n2\n2\n0\n1\n3\n1\n1\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>There are two test cases to handle<\/p>\n\n<p><b>Test case #1:<\/b><\/p>\n<p>There are <b>8<\/b> days for which prices are given and <b>5<\/b> queries to handle.<\/p>\n<p>The first query asks for the number of stable blocks of order <b>2<\/b> in range <b>[2, 6]<\/b>, which corresponds to prices <b>10 10 10 7 7<\/b>. The answer is <b>2<\/b> because there are two such blocks: <b>10 10 10<\/b> and <b>7 7<\/b>.<\/p>\n<p>The second query asks for the number of stable blocks of order <b>2<\/b> in range <b>[3, 6]<\/b>, which corresponds to prices <b>10 10 7 7<\/b>. The answer is <b>2<\/b> because there are two such blocks: <b>10 10<\/b> and <b>7 7<\/b>.<\/p>\n<p>The third query asks for the number of stable blocks of order <b>3<\/b> in range <b>[3, 6]<\/b>, which corresponds to prices <b>10 10 7 7<\/b>. The answer is <b>0<\/b> because there is no stable block of order <b>3<\/b> there (maximum order of a stable block is <b>2<\/b>).<\/p>\n<p>The fourth query asks for the number of stable blocks of order <b>3<\/b> in range <b>[3, 8]<\/b>, which corresponds to prices <b>10 10 7 7 7 10<\/b>. The answer is <b>1<\/b> because the only stable block of order <b>3<\/b> here is <b>7 7 7<\/b>.<\/p>\n<p>The fifth query asks for the number of stable blocks of order <b>1<\/b> in range <b>[3, 8]<\/b>, which corresponds to prices <b>10 10 7 7 7 10<\/b>. The answer is <b>3<\/b> because there are <b>3<\/b> stable blocks of order <b>1<\/b> there: <b>10 10<\/b>, <b>7 7 7<\/b> and <b>10<\/b>.\n\n<p><b>Test case #2:<\/b><\/p>\n<p>There are <b>3<\/b> days for which prices are given and <b>2<\/b> queries to handle.<\/p>\n<p>The first query asks for the number of stable blocks of order <b>1<\/b> in range <b>[1, 3]<\/b>, which corresponds to prices <b>27 27 27<\/b>. The answer is <b>1<\/b> because the only such block there is <b>27 27 27<\/b>.<\/p>\n<p>The second query asks for the number of stable blocks of order <b>1<\/b> in range <b>[2, 2]<\/b>, which corresponds to a single price <b>27<\/b>. The answer is <b>1<\/b> because the only such block there is <b>27<\/b>.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"2","source_sizelimit":"50000","problem_author":"pkacprzak","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>pkacprzak<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"29-03-2017","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/april17'>\n                    april17\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/pkacprzak'>\n                    pkacprzak\n                <\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SMARKET","user":{"username":null},"time":{"view_start_date":1492421400,"submit_start_date":1492421400,"visible_start_date":1492421400,"end_date":1735669800,"current":1497284443},"todo":false,"problem_status":"unattempted"}