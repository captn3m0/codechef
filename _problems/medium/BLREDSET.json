{"category_name":"medium","status":"success","problem_code":"BLREDSET","problem_name":"Black and Red vertices of Tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>You are given a tree <b>T<\/b> with <b>N<\/b> vertices. The vertices are numbered from 1 to <b>N<\/b>. Some of the vertices are colored black and some are colored red. Also, some vertices can be uncolored. There is at least one black and at least one red vertex.<\/p>\n\n<p>Compute the number of subsets of vertices <b>W<\/b> such that:\n<ul>\n<li>Each vertex in <b>W<\/b> is uncolored.<\/li>\n<li><b>W<\/b> is a connected subgraph of <b>T<\/b>.<\/li>\n<li>If you remove all the vertices of set <b>W<\/b>, there will be at least one pair of vertices (<b>u<\/b>, <b>v<\/b>) such that:\n<ul>\n<li><b>u<\/b> is colored black and <b>v<\/b> red.<\/li>\n<li>There is no path from node <b>u<\/b> to node <b>v<\/b>.<\/li>\n<\/ul>\n<\/li>\n<\/ul><\/p>\n\n<p>Output your answer <b>modulo 10<sup>9<\/sup> + 7<\/b>.<\/p>\n\n<h3>Input<\/h3>\n<p>\n<ul>\n<li>The first line of the input contains a single integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/li>\n<li>The first line of each test case contains a single integer <b>N<\/b> denoting the number of vertices.<\/li>\n<li>Each of the next <b>N - 1<\/b> lines contains two space-separated integers <b>u<\/b> and <b>v<\/b> denoting an edge between vertices <b>u<\/b> and <b>v<\/b>.<\/li>\n<li>The next line contains <b>N<\/b> space-separated integers denoting the colors of the vertices. The <b>i<\/b>-th of these integers is 0 if vertex <b>i<\/b> is uncolored, 1 if it's black or 2 if it's red.<\/li>\n<\/ul>\n<\/p>\n\n<h3>Output<\/h3>\n<p>For each test case, print a single line containing one integer denoting the number of ways to select a valid subset <b>W<\/b>, modulo 10<sup>9<\/sup> + 7.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>T<\/b> \u2264 2 \u00b7 10<sup>5<\/sup><\/li>\n<li>2 \u2264 <b>N<\/b> \u2264 10<sup>5<\/sup><\/li>\n<li>1 \u2264 <b>u<\/b>, <b>v<\/b> \u2264 <b>N<\/b><\/li>\n<li>Sum of <b>N<\/b> over all test cases doesn't exceed 10<sup>6<\/sup><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre>\n<b>Input<\/b>\n2\n6\n1 2\n1 3\n1 4\n3 5\n3 6\n0 1 0 1 2 0\n6\n1 2\n1 3\n1 4\n3 5\n3 6\n1 0 0 0 2 0\n\n<b>Output<\/b>\n5\n2\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p><b>Example case 1:<\/b> The possible subsets <b>W<\/b> are <b>{1}, {3}, {1, 3}, {3, 6}<\/b> and <b>{1, 3, 6}<\/b>.<\/p>\n<p><b>Example case 2:<\/b> The possible subsets <b>W<\/b> are <b>{3}<\/b> and <b>{3, 6}<\/b>.<\/p>","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, CLOJ, COB, FS","max_timelimit":"5","source_sizelimit":"50000","problem_author":"admin2","problem_author_html_handle":"admin2","problem_tester":null,"problem_tester_html_handle":"","date_added":"21-11-2017","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/acm17chn'>acm17chn<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/admin2'>admin2<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/chn17rol'>chn17rol<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tree-dp'>tree-dp<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/BLREDSET","time":{"view_start_date":1515357000,"submit_start_date":1515357000,"visible_start_date":1515357000,"end_date":1735669800,"current":1525454465},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}