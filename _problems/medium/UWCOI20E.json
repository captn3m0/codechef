{"category_name":"medium","status":"success","problem_code":"UWCOI20E","problem_name":"Escape","body":"While Kim notes down the different base plans possible, Soum pulls a lever from the control room, and Kim falls into a trapped cell! Has the JSA won the battle?\r\n\r\nUnfortunately for the JSA, Kim is a genius, so he has obviously easily escaped from his cell. However, he found that his cell is only one in a large underground network of cells. Now he needs to find a way to escape!\r\n\r\nOf course, since it is a prison, some of the cells are locked at all times. However, some prison guards are lazy and left the keys for a cell in another cell. Each key can only unlock one cell and each cell can only be unlocked by one key. If any cell does not have a corresponding key, it is unlocked.\r\n\r\nThe prison consists of $N$ cells labelled 1 to $N$ with cell 1 being Kim's starting position and cell $N$ being the exit of the underground prison network. Furthermore, there are $E$ bidirectional connections between cells. The $i$-th connection takes Kim $C_i$ seconds to pass through, and connects cells $A_i$ and $B_i$. Kim takes no time to pick up a key when he reaches a cell containing a key, and takes no time to unlock a door with a key. Cells 1 and $N$ never have any keys in them. Additionally, no two keys will ever be found in the same cell.\r\n\r\nCan you help Kim find the minimum time it would take him to go from cell 1 to cell $N$?\r\n\r\n###Input:\r\n\r\nThe first line of input contains 3 integers $N$, $E$ and $K$ denoting the number of cells, number of connections and the number of keys.\r\n\r\nThe following $E$ lines contain 3 integers, $A_i$, $B_i$ and $C_i$ showing that a connection exists between cell $A_i$ and $B_i$ taking $C_i$ time to traverse.\r\n\r\nThe following $K$ lines contain 2 integers, $L$ and $U$ denoting that the key for cell $U$ is located at cell $L$.\r\n\r\n###Output:\r\n\r\nPrint one number $S$ which is the time from cell 1 to cell $N$. If this is not possible print -1.\r\n\r\nThe answer is guaranteed to fit into a 64 bit integer.\r\n\r\n###Subtasks\r\nFor all subtasks, $5 \\leq N \\leq 100000$, $4 \\leq E \\leq 200000$, $0 \\leq K \\leq 12$. For all edges, $1 \\leq A, B \\leq N$, $1 \\leq C \\leq 10^9$. All key nodes and lock nodes are distinct. No cell contains both a key and a lock, and no cell contains more than one key or more than one lock. In addition, cells $1$ and $N$ will never have a key or lock. Connections may connect a node to itself, and multiple connections may exist between two nodes.\r\n\r\nSubtask 1 [30 points]: $N \\leq 20000$, $E \\leq 100000$, $K = 0$\r\n\r\nSubtask 2 [30 points]: $N \\leq 10000$, $E \\leq 20000$, $K \\leq 6$\r\n\r\nSubtask 3 [40 points]: $N \\leq 100000$, $E \\leq 200000$, $K \\leq 12$\r\n\r\n###Sample Input:\r\n```\r\n5 4 1\r\n1 2 5\r\n2 3 7\r\n3 4 8\r\n4 5 2\r\n2 3\r\n```\r\n###Sample Output:\r\n```\r\n22\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"While Kim notes down the different base plans possible, Soum pulls a lever from the control room, and Kim falls into a trapped cell! Has the JSA won the battle?\r\n\r\nUnfortunately for the JSA, Kim is a genius, so he has obviously easily escaped from his cell. However, he found that his cell is only one in a large underground network of cells. Now he needs to find a way to escape!\r\n\r\nOf course, since it is a prison, some of the cells are locked at all times. However, some prison guards are lazy and left the keys for a cell in another cell. Each key can only unlock one cell and each cell can only be unlocked by one key. If any cell does not have a corresponding key, it is unlocked.\r\n\r\nThe prison consists of $N$ cells labelled 1 to $N$ with cell 1 being Kim's starting position and cell $N$ being the exit of the underground prison network. Furthermore, there are $E$ bidirectional connections between cells. The $i$-th connection takes Kim $C_i$ seconds to pass through, and connects cells $A_i$ and $B_i$. Kim takes no time to pick up a key when he reaches a cell containing a key, and takes no time to unlock a door with a key. Cells 1 and $N$ never have any keys in them. Additionally, no two keys will ever be found in the same cell.\r\n\r\nCan you help Kim find the minimum time it would take him to go from cell 1 to cell $N$?\r\n\r\n###Input:\r\n\r\nThe first line of input contains 3 integers $N$, $E$ and $K$ denoting the number of cells, number of connections and the number of keys.\r\n\r\nThe following $E$ lines contain 3 integers, $A_i$, $B_i$ and $C_i$ showing that a connection exists between cell $A_i$ and $B_i$ taking $C_i$ time to traverse.\r\n\r\nThe following $K$ lines contain 2 integers, $L$ and $U$ denoting that the key for cell $U$ is located at cell $L$.\r\n\r\n###Output:\r\n\r\nPrint one number $S$ which is the time from cell 1 to cell $N$. If this is not possible print -1.\r\n\r\nThe answer is guaranteed to fit into a 64 bit integer.\r\n\r\n###Subtasks\r\nFor all subtasks, $5 \\leq N \\leq 100000$, $4 \\leq E \\leq 200000$, $0 \\leq K \\leq 12$. For all edges, $1 \\leq A, B \\leq N$, $1 \\leq C \\leq 10^9$. All key nodes and lock nodes are distinct. No cell contains both a key and a lock, and no cell contains more than one key or more than one lock. In addition, cells $1$ and $N$ will never have a key or lock. Connections may connect a node to itself, and multiple connections may exist between two nodes.\r\n\r\nSubtask 1 [30 points]: $N \\leq 20000$, $E \\leq 100000$, $K = 0$\r\n\r\nSubtask 2 [30 points]: $N \\leq 10000$, $E \\leq 20000$, $K \\leq 6$\r\n\r\nSubtask 3 [40 points]: $N \\leq 100000$, $E \\leq 200000$, $K \\leq 12$\r\n\r\n###Sample Input:\r\n```\r\n5 4 1\r\n1 2 5\r\n2 3 7\r\n3 4 8\r\n4 5 2\r\n2 3\r\n```\r\n###Sample Output:\r\n```\r\n22\r\n```\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"kimbj0709","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span class='m-username--link'>kimbj0709<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"24-02-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/kimbj0709'>kimbj0709<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/uwcoi20'>uwcoi20<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/UWCOI20E","time":{"view_start_date":1582655400,"submit_start_date":1582655400,"visible_start_date":1582655400,"end_date":1735669800,"current":1643797988},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=UWCOI20E","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}