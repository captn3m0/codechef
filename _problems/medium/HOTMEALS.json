{"category_name":"medium","status":"success","problem_code":"HOTMEALS","problem_name":"Hot Meals and Queues","body":"### Read problem statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME93\/mandarin\/HOTMEALS.pdf), and [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME93\/russian\/HOTMEALS.pdf) as well.\r\n\r\nAs you know, there is a big problem in the educational system of Chefland - impudent students who cuts in line in the cafeteria. Chef wants to assess the problem. He was able to understand how the queue works:\r\n\r\n- Each student has value of discontent, which is initially equal to $0$;\r\n\r\n- Initially the queue is empty;\r\n\r\n- Students arrive at the queue one by one. Each student can either enter the queue in the end, or \\textit{cut in line}, by which we mean stand in front of one or more students already in the queue;\r\n\r\n- When someone cuts in line, the value of discontent of every student who ended up behind the new one is increased by $1$.\r\n\r\nFor example, if the students will enter the queue in the following order:\r\n\r\n$[] \\rightarrow [1] \\rightarrow [1,2] \\rightarrow [1,3,2] \\rightarrow [1,3,2,4] \\rightarrow [1,3,5,2,4]$\r\n\r\nThe discontent of the students in the queue will change as follows:\r\n\r\n$[] \\rightarrow [0] \\rightarrow [0,0] \\rightarrow [0,0,1] \\rightarrow [0,0,1,0] \\rightarrow [0,0,0,2,1]$\r\n\r\nNote that the values of discontent are given in the same order as students are in the queue in the end of the process, not in order they were entering the queue.\r\n\r\nLet's call the array of discontent values in the same order as students are in the queue in the end of the process \\textit{the array of discontent}. Chef notices that if one knows the array of discontent then it is possible to find out how many students cut in line. And then Chef decides to make a competitive programming problem out of it!\r\n\r\nYou are given array $a_{1}, a_{2}, \\ldots, a_{n}$. You have to process queries of two types:\r\n\r\n- Find the number of students who cut in line if the array of discontent is $[a_{l}, a_{l+1}, \\ldots, a_{r}]$ - that is, the subsegment of the array $a$;\r\n\r\n- Add a number $w$ to $a_{l}, a_{l+1}, \\ldots, a_{r}$ - that is, the subsegment of the array $a$.\r\n\r\nYou also have to find the number of students who cut in line using the initial $a$ as array of discontent.\r\n\r\n###Input:\r\n\r\n- The first line of input contains one integer $n$ ($3 \\le n \\le 5 \\cdot 10^5$) - the size of the array $a$.\r\n\r\n- The second line of input contains $n$ integers $a_1, a_2, \\ldots, a_n$ separated by spaces - the array $a$ itself.\r\n\r\n- The third line on input contains one integer $q$ ($0 \\le q \\le 5 \\cdot 10^5$) - the number of queries.\r\n\r\n- Then $q$ lines describing the queries follow.\r\n\r\n- Each line starts with integer $t$ - the type of the query.\r\n\r\n- If $t = 1$, then two more integers $l, r$ follow ($1 \\le l \\le r \\le n$). For this query you have to print the number of students who cut in line if the array of discontent is $[a_{l}, a_{l+1}, \\ldots, a_{r}]$.\r\n\r\n- If $t = 2$, then three more numbers $l, r, w$ follow ($1 \\le l \\le r \\le n$, $|w| < n$). For this query you have to add $w$ to numbers $a_{l}, a_{l+1}, \\ldots, a_{r}$.\r\n\r\nIt is guaranteed that at any given time $|a_{i}| \\le 10^9$, and also that every time you have to find the number of students who cut in line the corresponding array of discontent will be consistent, that is, there exists at least one process which results in the given array of discontent.\r\n\r\n###Output:\r\nIn the first line of output you should print the answer for the initial array $a$. Then print answers for each query of type $1$ in the order they are given in input.\r\n\r\n###Constraints \r\n- $3 \\leq N \\leq 5 \\cdot 10^5$\r\n- $0 \\leq Q \\leq 5 \\cdot 10^5$\r\n- $0 \\leq a_i < n$\r\n- $0 \\leq |w_i| < n$\r\n\r\n###Subtasks\r\n- 10 points : $3 \\leq N \\leq 10^5$, $q = 0$\r\n- 10 points : $3 \\leq N \\leq 10^5$, $q \\leq 1000$\r\n- 40 points : $3 \\leq N \\leq 10^5$, $q \\leq  10^5$\r\n- 40 points : $3 \\leq N \\leq 5 \\cdot 10^5$, $q \\leq 5\\cdot 10^5$\r\n\r\n###Sample Input:\r\n\t5\r\n\t0 0 0 2 1\r\n\t6\r\n\t2 4 4 -1\r\n\t2 3 4 1\r\n\t1 2 4\r\n\t1 2 5\r\n\t2 4 5 1\r\n\t1 1 5\r\n\r\n###Sample Output:\r\n\t2\r\n\t2\r\n\t2\r\n\t3\r\n\t\r\n###EXPLANATION:\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME93\/mandarin\/HOTMEALS.pdf), and [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME93\/russian\/HOTMEALS.pdf) as well.\r\n\r\nAs you know, there is a big problem in the educational system of Chefland - impudent students who cuts in line in the cafeteria. Chef wants to assess the problem. He was able to understand how the queue works:\r\n\r\n- Each student has value of discontent, which is initially equal to $0$;\r\n\r\n- Initially the queue is empty;\r\n\r\n- Students arrive at the queue one by one. Each student can either enter the queue in the end, or \\textit{cut in line}, by which we mean stand in front of one or more students already in the queue;\r\n\r\n- When someone cuts in line, the value of discontent of every student who ended up behind the new one is increased by $1$.\r\n\r\nFor example, if the students will enter the queue in the following order:\r\n\r\n$[] \\rightarrow [1] \\rightarrow [1,2] \\rightarrow [1,3,2] \\rightarrow [1,3,2,4] \\rightarrow [1,3,5,2,4]$\r\n\r\nThe discontent of the students in the queue will change as follows:\r\n\r\n$[] \\rightarrow [0] \\rightarrow [0,0] \\rightarrow [0,0,1] \\rightarrow [0,0,1,0] \\rightarrow [0,0,0,2,1]$\r\n\r\nNote that the values of discontent are given in the same order as students are in the queue in the end of the process, not in order they were entering the queue.\r\n\r\nLet's call the array of discontent values in the same order as students are in the queue in the end of the process \\textit{the array of discontent}. Chef notices that if one knows the array of discontent then it is possible to find out how many students cut in line. And then Chef decides to make a competitive programming problem out of it!\r\n\r\nYou are given array $a_{1}, a_{2}, \\ldots, a_{n}$. You have to process queries of two types:\r\n\r\n- Find the number of students who cut in line if the array of discontent is $[a_{l}, a_{l+1}, \\ldots, a_{r}]$ - that is, the subsegment of the array $a$;\r\n\r\n- Add a number $w$ to $a_{l}, a_{l+1}, \\ldots, a_{r}$ - that is, the subsegment of the array $a$.\r\n\r\nYou also have to find the number of students who cut in line using the initial $a$ as array of discontent.\r\n\r\n###Input:\r\n\r\n- The first line of input contains one integer $n$ ($3 \\le n \\le 5 \\cdot 10^5$) - the size of the array $a$.\r\n\r\n- The second line of input contains $n$ integers $a_1, a_2, \\ldots, a_n$ separated by spaces - the array $a$ itself.\r\n\r\n- The third line on input contains one integer $q$ ($0 \\le q \\le 5 \\cdot 10^5$) - the number of queries.\r\n\r\n- Then $q$ lines describing the queries follow.\r\n\r\n- Each line starts with integer $t$ - the type of the query.\r\n\r\n- If $t = 1$, then two more integers $l, r$ follow ($1 \\le l \\le r \\le n$). For this query you have to print the number of students who cut in line if the array of discontent is $[a_{l}, a_{l+1}, \\ldots, a_{r}]$.\r\n\r\n- If $t = 2$, then three more numbers $l, r, w$ follow ($1 \\le l \\le r \\le n$, $|w| < n$). For this query you have to add $w$ to numbers $a_{l}, a_{l+1}, \\ldots, a_{r}$.\r\n\r\nIt is guaranteed that at any given time $|a_{i}| \\le 10^9$, and also that every time you have to find the number of students who cut in line the corresponding array of discontent will be consistent, that is, there exists at least one process which results in the given array of discontent.\r\n\r\n###Output:\r\nIn the first line of output you should print the answer for the initial array $a$. Then print answers for each query of type $1$ in the order they are given in input.\r\n\r\n###Constraints \r\n- $3 \\leq N \\leq 5 \\cdot 10^5$\r\n- $0 \\leq Q \\leq 5 \\cdot 10^5$\r\n- $0 \\leq a_i < n$\r\n- $0 \\leq |w_i| < n$\r\n\r\n###Subtasks\r\n- 10 points : $3 \\leq N \\leq 10^5$, $q = 0$\r\n- 10 points : $3 \\leq N \\leq 10^5$, $q \\leq 1000$\r\n- 40 points : $3 \\leq N \\leq 10^5$, $q \\leq  10^5$\r\n- 40 points : $3 \\leq N \\leq 5 \\cdot 10^5$, $q \\leq 5\\cdot 10^5$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"5\r\n\t0 0 0 2 1\r\n\t6\r\n\t2 4 4 -1\r\n\t2 3 4 1\r\n\t1 2 4\r\n\t1 2 5\r\n\t2 4 5 1\r\n\t1 1 5","output":"2\r\n\t2\r\n\t2\r\n\t3","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1 - 3","source_sizelimit":"50000","problem_author":"fairy_winx","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>fairy_winx<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"23-02-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/binary-search'>binary-search<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fairy_winx'>fairy_winx<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime93'>ltime93<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/square-root-decomposition'>square-root-decomposition<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Binary Search","editorial_url":"https:\/\/discuss.codechef.com\/problems\/HOTMEALS","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797947},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=HOTMEALS","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}