{"category_name":"medium","status":"success","problem_code":"STRKSORT","problem_name":"Sort String","body":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK127\/mandarin\/STRKSORT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK127\/russian\/STRKSORT.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK127\/vietnamese\/STRKSORT.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK127\/bengali\/STRKSORT.pdf) as well.\r\n\r\nChef has a string $S$ with length $N$ and integer $K$. Let's consider all strings that can be obtained by erasing $K$ consecutive characters from the original string \u2015 specifically, for each $i$ ($1 \\le i \\le N-K+1$), let $f(i)$ be the string that is obtained by erasing the characters at positions $i, i+1, \\ldots, i + K - 1$.\r\n\r\nConsider a permutation $P$ of the integers $1$ through $N - K + 1$. You need to find the lexicographically smallest permutation $P$ such that $f(P_i) \\leq f(P_{i+1})$ for each $i$ ($1 \\le i \\le N - K$).\r\n\r\nSince the length of this permutation can be too large, you should only compute its hash: $\\sum_{i=1}^{N-K+1} P_i \\cdot i$ modulo $10^9 + 7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- The second line contains a single string $S$ with length $N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the hash of the lexicographically smallest valid permutation.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 10^5$\r\n- $1 \\leq K \\lt N \\leq 10^7$\r\n- $S$ contains only lowercase English letters\r\n- the sum of $N$ over all test cases does not exceed $10^7$\r\n\r\n### Example Input\r\n```\r\n4\r\n2 1\r\naa\r\n5 2\r\nabcde\r\n4 2\r\nabac\r\n10 1\r\nabccbaabca\r\n```\r\n\r\n### Example Output\r\n```\r\n5\r\n20\r\n11\r\n286\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** $f(1)$ and $f(2)$ are both \"a\", the lexicographically smallest permutation is $P = [1, 2]$. The answer is $1 \\cdot 1 + 2 \\cdot 2 = 4$.\r\n\r\n**Example case 2:** $f(1)$ is \"cde\", $f(2)$ is \"ade\", $f(3)$ is \"abe\", $f(4)$ is \"abc\". The lexicographically smallest valid permutation is $P = [4, 3, 2, 1]$ and the answer is $4 \\cdot 1 + 3 \\cdot 2 + 2 \\cdot 3 + 1 \\cdot 4 = 20$. \r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK127\/mandarin\/STRKSORT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK127\/russian\/STRKSORT.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK127\/vietnamese\/STRKSORT.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK127\/bengali\/STRKSORT.pdf) as well.\r\n\r\nChef has a string $S$ with length $N$ and integer $K$. Let's consider all strings that can be obtained by erasing $K$ consecutive characters from the original string \u2015 specifically, for each $i$ ($1 \\le i \\le N-K+1$), let $f(i)$ be the string that is obtained by erasing the characters at positions $i, i+1, \\ldots, i + K - 1$.\r\n\r\nConsider a permutation $P$ of the integers $1$ through $N - K + 1$. You need to find the lexicographically smallest permutation $P$ such that $f(P_i) \\leq f(P_{i+1})$ for each $i$ ($1 \\le i \\le N - K$).\r\n\r\nSince the length of this permutation can be too large, you should only compute its hash: $\\sum_{i=1}^{N-K+1} P_i \\cdot i$ modulo $10^9 + 7$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- The second line contains a single string $S$ with length $N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the hash of the lexicographically smallest valid permutation.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 10^5$\r\n- $1 \\leq K \\lt N \\leq 10^7$\r\n- $S$ contains only lowercase English letters\r\n- the sum of $N$ over all test cases does not exceed $10^7$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"4\r\n2 1\r\naa\r\n5 2\r\nabcde\r\n4 2\r\nabac\r\n10 1\r\nabccbaabca","output":"5\r\n20\r\n11\r\n286","explanation":"**Example case 1:** $f(1)$ and $f(2)$ are both \"a\", the lexicographically smallest permutation is $P = [1, 2]$. The answer is $1 \\cdot 1 + 2 \\cdot 2 = 4$.\r\n\r\n**Example case 2:** $f(1)$ is \"cde\", $f(2)$ is \"ade\", $f(3)$ is \"abe\", $f(4)$ is \"abc\". The lexicographically smallest valid permutation is $P = [4, 3, 2, 1]$ and the answer is $4 \\cdot 1 + 3 \\cdot 2 + 2 \\cdot 3 + 1 \\cdot 4 = 20$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/eodLNVcW56I","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"0.75","source_sizelimit":"50000","problem_author":"karpovich","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>karpovich<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"15-03-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook127'>cook127<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/karpovich'>karpovich<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/longest-common-prefix'>longest-common-prefix<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Longest Common Prefix","editorial_url":"https:\/\/discuss.codechef.com\/problems\/STRKSORT","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797980},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=STRKSORT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}