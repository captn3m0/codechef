{"category_name":"medium","status":"success","problem_code":"PRIMECYC","problem_name":"Prime Cycle","body":"### Read problem statements in [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME94\/russian\/PRIMECYC.pdf)\r\n\r\nYou are given a full binary tree of height $n$. Node $1$ is the root, and for $i \\leq 2^{n-1}-1$, node $i$ is the parent of node $2i$ and node $2i+1$. For each node $i$, there is a positive integer $a_i$ written on it.\r\n\r\nA primeful cycle is a group of $k>2$ nodes $x_1,x_2,\\ldots,x_k$ such that:\r\n\r\n- $k$ is a prime number,\r\n-  gcd($a_{x_1},a_{x_2}$) mod $k=$ gcd($a_{x_2},a_{x_3}$) mod $k= \\ldots =$ gcd($a_{x_{k-1}},a_{x_k}$) mod $k=$ gcd($a_{x_k},a_{x_1}$) mod $k$ .\r\n\r\nLet the height of each node be $1$ plus the distance from that node to node $1$. Note that by this definition, the height of node $1$ is $1$. Let the beauty value of a primeful cycle of nodes be the sum of the height of each node.\r\n\r\nThere are $q$ queries. In each query, you are given a node $x$. Considering all the nodes in the subtree of node $x$ (including node $x$), find the smallest possible beauty value of a primeful cycle of nodes taken from these nodes only. If there is no such group, print $-1$ instead.\r\n\r\n###Input:\r\n- The first line contains two integers, $n$ and $q$.\r\n- The second line contains $2^n-1$ integers, $a_1,a_2,\\ldots,a_{2^n-1}$.\r\n- The third line contains $q$ integers, the $i$-th of which is the integer $x$ for the $i$-th query. \r\n\r\n###Output:\r\nFor each test case, print a single line containing the answer to the test case. Print the answer to the test cases on separate lines.\r\n\r\n###Constraints \r\n- $1 \\le n \\le 20$\r\n- $1 \\le x \\le 2^n-1$\r\n- $1 \\le q \\le 10^5$\r\n- $1 \\le a_i \\le 10^9$\r\n\r\n###Subtasks:\r\n**Subtask #1 (70 points):** $q \\le 10$\r\n\r\n**Subtask #2 (30 points):** original constraints\r\n\r\n###Sample Input:\r\n    3 3\r\n    1 2 4 5 6 7 10\r\n    1 3 7\r\n###Sample Output:\r\n    6\r\n    -1\r\n    -1\r\n\t\r\n###Explanation:\r\nIn the first query, we choose nodes $1,3$ and $6$.\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME94\/russian\/PRIMECYC.pdf)\r\n\r\nYou are given a full binary tree of height $n$. Node $1$ is the root, and for $i \\leq 2^{n-1}-1$, node $i$ is the parent of node $2i$ and node $2i+1$. For each node $i$, there is a positive integer $a_i$ written on it.\r\n\r\nA primeful cycle is a group of $k>2$ nodes $x_1,x_2,\\ldots,x_k$ such that:\r\n\r\n- $k$ is a prime number,\r\n-  gcd($a_{x_1},a_{x_2}$) mod $k=$ gcd($a_{x_2},a_{x_3}$) mod $k= \\ldots =$ gcd($a_{x_{k-1}},a_{x_k}$) mod $k=$ gcd($a_{x_k},a_{x_1}$) mod $k$ .\r\n\r\nLet the height of each node be $1$ plus the distance from that node to node $1$. Note that by this definition, the height of node $1$ is $1$. Let the beauty value of a primeful cycle of nodes be the sum of the height of each node.\r\n\r\nThere are $q$ queries. In each query, you are given a node $x$. Considering all the nodes in the subtree of node $x$ (including node $x$), find the smallest possible beauty value of a primeful cycle of nodes taken from these nodes only. If there is no such group, print $-1$ instead.\r\n\r\n###Input:\r\n- The first line contains two integers, $n$ and $q$.\r\n- The second line contains $2^n-1$ integers, $a_1,a_2,\\ldots,a_{2^n-1}$.\r\n- The third line contains $q$ integers, the $i$-th of which is the integer $x$ for the $i$-th query. \r\n\r\n###Output:\r\nFor each test case, print a single line containing the answer to the test case. Print the answer to the test cases on separate lines.\r\n\r\n###Constraints \r\n- $1 \\le n \\le 20$\r\n- $1 \\le x \\le 2^n-1$\r\n- $1 \\le q \\le 10^5$\r\n- $1 \\le a_i \\le 10^9$\r\n\r\n###Subtasks:\r\n**Subtask #1 (70 points):** $q \\le 10$\r\n\r\n**Subtask #2 (30 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3 3\r\n    1 2 4 5 6 7 10\r\n    1 3 7","output":"6\r\n    -1\r\n    -1","explanation":"In the first query, we choose nodes $1,3$ and $6$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"minh2345","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span class='m-username--link'>minh2345<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"2-01-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/graphs'>graphs<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime94'>ltime94<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/minh2345'>minh2345<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/pigeonhole'>pigeonhole<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/PRIMECYC","time":{"view_start_date":1616864402,"submit_start_date":1616864402,"visible_start_date":1616864402,"end_date":1735669800,"current":1643797969},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=PRIMECYC","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}