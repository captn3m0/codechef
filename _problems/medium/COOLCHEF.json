{"category_name":"medium","status":"success","problem_code":"COOLCHEF","problem_name":"Chef and His Dish","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JUNE19\/hindi\/COOLCHEF.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JUNE19\/bengali\/COOLCHEF.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JUNE19\/mandarin\/COOLCHEF.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JUNE19\/russian\/COOLCHEF.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JUNE19\/vietnamese\/COOLCHEF.pdf) as well.\r\n\r\nChef is experimenting in his kitchen. He has $N$ spices (numbered $0$ through $N-1$) with types $S_0, S_1, \\ldots, S_{N-1}$.\r\n\r\nYou should answer $Q$ queries. Each query is described by two integers $L$ and $R$. In each query, Chef wants to use the spices $S_L, S_{L+1}, \\ldots, S_R$ in some order to make a dish. However, he has no clue about the order in which he should use them to make a perfect dish, so he wants to try all possible orders (sequences created by permuting these $R-L+1$ spices) to find out. Tell Chef the number of distinct orders (sequences) of spices he needs to try. Since this number can be very large, compute it modulo $10^9+7$.\r\n\r\nTwo sequences of spices are considered different if there is a valid index $i$ such that the type of the $i$-th spice in one sequence is different from the type of the $i$-th spice used in the other sequence.\r\n\r\nNote that the input is encoded so that you have to answer the queries online.\r\n  \r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $Q$.\r\n- The next line contains $N$ space-separated integers $S_0, S_1, S_2, \\ldots, S_{N-1}$.\r\n- Each of the next $Q$ lines contains four space-separated integers $L_1$, $L_2$, $R_1$ and $R_2$ describing a query. The parameters $L$ and $R$ can be calculated in the following way:\r\n    - Let's denote the answer to the previous query by $a$; for the first query, $a = 0$.\r\n    - Calculate $L = (L_1 \\cdot a + L_2) \\% N$ and $R = (R_1 \\cdot a + R_2) \\% N$.\r\n    - Then, if $L \\gt R$, swap $L$ and $R$.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2014 the number of distinct orders of spices modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le N, Q \\le 3 \\cdot 10^5$\r\n- $1 \\le S_i \\le 10^9$ for each valid $i$\r\n- $0 \\le L_1, L_2, R_1, R_2 \\le N-1$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** $1 \\le N, Q \\le 10^3$\r\n\r\n**Subtask #2 (40 points):**\r\n- $1 \\le N, Q \\le 10^5$\r\n- $L_1 = R_1 = 0$\r\n\r\n**Subtask #3 (30 points):** $1 \\le N, Q \\le 10^5$\r\n\r\n**Subtask #4 (20 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n5 3\r\n1 2 3 7 10\r\n1 1 1 1\r\n2 1 3 4\r\n0 0 0 4\r\n```\r\n\r\n### Example Output\r\n```\r\n1\r\n2\r\n120\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JUNE19\/hindi\/COOLCHEF.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JUNE19\/bengali\/COOLCHEF.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JUNE19\/mandarin\/COOLCHEF.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JUNE19\/russian\/COOLCHEF.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JUNE19\/vietnamese\/COOLCHEF.pdf) as well.\r\n\r\nChef is experimenting in his kitchen. He has $N$ spices (numbered $0$ through $N-1$) with types $S_0, S_1, \\ldots, S_{N-1}$.\r\n\r\nYou should answer $Q$ queries. Each query is described by two integers $L$ and $R$. In each query, Chef wants to use the spices $S_L, S_{L+1}, \\ldots, S_R$ in some order to make a dish. However, he has no clue about the order in which he should use them to make a perfect dish, so he wants to try all possible orders (sequences created by permuting these $R-L+1$ spices) to find out. Tell Chef the number of distinct orders (sequences) of spices he needs to try. Since this number can be very large, compute it modulo $10^9+7$.\r\n\r\nTwo sequences of spices are considered different if there is a valid index $i$ such that the type of the $i$-th spice in one sequence is different from the type of the $i$-th spice used in the other sequence.\r\n\r\nNote that the input is encoded so that you have to answer the queries online.\r\n  \r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $Q$.\r\n- The next line contains $N$ space-separated integers $S_0, S_1, S_2, \\ldots, S_{N-1}$.\r\n- Each of the next $Q$ lines contains four space-separated integers $L_1$, $L_2$, $R_1$ and $R_2$ describing a query. The parameters $L$ and $R$ can be calculated in the following way:\r\n    - Let's denote the answer to the previous query by $a$; for the first query, $a = 0$.\r\n    - Calculate $L = (L_1 \\cdot a + L_2) \\% N$ and $R = (R_1 \\cdot a + R_2) \\% N$.\r\n    - Then, if $L \\gt R$, swap $L$ and $R$.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2014 the number of distinct orders of spices modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le N, Q \\le 3 \\cdot 10^5$\r\n- $1 \\le S_i \\le 10^9$ for each valid $i$\r\n- $0 \\le L_1, L_2, R_1, R_2 \\le N-1$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** $1 \\le N, Q \\le 10^3$\r\n\r\n**Subtask #2 (40 points):**\r\n- $1 \\le N, Q \\le 10^5$\r\n- $L_1 = R_1 = 0$\r\n\r\n**Subtask #3 (30 points):** $1 \\le N, Q \\le 10^5$\r\n\r\n**Subtask #4 (20 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"5 3\r\n1 2 3 7 10\r\n1 1 1 1\r\n2 1 3 4\r\n0 0 0 4","output":"1\r\n2\r\n120","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"5","source_sizelimit":"50000","problem_author":"coolreshab","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>coolreshab<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"29-04-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/coolreshab'>coolreshab<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/june19'>june19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/junechallenge'>junechallenge<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/COOLCHEF","time":{"view_start_date":1560763800,"submit_start_date":1560763800,"visible_start_date":1560763800,"end_date":1735669800,"current":1643797934},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=COOLCHEF","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}