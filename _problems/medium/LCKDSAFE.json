{"category_name":"medium","status":"success","problem_code":"LCKDSAFE","problem_name":"Locked Safe","body":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/bengali\/LCKDSAFE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/mandarin\/LCKDSAFE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/russian\/LCKDSAFE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/vietnamese\/LCKDSAFE.pdf) as well.\r\n\r\nChef has met up with his old friend Jack recently. Jack told Chef that he found a recipe for an ancient dish, but unfortunately, it is locked in a safe and to open the safe, it is necessary to enter the solution to the following problem.\r\n\r\nThere is a sequence of non-negative integers $A_1, A_2, \\ldots, A_N$ on the safe. Find the number of pairs $(l, r)$ ($1 \\leq l \\leq r \\leq N$) which satisfy the condition $$(A_l \\lor A_{l+1} \\lor \\ldots \\lor A_r) \\oplus (A_l \\land A_{l+1} \\land \\ldots \\land A_r) \\geq \\max(A_l, A_{l+1}, \\ldots, A_r) \\,.$$\r\n\r\nHere, $\\oplus$ denotes bitwise XOR, $\\lor$ denotes bitwise OR and $\\land$ denotes bitwise AND.\r\n\r\nJack and Chef cannot think of anything except the recipe, so you are asked to open the safe.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the number of pairs $(l,r)$ that satisfy the given condition.\r\n\r\n### Constraints\r\n- $1 \\leq N \\leq 10^6$\r\n- $0 \\leq A_i \\lt 2^{60}$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** for each valid $i$, $A_i$ is a power of $2$\r\n\r\n**Subtask #2 (30 points):**\r\n- $A_i \\leq 3 \\cdot 10^5$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $3 \\cdot 10^5$\r\n\r\n**Subtask #3 (60 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n2\r\n4\r\n0 1 2 3\r\n6\r\n1 3 5 6 4 2\r\n```\r\n\r\n### Example Output\r\n```\r\n6\r\n11\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** The pairs $(l, r)$ satisfying the condition are $(1,1)$, $(1,2)$, $(1, 3)$, $(1, 4)$, $(2, 3)$ and $(2, 4)$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/bengali\/LCKDSAFE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/mandarin\/LCKDSAFE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/russian\/LCKDSAFE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/vietnamese\/LCKDSAFE.pdf) as well.\r\n\r\nChef has met up with his old friend Jack recently. Jack told Chef that he found a recipe for an ancient dish, but unfortunately, it is locked in a safe and to open the safe, it is necessary to enter the solution to the following problem.\r\n\r\nThere is a sequence of non-negative integers $A_1, A_2, \\ldots, A_N$ on the safe. Find the number of pairs $(l, r)$ ($1 \\leq l \\leq r \\leq N$) which satisfy the condition $$(A_l \\lor A_{l+1} \\lor \\ldots \\lor A_r) \\oplus (A_l \\land A_{l+1} \\land \\ldots \\land A_r) \\geq \\max(A_l, A_{l+1}, \\ldots, A_r) \\,.$$\r\n\r\nHere, $\\oplus$ denotes bitwise XOR, $\\lor$ denotes bitwise OR and $\\land$ denotes bitwise AND.\r\n\r\nJack and Chef cannot think of anything except the recipe, so you are asked to open the safe.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the number of pairs $(l,r)$ that satisfy the given condition.\r\n\r\n### Constraints\r\n- $1 \\leq N \\leq 10^6$\r\n- $0 \\leq A_i \\lt 2^{60}$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $10^6$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** for each valid $i$, $A_i$ is a power of $2$\r\n\r\n**Subtask #2 (30 points):**\r\n- $A_i \\leq 3 \\cdot 10^5$ for each valid $i$\r\n- the sum of $N$ over all test cases does not exceed $3 \\cdot 10^5$\r\n\r\n**Subtask #3 (60 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n4\r\n0 1 2 3\r\n6\r\n1 3 5 6 4 2","output":"6\r\n11","explanation":"**Example case 1:** The pairs $(l, r)$ satisfying the condition are $(1,1)$, $(1,2)$, $(1, 3)$, $(1, 4)$, $(2, 3)$ and $(2, 4)$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/m-vFtsWt3Ck","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"karpovich","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>karpovich<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"24-02-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/data-structure'>data-structure<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/karpovich'>karpovich<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/march21'>march21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/two-pointers'>two-pointers<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Two Pointers","editorial_url":"https:\/\/discuss.codechef.com\/problems\/LCKDSAFE","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797954},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=LCKDSAFE","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}