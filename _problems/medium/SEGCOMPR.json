{"category_name":"medium","status":"success","problem_code":"SEGCOMPR","problem_name":"Compress all Subsegments","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/OCT20\/hindi\/SEGCOMPR.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/OCT20\/bengali\/SEGCOMPR.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/OCT20\/mandarin\/SEGCOMPR.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/OCT20\/russian\/SEGCOMPR.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/OCT20\/vietnamese\/SEGCOMPR.pdf) as well.\r\n\r\nFor an array $B$, while it has more than one element, you can apply an operation on it - you choose any two elements $x,y$  (they may be the same value, but they should have different indices), delete them, and add an element $g(x, y)$ instead. \r\n\r\nHere $g(x, y)$ denotes the highest set bit in $x \\oplus y$, or $0$ if they are equal. In other words, $g(x, y) = \\max 2^k$, such that $2^k \\leq (x \\oplus y)$ for $x \\neq y$, and $g(x,y)=0$ if $x = y$. For example, $g(1,1) = 0, g(1,2) = 2, g(2,4)=4, g(13,17)=16$.\r\n\r\nGiven an array $B$, we try to apply the operations repeatedly in such a way that when we are left with only one element at the end, that element is as small as possible. Let's denote this smallest possible value of the element at the end as $f(B)$.\r\n\r\nYou are given an array $A$ with $N$ elements, you need to find the sum of $f(A_{l \\ldots r})$ among all subsegments $1 \\leq l \\leq r \\leq N$.\r\n\r\nThe answer may be large, so you need to find it modulo $998\\,244\\,353$.\r\n\r\n###Input:\r\n- The first line contains one integer $N$.\r\n- The second line contains $N$ integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n###Output:\r\nIn a single line, print the sum, modulo $998\\,244\\,353$.\r\n\r\n###Constraints \r\n- $1 \\leq N \\leq 300\\,000$\r\n- $0 \\leq A_i < 2^{30}$\r\n\r\n###Subtasks\r\n- 10 points : $1 \\leq N \\leq 10$\r\n- 10 points : $1 \\leq N \\leq 500$\r\n- 10 points : $1 \\leq N \\leq 5000$\r\n- 70 points : $1 \\leq N \\leq 300\\,000$\r\n\r\n###Sample Input:\r\n```\r\n10  \r\n0 1 2 3 4 5 6 7 8 9\r\n```\r\n\r\n###Sample Output:\r\n```\r\n160\r\n```\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/OCT20\/hindi\/SEGCOMPR.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/OCT20\/bengali\/SEGCOMPR.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/OCT20\/mandarin\/SEGCOMPR.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/OCT20\/russian\/SEGCOMPR.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/OCT20\/vietnamese\/SEGCOMPR.pdf) as well.\r\n\r\nFor an array $B$, while it has more than one element, you can apply an operation on it - you choose any two elements $x,y$  (they may be the same value, but they should have different indices), delete them, and add an element $g(x, y)$ instead. \r\n\r\nHere $g(x, y)$ denotes the highest set bit in $x \\oplus y$, or $0$ if they are equal. In other words, $g(x, y) = \\max 2^k$, such that $2^k \\leq (x \\oplus y)$ for $x \\neq y$, and $g(x,y)=0$ if $x = y$. For example, $g(1,1) = 0, g(1,2) = 2, g(2,4)=4, g(13,17)=16$.\r\n\r\nGiven an array $B$, we try to apply the operations repeatedly in such a way that when we are left with only one element at the end, that element is as small as possible. Let's denote this smallest possible value of the element at the end as $f(B)$.\r\n\r\nYou are given an array $A$ with $N$ elements, you need to find the sum of $f(A_{l \\ldots r})$ among all subsegments $1 \\leq l \\leq r \\leq N$.\r\n\r\nThe answer may be large, so you need to find it modulo $998\\,244\\,353$.\r\n\r\n###Input:\r\n- The first line contains one integer $N$.\r\n- The second line contains $N$ integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n###Output:\r\nIn a single line, print the sum, modulo $998\\,244\\,353$.\r\n\r\n###Constraints \r\n- $1 \\leq N \\leq 300\\,000$\r\n- $0 \\leq A_i < 2^{30}$\r\n\r\n###Subtasks\r\n- 10 points : $1 \\leq N \\leq 10$\r\n- 10 points : $1 \\leq N \\leq 500$\r\n- 10 points : $1 \\leq N \\leq 5000$\r\n- 70 points : $1 \\leq N \\leq 300\\,000$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"10  \r\n0 1 2 3 4 5 6 7 8 9","output":"160","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"4","source_sizelimit":"50000","problem_author":"ildar_adm","problem_author_html_handle":"ildar_adm","problem_tester":"","problem_tester_html_handle":"","date_added":"28-09-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/ad-hoc'>ad-hoc<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/bit-manipulation'>bit-manipulation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/brute-force'>brute-force<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ildar_adm'>ildar_adm<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/oct20'>oct20<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Ad Hoc","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SEGCOMPR","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797975},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SEGCOMPR","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}