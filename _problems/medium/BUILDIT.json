{"category_name":"medium","status":"success","problem_code":"BUILDIT","problem_name":"Expected Buildings","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a href=\"http:\/\/www.codechef.com\/download\/translated\/JUNE18\/mandarin\/BUILDIT.pdf\" target=\"_blank\">Mandarin chinese<\/a>, <a href=\"http:\/\/www.codechef.com\/download\/translated\/JUNE18\/russian\/BUILDIT.pdf\" target=\"_blank\">Russian<\/a> and <a href=\"http:\/\/www.codechef.com\/download\/translated\/JUNE18\/vietnamese\/BUILDIT.pdf\" target=\"_blank\">Vietnamese<\/a> as well.<\/h3>\n\nChef is standing in the centre of a circle. The perimeter of the circle is divided into $h$ units (numbered $1$ through $h$) and some of those units contain buildings. There are $N$ buildings in total (numbered $1$ through $N$); let's denote the position of building $i$, i.e. the number of the unit containing this building, by $p_i$. Note that a unit may contain more than one building.\n\nChef has a *vision range* equal to $x$. This means he can look at an arbitrary contiguous range of $x$ units at the same time.\n\nChef likes to play with his girlfriend Cheftanya. Since he belongs to Wakanda, he decided to play a shooting game. In this game, he is going to look in some direction and shoot all the buildings he sees (without looking in any other direction). Cheftanya chooses the direction in which he looks; since she loves mathematics, she is going to choose this direction randomly using a special probability density function defined below. Before playing the game, though, she is interested in the expected number of buildings Chef will shoot. Chef is going to be busy shooting, so she asks for your help. Can you impress Cheftanya with your skills?\n\n\nThis expected value can be written as a fraction $P\/Q$, where $P$ and $Q$ are coprime. Since we are in the 21st century, nobody is interested in fractions. Therefore, you should compute $P\\cdot Q^{-1}$ modulo $163577857$, where $Q^{-1}$ denotes the modular inverse of $Q$ modulo $163577857$. (It is guaranteed that this inverse exists and is unique.)\n\nConsider a sequence of integers $a_1, a_2, \\dots, a_h$; let's denote $s=\\sum_{i=1}^h a_i$. We guarantee that $s$ is not divisible by respective modulo ($163577857$).\n For each $i$ ($1 \\le i \\le h$), the probability that Cheftanya directs Chef to look at units $i, i+1, \\dots, i+x-1$ is $a_i \/ s$; the units are cyclic, so we can consider \"unit $i$\" to be equivalent to \"unit $i-h$\". Since the sequence $a$ can be very large, you are only given its first $K$ elements. You are also given a sequence $c_1, c_2, \\dots, c_K$; the remainder of sequence $a$ can be generated using the formula \n$$a_i = \\sum_{j=1}^K c_j\\cdot a_{i-j} \\quad \\forall\\,i:\\;K \\lt i \\le h\\,.$$\n\n### Input\n- The first line of the input contains a single integer $N$ denoting the number of buildings.\n- The second line contains a single integer $h$ denoting the total number of units the circle is divided into.\n- The third line contains a single integer $x$ denoting Chef's vision range.\n- The fourth line contains a single integer $K$.\n- The fifth line contains $N$ space-separated integers $p_1, p_2, \\dots, p_N$ denoting the positions of the buildings.\n- The sixth line contains $K$ space-separated integers $a_1, a_2, \\dots, a_K$.\n- The seventh line contains $K$ space-separated integers $c_1, c_2, \\dots, c_K$ denoting the coefficients for generating the remaining probabilities.\n\n### Output\nPrint a single line containing one integer \u2014 the number equivalent to the expected number of buildings modulo $163577857$.\n\n### Constraints\n- $1 \\le p_i \\le h$ for each valid $i$\n- $1 \\le x, K \\le h$\n- $0 \\le a_i \\le 10^9$ for each valid $i$\n- $0 \\le c_i \\le 10^9$ for each valid $i$\n\n### Subtasks\n**Subtask #1 (5 points):**\n- $1 \\le N \\le 1,000$\n- $1 \\le h \\le 10,000$\n- $1 \\le K \\le 10$\n\n**Subtask #2 (10 points):**\n- $1 \\le N \\le 50,000$\n- $1 \\le h \\le 10^6$\n- $1 \\le K \\le 10$\n\n**Subtask #3 (30 points):**\n- $1 \\le N \\le 100$\n- $1 \\le h \\le 10^9$\n- $1 \\le K \\le 100$\n\n**Subtask #4 (55 points):**\n- $1 \\le N \\le 2,000$\n- $1 \\le h \\le 10^9$\n- $1 \\le K \\le 100$\n\n### Example Input\n```\n3\n5\n3\n2\n1 3 5\n1 1\n1 1\n```\n\n### Example Output\n```\n13631490\n```\n\n### Explanation\nThe complete sequence $a$ is equal to $\\{1, 1, 2, 3, 5\\}$ and $s = \\sum a_i = 1+1+2+3+5 = 12$. Chef looks at the range starting with unit $1$ with probability $a_1 \/ s = 1\/12$, at the range starting with unit $3$ with probability $a_3 \/ s = 1\/6$, and so on. The expected number of buildings he shoots is therefore equal to $\\frac{1}{12}\\cdot2 + \\frac{1}{12}\\cdot1 + \\frac{2}{12}\\cdot2 + \\frac{3}{12}\\cdot2 + \\frac{5}{12}\\cdot2 = \\frac{23}{12} = 23\\cdot12^{-1} = 13631490$.\n\n### Example Input\n```\n3\n5\n3\n2\n1 3 1\n1 1\n1 1\n```\n\n### Example Output\n```\n27262978\n```\n\n### Explanation\nAgain, $a = \\{1, 1, 2, 3, 5\\}$, $s = 1+1+2+3+5 = 12$, so the probabilities are the same as in the previous example. However, there are two buildings in unit $1$. The expected value $ = \\frac{1}{12}\\cdot3 + \\frac{1}{12}\\cdot1 + \\frac{2}{12}\\cdot1 + \\frac{3}{12}\\cdot2 + \\frac{5}{12}\\cdot2 = \\frac{22}{12} = 11\\cdot6^{-1} = 27262978$.\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, CLOJ, COB, FS","max_timelimit":"3","source_sizelimit":"50000","problem_author":"teja349","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>teja349<\/span>","problem_tester":"mgch","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>mgch<\/span>","date_added":"17-05-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/june18'>june18<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/likecs'>likecs<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/matrix-expo'>matrix-expo<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/recurrences'>recurrences<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/teja349'>teja349<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/teja349'>teja349<\/a>","time":{"view_start_date":1528709405,"submit_start_date":1528709405,"visible_start_date":1528709405,"end_date":1735669800,"current":1528985561},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}