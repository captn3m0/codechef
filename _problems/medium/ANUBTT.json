{"category_name":"medium","status":"success","problem_code":"ANUBTT","problem_name":"Build the Tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK46\/mandarin\/ANUBTT.pdf\">Mandarin Chinese<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK46\/russian\/ANUBTT.pdf\">Russian<\/a> as well.<\/h3>\n<h3>Problem description.<\/h3>\n<p>Given a rooted tree with <b>N<\/b> nodes. Nodes of the tree are numbered from <b>1<\/b> to <b>N<\/b>. Node <b>1<\/b> is the root. You need to add <b>M<\/b> nodes to it in the given order. All the nodes have values. Cost for adding a node <b>A<\/b> with value <b>va<\/b> to another node <b>B<\/b> with value <b>vb<\/b> is <b>va*vb<\/b>. There is an additional cost of <b>y<\/b> (so total cost of <b>va*vb+y<\/b>) if <b>B<\/b> has atleast <b>x<\/b> child nodes. After node <b>A<\/b> has been added to another node <b>B<\/b> it becomes a child of <b>B<\/b>.<\/p>\n<p>After adding a node <b>A<\/b> to the tree, nodes next in list can be added to <b>A<\/b> also. You need to calculate the total minimal cost to add all <b>M<\/b> nodes in given order.<\/p>\n<h3>Input<\/h3>\n<p>The first line of input contains <b>N<\/b>. The second line of input contains <b>N<\/b> integers representing the values of nodes in order from node <b>1<\/b> to node <b>N<\/b>. <b>N-1<\/b> lines follow, each line defines an edge. Each line has 2 integers, which says that those 2 nodes are connected.<\/p>\n<p>Next line of input contains an integer <b>Q<\/b>, denoting the number of queries you need to answer. Each query consists of 2 lines. The first line of each query has 3 integers, <b>M x y<\/b>. The second line of each query has <b>M<\/b> integers representing the values of the nodes to be added in order.<\/p>\n<p>Note that in each query, <b>M<\/b> nodes are added to the initial tree, and hence changes made in previous query should <b>not<\/b> be considered in later queries<\/p>\n<h3>Output<\/h3>\n<p>For each query, output a single line containing the minimal total cost to add all the nodes in given order.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>100000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>x<\/b> \u2264 <b>1000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>y<\/b> \u2264 <b>1000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>Q<\/b> \u2264 <b>100<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>M<\/b> \u2264 <b>100<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>Values of all nodes in input<\/b> \u2264 <b>1000<\/b><\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n3\n2 2 3\n1 2\n2 3\n2\n2 2 10\n10 10\n3 2 10\n1 2 2\n\n<b>Output:<\/b>\n40\n6\n<\/pre><p>\u00a0<\/p>\n<h3>Explanation<\/h3>\n<p><b>Query 1.<\/b><br\/><br \/>\nOptimal solution is to add the first node from the query to node 1 of the tree and the second node from the query to node 2 of the tree. Cost is 10*2 + 10*2.<br\/><br \/>\n<b>Query 2.<\/b><br\/><br \/>\nOptimal solution is to add the first node from the query to node 1 of the tree for a cost 2. Then add next two nodes from the query to newly added node.<br\/><br \/>\nTotal cost is 2 + 2 + 2 = 6.<\/br\/><\/br\/><\/br\/><\/br\/><\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"4","source_sizelimit":"50000","problem_author":"anudeep2011","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>anudeep2011<\/span>","problem_tester":"gerald","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>gerald<\/span>","date_added":"22-04-2014","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/anudeep2011'>\n                    anudeep2011\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/cook46'>\n                    cook46\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/min-cost-flow'>\n                    min-cost-flow\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/ANUBTT","user":{"username":null},"time":{"view_start_date":1400437800,"submit_start_date":1400437800,"visible_start_date":1400437800,"end_date":1735669800,"current":1493557470},"todo":false,"problem_status":"unattempted"}