{"category_name":"medium","status":"success","problem_code":"NPORP","problem_name":"Solve what you want","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/LTIME59\/mandarin\/NPORP.pdf\">Mandarin chinese<\/a>, <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/LTIME59\/russian\/NPORP.pdf\">Russian<\/a> and <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/LTIME59\/vietnamese\/NPORP.pdf\">Vietnamese<\/a> as well.<\/h3>\n\nGleb is trying to solve the **P versus NP** problem, so he is doing some research now. He does not have time to solve boring and easy problems like this one, so he gave it to you.\n\nYou are given a connected undirected graph with $N$ vertices labelled $1$ through $N$ and a number $K$. You have to solve exactly one of the following two problems or determine that both of them have no solution (if both have a solution, you are free to choose either one of them to solve):\n- Find a cut in the graph with size strictly smaller than $K$. A *cut* is a partition of vertices of the graph into two non-empty subsets $A$ and $B$ ($A \\cap B = \\emptyset$, $|A| + |B| = N$). The *size* of a cut is the number of edges $(u, v)$ such that $u \\in A$ and $v \\in B$.\n- Find a simple cycle in the graph with *size* at least $K$ (containing at least $K$ vertices). A simple cycle does not visit any edge more than once and does not visit any vertex more than once.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains three space-separated integers $N$, $M$ and $K$.\n- Each of the following $M$ lines contains two space-separated integers $u$ and $v$ describing an edge between vertices $u$ and $v$.\n\n### Output\nFor each test case:\n- If both problems have no solution, print a single line containing the string `\"NO ANSWER\"`.\n- Otherwise, print three lines. The first line should contain the string `\"CUT\"` if you solved the first problem or `\"CYCLE\"` if you solved the second problem.\n- If you solved the first problem, the second line should contain a single integer \u2014 the size of the set $A$, and the third line should contain $|A|$ space-separated integers denoting the labels of vertices in the set $A$.\n- If you solved the second problem, the second line should contain a single integer \u2014 the size $S$ of the simple cycle you found, and the third line should contain $S$ space-separated integers denoting the vertices of the cycle in an order in which they appear on the cycle.\n\n### Constraints \n- $1 \\le T \\le 100$\n- $2 \\le N, M \\le 2 \\cdot 10^5$\n- $3 \\le K \\le N$\n- $1 \\le u, v \\le N$\n- $u \\neq v$ for each edge\n- there are no two edges connecting the same pair of vertices\n- the graph described on the input is connected\n- the sum of $N$ over all test cases does not exceed $2 \\cdot 10^5$\n- the sum of $M$ over all test cases does not exceed $2 \\cdot 10^5$\n\n### Subtasks\n**Subtask #1 (40 points):** $1 \\le N \\le 10$\n\n**Subtask #2 (60 points):** original constraints\n\n### Example Input\n```\n2\n8 7 3\n1 4\n2 4\n3 4\n4 5\n5 6\n5 7\n5 8\n3 3 3\n1 2\n2 3\n1 3\n```\n\n### Example Output\n```\nCUT\n4\n1 2 3 4\nCYCLE\n3\n1 2 3\n```\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"altruist_","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>altruist_<\/span>","problem_tester":"kingofnumbers","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>kingofnumbers<\/span>","date_added":"20-04-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/altruist_'>altruist_<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/NPORP","time":{"view_start_date":1524934802,"submit_start_date":1524934802,"visible_start_date":1524934802,"end_date":1735669800,"current":1525454400},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}