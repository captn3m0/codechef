{"category_name":"medium","status":"success","problem_code":"STRPTRE","problem_name":"Strip in a Tree!","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/hindi\/STRPTRE.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/bengali\/STRPTRE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/mandarin\/STRPTRE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/russian\/STRPTRE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/vietnamese\/STRPTRE.pdf) as well.\r\n\r\nChef has a complete binary tree with depth $D$ and $N = 2^{D+1}-1$ nodes (numbered $1$ through $N$). Node $1$ is the root and each edge is either white or black. The shape of the tree is as follows:\r\n\r\n![](https:\/\/codechef_shared.s3.amazonaws.com\/download\/LTIME82\/STRPTRE\/strip%20in%20a%20tree.png)\r\n\r\nLet's number the levels of the tree $0$ through $D$ from top to bottom. Each node at an odd level is connected to its parent with a white edge (e.g. edges $1-2$ and $1-3$), while each node at an even level is connected to its parent with a black edge (e.g. edges $2-4$, $2-5$, $3-6$, $3-7$).\r\n\r\nChef's friend Alice wants to pick two distinct nodes $u$ and $v$ and a colour $C$ (white or black) uniformly randomly and add an edge between the nodes $u$ and $v$ with colour $C$. It is allowed for two parallel edges to exist between nodes $u$ and $v$ after this operation.\r\n\r\nA *strip* is an alternating cycle of white and black edges. Each vertex may appear any number of times in a strip. Find the probability that a strip is created when Alice adds an edge to the graph. It can be proved that this probability can be expressed as a fraction $\\frac{P}{Q}$, where $P$ and $Q$ are positive integers and $Q$ is coprime with $1,000,000,007$. You should compute $P \\cdot Q^{-1}$ modulo $1,000,000,007$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $1,000,000,007$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains a single integer $D$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $P \\cdot Q^{-1}$ modulo $1,000,000,007$ ($10^9 + 7$).\r\n\r\n### Constraints\r\n- $1 \\le T \\le 50$\r\n- $1 \\le D \\le 10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** $D \\le 15$\r\n\r\n**Subtask #2 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n2\r\n1\r\n2\r\n```\r\n\r\n### Example Output\r\n```\r\n333333336\r\n142857144\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** Alice picks one of the following pairs $(u,v)$: $(1,2)$, $(1,3)$, $(2,3)$, $(2,1)$, $(3,1)$ and $(3,2)$. She also picks a colour, but a strip can be created only if Alice picks the colour black and one of the pairs $(1,2)$, $(2,1)$, $(1,3)$ or $(3,1)$, so the probability is $4\/12 = 1\/3$, which is $333,333,336$ modulo $1,000,000,007$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/hindi\/STRPTRE.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/bengali\/STRPTRE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/mandarin\/STRPTRE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/russian\/STRPTRE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/vietnamese\/STRPTRE.pdf) as well.\r\n\r\nChef has a complete binary tree with depth $D$ and $N = 2^{D+1}-1$ nodes (numbered $1$ through $N$). Node $1$ is the root and each edge is either white or black. The shape of the tree is as follows:\r\n\r\n![](https:\/\/codechef_shared.s3.amazonaws.com\/download\/LTIME82\/STRPTRE\/strip%20in%20a%20tree.png)\r\n\r\nLet's number the levels of the tree $0$ through $D$ from top to bottom. Each node at an odd level is connected to its parent with a white edge (e.g. edges $1-2$ and $1-3$), while each node at an even level is connected to its parent with a black edge (e.g. edges $2-4$, $2-5$, $3-6$, $3-7$).\r\n\r\nChef's friend Alice wants to pick two distinct nodes $u$ and $v$ and a colour $C$ (white or black) uniformly randomly and add an edge between the nodes $u$ and $v$ with colour $C$. It is allowed for two parallel edges to exist between nodes $u$ and $v$ after this operation.\r\n\r\nA *strip* is an alternating cycle of white and black edges. Each vertex may appear any number of times in a strip. Find the probability that a strip is created when Alice adds an edge to the graph. It can be proved that this probability can be expressed as a fraction $\\frac{P}{Q}$, where $P$ and $Q$ are positive integers and $Q$ is coprime with $1,000,000,007$. You should compute $P \\cdot Q^{-1}$ modulo $1,000,000,007$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $1,000,000,007$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains a single integer $D$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $P \\cdot Q^{-1}$ modulo $1,000,000,007$ ($10^9 + 7$).\r\n\r\n### Constraints\r\n- $1 \\le T \\le 50$\r\n- $1 \\le D \\le 10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** $D \\le 15$\r\n\r\n**Subtask #2 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n1\r\n2","output":"333333336\r\n142857144","explanation":"**Example case 1:** Alice picks one of the following pairs $(u,v)$: $(1,2)$, $(1,3)$, $(2,3)$, $(2,1)$, $(3,1)$ and $(3,2)$. She also picks a colour, but a strip can be created only if Alice picks the colour black and one of the pairs $(1,2)$, $(2,1)$, $(1,3)$ or $(3,1)$, so the probability is $4\/12 = 1\/3$, which is $333,333,336$ modulo $1,000,000,007$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"phoenix71","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span class='m-username--link'>phoenix71<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"24-03-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy'>easy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime82'>ltime82<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/observation'>observation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/phoenix71'>phoenix71<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Easy","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/STRPTRE","time":{"view_start_date":1585408500,"submit_start_date":1585408500,"visible_start_date":1585408500,"end_date":1735669800,"current":1643797980},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=STRPTRE","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}