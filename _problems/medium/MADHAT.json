{"category_name":"medium","status":"success","problem_code":"MADHAT","problem_name":"Math Hatter","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK73\/mandarin\/MADHAT.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK73\/russian\/MADHAT.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK73\/vietnamese\/MADHAT.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>The education system of Wonderland was designed by the great psychologist Math Hatter. In Wonderland there are <b>n<\/b> kids attending school. For simplicity they are numbered from <b>1<\/b> to <b>n<\/b>. \nMath Hatter noticed that all of them are very smart, so he measured their Intellectual Quotient (IQ), it turned out that no two students had the same IQ and that all IQs were integers in the range from <b>1<\/b> to <b>n<\/b>.\n<\/p>\n\n<p>In the Math Hatter's education system, one kid can be the teacher of many other kids, and also be the pupil of many others.<\/p>\n\n<p>Let <b>j<\/b> be the smallest integer greater than <b>i<\/b> such that the IQ of kid <b>j<\/b> is greater than the IQ of kid <b>i<\/b>, the pupils of kid <b>i<\/b> are all the kids numbered from <b>i + 1<\/b> to <b>j - 1<\/b>. If no such <b>j<\/b> exist we consider <b>j<\/b> to be equal to <b>n + 1<\/b>, note that kid number <b>i<\/b> will not have any pupils when <b>j = i + 1<\/b> or when <b>i = n<\/b>.<\/p>\n\n<p>\nMath hatter doesn't remember the IQ of each kid, however he remembers their number of pupils. Using this information Math Hatter is trying to recover the IQ of each kid. Help him calculating the number of IQ assignations that he can find. As the answer could be large, output it modulo <b>10<sup>9<\/sup> + 7<\/b>.<\/p>\n\n<h3>Input<\/h3>\n<p>The first line of the input contains one integer <b>T<\/b> the number of test cases. The description of <b>T<\/b> test cases follows.<\/p>\n<p>Each test case consists of two lines.<\/p>\n<p>The first line contains one integer <b>n<\/b> the number of kids, the second line contains <b>n<\/b> space separated integers <b>c<sub>i<\/sub><\/b> denoting the number of pupils of kid <b>i<\/b>.<\/p>\n\n<h3>Output<\/h3>\n<p>For each test case, output the answer to the problem modulo <b>10<sup>9<\/sup>+7<\/b>.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>n<\/b> \u2264 <b>10<sup>5<\/sup><\/b>, the sum of <b>n<\/b> over all test cases is at most <b>10<sup>6<\/sup><\/b> <\/li>\n<li><b>0<\/b> \u2264 <b>c<sub>i<\/sub><\/b> < <b>n<\/b><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b><tt>\n2\n4\n0 2 1 0\n4\n0 2 1 1\n<\/tt>\n<b>Output:<\/b><tt>\n3\n0<\/tt>\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>\nIn the <b>first example<\/b>, the possible students IQs are the following:\n<ul>\n<li>[1, 4, 3, 2]<\/li>\n<li>[2, 4, 3, 1]<\/li>\n<li>[3, 4, 2, 1]<\/li>\n<\/ul>\n<\/p>\n\n<p>In the <b>second example<\/b>, there are no possible assignments because the last student can't have one pupil.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"alei","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>alei<\/span>","problem_tester":"kingofnumbers","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>kingofnumbers<\/span>","date_added":"21-07-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alei'>\n                    alei\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>\n                    combinatorics\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/cook73'>\n                    cook73\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>\n                    easy-medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/maths'>\n                    maths\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/MADHAT","user":{"username":null},"time":{"view_start_date":1471804200,"submit_start_date":1471804200,"visible_start_date":1471804200,"end_date":1735669800,"current":1493557777},"todo":false,"problem_status":"unattempted"}