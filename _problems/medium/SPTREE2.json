{"category_name":"medium","status":"success","problem_code":"SPTREE2","problem_name":"A Special Tree 2","body":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK131\/mandarin\/SPTREE2.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK131\/russian\/SPTREE2.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK131\/vietnamese\/SPTREE2.pdf) and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK131\/bengali\/SPTREE2.pdf) as well. \n\nYou are given a tree with $N$ nodes (numbered $1$ through $N$). \n\nThe distance $d(p,q)$ between two nodes $p$ and $q$ of the tree is the number of edges on the unique path between them.\n\nThere will be $Q$ events each of which can be of the following three types:\n\n- <tt>'1 u'<\/tt>: A certain node $u$ becomes a special node. It is guaranteed that $u$ was not special before this event.\n\n- <tt>'2 u'<\/tt>: A certain node $u$ becomes no longer special. It is guaranteed that $u$ was special before this event.\n\n- <tt>'3 K'<\/tt>: You are given a non-negative integer $K$. For a node $x$, define $f(x)=\\max\\{ d(x,y):y\\text{ is special}\\}$. You must answer if there exists a node $x$ such that $f(x)=K$. In other words, you are asked whether there exists a node $x$ whose distance to the farthest special node is $K$. Note that $x$ doesn't have to be special. It is guaranteed that there is at least one special node in the tree at the time of this event.\n\nIn the beginning, there are no special nodes.\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"- $1 \\le T \\le 200$\n- $1 \\le N,Q \\le 2 \\cdot 10^5$\n- $1 \\le u_i,v_i \\le N$\n- $1 \\le t_i \\le 3$\n- $1 \\le q_i \\le N$ for each $i$ such that $t_i=1$ or $t_i=2$\n- $0 \\le q_i \\le N-1$ for each $i$ such that $t_i=3$ \n- The graph described on the input is a tree\n- In each test case, there is at least one query of type $3$\n- The sum of $N$ over all test cases does not exceed $4 \\cdot 10^5$\n- The sum of $Q$ over all test cases does not exceed $4 \\cdot 10^5$","constraintsState":true,"subtasks":"- 30 points : $1 \\leq R \\leq 10000$\n- 70 points : $1 \\leq R \\leq 10^9$\n","subtasksState":false,"statement":"### Read problems statements in [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK131\/mandarin\/SPTREE2.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK131\/russian\/SPTREE2.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK131\/vietnamese\/SPTREE2.pdf) and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK131\/bengali\/SPTREE2.pdf) as well. \n\nYou are given a tree with $N$ nodes (numbered $1$ through $N$). \n\nThe distance $d(p,q)$ between two nodes $p$ and $q$ of the tree is the number of edges on the unique path between them.\n\nThere will be $Q$ events each of which can be of the following three types:\n\n- <tt>'1 u'<\/tt>: A certain node $u$ becomes a special node. It is guaranteed that $u$ was not special before this event.\n\n- <tt>'2 u'<\/tt>: A certain node $u$ becomes no longer special. It is guaranteed that $u$ was special before this event.\n\n- <tt>'3 K'<\/tt>: You are given a non-negative integer $K$. For a node $x$, define $f(x)=\\max\\{ d(x,y):y\\text{ is special}\\}$. You must answer if there exists a node $x$ such that $f(x)=K$. In other words, you are asked whether there exists a node $x$ whose distance to the farthest special node is $K$. Note that $x$ doesn't have to be special. It is guaranteed that there is at least one special node in the tree at the time of this event.\n\nIn the beginning, there are no special nodes.\n","inputFormat":"- The first line of the input contains a single integer $T$ - the number of test cases. The description of $T$ test cases follow.\n- The first line of each test case contains a single integer $N$.\n- $N\u22121$ lines follow. The $i$-th of these lines contains two integers $u_i$ and $v_i$ denoting an edge of the tree.\n- The next line contains a single integer $Q$ - the number of events.\n- $Q$ lines follow. The $i$-th of these lines contains two integers $t_i$ (the type of the $i$-th query) and $q_i$. If $t_i=1$ or $t_i=2$, $q_i$ is the vertex whose status is being changed. If $t_i=3$, $q_i$ is the parameter describing a query of the third type.","inputFormatState":true,"outputFormat":"- For each test case, print a single line.\n- In that line, print $l$ characters with no spaces between them, where $l$ is the number of queries of third type in this test case. \n- For each valid $i$, the $i$-th character in the line should be $1$ if there exists a node satisfying the conditions of the $i$-th query of third type in that test case and $0$ otherwise.\n","outputFormatState":true,"sampleTestCases":[{"id":"1","input":"2\n5\n1 2\n1 3\n2 4\n2 5\n7\n1 2\n3 2\n3 3\n1 4\n3 3\n2 2\n3 1\n8\n1 2\n2 3\n2 4\n2 5\n4 6\n5 7\n5 8\n9\n1 1\n1 7\n1 8\n3 2\n3 1\n3 4\n2 1\n3 1\n3 5","output":"1011\n10110","explanation":"**Test case 1:** The following picture shows the tree in the first test case:\n\n<div style=\"text-align: center;\">\n<img src=\"https:\/\/drive.google.com\/uc?export=view&id=1bDIeU2sdmfeaqDuJOUBkZ9NEbCk7R4ty\" class=\"center\">\n<\/div>\n\n- In the first query of the third type we have $K=2$ and the node $2$ is the only special node. The special node with the maximum distance from node $3$ is the node $2$ and $d(3,2)=2=K$, so the node $3$ satisfies the requirement. Therefore, the answer to this query is $1$.\n- In the second query of the third type we have $K=3$ and the node $2$ is the only special node. There do not exist any nodes at distance $K=3$ from the node $2$. Therefore, the answer to this query is $0$.\n- In the third query of the third type we have $K=3$ and the special nodes are $2$ and $4$. The special node with the maximum distance from node $3$ is the node $4$ and $d(3,4)=3=K$, so the node $3$ satisfies the requirement. Therefore, the answer to this query is $1$.\n- In the fourth query of the third type we have $K=1$ and the node $4$ is the only special node. The special node with the maximum distance from node $2$ is the node $4$ and $d(2,4)=1=K$, so the node $2$ satisfies the requirement. Therefore, the answer to this query is $1$.\n\n**Test case 2:** The following picture shows the tree in the second test case:\n\n<div style=\"text-align: center;\">\n<img src=\"https:\/\/drive.google.com\/uc?export=view&id=17LIQxnIx2mu-NB5-LQ0uLTyAgrQHPbui\" class=\"center\">\n<\/div>\n\n- In the first query of the third type we have $K=2$ and the special nodes are $1$, $7$ and $8$. The special node with the maximum distance from node $2$ is the node $7$ and $d(2,7)=2=K$, so the node $2$ satisfies the requirement. Therefore, the answer to this query is $1$.\n\n- In the second query of the third type we have $K=1$ and the special nodes are $1$, $7$ and $8$. There do not exist any nodes at distance $K=1$ from their farthest special node. Therefore, the answer to this query is $0$.\n\n- In the third query of the third type we have $K=4$ and the special nodes are $1$, $7$ and $8$. The special node with the maximum distance from node $6$ is the node $7$ and $d(6,7)=4=K$, so the node $6$ satisfies the requirement. Therefore, the answer to this query is $1$.\n\n- In the fourth query of the third type we have $K=1$ and the special nodes are $7$ and $8$. The special node with the maximum distance from node $5$ is the node $7$ and $d(5,7)=1=K$, so the node $5$ satisfies the requirement. Therefore, the answer to this query is $1$.\n\n- In the fifth query of the third type we have $K=5$ and the special nodes are $7$ and $8$. There do not exist any nodes at distance $K=5$ from their farthest special node. Therefore, the answer to this query is $0$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"losmi247","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>losmi247<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"24-07-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook131'>cook131<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/diameter'>diameter<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/losmi247'>losmi247<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/lowest-common-ancestor'>lowest-common-ancestor<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tree-queries'>tree-queries<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Segment Tree","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SPTREE2","time":{"view_start_date":1627492504,"submit_start_date":1627492504,"visible_start_date":1627492504,"end_date":1735669800,"current":1643797978},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SPTREE2","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}