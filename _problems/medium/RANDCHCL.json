{"category_name":"medium","status":"success","problem_code":"RANDCHCL","problem_name":"Random Chocolates","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK116\/hindi\/RANDCHCL.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK116\/mandarin\/RANDCHCL.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK116\/russian\/RANDCHCL.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK116\/vietnamese\/RANDCHCL.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK116\/bengali\/RANDCHCL.pdf) as well.\r\n\r\nWe all know that Chef got a box of $N$ chocolates (numbered $1$ through $N$) as his birthday present. For each valid $i$, the $i$-th chocolate has a sweetness value $W_i$. Chef is going to play the following randomised game for fun with his brother:\r\n- First, an integer $k$ between $1$ and $N$ (inclusive) is chosen uniformly randomly.\r\n- Then, $k$ times, Chef chooses a chocolate from the box uniformly randomly and independently (each chocolate may be chosen multiple times). For each $i$ ($1 \\le i \\le k$), let's denote the sweetness of the $i$-th chocolate chosen by Chef by $A_i$.\r\n- Chef's brother does the same thing \u2015 $k$ times, he also chooses a chocolate from the box uniformly randomly and independently from each other or Chef's choices (so each chocolate may still be chosen multiple times). For each $i$ ($1 \\le i \\le k$), let's denote the sweetness of the $i$-th chocolate chosen by Chef's brother by $B_i$.\r\n- The score of the game is $\\sum_{i=1}^k \\sum_{j=1}^k \\mathrm{gcd}(A_i, B_j)$.\r\n\r\nFind the expected value of the score. It can be proved that this expected value can be expressed as a fraction $\\frac{P}{Q}$, where $P$ and $Q$ are positive integers and $Q$ is coprime with $998,244,353$. You should compute $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $W_1, W_2, \\ldots, W_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $P \\cdot Q^{-1}$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 5$\r\n- $1 \\le N \\le 3 \\cdot 10^5$\r\n- $1 \\le W_i \\le 5 \\cdot 10^5$ for each valid $i$\r\n\r\n### Example Input\r\n```\r\n2\r\n3\r\n1 2 3\r\n4\r\n2 2 2 2\r\n```\r\n\r\n### Example Output\r\n```\r\n887328320\r\n15\r\n```\r\n\r\n### Explanation\r\n**Example case 2:**\r\n- When $k = 1$, the score is $1^2 \\cdot 2 = 2$.\r\n- When $k = 2$, the score is $2^2 \\cdot 2 = 8$.\r\n- When $k = 3$, the score is $3^2 \\cdot 2 = 18$.\r\n- When $k = 4$, the score is $4^2 \\cdot 2 = 32$.\r\n\r\nThe expected score is $\\frac{2+8+18+32}{4} = 15$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK116\/hindi\/RANDCHCL.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK116\/mandarin\/RANDCHCL.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK116\/russian\/RANDCHCL.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK116\/vietnamese\/RANDCHCL.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK116\/bengali\/RANDCHCL.pdf) as well.\r\n\r\nWe all know that Chef got a box of $N$ chocolates (numbered $1$ through $N$) as his birthday present. For each valid $i$, the $i$-th chocolate has a sweetness value $W_i$. Chef is going to play the following randomised game for fun with his brother:\r\n- First, an integer $k$ between $1$ and $N$ (inclusive) is chosen uniformly randomly.\r\n- Then, $k$ times, Chef chooses a chocolate from the box uniformly randomly and independently (each chocolate may be chosen multiple times). For each $i$ ($1 \\le i \\le k$), let's denote the sweetness of the $i$-th chocolate chosen by Chef by $A_i$.\r\n- Chef's brother does the same thing \u2015 $k$ times, he also chooses a chocolate from the box uniformly randomly and independently from each other or Chef's choices (so each chocolate may still be chosen multiple times). For each $i$ ($1 \\le i \\le k$), let's denote the sweetness of the $i$-th chocolate chosen by Chef's brother by $B_i$.\r\n- The score of the game is $\\sum_{i=1}^k \\sum_{j=1}^k \\mathrm{gcd}(A_i, B_j)$.\r\n\r\nFind the expected value of the score. It can be proved that this expected value can be expressed as a fraction $\\frac{P}{Q}$, where $P$ and $Q$ are positive integers and $Q$ is coprime with $998,244,353$. You should compute $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $W_1, W_2, \\ldots, W_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $P \\cdot Q^{-1}$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 5$\r\n- $1 \\le N \\le 3 \\cdot 10^5$\r\n- $1 \\le W_i \\le 5 \\cdot 10^5$ for each valid $i$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n3\r\n1 2 3\r\n4\r\n2 2 2 2","output":"887328320\r\n15","explanation":"**Example case 2:**\r\n- When $k = 1$, the score is $1^2 \\cdot 2 = 2$.\r\n- When $k = 2$, the score is $2^2 \\cdot 2 = 8$.\r\n- When $k = 3$, the score is $3^2 \\cdot 2 = 18$.\r\n- When $k = 4$, the score is $4^2 \\cdot 2 = 32$.\r\n\r\nThe expected score is $\\frac{2+8+18+32}{4} = 15$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"imanik","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>imanik<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"14-03-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/cook116'>cook116<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/imanik'>imanik<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tmwilliamlin'>tmwilliamlin<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/RANDCHCL","time":{"view_start_date":1584901802,"submit_start_date":1584901802,"visible_start_date":1584901802,"end_date":1735669800,"current":1643797971},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=RANDCHCL","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}