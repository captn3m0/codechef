{"category_name":"medium","status":"success","problem_code":"PGCDS","problem_name":"Permutation and GCD Set","body":"### Read problems statements in [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK133\/russian\/PGCDS.pdf).\n\nWe define the *GCD set* of an array $A$ of length $N$ as the set containing the GCD of all prefixes of $A$. More formally, the GCD set $G$ of $A$ contains the values $\\gcd([A_1]), \\gcd([A_1, A_2]), \\gcd([A_1, A_2, A_3]), \\ldots, \\gcd([A_1, A_2, \\ldots, A_n])$, where $\\gcd(B)$ is the largest integer $d$ such that all the numbers in array $B$ are divisible by $d$. Note that **all values in $G$ are distinct**.\n\nFor example, $\\gcd([6]) = 6$, $\\gcd([6, 12]) = 6$, $\\gcd([6, 12, 9]) = 3$, and $\\gcd([6, 12, 9, 2]) = 1$. Therefore, the GCD set of the array $[6, 12, 9, 2]$ is $\\{1, 3, 6\\}$.\n\nYou are given an integer set $S$ of size $M$ and two integers $N, MOD$, where $MOD$ is a prime. You need to calculate the probability that the GCD set of $P$ is equal to $S$, where $P$ is a **permutation** of values $1$ to $N$ chosen uniformly randomly.\n\nIt can be shown that the answer is in the form of $\\frac{P}{Q}$ where $P$ and $Q$ are coprime non-negative integers and $Q \\neq 0$. You need to find the value $P \\cdot Q^{-1} \\pmod{MOD}$.\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"- $1 \\le T \\le 10$\n- $1 \\le N \\le 10^9$\n- $1 \\leq M \\leq 2 \\cdot 10^4$\n- $10^9 < MOD < 2 \\cdot 10^9$\n- $MOD$ is a prime\n- $1 \\leq S_1 < S_2 < \\ldots < S_M \\leq N$","constraintsState":true,"subtasks":"- 30 points : $1 \\leq R \\leq 10000$\n- 70 points : $1 \\leq R \\leq 10^9$\n","subtasksState":false,"statement":"### Read problems statements in [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK133\/russian\/PGCDS.pdf).\n\nWe define the *GCD set* of an array $A$ of length $N$ as the set containing the GCD of all prefixes of $A$. More formally, the GCD set $G$ of $A$ contains the values $\\gcd([A_1]), \\gcd([A_1, A_2]), \\gcd([A_1, A_2, A_3]), \\ldots, \\gcd([A_1, A_2, \\ldots, A_n])$, where $\\gcd(B)$ is the largest integer $d$ such that all the numbers in array $B$ are divisible by $d$. Note that **all values in $G$ are distinct**.\n\nFor example, $\\gcd([6]) = 6$, $\\gcd([6, 12]) = 6$, $\\gcd([6, 12, 9]) = 3$, and $\\gcd([6, 12, 9, 2]) = 1$. Therefore, the GCD set of the array $[6, 12, 9, 2]$ is $\\{1, 3, 6\\}$.\n\nYou are given an integer set $S$ of size $M$ and two integers $N, MOD$, where $MOD$ is a prime. You need to calculate the probability that the GCD set of $P$ is equal to $S$, where $P$ is a **permutation** of values $1$ to $N$ chosen uniformly randomly.\n\nIt can be shown that the answer is in the form of $\\frac{P}{Q}$ where $P$ and $Q$ are coprime non-negative integers and $Q \\neq 0$. You need to find the value $P \\cdot Q^{-1} \\pmod{MOD}$.","inputFormat":"- The first line contains an integer $T$ denoting the number of test cases. The $T$ test cases then follow.\n- The first line of each test case contains three integers $N, M, MOD$ denoting the length of the permutation, the size of the given integer set, and the modulo respectively.\n- The second line of each test case contains $m$ integers in increasing order $S_1, S_2, \\ldots, S_M$ representing the given integer set.","inputFormatState":true,"outputFormat":"For each test case, output on one line an integer equals to the answer of that test case.","outputFormatState":true,"sampleTestCases":[{"id":"1","input":"4\n4 3 1000000007\n1 2 4\n9 2 1000000009\n1 3\n10 3 1000000007\n2 4 8\n864197532 5 1876248763\n1 4019 727439 19640853 864197532\n","output":"83333334\n888888897\n0\n1828476640","explanation":"- For the first test case, there are 2 permutations that satisfy the condition:\n\n1. $[4, 2, 1, 3]$\n\n2. $[4, 2, 3, 1]$\n\nSince there are $4!$ permutations of length $4$ in total, the probability is $\\frac{2}{4!} = \\frac{1}{12}$. As $83333334 \\cdot 12 \\equiv 1 \\pmod {10^9 + 7}$, we output $83333334$.\n\n- For the second test case, the probability is $\\frac{1}{9}$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"abc864197532","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span class='m-username--link'>abc864197532<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"17-09-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/abc864197532'>abc864197532<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/cook133'>cook133<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/inclusion-exclusion'>inclusion-exclusion<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/number-theory'>number-theory<\/a>","problem_difficulty_level":"Unavailable","user_zen_mode":false,"best_tag":"Number Theory","editorial_url":"https:\/\/discuss.codechef.com\/problems\/PGCDS","time":{"view_start_date":1632078002,"submit_start_date":1632078002,"visible_start_date":1632078002,"end_date":1735669800,"current":1643797968},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=PGCDS","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}