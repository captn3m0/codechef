{"category_name":"medium","status":"success","problem_code":"COMMCHA","problem_name":"Communication Channel","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK124\/hindi\/COMMCHA.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK124\/mandarin\/COMMCHA.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK124\/russian\/COMMCHA.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK124\/vietnamese\/COMMCHA.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK124\/bengali\/COMMCHA.pdf) as well.\r\n\r\nThere is a communication channel with $N+1$ stations (numbered $0$ through $N$). Station $0$ wants to send a message to station $N$. You may install memory disks at up to $K$ of the stations $1, 2, \\ldots, N-1$. Let's denote the increasing sequence of stations at which memory disks are installed by $(v_1, v_2, \\ldots, v_k)$, where $k \\le K$ is the number of such stations, and let $v_0 = 0$ and $v_{k+1} = N$. In stations other than $v_0, v_1, \\ldots, v_{k+1}$, it is only possible to send the message forward without storing it for later.\r\n\r\nFor each $i$ ($0 \\le i \\lt N$), if the message is currently at the station $i$, this station can send the message to the station $i + 1$. This transfer takes one second regardless of its success or failure. With probability $p_i$, the transfer succeeds and the message reaches the station $i + 1$. Otherwise, the transfer fails and the message instantly goes back to the station $v_j$, where $j$ is the unique index such that $v_j \\le i \\lt v_{j+1}$ (if $i = v_j$, the message simply stays in the station $v_j$), and this station has to send it forward again.\r\n\r\nYour task is to choose stations where memory disks should be installed, in such a way that the expected value of time needed for the message to reach station $N$ is the smallest possible. Find this smallest expected time.\r\n\r\nYou are not given the probabilities directly. Instead, you are given a non-increasing integer sequence $F_0, F_1, \\ldots, F_N$. For each valid $i$, $p_i = F_{i+1} \/ F_i$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- The second line contains $N + 1$ space-separated integers $F_0, F_1, \\ldots, F_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one real number \u2014 the smallest possible expected time needed for the message to reach station $N$. Your answer will be considered correct if its absolute or relative error does not exceed $10^{-6}$.\r\n\r\n### Constraints \r\n- $1 \\le T \\le 10^5$\r\n- $1 \\le N \\le 10^5$\r\n- $0 \\le K \\le \\min(50, N-1)$\r\n- $10^{12} \\ge F_0 \\ge F_1 \\ge \\ldots \\ge F_N \\ge 1$\r\n- the sum of $N$ over all test cases does not exceed $10^5$\r\n\r\n### Example Input\r\n```\r\n1\r\n2 1\r\n4 2 1\r\n```\r\n\r\n### Example Output\r\n```\r\n4.0000000000\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** The probabilities of success are $p_0 = p_1 = 1\/2$. If no memory disks are installed, the expected amount of time the message needs to reach station $2$ is $6$ seconds.\r\n\r\nIf a memory disk is installed at station $1$, the expected time is $4$ seconds ($2$ seconds to transfer from station $0$ to station $1$ and further $2$ seconds to transfer from station $1$ to station $2$).\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK124\/hindi\/COMMCHA.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK124\/mandarin\/COMMCHA.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK124\/russian\/COMMCHA.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK124\/vietnamese\/COMMCHA.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK124\/bengali\/COMMCHA.pdf) as well.\r\n\r\nThere is a communication channel with $N+1$ stations (numbered $0$ through $N$). Station $0$ wants to send a message to station $N$. You may install memory disks at up to $K$ of the stations $1, 2, \\ldots, N-1$. Let's denote the increasing sequence of stations at which memory disks are installed by $(v_1, v_2, \\ldots, v_k)$, where $k \\le K$ is the number of such stations, and let $v_0 = 0$ and $v_{k+1} = N$. In stations other than $v_0, v_1, \\ldots, v_{k+1}$, it is only possible to send the message forward without storing it for later.\r\n\r\nFor each $i$ ($0 \\le i \\lt N$), if the message is currently at the station $i$, this station can send the message to the station $i + 1$. This transfer takes one second regardless of its success or failure. With probability $p_i$, the transfer succeeds and the message reaches the station $i + 1$. Otherwise, the transfer fails and the message instantly goes back to the station $v_j$, where $j$ is the unique index such that $v_j \\le i \\lt v_{j+1}$ (if $i = v_j$, the message simply stays in the station $v_j$), and this station has to send it forward again.\r\n\r\nYour task is to choose stations where memory disks should be installed, in such a way that the expected value of time needed for the message to reach station $N$ is the smallest possible. Find this smallest expected time.\r\n\r\nYou are not given the probabilities directly. Instead, you are given a non-increasing integer sequence $F_0, F_1, \\ldots, F_N$. For each valid $i$, $p_i = F_{i+1} \/ F_i$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- The second line contains $N + 1$ space-separated integers $F_0, F_1, \\ldots, F_N$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one real number \u2014 the smallest possible expected time needed for the message to reach station $N$. Your answer will be considered correct if its absolute or relative error does not exceed $10^{-6}$.\r\n\r\n### Constraints \r\n- $1 \\le T \\le 10^5$\r\n- $1 \\le N \\le 10^5$\r\n- $0 \\le K \\le \\min(50, N-1)$\r\n- $10^{12} \\ge F_0 \\ge F_1 \\ge \\ldots \\ge F_N \\ge 1$\r\n- the sum of $N$ over all test cases does not exceed $10^5$\r\n\r\n### Example Input\r\n```\r\n1\r\n2 1\r\n4 2 1\r\n```\r\n\r\n### Example Output\r\n```\r\n4.0000000000\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** The probabilities of success are $p_0 = p_1 = 1\/2$. If no memory disks are installed, the expected amount of time the message needs to reach station $2$ is $6$ seconds.\r\n\r\nIf a memory disk is installed at station $1$, the expected time is $4$ seconds ($2$ seconds to transfer from station $0$ to station $1$ and further $2$ seconds to transfer from station $1$ to station $2$).\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"https:\/\/youtu.be\/-OfadfAIFGw","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"shaanknight","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>shaanknight<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"20-11-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook124'>cook124<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/expected-value'>expected-value<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/shaanknight'>shaanknight<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/COMMCHA","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797932},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=COMMCHA","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}