{"category_name":"medium","status":"success","problem_code":"SUBPROB","problem_name":"Substring Probability","body":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/bengali\/SUBPROB.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/mandarin\/SUBPROB.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/russian\/SUBPROB.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/vietnamese\/SUBPROB.pdf) as well.\r\n\r\nYou are given two strings $P$ and $Q$. Consider some uniformly randomly and independently chosen non-empty prefix $X$ and non-empty suffix $Y$ of $P$. A string $Z$ is formed by concatenating $X$ and $Y$ in this order. Find the probability that $Z$ is a substring of $Q$.\r\n\r\nIt can be shown that the answer can be represented as a fraction $U\/V$, where $U$ and $V$ are non-negative integers and $V$ is coprime with $998,244,353$. You should compute $U \\cdot V^{-1}$ modulo $998,244,353$, where $V^{-1}$ denotes the multiplicative inverse of $V$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single string $P$.\r\n- The second line contains a single string $Q$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $U \\cdot V^{-1}$ modulo $998,244,353$.\r\n\r\n### Constraints \r\n- $1 \\leq T \\leq 10$\r\n- $1 \\leq |P|, |Q| \\leq 100,000$\r\n- $P$ and $Q$ contain only lowercase English letters\r\n\r\n### Subtasks\r\n**Subtask #1 (25 points):** $|P|, |Q| \\leq 2,000$\r\n\r\n**Subtask #2 (75 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n1\r\nabac\r\naacabc\r\n```\r\n\r\n### Example Output\r\n```\r\n811073537\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** There are $4$ possible prefixes $X$ and $4$ suffixes $Y$. The only combinations that result in a string $Z$ that is a substring of $Q$ are:\r\n- $X$ = \"a\", $Y$ = \"ac\"\r\n- $X$ = \"a\", $Y$ = \"c\"\r\n- $X$ = \"ab\", $Y$ = \"c\"\r\n\r\nThe probability that $Z$ is a substring of $Q$ is $3\/16$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/bengali\/SUBPROB.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/mandarin\/SUBPROB.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/russian\/SUBPROB.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/vietnamese\/SUBPROB.pdf) as well.\r\n\r\nYou are given two strings $P$ and $Q$. Consider some uniformly randomly and independently chosen non-empty prefix $X$ and non-empty suffix $Y$ of $P$. A string $Z$ is formed by concatenating $X$ and $Y$ in this order. Find the probability that $Z$ is a substring of $Q$.\r\n\r\nIt can be shown that the answer can be represented as a fraction $U\/V$, where $U$ and $V$ are non-negative integers and $V$ is coprime with $998,244,353$. You should compute $U \\cdot V^{-1}$ modulo $998,244,353$, where $V^{-1}$ denotes the multiplicative inverse of $V$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single string $P$.\r\n- The second line contains a single string $Q$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $U \\cdot V^{-1}$ modulo $998,244,353$.\r\n\r\n### Constraints \r\n- $1 \\leq T \\leq 10$\r\n- $1 \\leq |P|, |Q| \\leq 100,000$\r\n- $P$ and $Q$ contain only lowercase English letters\r\n\r\n### Subtasks\r\n**Subtask #1 (25 points):** $|P|, |Q| \\leq 2,000$\r\n\r\n**Subtask #2 (75 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\nabac\r\naacabc","output":"811073537","explanation":"**Example case 1:** There are $4$ possible prefixes $X$ and $4$ suffixes $Y$. The only combinations that result in a string $Z$ that is a substring of $Q$ are:\r\n- $X$ = \"a\", $Y$ = \"ac\"\r\n- $X$ = \"a\", $Y$ = \"c\"\r\n- $X$ = \"ab\", $Y$ = \"c\"\r\n\r\nThe probability that $Z$ is a substring of $Q$ is $3\/16$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/0aB00I8Quls","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"smartnj","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>smartnj<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"13-02-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/march21'>march21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/smartnj'>smartnj<\/a>","problem_difficulty_level":"Unavailable","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SUBPROB","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797982},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SUBPROB","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}