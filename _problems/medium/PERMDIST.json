{"category_name":"medium","status":"success","problem_code":"PERMDIST","problem_name":"Permutation Distance","body":"Consider a permutation $P = (p_1, p_2, ..., p_n)$ of numbers $\\{1, 2, ... , n\\}$. Let us construct a graph $G(P)$ with $n$ vertices as follows: if $i, j \\in \\{1, ..., n\\}$ and $i < j$, then an undirected edge $(i, j)$ is present in $G(P)$ if and only if $p_i < p_j$.\r\n\r\nGiven a permutation $P$, answer several queries of the form \"what is the shortest length of a path between $u$ and $v$ in $G(P)$?\". If there is no path between $u$ and $v$, report so.\r\n\r\n\r\n###Input:\r\n- The first line contains a single integer $T$ denoting the number of test cases. $T$ test case descriptions follow.\r\n- Each test case description starts with a line containing two integers, $n$ and $q$, denoting the length of the permutation $P$ and the number of queries respectively.\r\n- The next line contains $n$ distinct integers $p_1, ..., p_n$ denoting the permutation $P$.\r\n- The following $q$ lines describe queries. The $i$-th of these lines contains two integers $u_i$ and $v_i$ denoting parameters of the $i$-th query.\r\n\r\n###Output:\r\n- Print answers for all queries in order of appearance in the input, one per line.\r\n- If there is no path between $u_i$ and $v_i$, print $-1$ as the answer for the $i$-th query. Otherwise, print a single integer denoting the shortest length of a path between $u_i$ and $v_i$.\r\n\r\n\r\n###Constraints\r\n- $1 \\leq T \\leq 10^5$\r\n- $1 \\leq n, q \\leq 10^5$\r\n- $1 \\leq p_i \\leq n$\r\n- $p_1, ..., p_n$ forms a permutation of  $\\{1, 2, ... , n\\}$\r\n- $1 \\leq u_i, v_i \\leq n$\r\n- The sum of all $n$ in a test file does not exceed $5 \\cdot 10^5$\r\n- The sum of all $q$ in a test file does not exceed $5 \\cdot 10^5$\r\n\r\n###Sample Input:\r\n```\r\n1\r\n5 4\r\n3 5 2 4 1\r\n1 1\r\n2 3\r\n1 4\r\n4 5\r\n```\r\n\r\n###Sample Output:\r\n```\r\n0\r\n3\r\n1\r\n-1\r\n```\r\n\r\n###Explanation\r\n- In the first query, we can go from 1 to 1 by just staying there, and hence path of length 0.\r\n- In the second query, we can go from the 2 (which has the value $p_2 = 5$) to 1, because 1 < 2 and $p_1 < p_2$. From there, we can go to 4, and from there to 3. This gives us a path of length 3, and is the shortest that we can get.\r\n\t\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"Consider a permutation $P = (p_1, p_2, ..., p_n)$ of numbers $\\{1, 2, ... , n\\}$. Let us construct a graph $G(P)$ with $n$ vertices as follows: if $i, j \\in \\{1, ..., n\\}$ and $i < j$, then an undirected edge $(i, j)$ is present in $G(P)$ if and only if $p_i < p_j$.\r\n\r\nGiven a permutation $P$, answer several queries of the form \"what is the shortest length of a path between $u$ and $v$ in $G(P)$?\". If there is no path between $u$ and $v$, report so.\r\n\r\n\r\n###Input:\r\n- The first line contains a single integer $T$ denoting the number of test cases. $T$ test case descriptions follow.\r\n- Each test case description starts with a line containing two integers, $n$ and $q$, denoting the length of the permutation $P$ and the number of queries respectively.\r\n- The next line contains $n$ distinct integers $p_1, ..., p_n$ denoting the permutation $P$.\r\n- The following $q$ lines describe queries. The $i$-th of these lines contains two integers $u_i$ and $v_i$ denoting parameters of the $i$-th query.\r\n\r\n###Output:\r\n- Print answers for all queries in order of appearance in the input, one per line.\r\n- If there is no path between $u_i$ and $v_i$, print $-1$ as the answer for the $i$-th query. Otherwise, print a single integer denoting the shortest length of a path between $u_i$ and $v_i$.\r\n\r\n\r\n###Constraints\r\n- $1 \\leq T \\leq 10^5$\r\n- $1 \\leq n, q \\leq 10^5$\r\n- $1 \\leq p_i \\leq n$\r\n- $p_1, ..., p_n$ forms a permutation of  $\\{1, 2, ... , n\\}$\r\n- $1 \\leq u_i, v_i \\leq n$\r\n- The sum of all $n$ in a test file does not exceed $5 \\cdot 10^5$\r\n- The sum of all $q$ in a test file does not exceed $5 \\cdot 10^5$\r\n\r\n###Sample Input:\r\n```\r\n1\r\n5 4\r\n3 5 2 4 1\r\n1 1\r\n2 3\r\n1 4\r\n4 5\r\n```\r\n\r\n###Sample Output:\r\n```\r\n0\r\n3\r\n1\r\n-1\r\n```\r\n\r\n###Explanation\r\n- In the first query, we can go from 1 to 1 by just staying there, and hence path of length 0.\r\n- In the second query, we can go from the 2 (which has the value $p_2 = 5$) to 1, because 1 < 2 and $p_1 < p_2$. From there, we can go to 4, and from there to 3. This gives us a path of length 3, and is the shortest that we can get.\r\n\t","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"balajiganapath","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>balajiganapath<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"24-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/balajiganapath'>balajiganapath<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"","editorial_url":"","time":{"view_start_date":1577730600,"submit_start_date":1577730600,"visible_start_date":1577730600,"end_date":1735669800,"current":1643797968},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=PERMDIST","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}