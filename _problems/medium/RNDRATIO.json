{"category_name":"medium","status":"success","problem_code":"RNDRATIO","problem_name":"Mysterious Ratio","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/hindi\/RNDRATIO.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/bengali\/RNDRATIO.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/mandarin\/RNDRATIO.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/russian\/RNDRATIO.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/vietnamese\/RNDRATIO.pdf) as well.\r\n\r\nChef has been teaching probability and expectation in his class. He wants his $N$ students (numbered $1$ through $N$) to play a game so that they could understand the concepts clearly.\r\n\r\nFor each valid $i$, the $i$-th student should choose an integer from a range $[L_i, R_i]$ uniformly randomly. Chef wants to know the expected value of the ratio $A\/B$, where $A$ is the product of the integers chosen by the students and $B$ is the GCD of these integers. Please help him calculate it.\r\n\r\nIt can be proved that this expected value can be expressed as a fraction $\\frac{P}{Q}$, where $P$ and $Q$ are positive integers and $Q$ is coprime with $998,244,353$. You should compute $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- $N$ lines follow. For each valid $i$, the $i$-th of these lines contains two space-separated integers $L_i$ and $R_i$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $P \\cdot Q^{-1}$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 2$\r\n- $1 \\le N \\le 10^5$\r\n- $1 \\le L_i \\le R_i \\le 10^5$ for each valid $i$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):**\r\n- $N \\le 10^3$\r\n- $R_i \\le 10^3$ for each valid $i$\r\n\r\n**Subtask #2 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n2\r\n1\r\n1 3\r\n2\r\n2 4\r\n5 5\r\n```\r\n\r\n### Example Output\r\n```\r\n1\r\n15\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** There are three possible scenarios: student $1$ can choose $1$, $2$ or $3$. In all of them, $A = B$, so the expected value is $1$.\r\n\r\n**Example case 2:** There are three possible scenarios:\r\n- Student $1$ chooses $2$, student $2$ chooses $5$: $\\frac{A}{B} = \\frac{2 \\cdot 5}{\\mathrm{gcd}(2, 5)} = 10$.\r\n- Student $1$ chooses $3$, student $2$ chooses $5$: $\\frac{A}{B} = \\frac{3 \\cdot 5}{\\mathrm{gcd}(3, 5)} = 15$.\r\n- Student $1$ chooses $4$, student $2$ chooses $5$: $\\frac{A}{B} = \\frac{4 \\cdot 5}{\\mathrm{gcd}(4, 5)} = 20$.\r\n\r\nThe expected value of the ratio is $\\frac{10+15+20}{3} = 15$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/hindi\/RNDRATIO.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/bengali\/RNDRATIO.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/mandarin\/RNDRATIO.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/russian\/RNDRATIO.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME82\/vietnamese\/RNDRATIO.pdf) as well.\r\n\r\nChef has been teaching probability and expectation in his class. He wants his $N$ students (numbered $1$ through $N$) to play a game so that they could understand the concepts clearly.\r\n\r\nFor each valid $i$, the $i$-th student should choose an integer from a range $[L_i, R_i]$ uniformly randomly. Chef wants to know the expected value of the ratio $A\/B$, where $A$ is the product of the integers chosen by the students and $B$ is the GCD of these integers. Please help him calculate it.\r\n\r\nIt can be proved that this expected value can be expressed as a fraction $\\frac{P}{Q}$, where $P$ and $Q$ are positive integers and $Q$ is coprime with $998,244,353$. You should compute $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- $N$ lines follow. For each valid $i$, the $i$-th of these lines contains two space-separated integers $L_i$ and $R_i$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer $P \\cdot Q^{-1}$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 2$\r\n- $1 \\le N \\le 10^5$\r\n- $1 \\le L_i \\le R_i \\le 10^5$ for each valid $i$\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):**\r\n- $N \\le 10^3$\r\n- $R_i \\le 10^3$ for each valid $i$\r\n\r\n**Subtask #2 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n1\r\n1 3\r\n2\r\n2 4\r\n5 5","output":"1\r\n15","explanation":"**Example case 1:** There are three possible scenarios: student $1$ can choose $1$, $2$ or $3$. In all of them, $A = B$, so the expected value is $1$.\r\n\r\n**Example case 2:** There are three possible scenarios:\r\n- Student $1$ chooses $2$, student $2$ chooses $5$: $\\frac{A}{B} = \\frac{2 \\cdot 5}{\\mathrm{gcd}(2, 5)} = 10$.\r\n- Student $1$ chooses $3$, student $2$ chooses $5$: $\\frac{A}{B} = \\frac{3 \\cdot 5}{\\mathrm{gcd}(3, 5)} = 15$.\r\n- Student $1$ chooses $4$, student $2$ chooses $5$: $\\frac{A}{B} = \\frac{4 \\cdot 5}{\\mathrm{gcd}(4, 5)} = 20$.\r\n\r\nThe expected value of the ratio is $\\frac{10+15+20}{3} = 15$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"5","source_sizelimit":"50000","problem_author":"imanik","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>imanik<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"24-03-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/expected-value'>expected-value<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/imanik'>imanik<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/inclusion-exclusion'>inclusion-exclusion<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime82'>ltime82<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Expected Value","editorial_url":"https:\/\/discuss.codechef.com\/problems\/RNDRATIO","time":{"view_start_date":1585408500,"submit_start_date":1585408500,"visible_start_date":1585408500,"end_date":1735669800,"current":1643797973},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=RNDRATIO","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}