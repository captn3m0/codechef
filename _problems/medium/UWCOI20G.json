{"category_name":"medium","status":"success","problem_code":"UWCOI20G","problem_name":"Optimal Memory Address","body":"Kim has successfully broken into the vault. He finds the main computer, a hideous creation with a wormhole to some extradimensional space.\r\n\r\nAs we all know, Kim is a very powerful hacker. However, it seems that he has finally met his match: Jishnu's computer network is too difficult for him to hack into, even though it is right in front of him! He needs your help to recover the files related to the JSA's world domination plans so he can expose them to the world and win the Pulitzer Prize.\r\n\r\nUsing some tricks, Jishnu has created a computer system with infinite memory! Each memory address is numbered from $1$ to $\\infty$.\r\n\r\nKim knows that all of the data related to Jishnu's world domination plans is stored in $N$ memory addresses. The $i$th memory address is $A[i]$. These memory addresses may be very large, so we can express an integer $X$ as the product of $K(X)$ prime factors raised to some power. The prime factors are given in increasing order. Formally, for an integer $X$, there are two $K(X)$-length arrays $P(X)$ and $Q(X)$ where $P(X)[i] < P(X)[i+1]$ for all $i$, and $X = \\prod_{i=1}^{K(X)} {P(X)[i]}^{Q(X)[i]}$. This is the format that the input will be given in. Note that they may not be distinct.\r\n\r\nOf course, it takes time to move between memory addresses. Kim has found an odd rule for finding the time needed to move between two memory addressees numbered $X$ and $Y$, $dist(X,Y)$. Let each integer $X$ be associated with an infinite-length sequence $S(X)$. Below is the pseudocode for creating the sequence given $X$:\r\n\r\n```\r\nS(X) = []\r\nfor i=1 to K(X) do:\r\n    for j=1 to Q(X)[i] do:\r\n        append P(X)[i] to S(X)\r\nwhile (true):\r\n    append -1 to S(X)\r\n\r\n```\r\n\r\nLet $V$ be the first index (0-indexed) where $S(X)[V] \\neq S(Y)[V]$. Furthermore, let $size(X)$ be $\\sum_{i=1}^{K(X)} Q(X)[i]$. Then, $dist(X,Y) = size(X)+size(Y)-2*V$. Please note, $dist(X,X) = 0$ because Kim is not moving memory address.\r\n\r\nKim's hacking works as follows: he chooses a starting memory address as his incision point, and then he goes directly to each  of the memory addresses which contains the world domination plans separately, one after another. So, the total amount of time it takes for Kim to get all the information is $\\sum_{i=1}^{N} dist(C,A[i])$, where $C$ was his starting memory address. Kim is interested in what the minimum possible value of this could be if he chooses an optimal value of $C$. Since $C$ must be a valid memory address, $C$ must be an integer greater than or equal to $1$.\r\n\r\n###Input:\r\n\r\n- The first will contain one integer, $N$. \r\n- For the next $N$ lines, the $(i+1)$th line will have their first integer as $K(A[i])$. Following that is $2*K(A[i])$ integers, $P(A[i])[1] \\quad Q(A[i])[1] \\quad ... \\quad P(A[i])[K(A[i])] \\quad Q(A[i])[K(A[i])]$. \r\n\r\n###Output:\r\nFor each testcase, output one integer: the minimum possible value of $\\sum_{i=1}^{N} dist(C,A[i])$.\r\n\r\n###Constraints \r\n- $\\sum_{i=1}^{N} K(A[i]) \\leq 10^6$\r\n- $1 \\leq N \\leq 10^6$\r\n- $A[i] > 1$ for all $i$\r\n- $P[i], Q[i] \\leq 10^9$ for all $i$\r\n- $P(X)[i]$ is always prime\r\n- $P(X)[i] < P(X)[i+1]$ for all $i$\r\n- All $P(X)[i]$ are distinct for a given $X$.\r\n\r\n###Subtasks\r\n- 50 points : $Q(A[i])[j] = 1$ for all $(i,j)$.\r\n- 50 points : No additional constraints.\r\n\r\n###Sample Input:\r\n\t5\r\n\t1 3 1\r\n\t2 2 1 3 1\r\n\t1 3 2\r\n\t2 3 1 5 1\r\n\t1 2 1\r\n\r\n\r\n###Sample Output:\r\n\t7\r\n\t\r\n###EXPLANATION:\r\nThe array $A$ is $[3, 6, 9, 15, 2]$. It can be verified that the minimum possible time is $7$, which is achieved when $C=3$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"Kim has successfully broken into the vault. He finds the main computer, a hideous creation with a wormhole to some extradimensional space.\r\n\r\nAs we all know, Kim is a very powerful hacker. However, it seems that he has finally met his match: Jishnu's computer network is too difficult for him to hack into, even though it is right in front of him! He needs your help to recover the files related to the JSA's world domination plans so he can expose them to the world and win the Pulitzer Prize.\r\n\r\nUsing some tricks, Jishnu has created a computer system with infinite memory! Each memory address is numbered from $1$ to $\\infty$.\r\n\r\nKim knows that all of the data related to Jishnu's world domination plans is stored in $N$ memory addresses. The $i$th memory address is $A[i]$. These memory addresses may be very large, so we can express an integer $X$ as the product of $K(X)$ prime factors raised to some power. The prime factors are given in increasing order. Formally, for an integer $X$, there are two $K(X)$-length arrays $P(X)$ and $Q(X)$ where $P(X)[i] < P(X)[i+1]$ for all $i$, and $X = \\prod_{i=1}^{K(X)} {P(X)[i]}^{Q(X)[i]}$. This is the format that the input will be given in. Note that they may not be distinct.\r\n\r\nOf course, it takes time to move between memory addresses. Kim has found an odd rule for finding the time needed to move between two memory addressees numbered $X$ and $Y$, $dist(X,Y)$. Let each integer $X$ be associated with an infinite-length sequence $S(X)$. Below is the pseudocode for creating the sequence given $X$:\r\n\r\n```\r\nS(X) = []\r\nfor i=1 to K(X) do:\r\n    for j=1 to Q(X)[i] do:\r\n        append P(X)[i] to S(X)\r\nwhile (true):\r\n    append -1 to S(X)\r\n\r\n```\r\n\r\nLet $V$ be the first index (0-indexed) where $S(X)[V] \\neq S(Y)[V]$. Furthermore, let $size(X)$ be $\\sum_{i=1}^{K(X)} Q(X)[i]$. Then, $dist(X,Y) = size(X)+size(Y)-2*V$. Please note, $dist(X,X) = 0$ because Kim is not moving memory address.\r\n\r\nKim's hacking works as follows: he chooses a starting memory address as his incision point, and then he goes directly to each  of the memory addresses which contains the world domination plans separately, one after another. So, the total amount of time it takes for Kim to get all the information is $\\sum_{i=1}^{N} dist(C,A[i])$, where $C$ was his starting memory address. Kim is interested in what the minimum possible value of this could be if he chooses an optimal value of $C$. Since $C$ must be a valid memory address, $C$ must be an integer greater than or equal to $1$.\r\n\r\n###Input:\r\n\r\n- The first will contain one integer, $N$. \r\n- For the next $N$ lines, the $(i+1)$th line will have their first integer as $K(A[i])$. Following that is $2*K(A[i])$ integers, $P(A[i])[1] \\quad Q(A[i])[1] \\quad ... \\quad P(A[i])[K(A[i])] \\quad Q(A[i])[K(A[i])]$. \r\n\r\n###Output:\r\nFor each testcase, output one integer: the minimum possible value of $\\sum_{i=1}^{N} dist(C,A[i])$.\r\n\r\n###Constraints \r\n- $\\sum_{i=1}^{N} K(A[i]) \\leq 10^6$\r\n- $1 \\leq N \\leq 10^6$\r\n- $A[i] > 1$ for all $i$\r\n- $P[i], Q[i] \\leq 10^9$ for all $i$\r\n- $P(X)[i]$ is always prime\r\n- $P(X)[i] < P(X)[i+1]$ for all $i$\r\n- All $P(X)[i]$ are distinct for a given $X$.\r\n\r\n###Subtasks\r\n- 50 points : $Q(A[i])[j] = 1$ for all $(i,j)$.\r\n- 50 points : No additional constraints.\r\n\r\n###Sample Input:\r\n\t5\r\n\t1 3 1\r\n\t2 2 1 3 1\r\n\t1 3 2\r\n\t2 3 1 5 1\r\n\t1 2 1\r\n\r\n\r\n###Sample Output:\r\n\t7\r\n\t\r\n###EXPLANATION:\r\nThe array $A$ is $[3, 6, 9, 15, 2]$. It can be verified that the minimum possible time is $7$, which is achieved when $C=3$.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"astoria","problem_author_html_handle":"astoria","problem_tester":null,"problem_tester_html_handle":"","date_added":"25-02-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/astoria'>astoria<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/uwcoi20'>uwcoi20<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Medium Hard","editorial_url":"https:\/\/discuss.codechef.com\/problems\/UWCOI20G","time":{"view_start_date":1582655400,"submit_start_date":1582655400,"visible_start_date":1582655400,"end_date":1735669800,"current":1643797988},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=UWCOI20G","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}