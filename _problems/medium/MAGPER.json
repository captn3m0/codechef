{"category_name":"medium","status":"success","problem_code":"MAGPER","problem_name":"Magic Permutations","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK109\/hindi\/MAGPER.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK109\/mandarin\/MAGPER.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK109\/russian\/MAGPER.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK109\/vietnamese\/MAGPER.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK109\/bengali\/MAGPER.pdf) as well.\n\nSaeed bought two magic permutations of integers $1$ through $N$ and gave them to his grandsons Rami and Ghoda to encourage them to train in problem solving.\n\nRami found out that he can only cyclically shift his permutation, i.e. choose any number of elements from the beginning and move them to the end without changing their order. On the other hand, Ghoda found out that he can only swap elements of his permutation.\n\nThe distance between two permutations $P_1, P_2, \\ldots, P_N$ and $R_1, R_2, \\ldots, R_N$ is the sum of $|i-j|$ over all pairs of valid indices $i, j$ such that $P_i = R_j$.\n\nYou should process $Q$ queries. In each query, one of Saeed's grandsons plays with his permutation (performs an operation described above), and afterwards, you should tell Saeed the distance between his grandsons' current permutations. Note that the queries are cumulative \u2014 the changes made in one query remain in subsequent queries.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains two space-separated integers $N$ and $Q$.\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$, denoting Rami's initial permutation.\n- The third line contains $N$ space-separated integers $B_1, B_2, \\ldots, B_N$, denoting Ghoda's initial permutation.\n- Each of the next $Q$ lines describes a query in one of the following formats:\n    - `1 z`: Rami moves $z$ elements from the beginning of his permutation to the end.\n    - `2 x y`: Ghoda swaps the $x$-th and $y$-th element of his permutation.\n\n### Output\nFor each query, print a single line containing one integer \u2014 the current distance between the permutations.\n\n### Constraints\n- $1 \\le T \\le 100$\n- $2 \\le N, Q \\le 10^5$\n- $1 \\le x, y \\le N$\n- $x \\neq y$\n- $1 \\le z \\le N-1$\n- $1 \\le A_i, B_i \\le N$ for each valid $i$\n- $A$ and $B$ are permutations\n- the sum of $N$ over all test cases does not exceed $10^5$\n- the sum of $Q$ over all test cases does not exceed $10^5$\n\n### Example Input\n```\n1\n4 3\n1 3 2 4\n4 3 2 1\n1 1\n2 3 1\n1 2\n```\n\n### Example Output\n```\n4\n2\n8\n```\n\n### Explanation\n**Example case 1:**\n- Rami's permutation is $(1, 3, 2, 4) \\rightarrow (3, 2, 4, 1) \\rightarrow (3, 2, 4, 1) \\rightarrow (4, 1, 3, 2)$.\n- Ghoda's permutation is $(4, 3, 2, 1) \\rightarrow (4, 3, 2, 1) \\rightarrow (2, 3, 4, 1) \\rightarrow (2, 3, 4, 1)$.\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK109\/hindi\/MAGPER.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK109\/mandarin\/MAGPER.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK109\/russian\/MAGPER.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK109\/vietnamese\/MAGPER.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK109\/bengali\/MAGPER.pdf) as well.\n\nSaeed bought two magic permutations of integers $1$ through $N$ and gave them to his grandsons Rami and Ghoda to encourage them to train in problem solving.\n\nRami found out that he can only cyclically shift his permutation, i.e. choose any number of elements from the beginning and move them to the end without changing their order. On the other hand, Ghoda found out that he can only swap elements of his permutation.\n\nThe distance between two permutations $P_1, P_2, \\ldots, P_N$ and $R_1, R_2, \\ldots, R_N$ is the sum of $|i-j|$ over all pairs of valid indices $i, j$ such that $P_i = R_j$.\n\nYou should process $Q$ queries. In each query, one of Saeed's grandsons plays with his permutation (performs an operation described above), and afterwards, you should tell Saeed the distance between his grandsons' current permutations. Note that the queries are cumulative \u2014 the changes made in one query remain in subsequent queries.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains two space-separated integers $N$ and $Q$.\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$, denoting Rami's initial permutation.\n- The third line contains $N$ space-separated integers $B_1, B_2, \\ldots, B_N$, denoting Ghoda's initial permutation.\n- Each of the next $Q$ lines describes a query in one of the following formats:\n    - `1 z`: Rami moves $z$ elements from the beginning of his permutation to the end.\n    - `2 x y`: Ghoda swaps the $x$-th and $y$-th element of his permutation.\n\n### Output\nFor each query, print a single line containing one integer \u2014 the current distance between the permutations.\n\n### Constraints\n- $1 \\le T \\le 100$\n- $2 \\le N, Q \\le 10^5$\n- $1 \\le x, y \\le N$\n- $x \\neq y$\n- $1 \\le z \\le N-1$\n- $1 \\le A_i, B_i \\le N$ for each valid $i$\n- $A$ and $B$ are permutations\n- the sum of $N$ over all test cases does not exceed $10^5$\n- the sum of $Q$ over all test cases does not exceed $10^5$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\n4 3\n1 3 2 4\n4 3 2 1\n1 1\n2 3 1\n1 2","output":"4\n2\n8","explanation":"**Example case 1:**\n- Rami's permutation is $(1, 3, 2, 4) \\rightarrow (3, 2, 4, 1) \\rightarrow (3, 2, 4, 1) \\rightarrow (4, 1, 3, 2)$.\n- Ghoda's permutation is $(4, 3, 2, 1) \\rightarrow (4, 3, 2, 1) \\rightarrow (2, 3, 4, 1) \\rightarrow (2, 3, 4, 1)$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1.5","source_sizelimit":"50000","problem_author":"i_love_islam","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>i_love_islam<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"14-08-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook109'>cook109<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/i_love_islam'>i_love_islam<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/lazy-propagation'>lazy-propagation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Segment Tree","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MAGPER","time":{"view_start_date":1566153002,"submit_start_date":1566153002,"visible_start_date":1566153002,"end_date":1735669800,"current":1643797956},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=MAGPER","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}