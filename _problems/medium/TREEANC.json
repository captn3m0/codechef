{"category_name":"medium","status":"success","problem_code":"TREEANC","problem_name":"Common Ancestors","body":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK126\/hindi\/TREEANC.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK126\/mandarin\/TREEANC.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK126\/russian\/TREEANC.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK126\/vietnamese\/TREEANC.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK126\/bengali\/TREEANC.pdf) as well.\r\n\r\nAyush has two rooted trees. Each of them contains $N$ vertices (numbered $1$ through $N$); let's denote a vertex $v$ in tree $1$ by $v_1$ and a corresponding vertex $v$ in tree $2$ by $v_2$.\r\n\r\nFor each tree $t$, any vertex on the path from the root to a vertex $v_t$ (including $v_t$) is an ancestor of $v_t$ and the depth of $v_t$ is the distance of $v_t$ from the root of tree $t$.\r\n\r\nFor any integer $w$ ($1 \\le w \\le N$) and vertices $u_1$ and $v_2$, $w$ is said to be a *common ancestor* of $u_1$ and $v_2$ if:\r\n- in tree $1$, $w_1$ is an ancestor of $u_1$\r\n- in tree $2$, $w_2$ is an ancestor of $v_2$\r\n- the depths of vertices $w_1$ and $w_2$ (from their respective roots) are the same\r\n\r\n<img src=\"https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/COOK126\/TREEANC\/TREEANC.png\" class=\"center\" width=\"400\" height=\"250\">\r\n\r\nFor example, in the figure above, the pair $(u_1, v_2) = (6, 1)$ has two common ancestors \u2014 $4$ and $6$. Although vertex $2$ is an ancestor for each of them, the depths of $2_1$ and $2_2$ are not the same.\r\n\r\nHelp Ayush find the maximum number of common ancestors for a pair of vertices, i.e. the largest integer $c$ such that there is a pair of vertices $(u_1, v_2)$ (possibly $u = v$) with $c$ common ancestors.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $p_1, p_2, \\ldots, p_N$. For each valid $i$, $p_i$ is the parent of the vertex $i_1$ or $-1$ if the vertex $i_1$ is the root of tree $1$.\r\n- The third line contains $N$ space-separated integers $q_1, q_2, \\ldots, q_N$. Similarly, for each valid $i$, $q_i$ is the parent of the vertex $i_2$ or $-1$ if the vertex $i_2$ is the root of tree $2$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2014 the maximum number of common ancestors for a pair $(u_1, v_2)$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10^5$\r\n- $1 \\le N \\le 10^6$\r\n- $1 \\leq p_i, q_i \\leq N$ for each valid $i$\r\n- $p_1, p_2, \\ldots, p_N$ describe a tree with exactly one root\r\n- $q_1, q_2, \\ldots, q_N$ describe a tree with exactly one root\r\n- the sum of $N$ over all test cases does not exceed $10^6$\r\n\r\n### Example Input\r\n```\r\n3\r\n1\r\n-1\r\n-1\r\n3\r\n2 -1 2\r\n2 -1 1\r\n7\r\n2 3 -1 2 2 4 4\r\n6 -1 4 5 2 4 4\r\n```\r\n\r\n### Example Output\r\n```\r\n1\r\n2\r\n2\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** There is only one pair $(u_1, v_2) = (1_1, 1_2)$ and only one common ancestor.\r\n\r\n**Example case 2:** If $u = 1$, then $1$ and $2$ are common ancestors for any $v$.\r\n\r\n**Example case 3:** The maximum number of common ancestors is $2$, e.g. $4$ and $6$ for $(u_1, v_2) = (6, 1)$, as shown in the figure in the statement.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problems statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/COOK126\/hindi\/TREEANC.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/COOK126\/mandarin\/TREEANC.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/COOK126\/russian\/TREEANC.pdf), [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/COOK126\/vietnamese\/TREEANC.pdf), and [Bengali](https:\/\/www.codechef.com\/download\/translated\/COOK126\/bengali\/TREEANC.pdf) as well.\r\n\r\nAyush has two rooted trees. Each of them contains $N$ vertices (numbered $1$ through $N$); let's denote a vertex $v$ in tree $1$ by $v_1$ and a corresponding vertex $v$ in tree $2$ by $v_2$.\r\n\r\nFor each tree $t$, any vertex on the path from the root to a vertex $v_t$ (including $v_t$) is an ancestor of $v_t$ and the depth of $v_t$ is the distance of $v_t$ from the root of tree $t$.\r\n\r\nFor any integer $w$ ($1 \\le w \\le N$) and vertices $u_1$ and $v_2$, $w$ is said to be a *common ancestor* of $u_1$ and $v_2$ if:\r\n- in tree $1$, $w_1$ is an ancestor of $u_1$\r\n- in tree $2$, $w_2$ is an ancestor of $v_2$\r\n- the depths of vertices $w_1$ and $w_2$ (from their respective roots) are the same\r\n\r\n<img src=\"https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/COOK126\/TREEANC\/TREEANC.png\" class=\"center\" width=\"400\" height=\"250\">\r\n\r\nFor example, in the figure above, the pair $(u_1, v_2) = (6, 1)$ has two common ancestors \u2014 $4$ and $6$. Although vertex $2$ is an ancestor for each of them, the depths of $2_1$ and $2_2$ are not the same.\r\n\r\nHelp Ayush find the maximum number of common ancestors for a pair of vertices, i.e. the largest integer $c$ such that there is a pair of vertices $(u_1, v_2)$ (possibly $u = v$) with $c$ common ancestors.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N$ space-separated integers $p_1, p_2, \\ldots, p_N$. For each valid $i$, $p_i$ is the parent of the vertex $i_1$ or $-1$ if the vertex $i_1$ is the root of tree $1$.\r\n- The third line contains $N$ space-separated integers $q_1, q_2, \\ldots, q_N$. Similarly, for each valid $i$, $q_i$ is the parent of the vertex $i_2$ or $-1$ if the vertex $i_2$ is the root of tree $2$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2014 the maximum number of common ancestors for a pair $(u_1, v_2)$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 10^5$\r\n- $1 \\le N \\le 10^6$\r\n- $1 \\leq p_i, q_i \\leq N$ for each valid $i$\r\n- $p_1, p_2, \\ldots, p_N$ describe a tree with exactly one root\r\n- $q_1, q_2, \\ldots, q_N$ describe a tree with exactly one root\r\n- the sum of $N$ over all test cases does not exceed $10^6$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3\r\n1\r\n-1\r\n-1\r\n3\r\n2 -1 2\r\n2 -1 1\r\n7\r\n2 3 -1 2 2 4 4\r\n6 -1 4 5 2 4 4","output":"1\r\n2\r\n2","explanation":"**Example case 1:** There is only one pair $(u_1, v_2) = (1_1, 1_2)$ and only one common ancestor.\r\n\r\n**Example case 2:** If $u = 1$, then $1$ and $2$ are common ancestors for any $v$.\r\n\r\n**Example case 3:** The maximum number of common ancestors is $2$, e.g. $4$ and $6$ for $(u_1, v_2) = (6, 1)$, as shown in the figure in the statement.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/vnDaNQj1-Zk","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"the_hyp0cr1t3","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span class='m-username--link'>the_hyp0cr1t3<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"21-01-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook-off'>cook-off<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/cook126'>cook126<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/lazy-propagation'>lazy-propagation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/the_hyp0cr1t3'>the_hyp0cr1t3<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/trees'>trees<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Segment Tree","editorial_url":"https:\/\/discuss.codechef.com\/problems\/TREEANC","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797984},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=TREEANC","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}