{"category_name":"medium","status":"success","problem_code":"SNKAPT","problem_name":"Snake and Apple Tree","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JULY19\/hindi\/SNKAPT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY19\/bengali\/SNKAPT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/mandarin\/SNKAPT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY19\/russian\/SNKAPT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/vietnamese\/SNKAPT.pdf) as well.\r\n\r\nChef is playing a game called \"Snake and Apple Tree\". This game is played on a grid with $N$ rows (numbered $1$ through $N$) and $M$ columns (numbered $1$ through $M$). Some cells of this grid are blocked. Initially, there are also $S$ snakes present in $S$ non-blocked cells. The snakes do not grow, so each snake always takes up exactly one cell.\r\n\r\nThe game starts at second $0$ and will run for $T$ seconds. At the end of each second, each snake may (independently from the other snakes) move to an edge-adjacent non-blocked cell or stay in its current cell. During each second, there may be at most one snake in each cell, but when a snake is moving out of a cell, another snake is allowed to move into that cell at the same time.\r\n\r\nDuring these $T$ seconds, $Z$ apple trees (numbered $1$ through $Z$) will grow in some cells, bear fruit and wither. For each valid $i$, the $i$-th tree will grow in the cell in row $X_i$ and column $Y_i$ and start bearing fruit at a time $P_i$. At a later time $Q_i$, the tree will wither and bear no fruit. At each second between the $P_i$-th and $Q_i$-th second (including $P_i$, but not including $Q_i$), if there is a snake in the same cell as this tree and it does not move to another cell at the end of this second, it may eat an apple from this tree. Eating one apple from the tree increases the *total happiness* of the snakes by $H_i$; if a snake eats multiple apples from this tree, the happiness increases by $H_i$ multiple times.\r\n\r\nEach snake takes $1$ second to eat an apple. It cannot do anything else while eating and if there are multiple trees bearing fruit in the same cell, a snake in that cell may only eat an apple from one tree during each second (possibly from different trees during different seconds).\r\n\r\nInitially, the total happiness of the snakes is $0$. Help Chef maximise their happiness after $T$ seconds.\r\n\r\n### Input\r\n- The first line of the input contains four space-separated integers $N$, $M$, $Z$ and $T$.\r\n- $N$ lines follow. For each $i$ ($1 \\le i \\le N$), the $i$-th of these lines contains a single string with length $M$ describing the $i$-th row of the grid: for each valid $j$, the $j$-th character of this string is '#' if the cell in the $j$-th column of this row is blocked, '.' if it is empty or 'S' if it contains a snake.\r\n- $Z$ lines follow. For each $i$ ($1 \\le i \\le Z$), the $i$-th of these lines contains five space-separated integers $X_i$, $Y_i$, $P_i$, $Q_i$ and $H_i$.\r\n\r\n### Output\r\nPrint a single line containing one integer \u2014 the maximum total happiness of the snakes.\r\n\r\n### Constraints\r\n- $1 \\le S \\le 25$\r\n- $1 \\le N, M \\le 256$\r\n- $1 \\le N \\cdot M \\le 256$\r\n- $1 \\le Z \\le 5,000$\r\n- $1 \\le T \\le 80$\r\n- $1 \\le X_i \\le N$ for each valid $i$\r\n- $1 \\le Y_i \\le M$ for each valid $i$\r\n- $0 \\le P_i \\lt Q_i \\le T$ for each valid $i$\r\n- $1 \\le H_i \\le 10^6$ for each valid $i$\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points, time limit 1 second):** $S \\le 2$\r\n\r\n**Subtask #2 (80 points, time limit 4 seconds):** original constraints\r\n\r\n### Example Input 1\r\n```\r\n3 3 1 30\r\n...\r\n.#.\r\n.#S\r\n3 1 0 20 4\r\n```\r\n\r\n### Example Output 1\r\n```\r\n56\r\n```\r\n\r\n### Explanation 1\r\nThere is only one snake. It starts in the cell $(3, 3)$ and it will reach the only tree at $(3, 1)$ during the $6$-th second. From then on, it will eat apples from this tree until the $20$-th second, so the total happiness is $(20 - 6) \\cdot 4 = 56$.\r\n\r\n### Example Input 2\r\n```\r\n1 4 2 20\r\nSS..\r\n1 3 0 4 20\r\n1 4 0 4 10\r\n```\r\n\r\n### Example Output 2\r\n```\r\n60\r\n```\r\n\r\n### Explanation 2\r\nDuring the first two seconds, both snakes will move simultaneously to the right. Then, they will simultaneously start eating apples. Each snake will eat two apples, so the total happiness will be $2 \\cdot (10 + 20) = 60$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JULY19\/hindi\/SNKAPT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY19\/bengali\/SNKAPT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/mandarin\/SNKAPT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY19\/russian\/SNKAPT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/vietnamese\/SNKAPT.pdf) as well.\r\n\r\nChef is playing a game called \"Snake and Apple Tree\". This game is played on a grid with $N$ rows (numbered $1$ through $N$) and $M$ columns (numbered $1$ through $M$). Some cells of this grid are blocked. Initially, there are also $S$ snakes present in $S$ non-blocked cells. The snakes do not grow, so each snake always takes up exactly one cell.\r\n\r\nThe game starts at second $0$ and will run for $T$ seconds. At the end of each second, each snake may (independently from the other snakes) move to an edge-adjacent non-blocked cell or stay in its current cell. During each second, there may be at most one snake in each cell, but when a snake is moving out of a cell, another snake is allowed to move into that cell at the same time.\r\n\r\nDuring these $T$ seconds, $Z$ apple trees (numbered $1$ through $Z$) will grow in some cells, bear fruit and wither. For each valid $i$, the $i$-th tree will grow in the cell in row $X_i$ and column $Y_i$ and start bearing fruit at a time $P_i$. At a later time $Q_i$, the tree will wither and bear no fruit. At each second between the $P_i$-th and $Q_i$-th second (including $P_i$, but not including $Q_i$), if there is a snake in the same cell as this tree and it does not move to another cell at the end of this second, it may eat an apple from this tree. Eating one apple from the tree increases the *total happiness* of the snakes by $H_i$; if a snake eats multiple apples from this tree, the happiness increases by $H_i$ multiple times.\r\n\r\nEach snake takes $1$ second to eat an apple. It cannot do anything else while eating and if there are multiple trees bearing fruit in the same cell, a snake in that cell may only eat an apple from one tree during each second (possibly from different trees during different seconds).\r\n\r\nInitially, the total happiness of the snakes is $0$. Help Chef maximise their happiness after $T$ seconds.\r\n\r\n### Input\r\n- The first line of the input contains four space-separated integers $N$, $M$, $Z$ and $T$.\r\n- $N$ lines follow. For each $i$ ($1 \\le i \\le N$), the $i$-th of these lines contains a single string with length $M$ describing the $i$-th row of the grid: for each valid $j$, the $j$-th character of this string is '#' if the cell in the $j$-th column of this row is blocked, '.' if it is empty or 'S' if it contains a snake.\r\n- $Z$ lines follow. For each $i$ ($1 \\le i \\le Z$), the $i$-th of these lines contains five space-separated integers $X_i$, $Y_i$, $P_i$, $Q_i$ and $H_i$.\r\n\r\n### Output\r\nPrint a single line containing one integer \u2014 the maximum total happiness of the snakes.\r\n\r\n### Constraints\r\n- $1 \\le S \\le 25$\r\n- $1 \\le N, M \\le 256$\r\n- $1 \\le N \\cdot M \\le 256$\r\n- $1 \\le Z \\le 5,000$\r\n- $1 \\le T \\le 80$\r\n- $1 \\le X_i \\le N$ for each valid $i$\r\n- $1 \\le Y_i \\le M$ for each valid $i$\r\n- $0 \\le P_i \\lt Q_i \\le T$ for each valid $i$\r\n- $1 \\le H_i \\le 10^6$ for each valid $i$\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points, time limit 1 second):** $S \\le 2$\r\n\r\n**Subtask #2 (80 points, time limit 4 seconds):** original constraints\r\n\r\n### Example Input 1\r\n```\r\n3 3 1 30\r\n...\r\n.#.\r\n.#S\r\n3 1 0 20 4\r\n```\r\n\r\n### Example Output 1\r\n```\r\n56\r\n```\r\n\r\n### Explanation 1\r\nThere is only one snake. It starts in the cell $(3, 3)$ and it will reach the only tree at $(3, 1)$ during the $6$-th second. From then on, it will eat apples from this tree until the $20$-th second, so the total happiness is $(20 - 6) \\cdot 4 = 56$.\r\n\r\n### Example Input 2\r\n```\r\n1 4 2 20\r\nSS..\r\n1 3 0 4 20\r\n1 4 0 4 10\r\n```\r\n\r\n### Example Output 2\r\n```\r\n60\r\n```\r\n\r\n### Explanation 2\r\nDuring the first two seconds, both snakes will move simultaneously to the right. Then, they will simultaneously start eating apples. Each snake will eat two apples, so the total happiness will be $2 \\cdot (10 + 20) = 60$.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1 - 4","source_sizelimit":"50000","problem_author":"aviroop123","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>aviroop123<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"19-04-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/aviroop123'>aviroop123<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/graphs'>graphs<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/july19'>july19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/min-cost-flow'>min-cost-flow<\/a>","problem_difficulty_level":"Medium","user_zen_mode":false,"best_tag":"Min Cost Flow","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SNKAPT","time":{"view_start_date":1563183002,"submit_start_date":1563183002,"visible_start_date":1563183002,"end_date":1735669800,"current":1643797977},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SNKAPT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}