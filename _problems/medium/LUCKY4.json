{"category_name":"medium","status":"success","problem_code":"LUCKY4","problem_name":"Lucky Array","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p> Chef loves lucky numbers. Everybody knows that lucky numbers are positive integers whose decimal representation contains only the lucky digits <b>4<\/b> and <b>7<\/b>. For example, numbers <b>47<\/b>, <b>744<\/b>, <b>4<\/b> are lucky and <b>5<\/b>, <b>17<\/b>, <b>467<\/b> are not.\n\n<\/p><p> Chef likes sequences of <b>n<\/b> positive integers, each of which does not exceed <b>m<\/b>. The total number of such sequences is equal to <b>m^n<\/b>.\n\n<\/p><p> Chef has an array <b>C<\/b> of <b>n-1<\/b> integers. Let <b>F(x)<\/b> be equal to the number of lucky digits in decimal representation of integer <b>x<\/b>.  Let there be a sequence <b>A<\/b> of <b>n<\/b> integers (1-based numeration). Chef calls it lucky when the following hold: if for each <b>i (1 &lt;= i &lt; n)<\/b> if <b>C[i]<\/b> equals to <b>1<\/b>, then <b>F(A[i])<\/b> must be equal to <b>F(A[i+1])<\/b> and if <b>C[i]<\/b> equals to <b>0<\/b>, then <b>F(A[i])<\/b> must not be equal to <b>F(A[i+1])<\/b>.\n\n<\/p><p> Chef has integers <b>n, m, k<\/b> and an array <b>C<\/b>. He wants to find out the <b>k-th<\/b> lucky sequence for a given array <b>C<\/b>. Help him. If the <b>k-th<\/b> lucky sequence does not exist, print the only integer <b>-1<\/b>.\n\n<\/p><p> The <b>k-th<\/b> lucky sequence is the <b>k-th<\/b> (1-based numeration) sequence in lexicographically sorted list of all lucky sequences for given integers <b>n, m<\/b> and an array <b>C<\/b>. The sequence <b>A<\/b> is lexicographic less than the sequence <b>B<\/b> if there exits integer <b>x (1 &lt;= x &lt;= n)<\/b> that <b>A[x] &lt; B[x]<\/b> and <b>A[y] = B[y]<\/b> for all <b>y (1 &lt;= y &lt; x)<\/b>.\n\n<h3>Input<\/h3>\n<\/p><p>First line contains one number <b>T<\/b> - the number of test cases. Each test is formed as following: first line contains <b>3<\/b> integers <b>n, m,<\/b> and <b>k<\/b>. Next line contains <b>n-1<\/b> integers - array <b>C<\/b> for corresponding test.\n\n<h3>Output<\/h3>\n<\/p><p>For each <b>T<\/b> test cases print sequence of integers - answer for corresponding test.\n\n<h3>Constraints<\/h3>\n<\/p><p>\n2 &lt;= <b>T<\/b> &lt;= 10\n<\/p><p>\n2 &lt;= <b>n<\/b> &lt;= 50\n<\/p><p>\n1 &lt;= <b>m, k<\/b> &lt;= 10^9\n<\/p><p>\n0 &lt;= <b>C[i]<\/b> &lt;= 1\n\n<h3>Example<\/h3>\n\n<pre><b>Input:<\/b>\n2\n2 4 7\n0\n3 7 4\n0 1\n\n<b>Output:<\/b>\n-1\n1 7 7<\/pre><\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"witua","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>witua<\/span>","problem_tester":"laycurse","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>laycurse<\/span>","date_added":"22-11-2011","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/april12'>\n                    april12\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/witua'>\n                    witua\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/LUCKY4","user":{"username":null},"time":{"view_start_date":1334137578,"submit_start_date":1334137578,"visible_start_date":1334136600,"end_date":1735669800,"current":1493557762},"todo":false,"problem_status":"unattempted"}