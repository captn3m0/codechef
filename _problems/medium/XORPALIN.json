{"category_name":"medium","status":"success","problem_code":"XORPALIN","problem_name":"XOR-ed Palindromes","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME91\/hindi\/XORPALIN.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME91\/bengali\/XORPALIN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME91\/mandarin\/XORPALIN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME91\/russian\/XORPALIN.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME91\/vietnamese\/XORPALIN.pdf) as well.\r\n\r\nIn this problem, we are working with binary strings with length $K$. A binary string contains only characters '0' and '1'. The bitwise XOR of two such strings $X$ and $Y$ (denoted by $X \\oplus Y$) is also a binary string with length $K$.\r\n\r\nYou have a sequence $A$ of binary strings, indexed from $1$. Initially, it is empty.\r\n\r\nYou should process $Q$ queries. In each query:\r\n- You are given two integers $L$ and $R$ ($0 \\le L \\le R \\lt 2^K$). For each $i$ ($L \\le i \\le R$), consider the string which is the binary representation of $i$, possibly padded with leading zeros so its length is exactly $K$; append this string to $A$. In total, you should append $(R - L + 1)$ strings to $A$ in this query.\r\n- Then, compute the number of pairs $(i, j)$ ($1 \\le i \\lt j \\le |A|$) such that $(A_i \\oplus A_j)$ is a palindrome. Since this number can be very large, compute it modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $Q$ and $K$.\r\n- Each of the next $Q$ lines contains two space-separated integers $L$ and $R$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2014 the number of pairs of strings in $A$ such that their XOR is a palindrome, modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 10$\r\n- $1 \\leq Q \\leq 25,000$\r\n- $1 \\leq K \\leq 60$\r\n- $0 \\leq L \\leq R \\lt 2^K$\r\n- the sum of $Q$ over all test cases does not exceed $25,000$\r\n\r\n### Subtasks\r\n**Subtask #1 (5 points):**\r\n- $K \\leq 5$\r\n- the sum of $Q$ over all test cases does not exceed $200$\r\n\r\n**Subtask #2 (10 points):** $L = R$\r\n\r\n**Subtask #3 (25 points):**\r\n- $K \\leq 50$\r\n- the sum of $Q$ over all test cases does not exceed $50$\r\n\r\n**Subtask #4 (25 points):**\r\n- $K \\le 20$\r\n- the sum of $Q$ over all test cases does not exceed $5,000$\r\n\r\n**Subtask #5 (15 points):**\r\n- $K \\le 40$\r\n- the sum of $Q$ over all test cases does not exceed $5,000$\r\n\r\n**Subtask #6 (20 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n1\r\n2 3\r\n3 6\r\n2 3\r\n```\r\n\r\n### Example Output\r\n```\r\n3\r\n7\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** The sequence $A$ after the first query is [\"011\", \"100\", \"101\", \"110\"]. The valid pairs of indices are $(1,2)$, $(2,4)$ and $(1,4)$.\r\n\r\nAfter the second query, the sequence $A$ is [\"011\", \"100\", \"101\", \"110\", \"010\", \"011\"]. The valid pairs of indices are $(1,2)$, $(2,4)$, $(1,4)$, $(3,5)$, $(1,6)$, $(2,6)$ and $(4,6)$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME91\/hindi\/XORPALIN.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME91\/bengali\/XORPALIN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME91\/mandarin\/XORPALIN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME91\/russian\/XORPALIN.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME91\/vietnamese\/XORPALIN.pdf) as well.\r\n\r\nIn this problem, we are working with binary strings with length $K$. A binary string contains only characters '0' and '1'. The bitwise XOR of two such strings $X$ and $Y$ (denoted by $X \\oplus Y$) is also a binary string with length $K$.\r\n\r\nYou have a sequence $A$ of binary strings, indexed from $1$. Initially, it is empty.\r\n\r\nYou should process $Q$ queries. In each query:\r\n- You are given two integers $L$ and $R$ ($0 \\le L \\le R \\lt 2^K$). For each $i$ ($L \\le i \\le R$), consider the string which is the binary representation of $i$, possibly padded with leading zeros so its length is exactly $K$; append this string to $A$. In total, you should append $(R - L + 1)$ strings to $A$ in this query.\r\n- Then, compute the number of pairs $(i, j)$ ($1 \\le i \\lt j \\le |A|$) such that $(A_i \\oplus A_j)$ is a palindrome. Since this number can be very large, compute it modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $Q$ and $K$.\r\n- Each of the next $Q$ lines contains two space-separated integers $L$ and $R$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2014 the number of pairs of strings in $A$ such that their XOR is a palindrome, modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 10$\r\n- $1 \\leq Q \\leq 25,000$\r\n- $1 \\leq K \\leq 60$\r\n- $0 \\leq L \\leq R \\lt 2^K$\r\n- the sum of $Q$ over all test cases does not exceed $25,000$\r\n\r\n### Subtasks\r\n**Subtask #1 (5 points):**\r\n- $K \\leq 5$\r\n- the sum of $Q$ over all test cases does not exceed $200$\r\n\r\n**Subtask #2 (10 points):** $L = R$\r\n\r\n**Subtask #3 (25 points):**\r\n- $K \\leq 50$\r\n- the sum of $Q$ over all test cases does not exceed $50$\r\n\r\n**Subtask #4 (25 points):**\r\n- $K \\le 20$\r\n- the sum of $Q$ over all test cases does not exceed $5,000$\r\n\r\n**Subtask #5 (15 points):**\r\n- $K \\le 40$\r\n- the sum of $Q$ over all test cases does not exceed $5,000$\r\n\r\n**Subtask #6 (20 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n2 3\r\n3 6\r\n2 3","output":"3\r\n7","explanation":"**Example case 1:** The sequence $A$ after the first query is [\"011\", \"100\", \"101\", \"110\"]. The valid pairs of indices are $(1,2)$, $(2,4)$ and $(1,4)$.\r\n\r\nAfter the second query, the sequence $A$ is [\"011\", \"100\", \"101\", \"110\", \"010\", \"011\"]. The valid pairs of indices are $(1,2)$, $(2,4)$, $(1,4)$, $(3,5)$, $(1,6)$, $(2,6)$ and $(4,6)$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"nishant403","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>nishant403<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"25-12-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/bitmasking'>bitmasking<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime91'>ltime91<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nishant403'>nishant403<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Medium Hard","editorial_url":"https:\/\/discuss.codechef.com\/problems\/XORPALIN","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797989},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=XORPALIN","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}