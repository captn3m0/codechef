{"category_name":"medium","status":"success","problem_code":"GCDCNT","problem_name":"Chef and Gcd Queries","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/MARCH18\/mandarin\/GCDCNT.pdf\">Mandarin chinese<\/a>, <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/MARCH18\/russian\/GCDCNT.pdf\">Russian<\/a> and <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/MARCH18\/vietnamese\/GCDCNT.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Chef likes solving problems involving a lot of queries with numbers. One day, he found a new problem which he finds difficult to solve. Therefore, he's asking for your help!<\/p>\n\n<p>You are given a sequence <b>A<sub>1<\/sub><\/b>, <b>A<sub>2<\/sub><\/b>, ..., <b>A<sub>N<\/sub><\/b> and <b>Q<\/b> queries. There are two types of queries:\n<ul> \n<li>1 <b>X<\/b> <b>Y<\/b> \u2014 Set <b>A<sub>X<\/sub><\/b> = <b>Y<\/b>.<\/li>\n<li>2 <b>L<\/b> <b>R<\/b> <b>G<\/b> \u2014 Compute the number of indices <b>i<\/b> such that <b>L<\/b> \u2264 <b>i<\/b> \u2264 <b>R<\/b> and <b>gcd<\/b>(<b>G<\/b>, <b>A<sub>i<\/sub><\/b>) = 1.<\/li>\n<\/ul><\/p>\n\n<p>\nFind the answer to each query of the second type.\n<\/b>\n\n<p>Note: <b>gcd<\/b>(<b>X<\/b>, <b>Y<\/b>) denotes the greatest common divisor \u2014 the highest positive integer which divides both <b>X<\/b> and <b>Y<\/b>.<\/p>\n\n<h3>Input<\/h3>\n<ul>\n<li>The first line of the input contains a single integer <b>N<\/b> denoting the number of elements in the sequence.<\/li>\n<li>The second line contains <b>N<\/b> space-separated integers <b>A<sub>1<\/sub><\/b>, <b>A<sub>2<\/sub><\/b>, ..., <b>A<sub>N<\/sub><\/b>.<\/li>\n<li>The third line contains a single integer <b>Q<\/b> denoting the number of queries.<\/li>\n<li>Each of the following <b>Q<\/b> lines describes one query in the following format:\n<ul>\n<li>1 <b>X<\/b> <b>Y<\/b> for a query of the first type<\/li>\n<li>2 <b>L<\/b> <b>R<\/b> <b>G<\/b> for a query of the second type<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n\n<h3>Output<\/h3>\n<p>For each query of type 2, print a single line containing one integer - the answer to the query.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>N<\/b>, <b>Q<\/b> \u2264 5 \u00b7 10<sup>4<\/sup><\/li>\n<li>1 \u2264 <b>L<\/b> \u2264 <b>R<\/b> \u2264 <b>N<\/b><\/li>\n<li>1 \u2264 <b>X<\/b> \u2264 <b>N<\/b><\/li>\n<li>1 \u2264 <b>Y<\/b>, <b>G<\/b> \u2264 10<sup>5<\/sup><\/li>\n<li>1 \u2264 <b>A<sub>i<\/sub><\/b> \u2264 10<sup>5<\/sup> for each valid <b>i<\/b><\/li>\n<\/ul>\n\n\n<h3>Subtasks  <\/h3>\n<p><b>Subtask #1 (15 points):<\/b> 1 \u2264 <b>N<\/b>, <b>Q<\/b> \u2264 1000<\/p>\n<p><b>Subtask #2 (85 points):<\/b> original constraints<\/p>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n\n4\n2 3 4 5\n3\n2 1 4 2\n1 2 6\n2 1 4 2\n\n<b>Output:<\/b>\n\n2\n1\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>In the first query, <b>gcd<\/b>(<b>A<sub>2<\/sub><\/b>, 2) = 1 and <b>gcd<\/b>(<b>A<sub>4<\/sub><\/b>, 2) = 1, so the answer is 2.<\/p>\n<p>In the third query, only <b>gcd<\/b>(<b>A<sub>4<\/sub><\/b>, 2) is equal to 1, so the answer is 1.<\/p>\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"vipsharmavip","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>vipsharmavip<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"31-01-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/inclusion-exclusion'>inclusion-exclusion<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/march18'>march18<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/mobius'>mobius<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/vipsharmavip'>vipsharmavip<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/GCDCNT","time":{"view_start_date":1520847000,"submit_start_date":1520847000,"visible_start_date":1520847000,"end_date":1735669800,"current":1525454464},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}