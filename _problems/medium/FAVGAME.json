{"category_name":"medium","status":"success","problem_code":"FAVGAME","problem_name":"Completing favorite game","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MARCH17\/mandarin\/FAVGAME.pdf?v=1\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MARCH17\/russian\/FAVGAME.pdf?v=1\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MARCH17\/vietnamese\/FAVGAME.pdf?v=1\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Chef has a nice job. Actually he doesn't even remember what he is supposed to do there, because he just plays video-games all the time, exactly <b>h<\/b> hours every working day!<\/p>\n\n<p>Recently he got bored of just randomly playing video-games and decided to complete all the levels of his favorite Game as fast as possible.<\/p>\n\n<p>The Game consists of <b>n<\/b> levels numbered with integers from <b>1<\/b> to <b>n<\/b>. After completing every level, some <b>small<\/b> number of new levels is unlocked. The structure of the Game levels is a tree with the root in level <b>1<\/b>, i.e. every level (except for <b>1<\/b>) has a unique level that unlocks it and level <b>1<\/b> is the only level that is considered unlocked at the very beginning. Chef has completed his favorite Game lots of times, so he knows that he needs exactly <b>t<sub>i<\/sub><\/b> hours to complete level <b>i<\/b>. Due to specifics of the Game every level should be completed entirely within one working day, i.e. Chef <b>cannot<\/b> start a level on Thursday, and finish it Friday morning.<\/p>\n\n<p>Overall the game-play proceeds as follows:<\/p>\n<ol>\n    <li>There is a stack <b>S<\/b> that initially contains only the level <b>1<\/b><\/li>\n    <li>Chef pops the topmost level out of the stack. Let's call this level <b>x<\/b><\/li>\n    <li>Chef spends <b>t<sub>x<\/sub><\/b> hours to complete level <b>x<\/b>. Note that he doesn't want to stay at work longer than for <b>h<\/b> hours, so if there is not enough time left today Chef will complete level <b>x<\/b> the next working day morning.<\/li>\n    <li>After completing level <b>x<\/b> some <b>m<sub>x<\/sub><\/b> new levels get unlocked<\/li>\n    <li>Chef places all the <b>m<sub>x<\/sub><\/b> unlocked levels on the top of the stack <b>S<\/b> in an arbitrary order, i.e. he is free to choose any order he likes<\/li>\n    <li>If stack <b>S<\/b> is empty, the Game is considered completed, otherwise Chef goes back to the step <b>2<\/b><\/li>\n<\/ol>\n\n<p>Can you help Chef figure out the minimum number of working days necessary to complete the Game?<\/p>\n\n<h3>Input<\/h3>\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. <\/p>\n\n<p>For each test case, the first line of input contains two integers <b>n<\/b> and <b>h<\/b>. <\/p>\n\n<p>The next line contains <b>n<\/b> space-separated integers \u2015 <b>t<sub>1<\/sub><\/b>, <b>t<sub>2<\/sub><\/b>, <b>...<\/b>, <b>t<sub>n<\/sub><\/b>.<\/p>\n\n<p>The following <b>n<\/b> lines describe the structure of Game's levels: the <b>x<\/b>-th of them contains an integer <b>m<sub>x<\/sub><\/b> followed by <b>m<sub>x<\/sub><\/b> integers \u2015 the levels that get unlocked after completing level <b>x<\/b>.<\/p>\n\n<h3>Output<\/h3>\n<p>For each test case, output a single integer \u2015 the minimum number of working days necessary to complete the Game.<\/p>\n\n<h3>Constraints<\/h3>\n<p>\n<ul>\n    <li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>10<\/b><\/li>\n    <li><b>1<\/b> \u2264 <b>n<\/b> \u2264 <b>1000<\/b><\/li>\n    <li><b>1<\/b> \u2264 <b>t<sub>i<\/sub><\/b> \u2264 <b>h<\/b> \u2264 <b>24<\/b><\/li>\n    <li><b>0<\/b> \u2264 <b>m<sub>x<\/sub><\/b> \u2264 <b>10<\/b><\/li>\n    <li> It is guaranteed that the structure of the Game levels is a tree, i.e. it is possible to unlock all <b>n<\/b> levels and every level (except for <b>1<\/b>) has exactly one other level that unlocks it.<\/li>\n<\/ul>\n<\/p>\n\n<h3>Subtasks<\/h3>\n<ul>\n    <li>Subtask #1: <b>n \u2264 9<\/b> (7 points)<\/li>\n    <li>Subtask #2: <b>m<sub>x<\/sub> \u2264 2<\/b> (20 points)<\/li>\n    <li>Subtask #3: <b>n \u2264 100; h \u2264 8<\/b> (27 points)<\/li>\n    <li>Subtask #4: Original constraints (46 points)<\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n<tt>2\n5 24\n13 24 22 12 16\n1 3\n0\n2 2 5\n0\n1 4\n10 8\n1 4 3 1 7 3 2 2 4 4\n3 2 5 10\n2 3 4\n0\n0\n1 6\n3 7 8 9\n0\n0\n0\n0<\/tt>\n\n<b>Output:<\/b>\n<tt>5\n4<\/tt>\n\n<\/pre>\n<h3>Explanation<\/h3>\n<p><b>Example case 1:<\/b> Chef has to complete every level during separate working days, and so to complete all <b>5<\/b> levels he needs <b>5<\/b> working days.\n<\/p>\n<p>\n<b>Example case 2:<\/b> Chef will complete the Game if he will always push unlocked levels into stack starting with the largest indexed one and ending with the smallest indexed one. That is, after Chef completes level <b>1<\/b> he first pushes level <b>10<\/b> (<b>S = [10]<\/b>), then level <b>5<\/b> (<b>S = [10, 5]<\/b>) and then level <b>2<\/b> (<b>S = [10, 5, 2]<\/b>). So the second level Chef will play is <b>2<\/b>.\n<\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"alex_2oo8","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>alex_2oo8<\/span>","problem_tester":"xcwgf666","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","date_added":"26-08-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alex_2oo8'>\n                    alex_2oo8\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/dfs'>\n                    dfs\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/dp+bitmask'>\n                    dp+bitmask\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>\n                    dynamic-programming\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/march17'>\n                    march17\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/tree'>\n                    tree\n                <\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/FAVGAME","user":{"username":null},"time":{"view_start_date":1489397400,"submit_start_date":1489397400,"visible_start_date":1489397400,"end_date":1735669800,"current":1493557649},"todo":false,"problem_status":"unattempted"}