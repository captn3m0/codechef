{"category_name":"school","status":"success","problem_code":"MAXTOPO","problem_name":"Maximum Topological Sort","body":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/bengali\/MAXTOPO.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/mandarin\/MAXTOPO.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/russian\/MAXTOPO.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/vietnamese\/MAXTOPO.pdf) as well.\r\n\r\nChef has a tree $G$ with $N$ nodes (numbered $1$ through $N$) and $N-1$ undirected edges. For each node $u$ in the tree, he can assign directions to the edges in such a way that $u$ is reachable from all the other nodes. Let $C_u$ be the number of valid [topological orderings](https:\/\/en.wikipedia.org\/wiki\/Topological_sorting) in the resulting directed acyclic graph.\r\n\r\nThis way, Chef obtains $N$ pairs $(C_1,1), (C_2,2), \\ldots, (C_N,N)$ and he sorts all these pairs $(C_i, i)$ in descending order (first by $C_i$ and in the case of a tie by $i$). \r\n\r\nFor example, consider the tree below:\r\n\r\n![](https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/MARCH21\/MAXTOPO\/MAXTOPO_eg.png)\r\n\r\nThe sorted list of pairs is $((2,2), (1,3), (1,1))$.\r\n\r\nChef quizzes you on this list \u2015 he wants you to find the $K$-th pair in the sorted list. To make that task easier, Chef only asks for $K = 1$ (the largest pair) or $K = 2$ (the second largest pair). Since the number of topological orderings can be very large, compute it modulo $10^9+7$. \r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- Each of the next $N-1$ lines contains two space-separated integers $u$ and $v$, denoting that nodes $u$ and $v$ are connected by an edge.\r\n\r\n### Output\r\nFor each test case, print a single line containing two space-separated integers $u$ and $C_u$ modulo $10^9+7$, where $(C_u, u)$ is the $K$-th pair in the sorted list.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 5$\r\n- $1 \\leq N \\leq 5 \\cdot 10^5$\r\n- $1 \\leq K \\leq 2$\r\n- $1 \\leq u,v \\leq N$\r\n- the graph described on the input is a tree\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** $N \\leq 10$\r\n\r\n**Subtask #2 (30 points):** $K = 1$\r\n\r\n**Subtask #3 (60 points):** $K = 2$\r\n\r\n### Example Input\r\n```\r\n1\r\n4 2\r\n1 2\r\n2 3\r\n2 4\r\n```\r\n\r\n### Example Output\r\n```\r\n4 2\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** The tree is\r\n\r\n![](https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/MARCH21\/MAXTOPO\/MAXTOPO_sample.png)\r\n\r\n- For $u = 1$, there are $C_1 = 2$ possible topological orderings: $(3,4,2,1)$ and $(4,3,2,1)$\r\n- For $u = 2$, there are $C_2 = 6$ possible topological orderings: $(3,4,1,2)$, $(4,3,1,2)$, $(3,1,4,2)$, $(4,1,3,2)$, $(1,3,4,2)$ and $(1,4,3,2)$.\r\n- For $u = 3$, there are $C_3 = 2$ possible topological orderings: $(1,4,2,3)$ and $(4,1,2,3)$.\r\n- For $u = 4$, there are $C_4 = 2$ possible topological orderings: $(3,1,2,4)$ and $(1,3,2,4)$.\r\n\r\nThe sorted list of pairs is $((6,2), (2,4), (2,3), (2,1))$. The node for the $2$-nd pair is $4$ and the corresponding number of topological orderings modulo $10^9+7$ is $2$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/bengali\/MAXTOPO.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/mandarin\/MAXTOPO.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/russian\/MAXTOPO.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH21\/vietnamese\/MAXTOPO.pdf) as well.\r\n\r\nChef has a tree $G$ with $N$ nodes (numbered $1$ through $N$) and $N-1$ undirected edges. For each node $u$ in the tree, he can assign directions to the edges in such a way that $u$ is reachable from all the other nodes. Let $C_u$ be the number of valid [topological orderings](https:\/\/en.wikipedia.org\/wiki\/Topological_sorting) in the resulting directed acyclic graph.\r\n\r\nThis way, Chef obtains $N$ pairs $(C_1,1), (C_2,2), \\ldots, (C_N,N)$ and he sorts all these pairs $(C_i, i)$ in descending order (first by $C_i$ and in the case of a tie by $i$). \r\n\r\nFor example, consider the tree below:\r\n\r\n![](https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/MARCH21\/MAXTOPO\/MAXTOPO_eg.png)\r\n\r\nThe sorted list of pairs is $((2,2), (1,3), (1,1))$.\r\n\r\nChef quizzes you on this list \u2015 he wants you to find the $K$-th pair in the sorted list. To make that task easier, Chef only asks for $K = 1$ (the largest pair) or $K = 2$ (the second largest pair). Since the number of topological orderings can be very large, compute it modulo $10^9+7$. \r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- Each of the next $N-1$ lines contains two space-separated integers $u$ and $v$, denoting that nodes $u$ and $v$ are connected by an edge.\r\n\r\n### Output\r\nFor each test case, print a single line containing two space-separated integers $u$ and $C_u$ modulo $10^9+7$, where $(C_u, u)$ is the $K$-th pair in the sorted list.\r\n\r\n### Constraints\r\n- $1 \\leq T \\leq 5$\r\n- $1 \\leq N \\leq 5 \\cdot 10^5$\r\n- $1 \\leq K \\leq 2$\r\n- $1 \\leq u,v \\leq N$\r\n- the graph described on the input is a tree\r\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** $N \\leq 10$\r\n\r\n**Subtask #2 (30 points):** $K = 1$\r\n\r\n**Subtask #3 (60 points):** $K = 2$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n4 2\r\n1 2\r\n2 3\r\n2 4","output":"4 2","explanation":"**Example case 1:** The tree is\r\n\r\n![](https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/MARCH21\/MAXTOPO\/MAXTOPO_sample.png)\r\n\r\n- For $u = 1$, there are $C_1 = 2$ possible topological orderings: $(3,4,2,1)$ and $(4,3,2,1)$\r\n- For $u = 2$, there are $C_2 = 6$ possible topological orderings: $(3,4,1,2)$, $(4,3,1,2)$, $(3,1,4,2)$, $(4,1,3,2)$, $(1,3,4,2)$ and $(1,4,3,2)$.\r\n- For $u = 3$, there are $C_3 = 2$ possible topological orderings: $(1,4,2,3)$ and $(4,1,2,3)$.\r\n- For $u = 4$, there are $C_4 = 2$ possible topological orderings: $(3,1,2,4)$ and $(1,3,2,4)$.\r\n\r\nThe sorted list of pairs is $((6,2), (2,4), (2,3), (2,1))$. The node for the $2$-nd pair is $4$ and the corresponding number of topological orderings modulo $10^9+7$ is $2$.","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/prtZ6XVPfOQ","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"shaanknight","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span class='m-username--link'>shaanknight<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"28-02-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/depth-first-search'>depth-first-search<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>easy-medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/march21'>march21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/shaanknight'>shaanknight<\/a>","problem_difficulty_level":"Easy-Medium","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MAXTOPO","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797734},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=MAXTOPO","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}