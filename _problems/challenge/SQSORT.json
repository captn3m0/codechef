{"category_name":"challenge","status":"success","problem_code":"SQSORT","problem_name":"Stack-Queue Sort (Challenge)","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN21\/hindi\/SQSORT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN21\/bengali\/SQSORT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/mandarin\/SQSORT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN21\/russian\/SQSORT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/vietnamese\/SQSORT.pdf) as well.\r\n\r\nThere are $B$ blocks (numbered $1$ through $B$) distributed in $N$ containers (numbered $1$ through $N$). For each valid $i$, the weight of the $i$-th block is $W_i$ kilograms.\r\n\r\nFor each container $i$, you should decide if it will be used like a *stack* or a *queue*. At any time, a container may contain any sequence of blocks (possibly the empty sequence); let's denote the number of the $j$-th block (indexed from $1$) in the $i$-th container by $A_{i,j}$.\r\n\r\nA [stack](https:\/\/en.wikipedia.org\/wiki\/Stack_(abstract_data_type)) is a data structure that stores a sequence of integers $(X_1, X_2, \\ldots, X_M)$ and supports two types of instructions:\r\n- `pop`: Remove the last element of the sequence. After this instruction, the sequence becomes $(X_1, \\ldots, X_{M-1})$; it must be non-empty before this instruction. The return value of this instruction is $X_M$.\r\n- `push a`: Add an element $a$ at the end of the sequence. After this instruction, the sequence becomes $(X_1, \\ldots, X_M, a)$.\r\n\r\nSimilarly, a [queue](https:\/\/en.wikipedia.org\/wiki\/Queue_(abstract_data_type)) is a data structure that stores a sequence of integers $(X_1, X_2, \\ldots, X_M)$ and supports two types of instructions:\r\n- `pop`: Remove the first element of the sequence. After this instruction, the sequence becomes $(X_2, \\ldots, X_M)$; it must be non-empty before this instruction. The return value of this instruction is $X_1$.\r\n- `push a`: Add an element $a$ at the end of the sequence. After this instruction, the sequence becomes $(X_1, \\ldots, X_M, a)$.\r\n\r\nFor each valid $i$, it takes $C_i \\cdot w$ nanoseconds to pop a block with weight $w$ from the container $i$ and $D_i \\cdot w$ nanoseconds to push a block with weight $w$ to the container $i$.\r\n\r\nUsing the given data structures, you may perform the following operation at most $B^2\/2$ times: choose two containers $c_1$ and $c_2$ ($c_1 \\neq c_2$), pop a block from the $c_1$-th container and then push this block to the $c_2$-th container.\r\n\r\nYour task is to sort all the blocks in a single container, i.e. after performing all operations, the sequence of blocks in some container must be $(1, 2, \\ldots, B)$. The time spent performing operations should be as small as possible.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $B$.\r\n- The second line contains $N$ space-separated integers $C_1, C_2, \\ldots, C_N$.\r\n- The third line contains $N$ space-separated integers $D_1, D_2, \\ldots, D_N$.\r\n- The fourth line contains $B$ space-separated integers $W_1, W_2, \\ldots, W_B$.\r\n- The next $N$ lines describe the initial distribution of blocks in containers. For each valid $i$, the $i$-th of these lines contains an integer $M$ denoting the number of blocks which are initially in the $i$-th container, followed by a space and $M$ space-separated integers $A_{i,1}, A_{i,2}, \\ldots, A_{i,M}$ denoting the sequence of blocks which are initially in this container.\r\n\r\n### Output\r\n- First, print a line containing a string with length $N$. For each valid $i$, the $i$-th character of this string should be either 'S' if the $i$-th sequence is used as a stack or 'Q' if it is used as a queue.\r\n- Then, print a line containing a single integer $Q$ \u2015 the number of operations to perform.\r\n- Finally, print $Q$ lines. Each of these lines should contain two space-separated integers $c_1$ and $c_2$ describing an operation that pops an element from the $c_1$-th container and pushes it into the $c_2$-th container.\r\n\r\n### Constraints\r\n- $2 \\le N \\le 128$\r\n- $B = 1,024$\r\n- $1 \\le C_i, D_i \\le 50$ for each valid $i$\r\n- $1 \\le W_i \\le 50$ for each valid $i$\r\n- $0 \\le M \\le B$\r\n- $1 \\le A_{i,j} \\le B$ for each valid $i,j$\r\n\r\n### Example Input\r\n```\r\n3 4\r\n1 2 3\r\n1 2 3\r\n2 1 4 3\r\n2 3 2\r\n1 1\r\n1 4\r\n```\r\n\r\n### Example Output\r\n```\r\nQQS\r\n4\r\n1 3\r\n1 2\r\n4 2\r\n4 2\r\n```\r\n\r\n### Explanation\r\nThe first two containers are used as queues and the third container as a stack. The sequences change as follows:\r\n- Initially: $(3,2), (1), (4)$.\r\n- After the first operation: $(2), (1), (4,3)$.\r\n- After the second operation: $(), (1,2), (4,3)$.\r\n- After the third operation: $(), (1,2,3), (4)$.\r\n- After the fourth operation: $(), (1,2,3,4), ()$.\r\n\r\n### Test Generation\r\nThe source code used to generate test data can be downloaded [here](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/JAN21\/SQSORT\/generator.cpp).\r\n\r\n- $N$ can be $16$, $32$, $64$ or $128$.\r\n- All values of $C_i$, $D_i$ and $W_i$ are chosen uniformly randomly and independently between $1$ and $50$ inclusive.\r\n- A permutation of the integers $1$ through $B$ is chosen uniformly randomly. The blocks are pushed to the containers one by one in this order.\r\n- One of the following two initial distribution schemes is chosen:\r\n    - All $B$ blocks are pushed into the $1$-st container.\r\n    - For each block, a container into which it is pushed is chosen uniformly randomly and independently.\r\n- There are eight test files \u2015 one for each possible value of $N$ and distribution scheme.\r\n\r\n### Scoring\r\nIf your output is invalid (in particular if you attempt to pop an empty container), you do not sort the blocks in a single container or you use more than $B^2\/2$ operations, you will receive the Wrong Answer verdict.\r\n\r\nOtherwise, the score of a test file is the number of nanoseconds spent performing your operations. The score of a submission is the sum of scores of all test files. Your goal is to minimise the score of your submission.\r\n\r\nThere are eight test files. During the contest, the displayed score will account for exactly four test files, i.e. your score reflects your submission's performance on 50% (4\/8) of the test files; However, if your program gets a non-AC verdict on any test file, your submission's verdict will be non-AC. In other words, an AC verdict denotes that your program runs successfully on all the test files. After the end of the contest, your score will be changed to include the sum of your program's scores over the other 4 test files.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN21\/hindi\/SQSORT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN21\/bengali\/SQSORT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/mandarin\/SQSORT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN21\/russian\/SQSORT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN21\/vietnamese\/SQSORT.pdf) as well.\r\n\r\nThere are $B$ blocks (numbered $1$ through $B$) distributed in $N$ containers (numbered $1$ through $N$). For each valid $i$, the weight of the $i$-th block is $W_i$ kilograms.\r\n\r\nFor each container $i$, you should decide if it will be used like a *stack* or a *queue*. At any time, a container may contain any sequence of blocks (possibly the empty sequence); let's denote the number of the $j$-th block (indexed from $1$) in the $i$-th container by $A_{i,j}$.\r\n\r\nA [stack](https:\/\/en.wikipedia.org\/wiki\/Stack_(abstract_data_type)) is a data structure that stores a sequence of integers $(X_1, X_2, \\ldots, X_M)$ and supports two types of instructions:\r\n- `pop`: Remove the last element of the sequence. After this instruction, the sequence becomes $(X_1, \\ldots, X_{M-1})$; it must be non-empty before this instruction. The return value of this instruction is $X_M$.\r\n- `push a`: Add an element $a$ at the end of the sequence. After this instruction, the sequence becomes $(X_1, \\ldots, X_M, a)$.\r\n\r\nSimilarly, a [queue](https:\/\/en.wikipedia.org\/wiki\/Queue_(abstract_data_type)) is a data structure that stores a sequence of integers $(X_1, X_2, \\ldots, X_M)$ and supports two types of instructions:\r\n- `pop`: Remove the first element of the sequence. After this instruction, the sequence becomes $(X_2, \\ldots, X_M)$; it must be non-empty before this instruction. The return value of this instruction is $X_1$.\r\n- `push a`: Add an element $a$ at the end of the sequence. After this instruction, the sequence becomes $(X_1, \\ldots, X_M, a)$.\r\n\r\nFor each valid $i$, it takes $C_i \\cdot w$ nanoseconds to pop a block with weight $w$ from the container $i$ and $D_i \\cdot w$ nanoseconds to push a block with weight $w$ to the container $i$.\r\n\r\nUsing the given data structures, you may perform the following operation at most $B^2\/2$ times: choose two containers $c_1$ and $c_2$ ($c_1 \\neq c_2$), pop a block from the $c_1$-th container and then push this block to the $c_2$-th container.\r\n\r\nYour task is to sort all the blocks in a single container, i.e. after performing all operations, the sequence of blocks in some container must be $(1, 2, \\ldots, B)$. The time spent performing operations should be as small as possible.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $B$.\r\n- The second line contains $N$ space-separated integers $C_1, C_2, \\ldots, C_N$.\r\n- The third line contains $N$ space-separated integers $D_1, D_2, \\ldots, D_N$.\r\n- The fourth line contains $B$ space-separated integers $W_1, W_2, \\ldots, W_B$.\r\n- The next $N$ lines describe the initial distribution of blocks in containers. For each valid $i$, the $i$-th of these lines contains an integer $M$ denoting the number of blocks which are initially in the $i$-th container, followed by a space and $M$ space-separated integers $A_{i,1}, A_{i,2}, \\ldots, A_{i,M}$ denoting the sequence of blocks which are initially in this container.\r\n\r\n### Output\r\n- First, print a line containing a string with length $N$. For each valid $i$, the $i$-th character of this string should be either 'S' if the $i$-th sequence is used as a stack or 'Q' if it is used as a queue.\r\n- Then, print a line containing a single integer $Q$ \u2015 the number of operations to perform.\r\n- Finally, print $Q$ lines. Each of these lines should contain two space-separated integers $c_1$ and $c_2$ describing an operation that pops an element from the $c_1$-th container and pushes it into the $c_2$-th container.\r\n\r\n### Constraints\r\n- $2 \\le N \\le 128$\r\n- $B = 1,024$\r\n- $1 \\le C_i, D_i \\le 50$ for each valid $i$\r\n- $1 \\le W_i \\le 50$ for each valid $i$\r\n- $0 \\le M \\le B$\r\n- $1 \\le A_{i,j} \\le B$ for each valid $i,j$\r\n\r\n### Example Input\r\n```\r\n3 4\r\n1 2 3\r\n1 2 3\r\n2 1 4 3\r\n2 3 2\r\n1 1\r\n1 4\r\n```\r\n\r\n### Example Output\r\n```\r\nQQS\r\n4\r\n1 3\r\n1 2\r\n4 2\r\n4 2\r\n```\r\n\r\n### Explanation\r\nThe first two containers are used as queues and the third container as a stack. The sequences change as follows:\r\n- Initially: $(3,2), (1), (4)$.\r\n- After the first operation: $(2), (1), (4,3)$.\r\n- After the second operation: $(), (1,2), (4,3)$.\r\n- After the third operation: $(), (1,2,3), (4)$.\r\n- After the fourth operation: $(), (1,2,3,4), ()$.\r\n\r\n### Test Generation\r\nThe source code used to generate test data can be downloaded [here](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/JAN21\/SQSORT\/generator.cpp).\r\n\r\n- $N$ can be $16$, $32$, $64$ or $128$.\r\n- All values of $C_i$, $D_i$ and $W_i$ are chosen uniformly randomly and independently between $1$ and $50$ inclusive.\r\n- A permutation of the integers $1$ through $B$ is chosen uniformly randomly. The blocks are pushed to the containers one by one in this order.\r\n- One of the following two initial distribution schemes is chosen:\r\n    - All $B$ blocks are pushed into the $1$-st container.\r\n    - For each block, a container into which it is pushed is chosen uniformly randomly and independently.\r\n- There are eight test files \u2015 one for each possible value of $N$ and distribution scheme.\r\n\r\n### Scoring\r\nIf your output is invalid (in particular if you attempt to pop an empty container), you do not sort the blocks in a single container or you use more than $B^2\/2$ operations, you will receive the Wrong Answer verdict.\r\n\r\nOtherwise, the score of a test file is the number of nanoseconds spent performing your operations. The score of a submission is the sum of scores of all test files. Your goal is to minimise the score of your submission.\r\n\r\nThere are eight test files. During the contest, the displayed score will account for exactly four test files, i.e. your score reflects your submission's performance on 50% (4\/8) of the test files; However, if your program gets a non-AC verdict on any test file, your submission's verdict will be non-AC. In other words, an AC verdict denotes that your program runs successfully on all the test files. After the end of the contest, your score will be changed to include the sum of your program's scores over the other 4 test files.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"https:\/\/youtu.be\/meL57y5f424","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"5","source_sizelimit":"50000","problem_author":"alei","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>alei<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"10-12-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alei'>alei<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/heuristic'>heuristic<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jan21'>jan21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sorting'>sorting<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tie-breaker'>tie-breaker<\/a>","problem_difficulty_level":"Unavailable","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SQSORT","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643798007},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SQSORT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}