{"category_name":"challenge","status":"success","problem_code":"CUTCAKE","problem_name":"Cut the Cake (Challenge)","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/FEB21\/hindi\/CUTCAKE.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/FEB21\/bengali\/CUTCAKE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/mandarin\/CUTCAKE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/FEB21\/russian\/CUTCAKE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/vietnamese\/CUTCAKE.pdf) as well.\r\n\r\nThere are $N$ points in a plane (numbered $1$ through $N$). For each valid $i$, the coordinates of the $i$-th point are $(X_i, Y_i)$. No three of these points are collinear. Let's denote a line segment between points $u$ and $v$ by $(u,v)$.\r\n\r\nYou are given a [Delaunay triangulation](https:\/\/en.wikipedia.org\/wiki\/Delaunay_triangulation) of those points, which consists of $M$ triangles (numbered $1$ through $M$). For each valid $i$, the vertices of the $i$-th triangle are the points $P_{i,1}, P_{i,2}, P_{i,3}$.\r\n\r\nYou may perform the following operation any number of times (possibly zero):\r\n- Flip diagonal segment $(u,v)$: If there is a convex quadrilateral that contains this segment as a diagonal and does not contain any points other than its vertices, erase this segment and draw a new segment corresponding to the other diagonal of this quadrilateral. (Note that some segments cannot be flipped. It can be proved that if such a quadrilateral exists, it is unique and the result is also a triangulation.)\r\n\r\nThen, you should perform the following operation some number of times:\r\n- Remove a segment $(u,v)$ that is shared by two regions with finite areas. When it is removed, the number of regions decreases by one.\r\n\r\nA *region* is defined as a maximal set in the plane such that it does not contain any of the given points or currently existing segments and it is possible to move from each point in this set to any other point in this set without crossing any edge. Note that a region is not necessarily convex. Two regions share a line segment if it is possible to move from one of these regions to the other one by crossing only this segment.\r\n\r\nAfter performing all operations, there must be exactly $R$ regions with finite areas. Let $A_1, A_2, \\ldots, A_R$ be these areas sorted in non-decreasing order. You are given the desired areas $B_1, B_2, \\ldots, B_R$ of the regions, also sorted in non-decreasing order. Your goal is to make $\\sum_{i=1}^R |B_i - 2\\cdot A_i|$ as small as possible by performing operations. However, you may only perform up to $1,024$ operations of the first type; note that the number of operations of the second type must always be $M-R$.\r\n\r\n### Input\r\n- The first line of the input contains three space-separated integers $N$, $M$ and $R$.\r\n- $N$ lines follow. For each valid $i$, the $i$-th of these lines contains two space-separated integers $X_i$ and $Y_i$.\r\n- $M$ more lines follow. For each valid $i$, the $i$-th of these lines contains three space-separated integers $P_{i,1}$, $P_{i,2}$ and $P_{i,3}$.\r\n- The last line contains $R$ space-separated integers $B_1, B_2, \\ldots, B_R$.\r\n\r\n### Output\r\n- First, print a line containing a single integer $F$ ($F \\leq 1024$) denoting the number of operations of the first type.\r\n- Then, print $F$ lines. Each of these lines should contain two space-separated integers $u$ and $v$ denoting that you want to flip a diagonal segment $(u,v)$.\r\n- Finally, print $M-R$ lines. Each of these lines should contain two space-separated integers $u$ and $v$ denoting that you want to remove a segment $(u,v)$.\r\n\r\n### Example Input\r\n```\r\n8 7 5\r\n0 11\r\n1 5\r\n2 12\r\n5 0\r\n10 12\r\n12 6\r\n13 5\r\n13 11\r\n1 2 3\r\n5 3 2\r\n8 5 6\r\n7 8 6\r\n4 7 6\r\n2 4 6\r\n5 2 6\r\n13 17 18 48 135\r\n```\r\n### Example Output\r\n```\r\n2\r\n6 8\r\n2 5\r\n2 6\r\n6 7\r\n```\r\n\r\n### Explanation\r\nThe initial triangulation is\r\n\r\n<img src=\"https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/FEB21\/CUTCAKE\/CUTCAKE00.png\"><\/img>\r\n\r\nAfter flipping edges $\\mathsf{FH}$ and $\\mathsf{BE}$, we obtain\r\n\r\n<img src=\"https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/FEB21\/CUTCAKE\/CUTCAKE01.png\"><\/img>\r\n\r\nAfter removing edges $\\mathsf{BF}$ and $\\mathsf{FG}$, we obtain\r\n\r\n<img src=\"https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/FEB21\/CUTCAKE\/CUTCAKE02.png\"><\/img>\r\n\r\nWith this sequence of operations, we get the minimum possible score $0$.\r\n\r\n### Test Generation\r\nThe source code in C++ used to generate test data can be downloaded [here](http:\/\/codechef.com\/download\/Images\/FEB21\/CUTCAKE\/generator.cp). The generator may crash with some seeds, run it multiple times until it generates the test files.\r\n\r\n- $N = 1,024$\r\n- the coordinates of each point are chosen uniformly randomly between $0$ and $10^5$ inclusive, in such a way that no three points are collinear\r\n- a Delaunay triangulation is calculated; this is the triangulation given on the input\r\n- a parameter $F$ is chosen from the set $\\{0, 64, 256\\}$\r\n- then, $F$ times, a diagonal segment is chosen uniformly randomly among segments in the Delaunay triangulation, and this segment is flipped\r\n- let $V$ be the set of diagonal segments that can be removed from the triangulation after performing the flips.\r\n- a parameter $S$ is chosen from the set $\\{64, 128, 256, 512\\}$\r\n- then, $S$ uniformly randomly edges are chosen from $V$ and removed from the triangulation. If is not possible to remove all the $S$ edges, then the process is repeated.\r\n- $R = M-S$ is the number of resulting regions with finite areas after removing the edges\r\n- for each of these regions, its area is calculated and multiplied by $2$ (the resulting value is always an integer); $B_1, B_2, \\ldots, B_R$ are these values sorted in non-decreasing order\r\n\r\nThere is one test file for each possible combination of the parameters $F$ and $S$.\r\n\r\n### Scoring\r\nIf your output is invalid (in particular, if you try to flip a non-diagonal segment, or to remove an edge that is not between two regions with finite areas, or to perform too many flips), you will receive the Wrong Answer verdict.\r\n\r\nThe score for each test case (and therefore each test file) is $10^8 + \\sum_{i=1}^R |B_i - 2\\cdot A_i|$. The score of a submission is equal to the sum of its scores over all test cases. Your goal is to minimise the score of your submission.\r\n\r\nThere are 12 test files. During the contest, the displayed score will account for exactly 6 test files, i.e. your score reflects your submission's performance on 50% (6\/12) of the test files. However, if your program gets a non-AC verdict on any test file, your submission's verdict will be non-AC. In other words, an AC verdict denotes that your program runs successfully on all the test files. After the end of the contest, your score will be changed to include the sum of your program's scores over the other six test files.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/FEB21\/hindi\/CUTCAKE.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/FEB21\/bengali\/CUTCAKE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/mandarin\/CUTCAKE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/FEB21\/russian\/CUTCAKE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/FEB21\/vietnamese\/CUTCAKE.pdf) as well.\r\n\r\nThere are $N$ points in a plane (numbered $1$ through $N$). For each valid $i$, the coordinates of the $i$-th point are $(X_i, Y_i)$. No three of these points are collinear. Let's denote a line segment between points $u$ and $v$ by $(u,v)$.\r\n\r\nYou are given a [Delaunay triangulation](https:\/\/en.wikipedia.org\/wiki\/Delaunay_triangulation) of those points, which consists of $M$ triangles (numbered $1$ through $M$). For each valid $i$, the vertices of the $i$-th triangle are the points $P_{i,1}, P_{i,2}, P_{i,3}$.\r\n\r\nYou may perform the following operation any number of times (possibly zero):\r\n- Flip diagonal segment $(u,v)$: If there is a convex quadrilateral that contains this segment as a diagonal and does not contain any points other than its vertices, erase this segment and draw a new segment corresponding to the other diagonal of this quadrilateral. (Note that some segments cannot be flipped. It can be proved that if such a quadrilateral exists, it is unique and the result is also a triangulation.)\r\n\r\nThen, you should perform the following operation some number of times:\r\n- Remove a segment $(u,v)$ that is shared by two regions with finite areas. When it is removed, the number of regions decreases by one.\r\n\r\nA *region* is defined as a maximal set in the plane such that it does not contain any of the given points or currently existing segments and it is possible to move from each point in this set to any other point in this set without crossing any edge. Note that a region is not necessarily convex. Two regions share a line segment if it is possible to move from one of these regions to the other one by crossing only this segment.\r\n\r\nAfter performing all operations, there must be exactly $R$ regions with finite areas. Let $A_1, A_2, \\ldots, A_R$ be these areas sorted in non-decreasing order. You are given the desired areas $B_1, B_2, \\ldots, B_R$ of the regions, also sorted in non-decreasing order. Your goal is to make $\\sum_{i=1}^R |B_i - 2\\cdot A_i|$ as small as possible by performing operations. However, you may only perform up to $1,024$ operations of the first type; note that the number of operations of the second type must always be $M-R$.\r\n\r\n### Input\r\n- The first line of the input contains three space-separated integers $N$, $M$ and $R$.\r\n- $N$ lines follow. For each valid $i$, the $i$-th of these lines contains two space-separated integers $X_i$ and $Y_i$.\r\n- $M$ more lines follow. For each valid $i$, the $i$-th of these lines contains three space-separated integers $P_{i,1}$, $P_{i,2}$ and $P_{i,3}$.\r\n- The last line contains $R$ space-separated integers $B_1, B_2, \\ldots, B_R$.\r\n\r\n### Output\r\n- First, print a line containing a single integer $F$ ($F \\leq 1024$) denoting the number of operations of the first type.\r\n- Then, print $F$ lines. Each of these lines should contain two space-separated integers $u$ and $v$ denoting that you want to flip a diagonal segment $(u,v)$.\r\n- Finally, print $M-R$ lines. Each of these lines should contain two space-separated integers $u$ and $v$ denoting that you want to remove a segment $(u,v)$.\r\n\r\n### Example Input\r\n```\r\n8 7 5\r\n0 11\r\n1 5\r\n2 12\r\n5 0\r\n10 12\r\n12 6\r\n13 5\r\n13 11\r\n1 2 3\r\n5 3 2\r\n8 5 6\r\n7 8 6\r\n4 7 6\r\n2 4 6\r\n5 2 6\r\n13 17 18 48 135\r\n```\r\n### Example Output\r\n```\r\n2\r\n6 8\r\n2 5\r\n2 6\r\n6 7\r\n```\r\n\r\n### Explanation\r\nThe initial triangulation is\r\n\r\n<img src=\"https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/FEB21\/CUTCAKE\/CUTCAKE00.png\"><\/img>\r\n\r\nAfter flipping edges $\\mathsf{FH}$ and $\\mathsf{BE}$, we obtain\r\n\r\n<img src=\"https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/FEB21\/CUTCAKE\/CUTCAKE01.png\"><\/img>\r\n\r\nAfter removing edges $\\mathsf{BF}$ and $\\mathsf{FG}$, we obtain\r\n\r\n<img src=\"https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/FEB21\/CUTCAKE\/CUTCAKE02.png\"><\/img>\r\n\r\nWith this sequence of operations, we get the minimum possible score $0$.\r\n\r\n### Test Generation\r\nThe source code in C++ used to generate test data can be downloaded [here](http:\/\/codechef.com\/download\/Images\/FEB21\/CUTCAKE\/generator.cp). The generator may crash with some seeds, run it multiple times until it generates the test files.\r\n\r\n- $N = 1,024$\r\n- the coordinates of each point are chosen uniformly randomly between $0$ and $10^5$ inclusive, in such a way that no three points are collinear\r\n- a Delaunay triangulation is calculated; this is the triangulation given on the input\r\n- a parameter $F$ is chosen from the set $\\{0, 64, 256\\}$\r\n- then, $F$ times, a diagonal segment is chosen uniformly randomly among segments in the Delaunay triangulation, and this segment is flipped\r\n- let $V$ be the set of diagonal segments that can be removed from the triangulation after performing the flips.\r\n- a parameter $S$ is chosen from the set $\\{64, 128, 256, 512\\}$\r\n- then, $S$ uniformly randomly edges are chosen from $V$ and removed from the triangulation. If is not possible to remove all the $S$ edges, then the process is repeated.\r\n- $R = M-S$ is the number of resulting regions with finite areas after removing the edges\r\n- for each of these regions, its area is calculated and multiplied by $2$ (the resulting value is always an integer); $B_1, B_2, \\ldots, B_R$ are these values sorted in non-decreasing order\r\n\r\nThere is one test file for each possible combination of the parameters $F$ and $S$.\r\n\r\n### Scoring\r\nIf your output is invalid (in particular, if you try to flip a non-diagonal segment, or to remove an edge that is not between two regions with finite areas, or to perform too many flips), you will receive the Wrong Answer verdict.\r\n\r\nThe score for each test case (and therefore each test file) is $10^8 + \\sum_{i=1}^R |B_i - 2\\cdot A_i|$. The score of a submission is equal to the sum of its scores over all test cases. Your goal is to minimise the score of your submission.\r\n\r\nThere are 12 test files. During the contest, the displayed score will account for exactly 6 test files, i.e. your score reflects your submission's performance on 50% (6\/12) of the test files. However, if your program gets a non-AC verdict on any test file, your submission's verdict will be non-AC. In other words, an AC verdict denotes that your program runs successfully on all the test files. After the end of the contest, your score will be changed to include the sum of your program's scores over the other six test files.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"5","source_sizelimit":"50000","problem_author":"alei","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>alei<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"27-01-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alei'>alei<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/feb21'>feb21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/heuristic'>heuristic<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tie-breaker'>tie-breaker<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/triangulation'>triangulation<\/a>","problem_difficulty_level":"Unavailable","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CUTCAKE","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643798007},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=CUTCAKE","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}