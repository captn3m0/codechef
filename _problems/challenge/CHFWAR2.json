{"category_name":"challenge","status":"success","problem_code":"CHFWAR2","problem_name":"(Challenge) Codechef War II","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JULY19\/hindi\/CHFWAR2.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY19\/bengali\/CHFWAR2.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/mandarin\/CHFWAR2.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY19\/russian\/CHFWAR2.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/vietnamese\/CHFWAR2.pdf) as well.\n\nChefland is a country with $N$ cities (numbered $1$ through $N$) and $M$ bidirectional roads (numbered from $1$ through $M$). Each road connects two different cities and no two different roads connect the same pair of cities.\n\nBitland declared war on Chefland and after multiple battles, all roads of Chefland have ended up in a very bad state. Moreover, the war is causing psychological damage to the citizens of Chefland \u2014 for each valid $u$, the *non-eagerness* of the inhabitants of city $u$ on day $d$ is $E_u(d) = P_u + Q_u \\cdot d$.\n\nIn Chefland, there are $K$ special cities that are very important strategically. Ada, the queen of Chefland, decided to repair some roads and construct new roads in such a way that if any one of these roads is destroyed, it is still possible to reach each special city from any other special city using only the roads that were repaired or constructed.\n\nIt is allowed to work on repairing and constructing different roads simultaneously, but to keep Chefland stable, Ada ordered that on each day, the number of roads that are being repaired and\/or constructed must be at most $S$. Also, whenever we start repairing or constructing a road, the work on that road cannot be paused until the road is finished.\n\nThe earliest day on which we can start repairing or constructing a road is day $1$; let's denote the last day on which we finish repairing or constructing a road by $T$. The queen does not want to wait too much, so for each day between $1$ and $T$ inclusive, there must be at least one road which is currently being constructed or repaired. Note that this means $T$ cannot exceed the time it would take to repair and construct all roads.\n\nFor each valid $i$, the $i$-th of the original roads connected cities $U_i$ and $V_i$, its length was $L_i$ kilometres and the cost of repairing it is described by two parameters $A_i$ and $B_i$. The workers of Chefland can only repair one kilometer of road per day and it is not allowed to work on different parts of a road at the same time, so it takes exactly $L_i$ days to repair this road. If we start repairing this road on day $d$, it costs $A_i + B_i \\cdot d$.\n\nFor each pair of different cities $u$ and $v$, let's denote the length of the shortest path between these cities before the original roads were damaged (before Chefland's invasion) by $D_{u, v}$. Then, it takes $D_{u, v}$ days to construct a brand new road between the cities $u$ and $v$. This road does not pass through any cities other than $u$ and $v$. If we start constructing this road on day $d$, it costs $(E_u(d)+E_v(d)) \\cdot D_{u, v}$. It is not allowed to construct a road between two cities if they are already directly connected by a road or if they were originally directly connected by a road.\n\nHelp Ada design a plan that minimises the total cost. Formally, determine which roads should be repaired, which ones should be constructed and for each of these roads, determine the day on which the work on this road should start. The total cost of this plan should be as small as possible, while all other constraints must be satisfied perfectly.\n\n### Input\n- The first line of the input contains four space-separated integers $N$, $M$, $K$ and $S$.\n- The second line contains $K$ space-separated integers denoting the indices of the special cities.\n- $N$ lines follow. For each $i$ ($1 \\le i \\le N$), the $i$-th of these lines contains two space-separated integers $P_i$ and $Q_i$.\n- $M$ more lines follow. For each $i$ ($1 \\le i \\le M$), the $i$-th of these lines contains five space-separated integers $U_i$, $V_i$, $L_i$, $A_i$ and $B_i$.\n\n### Output\n- First, print a line containing a single integer $X$ denoting the number of roads you want to repair.\n- Then, print $X$ lines. Each of these lines should contain two space-separated integers $d$ and $e$ denoting that you want to start repairing road $e$ on day $d$.\n- Next, print a line containing a single integer $Y$ denoting the number of new roads you want to construct.\n- Then, print $Y$ lines. Each of these lines should contain three space-separated integers $d$, $u$ and $v$ denoting that you want to start building a road between cities $u$ and $v$ on day $d$.\n\n### Constraints\n- $2 \\le K \\le N = 2^8$\n- $2^4 = S \\le M \\le (N \\cdot (N-1))\/2$\n- $1 \\le U_i, V_i \\le N$ for each valid $i$\n- $1 \\le L_i \\le 2^{12}$ for each valid $i$\n- $1 \\le A_i, B_i \\le 2^8$ for each valid $i$\n- $1 \\le P_i, Q_i \\le 2^{11}$ for each valid $i$\n\n### Example Input\n```\n7 9 3 2\n1 3 7\n1 1\n1 2\n1 3\n1 4\n1 5\n1 6\n1 7\n1 2 1 1 1\n1 4 1 1 2\n2 3 1 1 3\n2 4 1 1 4\n3 4 1 1 5\n3 5 1 1 6\n3 6 1 1 7\n5 7 1 1 8\n6 7 1 1 9\n```\n\n### Example Output\n```\n8\n1 1\n2 2\n3 3\n4 5\n5 6\n6 7\n7 8\n8 9\n0\n```\t\n\n### Scoring\nThe score of each test case (and therefore each test file) is the sum of costs of all the roads you want to repair or construct. The score of a submission is the sum of scores of all test files. Your goal is to minimise the score of your submission.\n\nThere are sixteen test files. If your program gets a non-AC verdict on any test file, your submission's verdict will be non-AC. In other words, an AC verdict denotes that your program runs successfully on all the test files.\n\n### Test Generation\nIn all test cases, $N = 2^8$ and $S = 2^4$.\n\nThere are two types of original road networks:\n- Type I: There is a road between each pair of cities and the special cities are chosen uniformly randomly.\n- Type II: First, ten permutations $p_1, p_2, \\ldots, p_{10}$ of integers $1$ through $K+K\/2$ ($1$-indexed) are generated. For each valid $i$ and $j$, the edge between cities $p_{i, j}$ and $p_{i, j+1}$ is added if it did not exist. Then, edges are added uniformly randomly until the total number of edges reaches $\\left\\lfloor\\frac{N \\cdot (N-1)}{5} \\right\\rfloor$. The special cities are chosen uniformly randomly between 1 and $K+K\/2$. After generating the road network, the indices of the cities are relabelled. A permutation $q$ of numbers from $1$ through $N$ is uniformly randomly chosen, the new index of city $u$ will be $q_u$. If in the original network cities $u$ and $v$ are connected, in the final network cities $q_u$ and $q_v$ are connected.\n\n$K$ is either $N\/4$ or $N\/2$. Next, we choose two parameters $MIN_L$ and $MAX_L$: either $1$ and $2^{12}$ respectively or $2^{11}-10$ and $2^{11}+10$ respectively. Next, we choose two more parameters $MIN_A$ and $MAX_A$: either $1$ and $2^8$ respectively or $2^7 - 20$ and $2^7 + 20$ respectively.\n\nThe lengths of all roads are chosen uniformly randomly between $MIN_L$ and $MAX_L$ inclusive. All parameters $A_i$ and $B_i$ are chosen uniformly randomly between $MIN_A$ and $MAX_A$ inclusive. All parameters $P_i$ and $Q_i$ are chosen uniformly randomly between $8 \\cdot MIN_A$ and $8 \\cdot MAX_A$ inclusive.\n\nThere is a test file for each unique combination of the following four parameters: road network type, $K$, the pair $(MIN_L, MAX_L)$ and the pair $(MIN_A, MAX_A)$.\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JULY19\/hindi\/CHFWAR2.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY19\/bengali\/CHFWAR2.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/mandarin\/CHFWAR2.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY19\/russian\/CHFWAR2.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/vietnamese\/CHFWAR2.pdf) as well.\n\nChefland is a country with $N$ cities (numbered $1$ through $N$) and $M$ bidirectional roads (numbered from $1$ through $M$). Each road connects two different cities and no two different roads connect the same pair of cities.\n\nBitland declared war on Chefland and after multiple battles, all roads of Chefland have ended up in a very bad state. Moreover, the war is causing psychological damage to the citizens of Chefland \u2014 for each valid $u$, the *non-eagerness* of the inhabitants of city $u$ on day $d$ is $E_u(d) = P_u + Q_u \\cdot d$.\n\nIn Chefland, there are $K$ special cities that are very important strategically. Ada, the queen of Chefland, decided to repair some roads and construct new roads in such a way that if any one of these roads is destroyed, it is still possible to reach each special city from any other special city using only the roads that were repaired or constructed.\n\nIt is allowed to work on repairing and constructing different roads simultaneously, but to keep Chefland stable, Ada ordered that on each day, the number of roads that are being repaired and\/or constructed must be at most $S$. Also, whenever we start repairing or constructing a road, the work on that road cannot be paused until the road is finished.\n\nThe earliest day on which we can start repairing or constructing a road is day $1$; let's denote the last day on which we finish repairing or constructing a road by $T$. The queen does not want to wait too much, so for each day between $1$ and $T$ inclusive, there must be at least one road which is currently being constructed or repaired. Note that this means $T$ cannot exceed the time it would take to repair and construct all roads.\n\nFor each valid $i$, the $i$-th of the original roads connected cities $U_i$ and $V_i$, its length was $L_i$ kilometres and the cost of repairing it is described by two parameters $A_i$ and $B_i$. The workers of Chefland can only repair one kilometer of road per day and it is not allowed to work on different parts of a road at the same time, so it takes exactly $L_i$ days to repair this road. If we start repairing this road on day $d$, it costs $A_i + B_i \\cdot d$.\n\nFor each pair of different cities $u$ and $v$, let's denote the length of the shortest path between these cities before the original roads were damaged (before Chefland's invasion) by $D_{u, v}$. Then, it takes $D_{u, v}$ days to construct a brand new road between the cities $u$ and $v$. This road does not pass through any cities other than $u$ and $v$. If we start constructing this road on day $d$, it costs $(E_u(d)+E_v(d)) \\cdot D_{u, v}$. It is not allowed to construct a road between two cities if they are already directly connected by a road or if they were originally directly connected by a road.\n\nHelp Ada design a plan that minimises the total cost. Formally, determine which roads should be repaired, which ones should be constructed and for each of these roads, determine the day on which the work on this road should start. The total cost of this plan should be as small as possible, while all other constraints must be satisfied perfectly.\n\n### Input\n- The first line of the input contains four space-separated integers $N$, $M$, $K$ and $S$.\n- The second line contains $K$ space-separated integers denoting the indices of the special cities.\n- $N$ lines follow. For each $i$ ($1 \\le i \\le N$), the $i$-th of these lines contains two space-separated integers $P_i$ and $Q_i$.\n- $M$ more lines follow. For each $i$ ($1 \\le i \\le M$), the $i$-th of these lines contains five space-separated integers $U_i$, $V_i$, $L_i$, $A_i$ and $B_i$.\n\n### Output\n- First, print a line containing a single integer $X$ denoting the number of roads you want to repair.\n- Then, print $X$ lines. Each of these lines should contain two space-separated integers $d$ and $e$ denoting that you want to start repairing road $e$ on day $d$.\n- Next, print a line containing a single integer $Y$ denoting the number of new roads you want to construct.\n- Then, print $Y$ lines. Each of these lines should contain three space-separated integers $d$, $u$ and $v$ denoting that you want to start building a road between cities $u$ and $v$ on day $d$.\n\n### Constraints\n- $2 \\le K \\le N = 2^8$\n- $2^4 = S \\le M \\le (N \\cdot (N-1))\/2$\n- $1 \\le U_i, V_i \\le N$ for each valid $i$\n- $1 \\le L_i \\le 2^{12}$ for each valid $i$\n- $1 \\le A_i, B_i \\le 2^8$ for each valid $i$\n- $1 \\le P_i, Q_i \\le 2^{11}$ for each valid $i$\n\n### Example Input\n```\n7 9 3 2\n1 3 7\n1 1\n1 2\n1 3\n1 4\n1 5\n1 6\n1 7\n1 2 1 1 1\n1 4 1 1 2\n2 3 1 1 3\n2 4 1 1 4\n3 4 1 1 5\n3 5 1 1 6\n3 6 1 1 7\n5 7 1 1 8\n6 7 1 1 9\n```\n\n### Example Output\n```\n8\n1 1\n2 2\n3 3\n4 5\n5 6\n6 7\n7 8\n8 9\n0\n```\t\n\n### Scoring\nThe score of each test case (and therefore each test file) is the sum of costs of all the roads you want to repair or construct. The score of a submission is the sum of scores of all test files. Your goal is to minimise the score of your submission.\n\nThere are sixteen test files. If your program gets a non-AC verdict on any test file, your submission's verdict will be non-AC. In other words, an AC verdict denotes that your program runs successfully on all the test files.\n\n### Test Generation\nIn all test cases, $N = 2^8$ and $S = 2^4$.\n\nThere are two types of original road networks:\n- Type I: There is a road between each pair of cities and the special cities are chosen uniformly randomly.\n- Type II: First, ten permutations $p_1, p_2, \\ldots, p_{10}$ of integers $1$ through $K+K\/2$ ($1$-indexed) are generated. For each valid $i$ and $j$, the edge between cities $p_{i, j}$ and $p_{i, j+1}$ is added if it did not exist. Then, edges are added uniformly randomly until the total number of edges reaches $\\left\\lfloor\\frac{N \\cdot (N-1)}{5} \\right\\rfloor$. The special cities are chosen uniformly randomly between 1 and $K+K\/2$. After generating the road network, the indices of the cities are relabelled. A permutation $q$ of numbers from $1$ through $N$ is uniformly randomly chosen, the new index of city $u$ will be $q_u$. If in the original network cities $u$ and $v$ are connected, in the final network cities $q_u$ and $q_v$ are connected.\n\n$K$ is either $N\/4$ or $N\/2$. Next, we choose two parameters $MIN_L$ and $MAX_L$: either $1$ and $2^{12}$ respectively or $2^{11}-10$ and $2^{11}+10$ respectively. Next, we choose two more parameters $MIN_A$ and $MAX_A$: either $1$ and $2^8$ respectively or $2^7 - 20$ and $2^7 + 20$ respectively.\n\nThe lengths of all roads are chosen uniformly randomly between $MIN_L$ and $MAX_L$ inclusive. All parameters $A_i$ and $B_i$ are chosen uniformly randomly between $MIN_A$ and $MAX_A$ inclusive. All parameters $P_i$ and $Q_i$ are chosen uniformly randomly between $8 \\cdot MIN_A$ and $8 \\cdot MAX_A$ inclusive.\n\nThere is a test file for each unique combination of the following four parameters: road network type, $K$, the pair $(MIN_L, MAX_L)$ and the pair $(MIN_A, MAX_A)$.\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"4","source_sizelimit":"50000","problem_author":"alei","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>alei<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"18-06-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alei'>alei<\/a>","problem_difficulty_level":"Unavailable","user_zen_mode":false,"best_tag":"","editorial_url":"","time":{"view_start_date":1563183002,"submit_start_date":1563183002,"visible_start_date":1563183002,"end_date":1735669800,"current":1643798004},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=CHFWAR2","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}