{"category_name":"challenge","status":"success","problem_code":"ANTS","problem_name":"Ants (Challenge) ","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/AUG20\/hindi\/ANTS.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/AUG20\/bengali\/ANTS.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/AUG20\/mandarin\/ANTS.pdf), [Russian] (https:\/\/www.codechef.com\/download\/translated\/AUG20\/russian\/ANTS.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/AUG20\/vietnamese\/ANTS.pdf) as well.\r\n\r\nYou are given a directed weighted graph with $N$ vertices (numbered $1$ through $N$) and $M$ edges (numbered $1$ through $M$). For each valid $i$, the $i$-th edge is initially directed from a vertex $u_i$ to a vertex $v_i$ and it has a *flipping cost* $W_i$. There is one ant living in each vertex of the graph.\r\n\r\nLet's denote a directed edge from a vertex $u$ to a vertex $v$ by $(u, v)$. The outdegree of a vertex $u$ is the number of vertices $v$ such that there is an edge $(u, v)$ in the graph. A vertex $u$ is adjacent to a vertex $v$ if there is an edge $(u, v)$ in the graph.\r\n\r\nThe queen of ants wants to gather all ants in at most $K$ distinct vertices. In order to do that, she may perform the following instructions in any order, any number of times:\r\n- `1 i`: Flip the $i$-th edge \u2015 if the edge was $(u, v)$ before this instruction, it becomes $(v, u)$. The cost of performing such an instruction is $W_i$ antcoins and it can be used at most $5 \\cdot 10^5$ times.\r\n- `2`: The queen orders that each ant which is currently in a vertex with outdegree $1$ must move to the only vertex adjacent to it. All ants move at once and when there are multiple ants that have to move from some vertex, they move together. The cost of performing such an instruction is $S$ antcoins and it can be used at most $700$ times.\r\n\r\nAfter all instructions are performed, the number of distinct vertices which still contain ants must be at most $K$. Find a way to achieve this with as little cost as possible.\r\n\r\n### Input\r\n- The first line of the input contains four space-separated integers $N$, $M$, $K$ and $S$.\r\n- $M$ lines follow. For each valid $i$, the $i$-th of these lines contains three space-seperated integers $u_i$, $v_i$ and $W_i$.\r\n\r\n### Output\r\nFirst, print a line containing a single integer $Q$ \u2015 the number of instructions.\r\n\r\nThen, print $Q$ lines. Each of these lines should describe one instruction in the format `1 i` or `2`.\r\n\r\n### Example Input\r\n```\r\n6 6 1 1\r\n1 2 1\r\n3 2 2\r\n4 3 3\r\n5 4 4\r\n6 5 5\r\n6 1 6\r\n```\r\n\r\n### Example Output\r\n```\r\n6\r\n2\r\n2\r\n2\r\n1 1\r\n1 5\r\n2\r\n```\r\n\r\n### Explanation\r\nThe following picture describes the state of the graph after the first operation (the highlighted vertices contain ants).\r\n\r\n<img src=\"https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/AUG20\/ANTS\/ANTS.png\"><\/img>\r\n\r\nIn the fourth and fifth instructions, the edges $(1, 2)$ and $(6, 5)$ are flipped. At the end, all ants are gathered in vertex $1$.\r\n\r\n### Test generation and constraints\r\n- $N$ is either $10^3$ or $10^4$\r\n- $M = 10^5$\r\n- $S$ is $50$, $500$ or $5,000$\r\n- $K$ is $1$ or $8$\r\n\r\nThere are twelve test files \u2015 one for each combination of the parameters $N$, $M$, $S$ and $K$.\r\n\r\n$M$ distinct undirected edges are chosen uniformly randomly and independently from the $N \\cdot (N-1)\/2$ possibilities, then a direction is uniformly random and independently chosen for each edge. The cost of each edge is chosen uniformly randomly and independently between $1$ and $50$ inclusive.\r\n\r\n### Scoring\r\nIf any of your instructions are invalid or there are more than $K$ vertices containing ants after all instructions are performed, you will receive the Wrong Answer verdict. Otherwise, the score of a test file is the sum of costs of all instructions. The score of a submission is the sum of scores of all test files. Your goal is to minimise the score of your submission.\r\n\r\nThere are twelve test files. During the contest, the displayed score will account for exactly six test files, i.e. your score reflects your submission's performance on 50% of the test files. However, if your program gets a non-AC verdict on any test file, your submission's verdict will be non-AC. In other words, an AC verdict denotes that your program runs successfully on all the test files. After the end of the contest, your score will be changed to include the sum of your program's scores over the other 6 test files.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/AUG20\/hindi\/ANTS.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/AUG20\/bengali\/ANTS.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/AUG20\/mandarin\/ANTS.pdf), [Russian] (https:\/\/www.codechef.com\/download\/translated\/AUG20\/russian\/ANTS.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/AUG20\/vietnamese\/ANTS.pdf) as well.\r\n\r\nYou are given a directed weighted graph with $N$ vertices (numbered $1$ through $N$) and $M$ edges (numbered $1$ through $M$). For each valid $i$, the $i$-th edge is initially directed from a vertex $u_i$ to a vertex $v_i$ and it has a *flipping cost* $W_i$. There is one ant living in each vertex of the graph.\r\n\r\nLet's denote a directed edge from a vertex $u$ to a vertex $v$ by $(u, v)$. The outdegree of a vertex $u$ is the number of vertices $v$ such that there is an edge $(u, v)$ in the graph. A vertex $u$ is adjacent to a vertex $v$ if there is an edge $(u, v)$ in the graph.\r\n\r\nThe queen of ants wants to gather all ants in at most $K$ distinct vertices. In order to do that, she may perform the following instructions in any order, any number of times:\r\n- `1 i`: Flip the $i$-th edge \u2015 if the edge was $(u, v)$ before this instruction, it becomes $(v, u)$. The cost of performing such an instruction is $W_i$ antcoins and it can be used at most $5 \\cdot 10^5$ times.\r\n- `2`: The queen orders that each ant which is currently in a vertex with outdegree $1$ must move to the only vertex adjacent to it. All ants move at once and when there are multiple ants that have to move from some vertex, they move together. The cost of performing such an instruction is $S$ antcoins and it can be used at most $700$ times.\r\n\r\nAfter all instructions are performed, the number of distinct vertices which still contain ants must be at most $K$. Find a way to achieve this with as little cost as possible.\r\n\r\n### Input\r\n- The first line of the input contains four space-separated integers $N$, $M$, $K$ and $S$.\r\n- $M$ lines follow. For each valid $i$, the $i$-th of these lines contains three space-seperated integers $u_i$, $v_i$ and $W_i$.\r\n\r\n### Output\r\nFirst, print a line containing a single integer $Q$ \u2015 the number of instructions.\r\n\r\nThen, print $Q$ lines. Each of these lines should describe one instruction in the format `1 i` or `2`.\r\n\r\n### Example Input\r\n```\r\n6 6 1 1\r\n1 2 1\r\n3 2 2\r\n4 3 3\r\n5 4 4\r\n6 5 5\r\n6 1 6\r\n```\r\n\r\n### Example Output\r\n```\r\n6\r\n2\r\n2\r\n2\r\n1 1\r\n1 5\r\n2\r\n```\r\n\r\n### Explanation\r\nThe following picture describes the state of the graph after the first operation (the highlighted vertices contain ants).\r\n\r\n<img src=\"https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/AUG20\/ANTS\/ANTS.png\"><\/img>\r\n\r\nIn the fourth and fifth instructions, the edges $(1, 2)$ and $(6, 5)$ are flipped. At the end, all ants are gathered in vertex $1$.\r\n\r\n### Test generation and constraints\r\n- $N$ is either $10^3$ or $10^4$\r\n- $M = 10^5$\r\n- $S$ is $50$, $500$ or $5,000$\r\n- $K$ is $1$ or $8$\r\n\r\nThere are twelve test files \u2015 one for each combination of the parameters $N$, $M$, $S$ and $K$.\r\n\r\n$M$ distinct undirected edges are chosen uniformly randomly and independently from the $N \\cdot (N-1)\/2$ possibilities, then a direction is uniformly random and independently chosen for each edge. The cost of each edge is chosen uniformly randomly and independently between $1$ and $50$ inclusive.\r\n\r\n### Scoring\r\nIf any of your instructions are invalid or there are more than $K$ vertices containing ants after all instructions are performed, you will receive the Wrong Answer verdict. Otherwise, the score of a test file is the sum of costs of all instructions. The score of a submission is the sum of scores of all test files. Your goal is to minimise the score of your submission.\r\n\r\nThere are twelve test files. During the contest, the displayed score will account for exactly six test files, i.e. your score reflects your submission's performance on 50% of the test files. However, if your program gets a non-AC verdict on any test file, your submission's verdict will be non-AC. In other words, an AC verdict denotes that your program runs successfully on all the test files. After the end of the contest, your score will be changed to include the sum of your program's scores over the other 6 test files.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"5","source_sizelimit":"50000","problem_author":"alei","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>alei<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"24-07-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alei'>alei<\/a>","problem_difficulty_level":"Unavailable","user_zen_mode":false,"best_tag":"","editorial_url":"","time":{"view_start_date":1597656602,"submit_start_date":1597656602,"visible_start_date":1597656602,"end_date":1735669800,"current":1643798005},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=ANTS","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}