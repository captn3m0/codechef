{"category_name":"challenge","status":"success","problem_code":"SCLUSTER","problem_name":"Social Cluster","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/AUG15\/mandarin\/SCLUSTER.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/AUG15\/russian\/SCLUSTER.pdf\">Russian<\/a>.<\/h3>\n\n\n<p>This problem deals with the effective formation of a cluster among <b>K<\/b> individuals living in a society. A society can be represented  as a <b>N \u00d7 N<\/b> grid. Individuals are located at certain points on the grid. Each individual's social interaction is measured by a positive integer, called <b>interaction power<\/b> denoted by <b>I<sub>i<\/sub><\/b>. The <b>dissimilarity<\/B> between two individuals is defined as the absolute difference between their interaction powers. Less the absolute difference between interaction powers of two individuals, more the probability that they will interact with each other.<\/p>\n<p>Now your task is to form a single cluster of individuals by displacing some individuals from their original positions. Formally, a cluster means a connected component. An individual at point <b>(x<sub>i<\/sub>, y<sub>i<\/sub>)<\/b> is said to be <b>adjacent<\/b> to another individual at point <b>(x<sub>j<\/sub>, y<sub>j<\/sub>)<\/b> if and only if <b>|x<sub>i<\/sub> \u2212 x<sub>j<\/sub>| \u2264 1<\/b> and <b>|y<sub>i<\/sub> \u2212 y<sub>j<\/sub>| \u2264 1<\/b>.<\/p>\n<p><b>What needs to be optimized ?<\/b><\/p>\n<p>The cost of clustering is defined as <b>Score = 1000\u00d7A + 10\u00d7B<\/b> , where <b>A<\/b> and <b>B<\/b> are two variables. <b>The task is to minimize this cost.<\/b><\/p>\n<p>We define <b>A<\/b> first. Suppose <b>P<\/b> be the set of individuals on the grid and <b>|P| = K<\/b>. In order to create the cluster, we may need to displace some individuals from their original positions on the grid. Let the individual <b>p<sub>i<\/sub><\/b> be displaced by a Manhattan distance <b>d<sub>i<\/sub><\/b> in order to become a part of the cluster.<br \/>Now <b>d<sub>i<\/sub> = |x<sub>i(final)<\/sub> \u2212 x<sub>i(initial)<\/sub>| + |y<sub>i(final)<\/sub> \u2212 y<sub>i(initial)<\/sub>|<\/b>.<br \/>Here <b>(x<sub>i(initial)<\/sub>, y<sub>i(initial)<\/sub>)<\/b> is the initial position of individual <b>p<sub>i<\/sub><\/b> and <b>(x<sub>i(final)<\/sub>, y<sub>i(final)<\/sub>)<\/b> is the position of the same individual after becoming a part of the cluster.<br \/>Now <b>A = \u03a3 (d<sub>i<\/sub> \/ I<sub>i<\/sub>) <\/b> where <b>i = 1 to K<\/b>.<br \/>Here <b>I<\/b><sub>i<\/sub> = Interaction power of individual <b>p<sub>i<\/sub><\/b>.<\/p><p>The variable <b>B<\/b> is defined after the cluster is formed.<br><b>B = \u03a3 ( s<sub>i<\/sub> \/ n<sub>i<\/sub> )<\/b> , where <b> i = 1 to K<\/b>.<br \/><b>s<sub>i<\/sub> = \u03a3 (|I<sub>j<\/sub> \u2212 I<sub>i<\/sub>| )<\/b>, where <b>{ p<sub>j<\/sub> \u2208 P | p<sub>j<\/sub> is adjacent to p<sub>i<\/sub> }<\/b>.<br \/><b>n<sub>i<\/sub><\/b> = Number of individuals adjacent to <b>p<sub>i<\/sub><\/b>.<\/p>\n\n<h3>Input<\/h3>\n<p>The first line of input contains an integer <b>T<\/b>, denoting the number of test cases. Then <b>T<\/b> test cases follow.<\/p>\n<p>The first line of each test case contains two space separated integers <b>N<\/b> and <b>K<\/b>, denoting the grid size and the number of individuals, respectively. Then <b>N<\/b> lines follow. The <b>i<sup>th<\/sup><\/b> of these lines contains <b>N<\/b> space separated integers, denoting the information regarding the <b>i<sup>th<\/sup><\/b> row. The <b>j<sup>th<\/sup><\/b> value of <b>i<sup>th<\/sup><\/b> row contains the index value of an individual at <b>(i, j)<\/b> cell. The index value, of course, ranges from <b>1<\/b> to <b>K<\/b>. Empty cells have zero value.<\/p>\n<p>Then <b>K<\/b> lines follow. The <b>i<sup>th<\/sup><\/b> of these lines contains the value of <b>I<sub>i<\/sub<\/p><\/b>, the interaction power of <b>i<sup>th<\/sup><\/b> individual.<\/p>\n\n<h3>Output<\/h3>\n<p> For each test case, print <b>N<\/b> lines, each line containing <b>N<\/b> space separated integers. It represents the <b>N \u00d7 N<\/b> grid containing the cluster.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>60<\/b><\/li>\n<li><b>2<\/b> \u2264 <b>N<\/b> \u2264 <b>60<\/b><\/li>\n<li><b>2<\/b> \u2264 <b>K<\/b> \u2264 <b>2000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>I<sub>i<\/sub><\/b> \u2264 <b>25<\/b><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n1\n5 5\n0 0 0 1 0\n0 0 0 0 0\n2 0 5 0 4\n0 0 0 0 0\n0 3 0 0 0\n2\n3\n2\n3\n3\n\n<b>Output:<\/b>\n0 0 0 0 0\n0 0 1 0 0\n0 2 5 4 0\n0 0 3 0 0\n0 0 0 0 0\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p><pre>Calculation of value <b>A<\/b> :\n<b>d<sub>1<\/sub><\/b> = 2        <b>I<sub>1<\/sub><\/b> = 2\n<b>d<sub>2<\/sub><\/b> = 1        <b>I<sub>2<\/sub><\/b> = 3\n<b>d<sub>3<\/sub><\/b> = 2        <b>I<sub>3<\/sub><\/b> = 2\n<b>d<sub>4<\/sub><\/b> = 1        <b>I<sub>4<\/sub><\/b> = 3\n<b>d<sub>5<\/sub><\/b> = 0        <b>I<sub>5<\/sub><\/b> = 3\n<b>A<\/b>  =   <b>d<sub>1<\/sub><\/b>\/ <b>I<sub>1<\/sub><\/b> + <b>d<sub>2<\/sub><\/b>\/<b>I<sub>2<\/sub><\/b> + <b>d<sub>3<\/sub><\/b>\/<b>I<sub>3<\/sub><\/b> + <b>d<sub>4<\/sub><\/b>\/<b>I<sub>4<\/sub><\/b> + <b>d<sub>5<\/sub><\/b>\/<b>I<sub>5<\/sub><\/b>\n    = <b>1<\/b> + <b>0.333...<\/b> + <b>1<\/b> + <b>0.333...<\/b> + <b>0<\/b>\n    = <b>2.666...<\/b> <br>   \nCalculation of value <b>B<\/b> :\n(Number of individuals adjacent to <b>1<\/b>) = <b>n<sub>1<\/sub><\/b> = <b>3<\/b>  ( 2 , 5 , 4 )\n<b>s<sub>1<\/sub><\/b> = <b>|I<sub>1<\/sub> \u2212 I<sub>2<\/sub>|<\/b> + <b>|I<sub>1<\/sub> \u2212 I<sub>5<\/sub>|<\/b> + <b>|I<sub>1<\/sub> \u2212 I<sub>4<\/sub>|<\/b>\n    = <b>1<\/b> + <b>1<\/b> + <b>1<\/b>\n    = <b>3<\/b>\n(Number of individuals adjacent to <b>2<\/b>) = <b>n<sub>2<\/sub><\/b> = <b>3<\/b>  ( 1 , 5 , 3 )\n<b>s<sub>2<\/sub><\/b> = <b>|I<sub>2<\/sub> \u2212 I<sub>1<\/sub>|<\/b> + <b>|I<sub>2<\/sub> \u2212 I<sub>5<\/sub>|<\/b> + <b>|I<sub>2<\/sub> \u2212 I<sub>3<\/sub>|<\/b>\n    = <b>1<\/b> + <b>0<\/b> + <b>1<\/b>\n    = <b>2<\/b>\nIn a similar fashion ,\n<b>n<sub>3<\/sub><\/b> = <b>3<\/b>, <b>n<sub>4<\/sub><\/b> = <b>3<\/b>, <b>n<sub>5<\/sub><\/b> = <b>4<\/b>,\n<b>s<sub>3<\/sub><\/b> = <b>3<\/b>, <b>s<sub>4<\/sub><\/b> = <b>2<\/b>, <b>s<sub>5<\/sub><\/b> = <b>2<\/b>,\n<b>B<\/b>  =   <b>s<sub>1<\/sub><\/b>\/<b>n<sub>1<\/sub><\/b> + <b>s<sub>2<\/sub><\/b>\/<b>n<sub>2<\/sub><\/b> + <b>s<sub>3<\/sub><\/b>\/<b>n<sub>3<\/sub><\/b> + <b>s<sub>4<\/sub><\/b>\/<b>n<sub>4<\/sub><\/b> + <b>s<sub>5<\/sub><\/b>\/<b>n<sub>5<\/sub><\/b>\n     =  <b>1<\/b> + <b>0.666...<\/b> + <b>1<\/b> + <b>0.666...<\/b> + <b>0.5<\/b>\n     =  <b>3.833...<\/b>\n\nNow <b>Cost<\/b> = <b>1000\u00d7A<\/b> + <b>10\u00d7B<\/b>\n                 = <b>2666.66...<\/b> + <b>38.33...<\/b>\n                 = <b>2705<\/b>\n\t\t\t\t\t\t\t\t\nA different configuration of the cluster may result in a different cost. The task is to minimize this clustering cost.\n<\/pre>\n\n<h3>Test generation method and scoring<\/h3>\n<p>All test file has <b>T = 60<\/b>. Then each test case is generated as follows.<\/p>\n<p>An integer <b>x<\/b> is chosen from <b>[2, 60]<\/b> uniformly and randomly at first. Then <b>N<\/b> is chosen from <b>[x, 60]<\/b> uniformly and randomly. Next, an integer <b>y<\/b> is chosen from <b>[2, min(2000, N\u00d7N)]<\/b>, and <b>K<\/b> is chosen from <b>[2, y]<\/b> uniformly and randomly. Starting at empty grid, choose an empty cell uniformly and randomly, then put one individual put the cell one by one. Lastly, <b>I<sub>i<\/sub><\/b> are chosen from <b>[1, 25]<\/b> uniformly and randomly and independently for <b>i=1,2,...,K<\/b>.<\/p>\n<p>There are <b>20<\/b> test files in the judge. The score for each test case is calculated as described in the statements. Then the score for each test file is defined by the sum of the score of test cases in the test file. Finally, the final score is defined by the average of the score for each test file. During the contest, only the first <b>12<\/b> test cases in each test case affect the score, and the scores of the rest <b>48<\/b> test cases are treated as <b>0<\/b>.<\/p>\n\n\n<h3>Note<\/h3>\nYou are allowed maximum of 200 submissions in this problem. Also, no memory and time limit information will be provided for the test cases which are meant to be judged after the contest (i.e. 80% of the test cases). Though, you will be told AC\/WA for that too.","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, SCM chicken, CLOJ, FS","max_timelimit":"5","source_sizelimit":"50000","problem_author":"nssprogrammer","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #1E7D22;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>2&#9733;<\/span><span>nssprogrammer<\/span>","problem_tester":"laycurse","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>laycurse<\/span>","date_added":"17-03-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/annealing'>annealing<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/aug15'>aug15<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/challenge'>challenge<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/facility-loc'>facility-loc<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/heuristic'>heuristic<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nssprogrammer'>nssprogrammer<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/steinertree'>steinertree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/stimulated'>stimulated<\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/SCLUSTER","time":{"view_start_date":1439803800,"submit_start_date":1439803800,"visible_start_date":1439803800,"end_date":1735669800,"current":1525454422},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}