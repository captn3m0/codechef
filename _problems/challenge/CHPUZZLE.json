{"category_name":"challenge","status":"success","problem_code":"CHPUZZLE","problem_name":"Jigsaw Puzzle Solving","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>Imagine a usual jigsaw puzzle. Let its picture be a completely white rectangle with the width of <b>W<\/b> pixels and the height of <b>H<\/b> pixels.<\/p>\n<p>The puzzle was splitted into <b>K<\/b> pieces, then they've got mixed up. Now you want to restore it again. Ideally, you'd like merge these pieces in such a way that they'd form a rectangle <b>W<\/b> pixels wide and <b>H<\/b> pixels tall, again. However, it can be very hard. Therefore, even reconstructing a part of a puzzle will make you happy.<\/p>\n<p>Let's formalize the things a bit. You have an empty matrix of <b>H<\/b> x <b>W<\/b> cells and <b>K<\/b> pieces, every piece is a connected component (see the further illustration for better understanding). By connected component, we mean that a piece is a figure where you can reach any pixel of a figure by going through side-adjacent pixels from the figure. You can place a piece anywhere in the matrix, in case it doesn't overlap with other pieces and doesn't crosses the border of the matrix. You can skip the piece and not to place it at all. You <b>cannot rotate<\/b> the pieces. Given that it is possible to place all the the pieces in such a way that the every cell of the matrix is exactly covered by one piece.<\/p>\n<p>Your goal is to place some (maybe, all) of the pieces in such a way that no two pieces overlap, no piece crosses the border of the matrix, and the number of the cells that are covered by placed pieces is maximized.<\/p>\n<p>Here is the example of the puzzle, splitted into pieces:<br \/><br \/>\n<font face=\"courier\">9 9 9 9 9 9 8 8 8 1 <\/font><br \/>\n<font face=\"courier\">9 9 9 9 9 9 8 8 8 1 <\/font><br \/>\n<font face=\"courier\">9 5 5 5 5 9 9 9 4 1 <\/font><br \/>\n<font face=\"courier\">5 5 5 5 5 9 9 4 4 1 <\/font><br \/>\n<font face=\"courier\">5 3 5 5 4 4 4 4 7 1 <\/font><br \/>\n<font face=\"courier\">3 3 5 5 4 2 2 7 7 1 <\/font><br \/>\n<font face=\"courier\">3 3 3 2 2 2 7 7 1 1 <\/font><br \/>\n<font face=\"courier\">3 3 3 2 7 7 7 7 7 7 <\/font><br \/>\n<font face=\"courier\">3 3 3 2 6 7 7 7 6 6 <\/font><br \/>\n<font face=\"courier\">2 2 2 2 6 6 6 6 6 6 <\/font>\n<\/p>\n<h3>Input<\/h3>\n<p>The first line of input contains three space separated integers <b>H<\/b>, <b>W<\/b> and <b>K<\/b> - the number of rows, columns and pieces respectively.<\/p>\n<p>Then <b>K<\/b> blocks, describing a piece follow.<\/p>\n<p>Each description starts with a line, containing a single integer <b>P<\/b>, denoting the number of cells that this piece cover.<\/p>\n<p>Then there are <b>P<\/b> lines, each contains a pair of integers <b>X, Y (1 &lt;= X &lt;= H, 1 &lt;= Y &lt;= W)<\/b>, denoting <b>1-based<\/b> coordinates of piece's cell in its' bounding box. That is, the minimal <b>X<\/b>-coordinate and the minimal <b>Y<\/b>-coordinate in each piece's description are both 1.<\/p>\n<p>All the pieces are identified by consecutive positive integers (starting from 1) in the order of input.<\/p>\n<h3>Output<\/h3>\n<p>Output <b>H<\/b> lines of <b>W<\/b> integers separated by a single space. The <b>j<\/b>-th integer in the <b>i<\/b>-th line should denote the identification number of piece that covers the respective cell, or 0 if the cell is not covered by any piece.<\/p>\n<h3>Test data information<\/h3>\n<p>There will be several groups in this problem (<b>20<\/b> test cases in total):<\/p>\n<p><ul>\n<li>The first group will contain <b>5<\/b> test cases. In these test cases, <b>W<\/b> and <b>H<\/b> will be chosen randomly between <b>10<\/b> and <b>50<\/b>. <b>K<\/b> will be chosen randomly between <b>W * H \/ 10<\/b> and <b>W * H \/ 2<\/b>, inclusively.<\/li>\n<li>The second group will contain <b>8<\/b> test cases. In these test cases, <b>W<\/b> and <b>H<\/b> will be chosen randomly between <b>100<\/b> and <b>200<\/b>. <b>K<\/b> will be chosen randomly between <b>W * H \/ 100<\/b> and <b>W * H \/ 34<\/b>, inclusively.<\/li>\n<li>The third group will contain <b>3<\/b> test cases. In these test cases, <b>W<\/b> and <b>H<\/b> will be chosen randomly between <b>600<\/b> and <b>800<\/b>. <b>K<\/b> will be chosen randomly between <b>W * H \/ 100<\/b> and <b>W * H \/ 34<\/b>, inclusively.<\/li>\n<li>The fourth group will contain <b>4<\/b> test cases. In these test cases, <b>W<\/b> and <b>H<\/b> will be chosen randomly between <b>500<\/b> and <b>1000<\/b>. <b>K<\/b> will be chosen randomly between <b>W * H \/ 50<\/b> and <b>W * H \/ 5<\/b>, inclusively.<\/li>\n<\/ul>\n<\/p>\n<p>In the test data provided, the maximal number of pixels in a piece and the minimal number of pixels in a piece will differ in no more than 3 times. That is, the <b>max_P - min_P &lt;= 3 * min_P<\/b>.<\/p>\n<h3>Scoring<\/h3>\n<p>Your score for the test case equals to the percentage of the matrix that is covered by pieces. Your score for the problem is the average of your scores for all the test cases. Pay attention that during the contest only the score on 20% of the test cases will be revealed. These 20% will contain <b>a single test case from each of the groups<\/b>.<\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n10 10 9\n8\n1 2\n2 2\n3 2\n4 2\n5 2\n6 2\n7 2\n7 1\n11\n1 7\n1 6\n2 5\n2 6\n5 3\n5 1\n5 2\n2 4\n3 4\n4 4\n5 4\n12\n4 3\n5 3\n5 1\n5 2\n1 2\n2 2\n2 1\n3 1\n3 2\n3 3\n4 1\n4 2\n8\n1 5\n2 5\n2 4\n3 4\n3 1\n4 1\n3 2\n3 3\n14\n2 4\n3 4\n2 3\n3 3\n4 3\n4 4\n1 2\n2 2\n2 1\n3 1\n1 3\n1 4\n1 5\n2 5\n9\n1 1\n2 1\n2 2\n2 3\n2 4\n2 5\n2 6\n1 6\n1 5\n14\n5 2\n5 3\n4 4\n5 4\n4 5\n4 6\n1 5\n2 5\n2 4\n3 4\n4 2\n4 1\n3 3\n4 3\n6\n1 2\n1 1\n1 3\n2 3\n2 1\n2 2\n18\n1 1\n1 2\n2 1\n3 1\n2 2\n2 3\n2 4\n2 5\n3 8\n3 7\n4 7\n4 6\n2 6\n3 6\n1 4\n1 3\n1 6\n1 5\n\n<b>Output:<\/b>\n0 1 8 8 8 0 0 2 2 0 \n0 1 8 8 8 2 2 2 3 0 \n0 1 0 0 0 2 0 3 3 0 \n0 1 0 0 0 2 0 3 3 3 \n0 1 2 2 2 2 4 3 3 3 \n0 1 0 0 0 4 4 3 3 3 \n1 1 4 4 4 4 5 5 5 5 \n0 0 4 0 0 5 5 5 5 5 \n0 0 0 0 0 5 0 5 5 0 \n0 0 0 0 0 0 0 5 5 0 \n<\/pre><p>\u00a0<\/p>\n<h3>Explanation<\/h3>\n<p>\n<b>How to assign coordinates to the pieces. ? <\/b> <\/p>\n<p>Let us consider the 6th piece. Its coordinates will be (1, 1), (1, 5), (1, 6), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6). You can notice that x coordinate will increase when you go towards south direction, your y coordinate will increase when you towards east direction.\n<\/p>\n<p><b>Another example:<\/b> <br \/>\nLet us consider this piece. <br \/>\n010 <br \/>\n110 <br \/>\n011 <\/p>\n<p>Its actual coordinates will be given you in row major in following way.<br \/>\n(1 2), (2 1), (2 2), (3 2), (3 3).\n<\/p>\n<p>This solution corresponding to given output would get 0.59 points.<\/p>\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, SCM chicken, CLOJ, FS","max_timelimit":"5","source_sizelimit":"50000","problem_author":"xcwgf666","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"16-01-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/challenge'>challenge<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/feb15'>feb15<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/xcwgf666'>xcwgf666<\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/CHPUZZLE","time":{"view_start_date":1424079000,"submit_start_date":1424079000,"visible_start_date":1424079000,"end_date":1735669800,"current":1525199659},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}