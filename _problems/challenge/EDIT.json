{"category_name":"challenge","status":"success","problem_code":"EDIT","problem_name":"Edit Distance Revisited","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/DEC16\/mandarin\/EDIT.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/DEC16\/russian\/EDIT.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/DEC16\/vietnamese\/EDIT.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Sergey has an uppercase Latin letter string <b>S<\/b>, which he wants to make equal to another uppercase Latin letter string <b>T<\/b>.<\/p>\n\n<p>However, he is only allowed to do the following kinds of operations on the string <b>S<\/b>:\n\n<ul>\n\t<li>To insert a symbol everywhere in the string <b>S<\/b> at any position. The operation costs <b>I<\/b> rubles.<\/li>\n\t<li>To delete a symbol from everywhere of the string <b>S<\/b>. The operation costs for <b>D<\/b> rubles.<\/li>\n\t<li>To replace one symbol in <b>S<\/b> with another one. This operation costs <b>R<sub>a, b<\/sub><\/b> rubles, where <b>x<\/b> is the old symbol and <b>y<\/b> is the new one.<\/li>\n\t<li>To swap any pair of symbols in the string <b>S<\/b>. This operation costs <b>W<\/b> rubles.<\/li>\n<\/ul>\n<\/p>\n\n<p>Sergey is a poor student, so he is looking for the cheapest way to obtain his target string <b>T<\/b>. Please help him! Note that in this problem, your solution doesn't have to be completely precise, but better approach will bring you more points.<\/p>\n\n<h3>Input<\/h3>\n<p>The first line of input contains a single integer <b>T<sub>n<\/sub><\/b>, denoting the number of test cases. Then, <b>T<sub>n<\/sub><\/b> description of test cases follow.<\/p>\n<p>The first line of every description contains a single uppercase Latin letter string <b>S<\/b>, denoting the string Sergey initially has.<\/p>\n<p>The next line contains a single uppercase Latin letter string <b>T<\/b>, denoting the string Sergey wants to obtain.<\/p>\n<p>The next line contains three space-separated integers <b>I<\/b>, <b>D<\/b>, <b>W<\/b>, denoting the cost of insertion, deletion and swap respectively.<\/p>\n<p>Each of the following <b>26<\/b> lines contains <b>26<\/b> integer numbers, denoting the matrix <b>R<sub>a, b<\/sub><\/b>. The <b>j<\/b><sup>th<\/sup> number in the <b>i<\/b><sup>th<\/sup> line denotes the cost of the replacement of the <b>i<\/b><sup>th<\/sup> Latin alphabet letter with the <b>j<\/b><sup>th<\/sup> Latin alphabet letter.<\/p>\n\n<h3>Output<\/h3>\n<p>For each test case, output the sequence of operations in the following form.<\/p>\n<p>On the first line output an integer <b>Q<\/b>, denoting the number of operations you're going to make. It shouldn't exceed <b>|S|+|T|<\/b>.<\/p>\n<p>On the following <b>Q<\/b> lines output the operations in the following format:\n\n<ul>\n\t<li><b>I p c<\/b>: insert the character <b>c<\/b> right after the <b>p<\/b><sup>th<\/sup> character (1-indexed). Use <b>p=0<\/b>, when you want to insert the character before all existing characters.<\/li>\n\t<li><b>D p<\/b>: delete the character on the <b>p<\/b><sup>th<\/sup> position (<b>1<\/b>-indexed) in the string.<\/li>\n\t<li><b>R p c<\/b>: replace the character on the <b>p<\/b><sup>th<\/sup> position with a character <b>c<\/b>.<\/li>\n\t<li><b>S i j<\/b>: swap the characters at the <b>i<\/b><sup>th<\/sup> and the <b>j<\/b><sup>th<\/sup> positions.<\/li>\n<\/ul>\n\n<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n\t<li>DataSet #1 (5 test files): <b>T<sub>n<\/sub><\/b> = <b>100<\/b>, <b>900<\/b> \u2264 <b>|S|, |T|<\/b> \u2264 <b>1000<\/b><\/li>\n\t<li>DataSet #2 (5 test files): <b>T<sub>n<\/sub><\/b> = <b>10<\/b>, <b>9000<\/b> \u2264 <b>|S|, |T|<\/b> \u2264 <b>10000<\/b><\/li>\n\t<li>DataSet #3 (5 test files): <b>T<sub>n<\/sub><\/b> = <b>2<\/b>, <b>45000<\/b> \u2264 <b>|S|, |T|<\/b> \u2264 <b>50000<\/b><\/li>\n\t<li>DataSet #4 (5 test files): <b>T<sub>n<\/sub><\/b> = <b>1<\/b>, <b>99000<\/b> \u2264 <b>|S|, |T|<\/b> \u2264 <b>100000<\/b><\/li>\n\t\n\t<li>Each character of <b>S<\/b> and <b>T<\/b> is chosen randomly from the set of uppercase Latin letters, independently of other characters.<\/li>\n\t<li>In all datasets the values of <b>|S|, |T|<\/b> are chosen randomly and independently from the allowed ranges.<\/li>\n\t<li><b>1000<\/b> \u2264 <b>R<sub>i, j<\/sub><\/b> \u2264 <b>10000<\/b>, <b>R<sub>i, i<\/sub><\/b> = <b>0<\/b>. Initially, the weights of <b>R<sub>i, j<\/sub><\/b> are picked from the specified range, and then the matrix <b>R<\/b> was replaced with its' transitive closure.<\/li>\n\t<li>The triangle inequality holds on the matrix <b>R<\/b>.<\/li>\n\t\t\n\t<li><b>R<sub>min<\/sub> \u00d7 1.5<\/b> \u2264 <b>I<\/b>, <b>D<\/b>, <b>W<\/b> \u2264 <b>R<sub>max<\/sub><\/b>. The values of <b>I<\/b>, <b>D<\/b>, <b>W<\/b> are chosen randomly and independently from the specified range.<\/li>\n<\/ul>\n\n<h3>Scoring<\/h3>\n<p>For every test case, your score will be equal to the sum of the costs of all the operations, divided by <b>|S| + |T|<\/b>.<\/p>\n<p>For every test file, your score will be equal to the average of the scores of all the test cases in this file.<\/p>\n\n<p>Please note that during the contest, score of your program will be decided by only 20% of the files, i.e. by 4 files, each from one group. However the verdict of your program will be based on all the test files, i.e. in order to get an AC, your program should work correctly on all the test files.<\/p>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n<tt>1\nJDCJPGROIE\nYFGWDIYAFVMMA\n23 32 4\n0 34 26 11 18 27 14 28 21 22 13 16 14 15 17 25 28 25 24 31 26 39 28 25 25 32\n17 0 18 24 23 21 20 22 24 23 29 11 20 18 13 24 21 21 27 23 27 11 10 13 24 16\n25 30 0 15 38 33 22 26 24 11 34 24 13 21 23 29 16 38 28 21 27 32 34 24 33 37\n26 27 22 0 38 37 28 17 25 11 29 37 20 26 30 25 31 34 13 26 26 30 20 16 25 25\n28 26 22 29 0 34 33 32 28 19 16 27 24 22 34 28 13 15 12 25 31 29 27 16 18 24\n23 22 21 18 22 0 21 25 16 16 26 33 10 26 20 29 22 22 26 26 11 29 20 25 23 29\n24 25 23 24 26 32 0 20 22 23 22 24 11 31 21 11 14 23 28 17 29 25 21 11 11 19\n27 16 24 30 29 24 23 0 13 13 12 23 22 12 29 31 31 22 22 13 25 20 26 25 34 32\n14 24 22 25 26 18 28 22 0 30 10 21 28 29 31 30 18 20 22 10 29 21 20 28 39 29\n15 19 11 26 27 37 29 26 29 0 28 30 24 30 28 18 27 30 18 28 36 30 27 18 29 26\n23 21 25 18 38 25 27 34 12 21 0 11 22 24 32 24 23 26 24 22 36 32 30 33 33 21\n12 36 30 17 30 14 26 31 13 26 23 0 24 23 29 13 30 16 30 23 25 34 19 26 22 27\n13 22 15 24 26 21 20 15 11 26 21 29 0 20 10 31 29 31 19 21 21 32 21 25 31 27\n27 34 29 23 34 12 11 28 25 28 32 34 14 0 24 19 25 24 33 23 13 28 22 13 22 23\n26 33 26 21 16 11 10 23 27 27 32 24 21 29 0 21 19 27 26 25 22 29 11 15 21 29\n16 26 31 14 25 29 26 28 11 22 21 24 30 23 33 0 27 12 27 21 26 32 16 28 11 27\n24 28 26 23 37 32 31 26 22 34 32 21 11 31 21 22 0 34 14 20 28 25 32 10 31 26\n25 23 21 29 33 36 39 20 33 10 32 34 23 32 33 28 27 0 28 26 16 31 33 16 24 36\n31 14 30 34 37 24 30 22 17 23 23 25 27 32 27 27 21 21 0 20 35 17 21 21 17 12\n33 19 31 22 34 21 26 23 28 31 26 30 29 31 32 20 27 21 26 0 30 11 16 32 31 24\n18 25 30 29 33 28 27 15 28 19 19 22 32 27 17 33 32 11 37 28 0 35 21 21 35 39\n33 27 31 28 32 10 28 23 26 20 33 25 20 35 27 28 26 10 24 24 19 0 30 26 33 13\n34 28 15 14 18 19 10 12 25 25 23 29 21 18 31 21 11 18 25 21 28 18 0 21 21 27\n28 23 35 13 31 25 25 30 23 24 33 34 33 35 28 12 34 24 26 10 18 15 26 0 23 28\n25 31 23 24 28 27 20 22 23 32 11 13 30 28 38 26 21 28 17 31 38 22 10 31 0 29\n26 14 22 29 25 13 33 33 26 11 34 25 23 32 27 15 32 16 11 14 24 23 23 27 26 0<\/tt>\n\n<b>Output:<\/b>\n<tt>13\nR 1 Y\nR 2 F\nR 3 G\nR 4 W\nR 5 D\nR 6 I\nR 7 Y\nR 8 A\nR 9 F\nR 10 V\nI 10 M\nI 11 M\nI 12 A<\/tt>\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>In this test case we have <b>10<\/b> \u2264 <b>R<sub>i, j<\/sub><\/b> \u2264  <b>100 (i \u2260 j)<\/b>. This is made only to fit the test case on the screen. In the actual test cases, the inequality <b>1000<\/b> \u2264 <b>R<sub>i, j<\/sub><\/b> \u2264 <b>10000<\/b> will hold.<\/p>\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, SCM chicken, CLOJ, FS","max_timelimit":"2","source_sizelimit":"50000","problem_author":"xcwgf666","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"5-11-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/xcwgf666'>xcwgf666<\/a>","time":{"view_start_date":1481535000,"submit_start_date":1481535000,"visible_start_date":1481535000,"end_date":1735669800,"current":1525199662},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}