{"category_name":"hard","status":"success","problem_code":"XRMTRX","problem_name":"Xor Matrix","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB15\/mandarin\/XRMTRX.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB15\/russian\/XRMTRX.pdf\">Russian<\/a>.<\/h3>\n<p>Let's consider a square matrix of size <b>N\u2009\u00d7\u2009N<\/b>, where <b>N = R \u2212\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad L + 1<\/b>. We will enumerate the columns of this matrix with consecutive integers from <b>L<\/b> to <b>R<\/b> (the leftmost column will be assigned number <b>L<\/b> and the rightmost - number <b>R<\/b>). In similar manner we will enumerate rows with the same integers (the top row will be assigned number <b>L<\/b> and the bottom row - number <b>R<\/b>).<\/p>\n<p>Every cell of this matrix has an integer written inside it. The cell at the intersection of row <b>X<\/b> and column <b>Y<\/b> has integer <b>(X <a href=\"http:\/\/en.wikipedia.org\/wiki\/Bitwise_operation#XOR\">xor<\/a> Y)<\/b> written inside.<\/p>\n<p>Two cells are called adjacent if and only if they have a common side. That way every inner cell have <b>4<\/b> neighbors and any of four corner cells have <b>2<\/b> neighbors.<\/p>\n<p>A walk is a sequence of cells <b>C<sub>0<\/sub>, C<sub>1<\/sub>, C<sub>2<\/sub>, ..., C<sub>K<\/sub><\/b>, where for every <b>1<\/b> \u2264 <b>i<\/b> \u2264 <b>K<\/b> the cells <b>C<sub>i-1<\/sub><\/b> and <b>C<sub>i<\/sub><\/b> are adjacent and for every <b>0<\/b> \u2264 <b>j<\/b> \u2264 <b>K<\/b> the number written inside cell <b>C<sub>j<\/sub><\/b> is equal <b>j<\/b>. The number <b>K<\/b> is the length of that walk.<\/p>\n<p>Your task is for given <b>L<\/b> and <b>R<\/b> values, find the maximal possible value of <b>K<\/b>, as well as the count <b>C<\/b> of different walks with that maximal length. As the value of <b>C<\/b> could be very large, output it modulo <b>(10<sup>9<\/sup> + 7)<\/b>.<\/p>\n<h3>Input<\/h3>\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. <br \/>\nThe description of <b>T<\/b> test cases follows. <br \/>\nFor each test case, the only line of input contains two integers <b>L<\/b> and <b>R<\/b>.<\/p>\n<h3>Output<\/h3>\n<p>For each test case, output a single line containing two integers <b>K<\/b> and <b>C<\/b>. <br \/>The value of <b>C<\/b> should be printed modulo <b>(10<sup>9<\/sup> + 7)<\/b>.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>20 000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>L<\/b> \u2264 <b>R<\/b> \u2264 <b>10<sup>18<\/sup><\/b><\/li>\n<\/ul>\n\n<h3>Subtasks<\/h3>\n<ul>\n<li>Subtask #1: <b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>500<\/b>; <b>0<\/b> \u2264 <b>R - L<\/b> \u2264 <b>300<\/b> (8 points)<\/li>\n<li>Subtask #2: original constraints, only the value of <b>K<\/b> will be checked. (24 points)<\/li>\n<li>Subtask #3: original constraints (68 points)<\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n4\n1 1\n1 2\n1 3\n2 3\n\n<b>Output:<\/b>\n0 1\n0 2\n3 4\n1 4\n<\/pre><p>\u00a0<\/p>\n<h3>Explanation<\/h3>\n<p><b>Example case 1.<\/b> The matrix contains just one cell, so, there is no possibility to make a single move, thus <b>K = 0<\/b>. We have just one possibility - to start the walk at the only cell and to end it immediately.<\/p>\n<p><b>Example case 2.<\/b> The matrix doesn't contains a cell with number one inside, so, there once again is no possibility to make a single move, thus <b>K = 0<\/b>. Our walk is just a single cell with number zero inside and there are two such cells, thus <b>C = 2<\/b>. The matrix in this case looks like this:<\/p>\n<pre>\n<b>(1 xor 1)   (1 xor 2)<\/b>          =          <b>0 3<\/b>\n<b>(2 xor 1)   (2 xor 2)<\/b>          =          <b>3 0<\/b>\n<\/pre>\n<p><b>Example case 3.<\/b> The four possible walks are:<\/p>\n<pre><font size=\"3\">0 <b><font color=\"#578fb2\">3 2<\/font><\/b>               0 <b><font color=\"#578fb2\">3 2<\/font><\/b>               0 3 2               0 3 2\n3 <b><font color=\"#578fb2\">0 1<\/font><\/b>               3 0 <b><font color=\"#578fb2\">1<\/font><\/b>               <b><font color=\"#578fb2\">3 0<\/font><\/b> 1               <b><font color=\"#578fb2\">3<\/font><\/b> 0 1\n2 1 0               2 1 <b><font color=\"#578fb2\">0<\/font><\/b>               <b><font color=\"#578fb2\">2 1<\/font><\/b> 0               <b><font color=\"#578fb2\">2 1 0<\/font><\/b>\n<\/font><\/pre>\n<p><b>Example case 4.<\/b> The four possible walks are:<\/p>\n<pre><font size=\"3\"><b><font color=\"#578fb2\">0 1<\/font><\/b>                   0 <b><font color=\"#578fb2\">1<\/font><\/b>                   <b><font color=\"#578fb2\">0<\/font><\/b> 1                   0 1\n1 0                   1 <b><font color=\"#578fb2\">0<\/font><\/b>                   <b><font color=\"#578fb2\">1<\/font><\/b> 0                   <b><font color=\"#578fb2\">1 0<\/font><\/b>\n<\/font><\/pre>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"2","source_sizelimit":"50000","problem_author":"alex_2oo8","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>alex_2oo8<\/span>","problem_tester":"pushkarmishra","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>pushkarmishra<\/span>","date_added":"13-01-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/ad-hoc'>\n                    ad-hoc\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/alex_2oo8'>\n                    alex_2oo8\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/feb15'>\n                    feb15\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/XRMTRX","user":{"username":null},"time":{"view_start_date":1424079000,"submit_start_date":1424079000,"visible_start_date":1424079000,"end_date":1735669800,"current":1493556902},"todo":false,"problem_status":"unattempted"}