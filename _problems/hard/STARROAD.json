{"category_name":"hard","status":"success","problem_code":"STARROAD","problem_name":"Roads in Stars","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MAY16\/mandarin\/STARROAD.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MAY16\/russian\/STARROAD.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MAY16\/vietnamese\/STARROAD.pdf\">Vietnamese<\/a> as well.<\/h3>\n<p>It is a period of civil war. Rebel spaceships, striking from a hidden base, have won their first victory against the evil Galactic Empire. <\/p>\n<p>In light of these events, Chef, the leader of the rebel alliance, wants to build safe connections in galaxy with <b>N<\/b> <b>stars<\/b>. There are <b>M<\/b> bidirectional <b>space roads<\/b> in space that connect pairs of stars together. Travelling through one space road takes 1 day. <\/p>\n<p>To avoid detection by the Empire, Chef decided that rebels must never travel alone. Instead, they must travel using armored rebel spaceships. Each spaceship is designated two stars, and a fixed route between these stars. A <b>route<\/b> is just a path composed of roads that connects two stars, but to increase security, Chef added the following restrictions on routes:<\/p>\n<ul>\n<li>Each route must be traversable within at most <b>K<\/b> days.<\/li>\n<li>Roads may be traversed any number times in a single route, in both directions.<\/li>\n<\/ul>\n<p><br \/><\/p>\n<p>After some time has passed, Chef and his engineers were able to <i>build a spaceship for every possible route between stars<\/i>.<\/p>\n<p>Unfortunately, the powerful Empire discovered this and plans to destroy these spaceships to maintain control of the galaxy. Specifically, they deployed a new superweapon called the Death Starkiller Base, which is able to destroy <b>X<\/b> spaceships at once! It works by analyzing all spaceships that pass through Empire-controlled star systems.<\/p>\n<p>Unfortunately, since the destruction of the Empire's two previous superweapons, the budget for the new superweapon is crippled, so the Death Starkiller Base has some severe restrictions:<\/p>\n<ul>\n<li>It can only destroy <b>exactly<\/b> <b>X<\/b> spaceships per usage. Not more, not less.<\/li>\n<li>It can only destroy a group of spaceships if they travel between the <i>same pair of stars<\/i>.<\/li>\n<\/ul>\n<p><br \/><\/p>\n<p>Despite these flaws, the Empire still used the superweapon as many times as possible, until there aren't enough groups of spaceships any more to destroy.<\/p>\n<p>To avoid more casualties, Chef decided to retire most of the surviving spaceships. Chef wants to retire as many spaceships as possible, but in order to stay connected, Chef wants to do this such that <i>there is still a way to get from any star to another using spaceships<\/i>. How many ways are there for Chef to retire spaceships so that this is satisfied?<\/p>\n<p>Note that a spaceship can only pick up or drop off people at the start or end of its journey, so a single spaceship that happens to pass through all stars isn't enough (unless there are only two stars).<\/p>\n<h3>Input<\/h3>\n<p>The first line of input contains four positive integers - <b>N<\/b>, <b>M<\/b>, <b>X<\/b>, <b>K<\/b>. The next <b>M<\/b> lines each contains two integers <b>U<\/b>, <b>V<\/b> stars which connect by space road. All space roads are pairwise distinct.<\/p>\n<h3>Output<\/h3>\n<p>Output a single line containing a single integer \u2014 the solution of Chef's problem.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>N<\/b> \u2264 100<\/li>\n<li>0 \u2264 <b>M<\/b> \u2264 <b>N<\/b>x<b>(N-1)<\/b>\/2<\/li>\n<li>1 \u2264 <b>K<\/b> \u2264 10<sup>18<sup><\/sup><\/sup><\/li>\n<li>1 \u2264 <b>X<\/b> \u2264 7777777<\/li>\n<li>1 \u2264 <b>U<\/b> &lt; <b>V<\/b> \u2264 <b>N<\/b> <\/li>\n<li> Each space road (<b>U<\/b>, <b>V<\/b>) will be in input at most once. <\/li>\n<\/ul>\n<h3>Subtasks<\/h3>\n<ul>\n<li><b>Subtask 1: (10 pts)<\/b> <b>N<\/b> \u2264 5.\n<\/li>\n<li><b>Subtask 2: (25 pts)<\/b> <b>N<\/b> \u2264 30.\n<\/li>\n<li><b>Subtask 3: (65 pts)<\/b> Original constraints.\n<\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre>\n<b>Input:<\/b>\n<tt>3 3 100 3\n1 2\n2 3\n3 1\n<\/tt>\n<b>Output:<\/b>\n<tt>75<\/tt>\n<\/pre>\n<pre>\n<b>Input:<\/b>\n<tt>3 3 2 3\n1 2\n2 3\n3 1\n<\/tt>\n<b>Output:<\/b>\n<tt>3<\/tt>\n<\/pre>\n<pre>\n<b>Input:<\/b>\n<tt>5 8 10000 1000000000\n4 5\n3 5\n1 4\n1 3\n2 3\n2 4\n1 2\n1 5\n<\/tt>\n<b>Output:<\/b>\n<tt>2220611572265625<\/tt>\n<\/pre><h3>Explanation:<\/h3>\n<p>\n<b>Example case 1.<\/b> There are five possible routes between stars 1 and 2 traversable in not more than 3 days: {1-2, 1-3-2, 1-2-1-2, 1-2-3-2, 1-3-1-2}. There are also five routes between stars 2 and 3, and also between stars 1 and 3. There are three possible plans for the remaining routes:<\/p>\n<ul>\n<li>A route remains between 1 and 2, and between 2 and 3. There are 5 x 5 = 25 ways to do this.<\/li>\n<li>A route remains between 2 and 3, and between 3 and 1. There are 5 x 5 = 25 ways to do this.<\/li>\n<li>A route remains between 3 and 1, and between 1 and 2. There are 5 x 5 = 25 ways to do this.<\/li>\n<\/ul>\n<p><br \/><\/p>\n<p>All in all, there are 25 + 25 + 25 = 75 plans.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"4","source_sizelimit":"50000","problem_author":"mgch","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>mgch<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"27-04-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/biginteger'>\n                    biginteger\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/chinese-rem'>\n                    chinese-rem\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>\n                    dynamic-programming\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/garner-algo'>\n                    garner-algo\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/matrix-expo'>\n                    matrix-expo\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/may16'>\n                    may16\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/mgch'>\n                    mgch\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/STARROAD","user":{"username":null},"time":{"view_start_date":1463391000,"submit_start_date":1463391000,"visible_start_date":1463391000,"end_date":1735669800,"current":1493556853},"todo":false,"problem_status":"unattempted"}