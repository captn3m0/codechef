{"category_name":"hard","status":"success","problem_code":"CHEFTRE","problem_name":"Chef and Tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/AUG16\/mandarin\/CHEFTRE.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/AUG16\/russian\/CHEFTRE.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/AUG16\/vietnamese\/CHEFTRE.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n\n\n<p>Chef likes trees a lot. Now he thinking about one interesting problem on trees. He finds the following problem interesting, and you? \n<\/p>\n\n<p>\nGiven a tree <b>T<\/b> and <b>Q<\/b> queries to it. Tree <b>T<\/b> has <b>N<\/b> nodes numbered from 1 to <b>N<\/b>. Each node <b>v<\/b> has a value <b>A<sub>v<\/sub><\/b> associated with it. Queries can be one of three types.\n<ul>\n<li><b>1 u v<\/b> - reverse the values on the path between vertices <b>u<\/b> and <b>v<\/b>.<\/li>\n<li><b>2 u<sub>l<\/sub> u<sub>r<\/sub> v<sub>l<\/sub> v<sub>r<\/sub><\/b> - print \"Yes\" if all the values on the path from <b>u<sub>l<\/sub><\/b> to  <b>u<sub>r<\/sub><\/b> are exactly same as that of path from  <b>v<sub>l<\/sub><\/b> to <b>v<sub>r<\/sub><\/b>, and \"No\" otherwise. It is ensured that length of both the paths are same.<\/li>\n<li><b>3 u<sub>l<\/sub> u<sub>r<\/sub> v<sub>l<\/sub> v<sub>r<\/sub><\/b> - Copy all values on path from <b>u<sub>l<\/sub><\/b> to  <b>u<sub>r<\/sub><\/b> and insert them into the path from <b>v<sub>l<\/sub><\/b> to <b>v<sub>r<\/sub><\/b>. It is ensured that length of both the paths are same.<\/li>\n<\/ul>\n<\/p>\n\n<h3>Input<\/h3>\n<p>The first line contains two integers <b>N<\/b> and <b>Q<\/b>. <\/p>\n<p>The second line contains <b>N<\/b> space-separeted integers denoting <b>A<sub>v<\/sub><\/b> - the values associated with nodes.<\/p>\n<p>Next <b>N-1<\/b> lines contains two space-separeted integers <b>u<\/b>, <b>v<\/b> denoting the nodes connected by an edge.<\/p>\n<p>Next <b>Q<\/b> lines contains queries as described above.<\/p>\n\n\n<h3>Output<\/h3>\n<p>For each query of second type output your answer in a single line.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>N, Q<\/b> \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>A<sub>i<\/sub><\/b> \u2264 <b>10<sup>3<\/sup><\/b>\n<li><b>1<\/b> \u2264 <b>u, v, u<sub>l<\/sub>, u<sub>r<\/sub>, v<sub>l<\/sub>, v<sub>r<\/sub><\/b> \u2264 <b>N<\/b><\/li>\n<\/ul>\n\n<h3>Subtasks<\/h3>\n<ul>\n<li><b>Subtask 1: (21 pts)<\/b> <b>N, Q<\/b> \u2264 25000.\n<\/li>\n<li><b>Subtask 2: (79 pts)<\/b> Original constraints. \n<\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n<tt>5 8\n1 2 3 4 5\n1 2\n1 3\n2 4\n2 5\n2 1 3 1 2\n3 1 1 2 2\n3 1 1 3 3\n2 1 3 1 2\n1 2 5\n2 1 3 1 2\n1 2 5\n2 1 3 1 2<\/tt>\n\n<b>Output:<\/b>\n<tt>No\nYes\nNo\nYes<\/tt>\n<\/pre>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"9","source_sizelimit":"50000","problem_author":"mgch","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>mgch<\/span>","problem_tester":"xcwgf666","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","date_added":"13-07-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/aug16'>\n                    aug16\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/decomposition'>\n                    decomposition\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/heavy-light'>\n                    heavy-light\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/mgch'>\n                    mgch\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>\n                    segment-tree\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/CHEFTRE","user":{"username":null},"time":{"view_start_date":1471253400,"submit_start_date":1471253400,"visible_start_date":1471253400,"end_date":1735669800,"current":1493556640},"todo":false,"problem_status":"unattempted"}