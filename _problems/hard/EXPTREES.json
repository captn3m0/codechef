{"category_name":"hard","status":"success","problem_code":"EXPTREES","problem_name":"Expected Spanning Trees","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JULY20\/hindi\/EXPTREES.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY20\/bengali\/EXPTREES.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY20\/mandarin\/EXPTREES.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY20\/russian\/EXPTREES.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY20\/vietnamese\/EXPTREES.pdf) as well.\r\n\r\nYou are given a simple undirected graph $G$ with $N$ vertices (numbered $1$ through $N$) and $M$ edges. Consider the following process performed for a fixed number of seconds:\r\n- Each second, choose an unordered pair of vertices $(a, b)$ uniformly randomly (there are $N (N - 1) \/ 2$ such pairs).\r\n- If the edge $(a, b)$ is present in the graph, remove it. Otherwise, add it to the graph.\r\n\r\nWe are interested in the number of spanning trees in the resulting graph. Two spanning trees are distinct if they contain different sets of edges. Note that the resulting graph may be disconnected, in which case the number of spanning trees is $0$. The initial graph does not have to be connected either.\r\n\r\nYou should answer $Q$ queries. In each query, you are given a time $T$ and you have to find the expected number of spanning trees in the graph after the process described above is performed for $T$ seconds, modulo $10^9 + 7$.\r\n\r\n### Input\r\n- The first line of the input contains three space-separated integers $N, M$ and $Q$.\r\n- Each of the next $M$ lines contains two space-separated integers $u$ and $v$ denoting that vertices $u$ and $v$ are connected by an edge.\r\n- Each of the next $Q$ lines contains a single integer $T$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the expected number of spanning trees modulo $10^9 + 7$.\r\n\r\n### Constraints\r\n- $1 \\le N \\le 100$\r\n- $0 \\le M \\le N(N - 1) \/ 2$\r\n- $1 \\le u, v \\le N$\r\n- the graph described on the input does not contain any parallel edges or self-loops\r\n- $1 \\le Q \\le 10^5$\r\n- $0 \\le T \\le 10^{18}$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $N \\le 8$\r\n- $Q \\le 100$\r\n- $T \\le 100$\r\n\r\n**Subtask #2 (10 points):**\r\n- $Q \\le 100$\r\n- $T \\le 100$\r\n\r\n**Subtask #3 (25 points):** $Q \\le 100$\r\n\r\n**Subtask #4 (55 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n3 2 4\r\n1 2\r\n2 3\r\n0\r\n1\r\n2\r\n3\r\n```\r\n\r\n### Example Output\r\n```\r\n1\r\n1\r\n777777784\r\n777777784\r\n```\r\n\r\n### Explanation\r\nInitially, the graph is a tree, so it has a single spanning tree, so the answer to the first query is $1$.\r\n\r\nAfter one second, exactly one edge has been \"toggled\". If this edge was initially present in the graph (with probability $2 \/ 3$), we have no spanning tree afterwards, otherwise (with probability $1 \/ 3$) we have $3$ spanning trees (since we get a complete graph on $3$ vertices). The expected value is still $1$.\r\n\r\nBoth after two seconds and after three seconds, the expected number of spanning trees is $\\frac{7}{9}$. The multiplicative inverse of $9$ modulo $10^9 + 7$ is $111,111,112$. Therefore, we print $7 \\cdot 111,111,112$ modulo $10^9 + 7$, which is $777,777,784$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JULY20\/hindi\/EXPTREES.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY20\/bengali\/EXPTREES.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY20\/mandarin\/EXPTREES.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY20\/russian\/EXPTREES.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY20\/vietnamese\/EXPTREES.pdf) as well.\r\n\r\nYou are given a simple undirected graph $G$ with $N$ vertices (numbered $1$ through $N$) and $M$ edges. Consider the following process performed for a fixed number of seconds:\r\n- Each second, choose an unordered pair of vertices $(a, b)$ uniformly randomly (there are $N (N - 1) \/ 2$ such pairs).\r\n- If the edge $(a, b)$ is present in the graph, remove it. Otherwise, add it to the graph.\r\n\r\nWe are interested in the number of spanning trees in the resulting graph. Two spanning trees are distinct if they contain different sets of edges. Note that the resulting graph may be disconnected, in which case the number of spanning trees is $0$. The initial graph does not have to be connected either.\r\n\r\nYou should answer $Q$ queries. In each query, you are given a time $T$ and you have to find the expected number of spanning trees in the graph after the process described above is performed for $T$ seconds, modulo $10^9 + 7$.\r\n\r\n### Input\r\n- The first line of the input contains three space-separated integers $N, M$ and $Q$.\r\n- Each of the next $M$ lines contains two space-separated integers $u$ and $v$ denoting that vertices $u$ and $v$ are connected by an edge.\r\n- Each of the next $Q$ lines contains a single integer $T$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the expected number of spanning trees modulo $10^9 + 7$.\r\n\r\n### Constraints\r\n- $1 \\le N \\le 100$\r\n- $0 \\le M \\le N(N - 1) \/ 2$\r\n- $1 \\le u, v \\le N$\r\n- the graph described on the input does not contain any parallel edges or self-loops\r\n- $1 \\le Q \\le 10^5$\r\n- $0 \\le T \\le 10^{18}$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $N \\le 8$\r\n- $Q \\le 100$\r\n- $T \\le 100$\r\n\r\n**Subtask #2 (10 points):**\r\n- $Q \\le 100$\r\n- $T \\le 100$\r\n\r\n**Subtask #3 (25 points):** $Q \\le 100$\r\n\r\n**Subtask #4 (55 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3 2 4\r\n1 2\r\n2 3\r\n0\r\n1\r\n2\r\n3","output":"1\r\n1\r\n777777784\r\n777777784","explanation":"Initially, the graph is a tree, so it has a single spanning tree, so the answer to the first query is $1$.\r\n\r\nAfter one second, exactly one edge has been \"toggled\". If this edge was initially present in the graph (with probability $2 \/ 3$), we have no spanning tree afterwards, otherwise (with probability $1 \/ 3$) we have $3$ spanning trees (since we get a complete graph on $3$ vertices). The expected value is still $1$.\r\n\r\nBoth after two seconds and after three seconds, the expected number of spanning trees is $\\frac{7}{9}$. The multiplicative inverse of $9$ modulo $10^9 + 7$ is $111,111,112$. Therefore, we print $7 \\cdot 111,111,112$ modulo $10^9 + 7$, which is $777,777,784$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"4","source_sizelimit":"50000","problem_author":"jtnydv25","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>jtnydv25<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"15-06-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jtnydv25'>jtnydv25<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jtnydv25'>jtnydv25<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/july20'>july20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/math'>math<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/EXPTREES","time":{"view_start_date":1136053800,"submit_start_date":1136053800,"visible_start_date":1136053800,"end_date":1735669800,"current":1643797995},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=EXPTREES","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}