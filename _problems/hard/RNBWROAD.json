{"category_name":"hard","status":"success","problem_code":"RNBWROAD","problem_name":"Chef and Rainbow Road","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MAY20\/hindi\/RNBWROAD.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MAY20\/bengali\/RNBWROAD.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/mandarin\/RNBWROAD.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MAY20\/russian\/RNBWROAD.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/vietnamese\/RNBWROAD.pdf) as well.\r\n\r\nChef was relaxing outdoors after a poor performance during his university varsity's yearly week-long training retreat in the mountains. He was looking for a sign that he should continue competitive programming, even though at times, it can feel insurmountably difficult. Then, he looked up and saw a dazzling rainbow in the sky. He was so moved by the beauty of nature that he decided to continue programming and even created this problem about a mathematical Rainbow Road.\r\n\r\nLet the Rainbow Road be a grid with $M$ rows (numbered $1$ through $M$ from top to bottom) and $N$ columns (numbered $1$ through $N$ from left to right). Let's denote a cell in row $i$ and column $j$ by $(i,j)$, i.e. $(1,1)$ is the cell in the top left corner and $(M,N)$ is the cell in the bottom right corner. Chef selected $N$ distinct positive integers $a_1, a_2, \\ldots, a_N$ and instead of using colours, he \"painted\" stripes on the road with these numbers. For each valid $j$, each cell in column $j$ has the same value $a_j$.\r\n\r\nYou should answer $Q$ queries. In each query:\r\n- You are given an integer $K$. Chef wants to travel from the cell $(1,1)$ to the cell $(K,N)$.\r\n- It is only possible to travel from any cell to the cell directly below it or to the cell directly to the right (if they exist). Formally, if Chef is in a cell $(i,j)$, he may only travel to $(i+1,j)$ or $(i,j+1)$.\r\n- Let's define a *path* as a sequence of cells $c_1, c_2, \\ldots, c_s$ such that for each $i$ ($1 \\le i \\lt s$), Chef can travel from the cell $c_i$ to the cell $c_{i+1}$.\r\n- The *weight* of a path is the product of the values of all cells in that path.\r\n- Chef wants you to find the sum of the weights of all possible paths that start in the cell $(1,1)$ and end in the cell $(K,N)$. Since this number can be quite large, compute it modulo $998,244,353 = 7 \\cdot 17 \\cdot 2^{23}+1$ (a prime number).\r\n\r\n### Input\r\n- The first line of the input contains three space-separated integers $M$, $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$.\r\n- $Q$ lines follow. Each of these lines contains a single integer $K$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the sum of weights of paths modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le M \\le 10^{18}$\r\n- $1 \\le N \\le 10^5$ \r\n- $1 \\le Q \\le 10^5$\r\n- $1 \\le a_i \\lt 998,244,353$ for each valid $i$\r\n- $a_1, a_2, \\ldots, a_N$ are pairwise distinct\r\n- $1 \\le K \\le M$\r\n\r\n### Subtasks\r\n**Subtask 1 (10 points):** $M, N \\le 2,000$\r\n\r\n**Subtask 2 (25 points):** $M \\le 10^5$\r\n\r\n**Subtask 3 (15 points):**\r\n- $Q \\le 10$\r\n- $N \\le 2,000$\r\n\r\n**Subtask 4 (50 points):** $Q \\le 10$\r\n\r\n### Example Input 1\r\n```\r\n2 3 2\r\n1 3 5\r\n1\r\n2\r\n```\r\n\r\n### Example Output 1\r\n```\r\n15\r\n135\r\n```\r\n\r\n### Explanation\r\nIn the first query, there is only one path from $(1,1)$ to $(1,3)$: $(1,1) \\rightarrow (1,2) \\rightarrow (1,3)$. This path has weight $1 \\cdot 3 \\cdot 5 = 15$.\r\n\r\nIn the second query, there are three paths from $(1,1)$ to $(2,3)$:\r\n- $(1,1) \\rightarrow (1,2) \\rightarrow (1,3) \\rightarrow (2,3)$ with weight $1 \\cdot 3 \\cdot 5 \\cdot 5 = 75$.\r\n- $(1,1) \\rightarrow (1,2) \\rightarrow (2,2) \\rightarrow (2,3)$ with weight $1 \\cdot 3 \\cdot 3 \\cdot 5 = 45$.\r\n- $(1,1) \\rightarrow (2,1) \\rightarrow (2,2) \\rightarrow (2,3)$ with weight $1 \\cdot 1 \\cdot 3 \\cdot 5 = 15$.\r\n\r\n### Example Input 2\r\n```\r\n5 2 5\r\n1 2\r\n1\r\n2\r\n3\r\n4\r\n5\r\n```\r\n\r\n### Example Output 2\r\n```\r\n2\r\n6\r\n14\r\n30\r\n62\r\n```\r\n\r\n### Explanation\r\nIn the last query, there are five paths from $(1,1)$ to $(5,2)$. Their weights are $2$, $4$, $8$, $16$ and $32$, which sum up to $62$.\r\n\r\n### Example Input 3\r\n```\r\n3 3 3\r\n215 228 229\r\n1\r\n2\r\n3\r\n```\r\n\r\n### Example Output 3\r\n```\r\n11225580\r\n555879289\r\n157593602\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MAY20\/hindi\/RNBWROAD.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MAY20\/bengali\/RNBWROAD.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/mandarin\/RNBWROAD.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MAY20\/russian\/RNBWROAD.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/vietnamese\/RNBWROAD.pdf) as well.\r\n\r\nChef was relaxing outdoors after a poor performance during his university varsity's yearly week-long training retreat in the mountains. He was looking for a sign that he should continue competitive programming, even though at times, it can feel insurmountably difficult. Then, he looked up and saw a dazzling rainbow in the sky. He was so moved by the beauty of nature that he decided to continue programming and even created this problem about a mathematical Rainbow Road.\r\n\r\nLet the Rainbow Road be a grid with $M$ rows (numbered $1$ through $M$ from top to bottom) and $N$ columns (numbered $1$ through $N$ from left to right). Let's denote a cell in row $i$ and column $j$ by $(i,j)$, i.e. $(1,1)$ is the cell in the top left corner and $(M,N)$ is the cell in the bottom right corner. Chef selected $N$ distinct positive integers $a_1, a_2, \\ldots, a_N$ and instead of using colours, he \"painted\" stripes on the road with these numbers. For each valid $j$, each cell in column $j$ has the same value $a_j$.\r\n\r\nYou should answer $Q$ queries. In each query:\r\n- You are given an integer $K$. Chef wants to travel from the cell $(1,1)$ to the cell $(K,N)$.\r\n- It is only possible to travel from any cell to the cell directly below it or to the cell directly to the right (if they exist). Formally, if Chef is in a cell $(i,j)$, he may only travel to $(i+1,j)$ or $(i,j+1)$.\r\n- Let's define a *path* as a sequence of cells $c_1, c_2, \\ldots, c_s$ such that for each $i$ ($1 \\le i \\lt s$), Chef can travel from the cell $c_i$ to the cell $c_{i+1}$.\r\n- The *weight* of a path is the product of the values of all cells in that path.\r\n- Chef wants you to find the sum of the weights of all possible paths that start in the cell $(1,1)$ and end in the cell $(K,N)$. Since this number can be quite large, compute it modulo $998,244,353 = 7 \\cdot 17 \\cdot 2^{23}+1$ (a prime number).\r\n\r\n### Input\r\n- The first line of the input contains three space-separated integers $M$, $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$.\r\n- $Q$ lines follow. Each of these lines contains a single integer $K$ describing a query.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the sum of weights of paths modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le M \\le 10^{18}$\r\n- $1 \\le N \\le 10^5$ \r\n- $1 \\le Q \\le 10^5$\r\n- $1 \\le a_i \\lt 998,244,353$ for each valid $i$\r\n- $a_1, a_2, \\ldots, a_N$ are pairwise distinct\r\n- $1 \\le K \\le M$\r\n\r\n### Subtasks\r\n**Subtask 1 (10 points):** $M, N \\le 2,000$\r\n\r\n**Subtask 2 (25 points):** $M \\le 10^5$\r\n\r\n**Subtask 3 (15 points):**\r\n- $Q \\le 10$\r\n- $N \\le 2,000$\r\n\r\n**Subtask 4 (50 points):** $Q \\le 10$\r\n\r\n### Example Input 1\r\n```\r\n2 3 2\r\n1 3 5\r\n1\r\n2\r\n```\r\n\r\n### Example Output 1\r\n```\r\n15\r\n135\r\n```\r\n\r\n### Explanation\r\nIn the first query, there is only one path from $(1,1)$ to $(1,3)$: $(1,1) \\rightarrow (1,2) \\rightarrow (1,3)$. This path has weight $1 \\cdot 3 \\cdot 5 = 15$.\r\n\r\nIn the second query, there are three paths from $(1,1)$ to $(2,3)$:\r\n- $(1,1) \\rightarrow (1,2) \\rightarrow (1,3) \\rightarrow (2,3)$ with weight $1 \\cdot 3 \\cdot 5 \\cdot 5 = 75$.\r\n- $(1,1) \\rightarrow (1,2) \\rightarrow (2,2) \\rightarrow (2,3)$ with weight $1 \\cdot 3 \\cdot 3 \\cdot 5 = 45$.\r\n- $(1,1) \\rightarrow (2,1) \\rightarrow (2,2) \\rightarrow (2,3)$ with weight $1 \\cdot 1 \\cdot 3 \\cdot 5 = 15$.\r\n\r\n### Example Input 2\r\n```\r\n5 2 5\r\n1 2\r\n1\r\n2\r\n3\r\n4\r\n5\r\n```\r\n\r\n### Example Output 2\r\n```\r\n2\r\n6\r\n14\r\n30\r\n62\r\n```\r\n\r\n### Explanation\r\nIn the last query, there are five paths from $(1,1)$ to $(5,2)$. Their weights are $2$, $4$, $8$, $16$ and $32$, which sum up to $62$.\r\n\r\n### Example Input 3\r\n```\r\n3 3 3\r\n215 228 229\r\n1\r\n2\r\n3\r\n```\r\n\r\n### Example Output 3\r\n```\r\n11225580\r\n555879289\r\n157593602\r\n```\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"7","source_sizelimit":"50000","problem_author":"shisuko","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span class='m-username--link'>shisuko<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"29-03-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/fast-fourier-transform'>fast-fourier-transform<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/generating-functions'>generating-functions<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/math'>math<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/may20'>may20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/polynomial'>polynomial<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/shisuko'>shisuko<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/shisuko'>shisuko<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Generating Functions","editorial_url":"https:\/\/discuss.codechef.com\/problems\/RNBWROAD","time":{"view_start_date":1589189402,"submit_start_date":1589189402,"visible_start_date":1589189402,"end_date":1735669800,"current":1643798001},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=RNBWROAD","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}