{"category_name":"hard","status":"success","problem_code":"TRIPWAYS","problem_name":"A Leisurely Journey","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/APRIL20\/hindi\/TRIPWAYS.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/APRIL20\/bengali\/TRIPWAYS.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/APRIL20\/mandarin\/TRIPWAYS.pdf), and [Russian](https:\/\/www.codechef.com\/download\/translated\/APRIL20\/russian\/TRIPWAYS.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/APRIL20\/vietnamese\/TRIPWAYS.pdf) as well. \r\n\r\nChef recently accepted a teaching fellowship at a prestigious culinary institution. The fellowship does not begin for a while yet, so Chef wants to use the remaining free time for a nice vacation. There are $N$ cities (numbered $1$ through $N$) connected by $M$ roads. For each valid $i$, there are $L_i$ tourist attractions in city $i$. Chef is initially in city $1$ and he will teach in city $N$. On each day of his vacation, Chef wants to perform one of the following actions:\r\n- Travel to a city with a higher number than his current city which is directly connected to his current city by a road. At the end of his vacation, Chef must be in city $N$.\r\n- Visit a tourist attraction in his current city. Chef may visit each tourist attraction repeatedly (on different days).\r\n\r\nChef has not yet decided for how many days the vacation should last. He has $Q$ queries described by a sequence $D_1, D_2, \\ldots, D_Q$. For each query, i.e. for each $i$ ($1 \\le i \\le Q$), he would like to know the number of different vacation plans if he wants his vacation to last exactly $D_i$ days. Since these numbers may be large, compute them modulo $1,000,000,007$.\r\n\r\nTwo vacation plans (for a fixed duration of the vacation) are considered different if there is at least one day such that Chef performs different actions in the two plans on that day. Visiting different tourist attractions also counts as different actions.\r\n\r\n### Input\r\n- The first line of the input contains three space-separated integers $N$, $M$ and $Q$.\r\n- The second line contains $N$ space-separated integers $L_1, L_2, \\ldots, L_N$.\r\n- Each of the next $M$ lines contains two space-separated integers $u$ and $v$ denoting that cities $u$ and $v$ are connected by a road.\r\n- The last line contains $Q$ space-separated integers $D_1, D_2, \\ldots, D_Q$.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the number of possible vacations modulo $1,000,000,007$.\r\n\r\n### Constraints\r\n- $1 \\le N \\le 4,000$\r\n- $1 \\le M \\le 10^5$\r\n- $1 \\le Q \\le 500$\r\n- $1 \\le L_i \\le 10^5$ for each valid $i$\r\n- $1 \\le u \\lt v \\le N$\r\n- $1 \\le D_i \\le 10^{18}$ for each valid $i$\r\n\r\n### Subtasks\r\n**Subtask #1 (5 points):** $D_i \\le 2,000$ for each valid $i$\r\n\r\n**Subtask #2 (10 points):** $N \\le 10$\r\n\r\n**Subtask #3 (20 points):**\r\n- $N \\le 1,500$\r\n- $D_i \\le 50,000$ for each valid $i$\r\n\r\n**Subtask #4 (20 points):** $N \\le 100$\r\n\r\n**Subtask #5 (45 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n4 4 4\r\n2 6 6 7\r\n1 2\r\n1 3\r\n2 4\r\n3 4\r\n1 2 3 4\r\n```\r\n\r\n### Example Output\r\n```\r\n0\r\n2\r\n30\r\n314\r\n```\r\n\r\n### Explanation\r\nSince there is no road directly connecting city $1$ to city $4$, there are no valid vacations that only last 1 day, so the answer to the first query is $0$.\r\n\r\nThere are two ways to get to city $4$ in 2 days \u2015 either travel from city $1$ to city $2$ on the first day and from city $2$ to city $4$ on the second day, or travel from city $1$ to city $3$ on the first day and from city $3$ to city $4$ on the second day. Neither option gives Chef any time for sightseeing, though.\r\n\r\nWith 3 days, Chef can spend one day at a tourist attraction and the other two days travelling, with 30 possible trips in total.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/APRIL20\/hindi\/TRIPWAYS.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/APRIL20\/bengali\/TRIPWAYS.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/APRIL20\/mandarin\/TRIPWAYS.pdf), and [Russian](https:\/\/www.codechef.com\/download\/translated\/APRIL20\/russian\/TRIPWAYS.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/APRIL20\/vietnamese\/TRIPWAYS.pdf) as well. \r\n\r\nChef recently accepted a teaching fellowship at a prestigious culinary institution. The fellowship does not begin for a while yet, so Chef wants to use the remaining free time for a nice vacation. There are $N$ cities (numbered $1$ through $N$) connected by $M$ roads. For each valid $i$, there are $L_i$ tourist attractions in city $i$. Chef is initially in city $1$ and he will teach in city $N$. On each day of his vacation, Chef wants to perform one of the following actions:\r\n- Travel to a city with a higher number than his current city which is directly connected to his current city by a road. At the end of his vacation, Chef must be in city $N$.\r\n- Visit a tourist attraction in his current city. Chef may visit each tourist attraction repeatedly (on different days).\r\n\r\nChef has not yet decided for how many days the vacation should last. He has $Q$ queries described by a sequence $D_1, D_2, \\ldots, D_Q$. For each query, i.e. for each $i$ ($1 \\le i \\le Q$), he would like to know the number of different vacation plans if he wants his vacation to last exactly $D_i$ days. Since these numbers may be large, compute them modulo $1,000,000,007$.\r\n\r\nTwo vacation plans (for a fixed duration of the vacation) are considered different if there is at least one day such that Chef performs different actions in the two plans on that day. Visiting different tourist attractions also counts as different actions.\r\n\r\n### Input\r\n- The first line of the input contains three space-separated integers $N$, $M$ and $Q$.\r\n- The second line contains $N$ space-separated integers $L_1, L_2, \\ldots, L_N$.\r\n- Each of the next $M$ lines contains two space-separated integers $u$ and $v$ denoting that cities $u$ and $v$ are connected by a road.\r\n- The last line contains $Q$ space-separated integers $D_1, D_2, \\ldots, D_Q$.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the number of possible vacations modulo $1,000,000,007$.\r\n\r\n### Constraints\r\n- $1 \\le N \\le 4,000$\r\n- $1 \\le M \\le 10^5$\r\n- $1 \\le Q \\le 500$\r\n- $1 \\le L_i \\le 10^5$ for each valid $i$\r\n- $1 \\le u \\lt v \\le N$\r\n- $1 \\le D_i \\le 10^{18}$ for each valid $i$\r\n\r\n### Subtasks\r\n**Subtask #1 (5 points):** $D_i \\le 2,000$ for each valid $i$\r\n\r\n**Subtask #2 (10 points):** $N \\le 10$\r\n\r\n**Subtask #3 (20 points):**\r\n- $N \\le 1,500$\r\n- $D_i \\le 50,000$ for each valid $i$\r\n\r\n**Subtask #4 (20 points):** $N \\le 100$\r\n\r\n**Subtask #5 (45 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"4 4 4\r\n2 6 6 7\r\n1 2\r\n1 3\r\n2 4\r\n3 4\r\n1 2 3 4","output":"0\r\n2\r\n30\r\n314","explanation":"Since there is no road directly connecting city $1$ to city $4$, there are no valid vacations that only last 1 day, so the answer to the first query is $0$.\r\n\r\nThere are two ways to get to city $4$ in 2 days ? either travel from city $1$ to city $2$ on the first day and from city $2$ to city $4$ on the second day, or travel from city $1$ to city $3$ on the first day and from city $3$ to city $4$ on the second day. Neither option gives Chef any time for sightseeing, though.\r\n\r\nWith 3 days, Chef can spend one day at a tourist attraction and the other two days travelling, with 30 possible trips in total.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"david_adm","problem_author_html_handle":"david_adm","problem_tester":"","problem_tester_html_handle":"","date_added":"17-02-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/april20'>april20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/david_adm'>david_adm<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/generating-functions'>generating-functions<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/recurrence'>recurrence<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Generating Functions","editorial_url":"https:\/\/discuss.codechef.com\/problems\/TRIPWAYS","time":{"view_start_date":1586779202,"submit_start_date":1586779202,"visible_start_date":1586779202,"end_date":1735669800,"current":1643798002},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=TRIPWAYS","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}