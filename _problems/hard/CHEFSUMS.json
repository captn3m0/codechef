{"category_name":"hard","status":"success","problem_code":"CHEFSUMS","problem_name":"Chef and Sums","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/SEPT20\/hindi\/CHEFSUMS.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/SEPT20\/bengali\/CHEFSUMS.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/SEPT20\/mandarin\/CHEFSUMS.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/SEPT20\/russian\/CHEFSUMS.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/SEPT20\/vietnamese\/CHEFSUMS.pdf) as well.\r\n\r\nChef gave you a sequence of integers $a_1, a_2, \\dots, a_N$ and $3$ integers $K$, $m$ and $x$. Let's define the following functions:\r\n$$G(i_1, \\ldots, i_K) = \\mathrm{gcd}\\left(a_{i_1}, \\dots, a_{i_K}\\right)$$\r\n$$S_x(i_1, \\ldots, i_K) = a_{i_1}^x + a_{i_2}^x + \\ldots + a_{i_K}^x$$\r\n$$P_m(i_1, \\ldots, i_K) = \\left(a_{i_1} \\cdot a_{i_2} \\cdot \\ldots \\cdot a_{i_K}\\right)^m$$\r\n$$W(T) = \\mathrm{smallest\\,\\, prime\\,\\, divisor\\,\\, of\\,\\, } P_1(T)$$\r\n\r\nChef wants you to compute the sum of $G(T) \\cdot W(T) \\cdot S_x(T) \\cdot P_m(T)$ over all $K$-tuples of indices $T = (i_1, i_2, \\ldots, i_K)$ such that $i_j \\in \\{1, 2, \\ldots, N\\}$ for each valid $j$ (there are $N^K$ of these $K$-tuples). Since this sum could be enormous, compute it modulo $10^9 + 7$.\r\n\r\n### Input\r\n- The first line of the input contains four space-separated integers $N$, $K$, $m$ and $x$.\r\n- The second line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$.\r\n\r\n### Output\r\nPrint a single line containing one integer $\\sum_T G(T) \\cdot W(T) \\cdot S_x(T) \\cdot P_m(T)$ modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le N \\le 10^6$\r\n- $1 \\le K, m, x \\le 10^{18}$\r\n- $2 \\le a_i \\le 10^6$ for each valid $i$\r\n\r\n### Subtasks\r\n**Subtask #1 (5 points):**\r\n- $N \\le 10$\r\n- $K \\le 6$\r\n\r\n**Subtask #2 (20 points):** for each valid $i$, $a_i$ is even\r\n\r\n**Subtask #3 (75 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n3 2 1 1\r\n2 3 4\r\n```\r\n\r\n### Example Output\r\n```\r\n2414\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** We have $N^K = 3^2 = 9$ possible pairs $T$ of indices. The corresponding summands are:\r\n- $T = (1, 1)$: $\\mathrm{gcd}(2, 2) \\cdot (2^1 + 2^1) \\cdot (2 \\cdot 2)^1 \\cdot 2 = 64$\r\n- $T = (1, 2)$: $\\mathrm{gcd}(2, 3) \\cdot (2^1 + 3^1) \\cdot (2 \\cdot 3)^1 \\cdot 2 = 60$\r\n- $T = (1, 3)$: $\\mathrm{gcd}(2, 4) \\cdot (2^1 + 4^1) \\cdot (2 \\cdot 4)^1 \\cdot 2 = 192$\r\n- $T = (2, 1)$: $\\mathrm{gcd}(3, 2) \\cdot (3^1 + 2^1) \\cdot (3 \\cdot 2)^1 \\cdot 2 = 60$\r\n- $T = (2, 2)$: $\\mathrm{gcd}(3, 3) \\cdot (3^1 + 3^1) \\cdot (3 \\cdot 3)^1 \\cdot 3 = 486$\r\n- $T = (2, 3)$: $\\mathrm{gcd}(3, 4) \\cdot (3^1 + 4^1) \\cdot (3 \\cdot 4)^1 \\cdot 2 = 168$\r\n- $T = (3, 1)$: $\\mathrm{gcd}(4, 2) \\cdot (4^1 + 2^1) \\cdot (4 \\cdot 2)^1 \\cdot 2 = 192$\r\n- $T = (3, 2)$: $\\mathrm{gcd}(4, 3) \\cdot (4^1 + 3^1) \\cdot (4 \\cdot 3)^1 \\cdot 2 = 168$\r\n- $T = (3, 3)$: $\\mathrm{gcd}(4, 4) \\cdot (4^1 + 4^1) \\cdot (4 \\cdot 4)^1 \\cdot 2 = 1024$\r\n\r\nTheir sum modulo $10^9+7$ is $2414$.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/SEPT20\/hindi\/CHEFSUMS.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/SEPT20\/bengali\/CHEFSUMS.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/SEPT20\/mandarin\/CHEFSUMS.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/SEPT20\/russian\/CHEFSUMS.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/SEPT20\/vietnamese\/CHEFSUMS.pdf) as well.\r\n\r\nChef gave you a sequence of integers $a_1, a_2, \\dots, a_N$ and $3$ integers $K$, $m$ and $x$. Let's define the following functions:\r\n$$G(i_1, \\ldots, i_K) = \\mathrm{gcd}\\left(a_{i_1}, \\dots, a_{i_K}\\right)$$\r\n$$S_x(i_1, \\ldots, i_K) = a_{i_1}^x + a_{i_2}^x + \\ldots + a_{i_K}^x$$\r\n$$P_m(i_1, \\ldots, i_K) = \\left(a_{i_1} \\cdot a_{i_2} \\cdot \\ldots \\cdot a_{i_K}\\right)^m$$\r\n$$W(T) = \\mathrm{smallest\\,\\, prime\\,\\, divisor\\,\\, of\\,\\, } P_1(T)$$\r\n\r\nChef wants you to compute the sum of $G(T) \\cdot W(T) \\cdot S_x(T) \\cdot P_m(T)$ over all $K$-tuples of indices $T = (i_1, i_2, \\ldots, i_K)$ such that $i_j \\in \\{1, 2, \\ldots, N\\}$ for each valid $j$ (there are $N^K$ of these $K$-tuples). Since this sum could be enormous, compute it modulo $10^9 + 7$.\r\n\r\n### Input\r\n- The first line of the input contains four space-separated integers $N$, $K$, $m$ and $x$.\r\n- The second line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$.\r\n\r\n### Output\r\nPrint a single line containing one integer $\\sum_T G(T) \\cdot W(T) \\cdot S_x(T) \\cdot P_m(T)$ modulo $10^9+7$.\r\n\r\n### Constraints\r\n- $1 \\le N \\le 10^6$\r\n- $1 \\le K, m, x \\le 10^{18}$\r\n- $2 \\le a_i \\le 10^6$ for each valid $i$\r\n\r\n### Subtasks\r\n**Subtask #1 (5 points):**\r\n- $N \\le 10$\r\n- $K \\le 6$\r\n\r\n**Subtask #2 (20 points):** for each valid $i$, $a_i$ is even\r\n\r\n**Subtask #3 (75 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3 2 1 1\r\n2 3 4","output":"2414","explanation":"**Example case 1:** We have $N^K = 3^2 = 9$ possible pairs $T$ of indices. The corresponding summands are:\r\n- $T = (1, 1)$: $\\mathrm{gcd}(2, 2) \\cdot (2^1 + 2^1) \\cdot (2 \\cdot 2)^1 \\cdot 2 = 64$\r\n- $T = (1, 2)$: $\\mathrm{gcd}(2, 3) \\cdot (2^1 + 3^1) \\cdot (2 \\cdot 3)^1 \\cdot 2 = 60$\r\n- $T = (1, 3)$: $\\mathrm{gcd}(2, 4) \\cdot (2^1 + 4^1) \\cdot (2 \\cdot 4)^1 \\cdot 2 = 192$\r\n- $T = (2, 1)$: $\\mathrm{gcd}(3, 2) \\cdot (3^1 + 2^1) \\cdot (3 \\cdot 2)^1 \\cdot 2 = 60$\r\n- $T = (2, 2)$: $\\mathrm{gcd}(3, 3) \\cdot (3^1 + 3^1) \\cdot (3 \\cdot 3)^1 \\cdot 3 = 486$\r\n- $T = (2, 3)$: $\\mathrm{gcd}(3, 4) \\cdot (3^1 + 4^1) \\cdot (3 \\cdot 4)^1 \\cdot 2 = 168$\r\n- $T = (3, 1)$: $\\mathrm{gcd}(4, 2) \\cdot (4^1 + 2^1) \\cdot (4 \\cdot 2)^1 \\cdot 2 = 192$\r\n- $T = (3, 2)$: $\\mathrm{gcd}(4, 3) \\cdot (4^1 + 3^1) \\cdot (4 \\cdot 3)^1 \\cdot 2 = 168$\r\n- $T = (3, 3)$: $\\mathrm{gcd}(4, 4) \\cdot (4^1 + 4^1) \\cdot (4 \\cdot 4)^1 \\cdot 2 = 1024$\r\n\r\nTheir sum modulo $10^9+7$ is $2414$.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"wm101","problem_author_html_handle":"wm101","problem_tester":"","problem_tester_html_handle":"","date_added":"22-07-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/math'>math<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sept20'>sept20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/wm101'>wm101<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/wm101'>wm101<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CHEFSUMS","time":{"view_start_date":1600075802,"submit_start_date":1600075802,"visible_start_date":1600075802,"end_date":1735669800,"current":1643797991},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=CHEFSUMS","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}