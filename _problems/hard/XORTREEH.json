{"category_name":"hard","status":"success","problem_code":"XORTREEH","problem_name":"Chef and Horcrux","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/OCT17\/mandarin\/XORTREEH.pdf\">mandarin chinese<\/a>, <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/OCT17\/russian\/XORTREEH.pdf\">russian<\/a> and <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/OCT17\/vietnamese\/XORTREEH.pdf\">vietnamese<\/a> as well.<\/h3>\n\n<p>Once again Harry is out there with his friends Ron and Hermione looking out for Horcruxes. They found out that one of the Horcrux is located at The Lestrange Vault. But You-Know-Who has locked the vault with a dark spell.<\/p>\n\n<p>Fortunately, the password to the vault can be found out by solving a problem. But they were not able to solve the problem and hence need help from Chef. Since Chef is quite busy, he has delegated this task to you.<\/p>\n\n<p>You are given an array of <b>N<\/b> elements. <a href=\"https:\/\/en.wikipedia.org\/wiki\/Mex_(mathematics)\"><b>MEX<\/b><\/a> of a set is defined as the minimum non-negative integer that doesn't exist in it. For example, the MEX of the set {0,\u20092,\u20094} is 1 and the MEX of the set {1,\u20092,\u20093} is 0. Note that the MEX of empty set will be 0.<\/p>\n\n<p>Similar to <a href=\"https:\/\/en.wikipedia.org\/wiki\/Expected_value\">Expected value<\/a>, let's define <em>Cheftated value<\/em>, <b>C[Y]<\/b> of a random variable <b>Y<\/b> as follows:\n<center><img src =\"https:\/\/discuss.codechef.com\/upfiles\/XORTREEH_img1.jpeg\" height=48 width=184><\/img><\/center>\nwhere <b>Y<\/b> is a random variable with a finite number of outcomes <b>y<sub>1<\/sub>, y<sub>2<\/sub>, ..... , y<sub>a<\/sub><\/b> occurring with probabilities <b>p<sub>1<\/sub>, p<sub>2<\/sub>, ..... , p<sub>a<\/sub><\/b>. Take <b>0<sup>0<\/sup> = 1<\/b>.\n<\/p>\n\n<p>You are given an array <b>A<\/b> consisting of <b>N<\/b> non-negative integers. Your task is to calculate the cheftated value of base <b>K<\/b> xor sum of MEX values of <b>X<\/b> randomly selected subsequences( <b>repetitions allowed<\/b>) of A.<\/p>\n\n<p>Cheftated value can always be represented as an irreducible fraction <b>P\/Q<\/b> such that <b>gcd(Q, 330301441) = 1<\/b>, i.e. <b>Q<sup>-1<\/sup><\/b> (<a href=\"https:\/\/en.wikipedia.org\/wiki\/Modular_multiplicative_inverse\"> multiplicative inverse<\/a>) modulo <b>330301441<\/b> exists. You have to print the value <b>P * Q<sup>-1<\/sup><\/b> modulo <b>330301441<\/b>. Please see the sample explanation for more details.<\/p>\n\n<p>Also, xor-sum in base <b>K<\/b> (xor<sub>k<\/sub>) can be perfomed by representing the numbers in base <b>K<\/b> and <a href=\"https:\/\/en.wikipedia.org\/wiki\/Addition#Addition_in_other_bases\">adding each digit in base K<\/a>( <b>without carrying forward<\/b>), e.g. xorsum of 6 and 9 in base 5 is equal to <b>11<sub>5<\/sub> xor<sub>5<\/sub> 14<sub>5<\/sub> = 20<sub>5<\/sub><\/b>, i.e. the number <b>10<\/b>.\n<\/p>\n\n<h3>Input<\/h3>\n<p>First line of the input contains an integer <b>T<\/b> denoting number of test cases. <\/p>\n<p>First line of each test case contains three space separated integers <b>N<\/b>, <b>K<\/b> and <b>X<\/b>.<\/p>\n<p>Second line of each test case contains <b>N<\/b> space separated integers, <b>i<\/b>-th of which is <b>A<sub>i<\/sub><\/b> denoting the i<sup>th<\/sup> element of the array.\n<\/p>\n\n<h3>Output<\/h3>\n<p>\nFor each test case, output a line containing single integer representing the value of <b>P*Q<sup>-1<\/sup><\/b> modulo <b>330301441<\/b>.\n<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>5<\/b>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>2<\/b> \u2264 <b>K<\/b> \u2264 <b>10<\/b><\/li>\n<li><b>2<\/b> \u2264 <b>X<\/b> \u2264 <b>10<sup>18<\/sup><\/b><\/li>\n<li><b>0<\/b> \u2264 <b>A<sub>i<\/sub><\/b> \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<\/ul>\n\n<h3>Subtasks<\/h3>\n<ul>\n<li><b>Subtask #1<\/b> (15 points) : <b>K<\/b> \u2264 3<\/li>\n<li><b>Subtask #2<\/b> (15 points) : <b>N<\/b> \u2264 10<sup>3<\/sup><\/li>\n<li><b>Subtask #3<\/b> (70 points) : Original constraints<\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre>\n<b>Input:<\/b>\n2\n3 2 2\n1 0 2\n4 4 4\n4 0 1 1\n\n<b>Output:<\/b>\n87392358\n88861416\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>\n<b>Example case 1:<\/b> \nLet's name the sub-sequences  as A = [], B = [1], C = [0], D = [2], E = [1, 0], F = [1, 2], G = [0, 2], H = [1, 0, 2].<\/p>\n<p>Possible outcome of xor values after selecting two sub-sequences (repetitions allowed):<\/p>\n<ul>\n<li>0 when you select (two from (A, B, D, F)) or (two from (C, G)) or (two from (E)) or (two from (H)) making it 22 ways.<\/li>\n<li>1 when you select (one from (A, B, D, F) and one from (C, G)) or (one from (E) and one from (H)) making it 18 ways.<\/li>\n<li>2 when you select (one from (A, B, D, F) and one from (E)) or (one from (H) and one from (C, G)) making it 12 ways.<\/li>\n<li>3 when you select (one from (A, B, D, F) and one from (H)) or (one from (E) and one from (C, G)) making it 12 ways.<\/li>\n<\/ul>\n\n<p>Cheftated value = 0<sup>2*0<\/sup> * (22\/64)<sup>3*0<\/sup> + 1<sup>2*1<\/sup> * (18\/64)<sup>3*1<\/sup> + 2<sup>2*2<\/sup> * (12\/64)<sup>3*2<\/sup> + 3<sup>2*3<\/sup> * (12\/64)<sup>3*3<\/sup> = 70310425195\/68719476736.<\/p>\n<p>Answer to print = 70310425195 * 68719476736<sup>-1<\/sup> mod 330301441 = <b>87392358<\/b>\n<\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 6.3, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, kotlin, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.5, RUBY, rust, SCALA, SCM chicken, SCM guile, SCM qobi, ST, swift, TCL, TEXT, WSPC","max_timelimit":"5","source_sizelimit":"50000","problem_author":"adkroxx","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>adkroxx<\/span>","problem_tester":"alex_2oo8","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>alex_2oo8<\/span>","date_added":"23-08-2017","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/adkroxx'>\n                    adkroxx\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/fast-expo'>\n                    fast-expo\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/fastmodexp'>\n                    fastmodexp\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/fft'>\n                    fft\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ntt'>\n                    ntt\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/oct17'>\n                    oct17\n                <\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/XORTREEH","time":{"view_start_date":1508146200,"submit_start_date":1508146200,"visible_start_date":1508146200,"end_date":1735669800,"current":1514816847},"user":{"username":null},"todo":false,"problem_status":"unattempted"}