{"category_name":"hard","status":"success","problem_code":"CHEFSPAG","problem_name":"Chef has a Spaghetti Garden","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/SEPT16\/mandarin\/CHEFSPAG.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/SEPT16\/russian\/CHEFSPAG.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/SEPT16\/vietnamese\/CHEFSPAG.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Chef is tending a really large <i>spaghetti garden<\/i>. This garden consists of many <i>spaghetti trees<\/i>. Specifically, there is a spaghetti tree planted for each lattice point location <b>(x, y)<\/b> with <b>x<\/b>, <b>y<\/b> \u2265 <b>0<\/b>. (Yes, there are an infinite number of trees in Chef's garden!)<\/p>\n\n<p>It's the 1st of April, so it's harvest time for Chef. Chef plans to harvest all <i>spaghetti strands<\/i> within a certain region today. In case you didn't know, a spaghetti tree bears <i>spaghetti strands<\/i> as its fruits.<\/p>\n\n<p>Specifically, Chef plans to harvest all spaghetti strands hanging from every spaghetti tree whose location <b>(x, y)<\/b> is within the interior or boundary of a certain polygon with <b>N<\/b> vertices. Also, the spaghetti tree located at <b>(x, y)<\/b> currently bears exactly <b>F<sub>x+y<\/sub><\/b> fruits, where <b>F<sub>k<\/sub><\/b> satisfies the following fourth-order recurrence:<\/p>\n\n<p><b>F<sub>k<\/sub> = a\u00b7F<sub>k-1<\/sub> + b\u00b7F<sub>k-2<\/sub> + c\u00b7F<sub>k-3<\/sub> + d\u00b7F<sub>k-4<\/sub><\/b><\/p>\n\n<p>How many strands of spaghetti will Chef be able to harvest today? Since this number can be very large, output it modulo <b>10<sup>9<\/sup> + 9<\/b>. (Note: this is slightly different from the usual mod.)<\/p>\n\n\n<h3>Input<\/h3>\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/p>\n<p>The first line of each test case contains nine space separated integers <b>N<\/b>, <b>a<\/b>, <b>b<\/b>, <b>c<\/b>, <b>d<\/b>, <b>F<sub>0<\/sub><\/b>, <b>F<sub>1<\/sub><\/b>, <b>F<sub>2<\/sub><\/b>, and <b>F<sub>3<\/sub><\/b>.<\/p>\n<p>After that, <b>N<\/b> lines follow. The <b>i<sup>th<\/sup><\/b> line contains two integers  <b>x<sub>i<\/sub><\/b> and <b>y<sub>i<\/sub><\/b>, denoting that <b>(x<sub>i<\/sub>, y<sub>i<\/sub>)<\/b> is the <b>i<sup>th<\/sup><\/b> vertex of the polygon in counterclockwise order.<\/p>\n\n\n<h3>Output<\/h3>\n<p>For each test case, output a single line containing the integer: the answer for that test case.<\/p>\n\n\n<h3>Constraints<\/h3>\n<ul>\n<li>0 \u2264 <b>a<\/b>, <b>b<\/b>, <b>c<\/b>, <b>d<\/b>, <b>F<sub>0<\/sub><\/b>, <b>F<sub>1<\/sub><\/b>, <b>F<sub>2<\/sub><\/b> <b>F<sub>3<\/sub><\/b> &lt; <b>10<sup>9<\/sup> + 9<\/b><\/li>\n<li>The polygon is simple and non-degenerate.<\/li>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>2000<\/b><\/li>\n<li><b>3<\/b> \u2264 <b>N<\/b> \u2264 <b>16<\/b><\/li>\n<li>The sum of the <b>N<\/b> in a single test file is \u2264 <b>6000<\/b><\/li>\n<\/ul>\n\n<h3>Subtasks<\/h3>\n<b>Subtask #1 (10 points):<\/b>\n<ul>\n<li><b>0<\/b> \u2264 <b>x<sub>i<\/sub><\/b>, <b>y<sub>i<\/sub><\/b> \u2264 <b>100<\/b><\/li>\n<\/ul> \n<p><\/p>\n<b>Subtask #2 (30 points):<\/b>\n<ul>\n<li><b>0<\/b> \u2264 <b>x<sub>i<\/sub><\/b>, <b>y<sub>i<\/sub><\/b> \u2264 <b>10<sup>4<\/sup><\/b><\/li>\n<\/ul> \n<p><\/p>\n<b>Subtask #3 (60 points):<\/b>\n<ul>\n<li><b>0<\/b> \u2264 <b>x<sub>i<\/sub><\/b>, <b>y<sub>i<\/sub><\/b> \u2264 <b>10<sup>9<\/sup><\/b><\/li>\n<\/ul> \n<p><\/p>\n\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n<tt>2\n4 1 2 3 4 0 1 2 3\n1 1\n2 1\n2 2\n1 2\n4 1 2 3 4 0 1 2 3\n1 1\n3 1\n3 3\n1 3\n<\/tt>\n<b>Output:<\/b>\n<tt>18\n153\n<\/tt>\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>In both test cases, we have <b>F<sub>k<\/sub> = k<\/b> for <b>0 \u2264 k \u2264 3<\/b> and <b>F<sub>k<\/sub> = F<sub>k-1<\/sub> + 2\u00b7F<sub>k-2<\/sub> + 3\u00b7F<sub>k-3<\/sub> + 4\u00b7F<sub>k-4<\/sub><\/b>. So you can check that <b>F<sub>4<\/sub> = 10<\/b>, <b>F<sub>5<\/sub> = 26<\/b> and <b>F<sub>6<\/sub> = 63<\/b><\/p>\n<ul>\n<li>In the first test case, Chef will harvest all spaghetti strands in the locations <b>(1, 1)<\/b>, <b>(1, 2)<\/b>, <b>(2, 1)<\/b>, <b>(2, 2)<\/b>.\nThe total number is\n<b>F<sub>1+1<\/sub> + F<sub>1+2<\/sub> + F<sub>2+1<\/sub> + F<sub>2+2<\/sub><\/b> =\n<b>F<sub>2<\/sub> + F<sub>3<\/sub> + F<sub>3<\/sub> + F<sub>4<\/sub><\/b> =\n<b>18<\/b><\/li>\n<li>In the second test case, Chef will harvest all spaghetti strands in the locations <b>(1, 1)<\/b>, <b>(1, 2)<\/b>, <b>(1, 3)<\/b>, <b>(2, 1)<\/b>, <b>(2, 2)<\/b>, <b>(2, 3)<\/b>, <b>(3, 1)<\/b>, <b>(3, 2)<\/b>, <b>(3, 3)<\/b>.\nThe total number is\n<b>F<sub>1+1<\/sub> + F<sub>1+2<\/sub> + F<sub>1+3<\/sub> + F<sub>2+1<\/sub> + F<sub>2+2<\/sub> + F<sub>2+3<\/sub> + F<sub>3+1<\/sub> + F<sub>3+2<\/sub> + F<sub>3+3<\/sub><\/b> =\n<b>F<sub>2<\/sub> + F<sub>3<\/sub> + F<sub>4<\/sub> + F<sub>3<\/sub> + F<sub>4<\/sub> + F<sub>5<\/sub> + F<sub>4<\/sub> + F<sub>5<\/sub> + F<sub>6<\/sub><\/b> =\n<b>153<\/b><\/li>\n<\/ul>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"9","source_sizelimit":"50000","problem_author":"kevinsogo","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>kevinsogo<\/span>","problem_tester":"dpraveen","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>dpraveen<\/span>","date_added":"14-07-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/kevinsogo'>\n                    kevinsogo\n                <\/a>","user":{"username":null},"time":{"view_start_date":1473931800,"submit_start_date":1473931800,"visible_start_date":1473931800,"end_date":1735669800,"current":1493556640},"todo":false,"problem_status":"unattempted"}