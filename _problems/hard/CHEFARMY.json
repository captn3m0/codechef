{"category_name":"hard","status":"success","problem_code":"CHEFARMY","problem_name":"Chefland Army","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN20\/hindi\/CHEFARMY.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN20\/bengali\/CHEFARMY.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/mandarin\/CHEFARMY.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN20\/russian\/CHEFARMY.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/vietnamese\/CHEFARMY.pdf) as well.\r\n\r\n**This is not intended to be the tie-break problem.**\r\n\r\nIn the Chefland army, there are $M$ generals (numbered $1$ through $M$) and $N$ soldiers (numbered $1$ through $N$).\r\n\r\nThe Army has a vertical hierarchy \u2015 a soldier may command many other soldiers (including zero), but each soldier has at most one commander. A soldier $y$ is a *subordinate* of a soldier $x$ if soldier $x$ is the commander of soldier $y$ or there is a soldier $z$ commanded by soldier $x$ such that soldier $y$ is a subordinate of soldier $z$. No soldier is commanded by one of their subordinates because every soldier is feared by all of his subordinates. Moreover, all soldiers are subordinates of soldier $1$. Let's denote the commander of soldier $i$ by $p_i$ ($p_1 = 0$ since soldier $1$ cannot have a commander).\r\n\r\nAs in any organisation, the generals have some soldiers they hate. If a general meets a soldier whom he hates, this general becomes angry for the rest of the day.\r\n\r\nThe soldiers should be paid some wages over one or more days. For each valid $i$, soldier $i$ should be paid $S_i$ chefcoins. Shyam is in charge of this; he should choose an integer $D$ ($0 \\le D \\le N^2$) and during each of the next $D$ days, perform the following process:\r\n- Choose an integer $K$ and $K$ soldiers, then call these soldiers to report their feats to the generals. Shyam is very careful \u2015 on each day, he chooses these soldiers in such a way that there are no two called soldiers where one is afraid of the other (in other words, no called soldier is a subordinate of another called soldier).\r\n- Choose a positive real number $R$ and give each of the called soldiers $R$ chefcoins.\r\n- For each soldier $v$ and general $u$, if soldier $v$ was called and is hated by general $u$, then general $u$ becomes angry. Let $G$ be the total number of angry generals on this day. Then, the total angriness of the generals increases by $G \\cdot R$.\r\n- Before the start of the next day, the generals that were angry calm down and are not angry anymore (so they can become angry again).\r\n\r\nHelp Shyam pay the soldiers while minimising the total angriness of the generals over all $D$ days.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $M$ and $N$.\r\n- Each of the next $M$ lines contains a binary string $B$ with length $N$. For each valid $i$ and $j$, the $j$-th character in the $i$-th of these strings is '1' if general $i$ hates soldier $j$ or '0' otherwise.\r\n- The next line contains $N$ space-separated integers $S_1, S_2, \\ldots, S_N$.\r\n- The last line contains $N$ space-separated integers $p_1, p_2, \\ldots, p_N$.\r\n\r\n### Output\r\nFor each test case:\r\n- First, print a line containing a single integer $D$ ($0 \\le D \\le N^2$) \u2015 the number of days during which the soldiers are paid.\r\n- Then, print $D$ lines. In each of these lines, print an integer $K$, a space, a real number $R$, a space and $K$ space-separated integers $x_1, x_2, \\ldots, x_K$ \u2015 the numbers of the called soldiers.\r\n- For each valid $i$, let the total amount of money received by soldier $i$ be $W_i$; your answer will be considered correct if $|W_i - S_i| \\le 10^{-6}$.\r\n\r\n### Constraints\r\n- $T = 50$\r\n- $M = 16$ \r\n- $N = 128$\r\n- $0 \\le p_i \\le N$ for each valid $i$\r\n- $1 \\le S_i \\le 100$ for each valid $i$\r\n\r\n### Test generation\r\nFor each test case:\r\n- $S_1, S_2, \\ldots, S_N$ are chosen uniformly randomly and independently between $1$ and $100$.\r\n- For each valid $i$, $p_i$ is chosen uniformly randomly between $1$ and $i-1$.\r\n- For each test case, a real number $p$ is chosen manually. There are $10$ test cases for each $p \\in \\{0.1, 0.2, 0.5, 0.7, 0.8\\}$.\r\n- For each valid $i$ and $j$, $B_{i,j}$ is chosen to be '1' with probability $p$ or '0' with probability $1-p$.\r\n\r\n### Scoring\r\nThe score of each test case is the sum of $R \\cdot G$ over all $D$ days. The score of a submission is equal to the sum of its scores over all test cases.\r\n\r\nThe goal is to minimise the score of your submission. However, this problem is solvable optimally \u2015 there is a solution which is guaranteed to score 100 points.\r\n\r\n### Example Input\r\n```\r\n1\r\n3 4\r\n0000\r\n1111\r\n0101\r\n1 2 3 4\r\n0 1 1 3\r\n```\r\n\r\n### Example Output\r\n```\r\n5\r\n2 1 2 4\r\n2 1 2 3\r\n1 2 3\r\n1 3 4\r\n1 1 1\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN20\/hindi\/CHEFARMY.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN20\/bengali\/CHEFARMY.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/mandarin\/CHEFARMY.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN20\/russian\/CHEFARMY.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/vietnamese\/CHEFARMY.pdf) as well.\r\n\r\n**This is not intended to be the tie-break problem.**\r\n\r\nIn the Chefland army, there are $M$ generals (numbered $1$ through $M$) and $N$ soldiers (numbered $1$ through $N$).\r\n\r\nThe Army has a vertical hierarchy \u2015 a soldier may command many other soldiers (including zero), but each soldier has at most one commander. A soldier $y$ is a *subordinate* of a soldier $x$ if soldier $x$ is the commander of soldier $y$ or there is a soldier $z$ commanded by soldier $x$ such that soldier $y$ is a subordinate of soldier $z$. No soldier is commanded by one of their subordinates because every soldier is feared by all of his subordinates. Moreover, all soldiers are subordinates of soldier $1$. Let's denote the commander of soldier $i$ by $p_i$ ($p_1 = 0$ since soldier $1$ cannot have a commander).\r\n\r\nAs in any organisation, the generals have some soldiers they hate. If a general meets a soldier whom he hates, this general becomes angry for the rest of the day.\r\n\r\nThe soldiers should be paid some wages over one or more days. For each valid $i$, soldier $i$ should be paid $S_i$ chefcoins. Shyam is in charge of this; he should choose an integer $D$ ($0 \\le D \\le N^2$) and during each of the next $D$ days, perform the following process:\r\n- Choose an integer $K$ and $K$ soldiers, then call these soldiers to report their feats to the generals. Shyam is very careful \u2015 on each day, he chooses these soldiers in such a way that there are no two called soldiers where one is afraid of the other (in other words, no called soldier is a subordinate of another called soldier).\r\n- Choose a positive real number $R$ and give each of the called soldiers $R$ chefcoins.\r\n- For each soldier $v$ and general $u$, if soldier $v$ was called and is hated by general $u$, then general $u$ becomes angry. Let $G$ be the total number of angry generals on this day. Then, the total angriness of the generals increases by $G \\cdot R$.\r\n- Before the start of the next day, the generals that were angry calm down and are not angry anymore (so they can become angry again).\r\n\r\nHelp Shyam pay the soldiers while minimising the total angriness of the generals over all $D$ days.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $M$ and $N$.\r\n- Each of the next $M$ lines contains a binary string $B$ with length $N$. For each valid $i$ and $j$, the $j$-th character in the $i$-th of these strings is '1' if general $i$ hates soldier $j$ or '0' otherwise.\r\n- The next line contains $N$ space-separated integers $S_1, S_2, \\ldots, S_N$.\r\n- The last line contains $N$ space-separated integers $p_1, p_2, \\ldots, p_N$.\r\n\r\n### Output\r\nFor each test case:\r\n- First, print a line containing a single integer $D$ ($0 \\le D \\le N^2$) \u2015 the number of days during which the soldiers are paid.\r\n- Then, print $D$ lines. In each of these lines, print an integer $K$, a space, a real number $R$, a space and $K$ space-separated integers $x_1, x_2, \\ldots, x_K$ \u2015 the numbers of the called soldiers.\r\n- For each valid $i$, let the total amount of money received by soldier $i$ be $W_i$; your answer will be considered correct if $|W_i - S_i| \\le 10^{-6}$.\r\n\r\n### Constraints\r\n- $T = 50$\r\n- $M = 16$ \r\n- $N = 128$\r\n- $0 \\le p_i \\le N$ for each valid $i$\r\n- $1 \\le S_i \\le 100$ for each valid $i$\r\n\r\n### Test generation\r\nFor each test case:\r\n- $S_1, S_2, \\ldots, S_N$ are chosen uniformly randomly and independently between $1$ and $100$.\r\n- For each valid $i$, $p_i$ is chosen uniformly randomly between $1$ and $i-1$.\r\n- For each test case, a real number $p$ is chosen manually. There are $10$ test cases for each $p \\in \\{0.1, 0.2, 0.5, 0.7, 0.8\\}$.\r\n- For each valid $i$ and $j$, $B_{i,j}$ is chosen to be '1' with probability $p$ or '0' with probability $1-p$.\r\n\r\n### Scoring\r\nThe score of each test case is the sum of $R \\cdot G$ over all $D$ days. The score of a submission is equal to the sum of its scores over all test cases.\r\n\r\nThe goal is to minimise the score of your submission. However, this problem is solvable optimally \u2015 there is a solution which is guaranteed to score 100 points.\r\n\r\n### Example Input\r\n```\r\n1\r\n3 4\r\n0000\r\n1111\r\n0101\r\n1 2 3 4\r\n0 1 1 3\r\n```\r\n\r\n### Example Output\r\n```\r\n5\r\n2 1 2 4\r\n2 1 2 3\r\n1 2 3\r\n1 3 4\r\n1 1 1\r\n```\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"7","source_sizelimit":"50000","problem_author":"alei","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>alei<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"22-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alei'>alei<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/alei'>alei<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/breadth-first-search'>breadth-first-search<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/depth-first-search'>depth-first-search<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hashing'>hashing<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jan20'>jan20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/linear-algebra'>linear-algebra<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/linear-programming'>linear-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/vijju123'>vijju123<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Linear Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CHEFARMY","time":{"view_start_date":1578907800,"submit_start_date":1578907800,"visible_start_date":1578907800,"end_date":1735669800,"current":1643797991},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=CHEFARMY","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}