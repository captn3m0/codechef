{"category_name":"hard","status":"success","problem_code":"BIKE","problem_name":"Chef and Bike","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/mandarin\/BIKE.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/russian\/BIKE.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/vietnamese\/BIKE.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n\n<p>\nIn Chefland, there are <b>n<\/b> cities and <b>m<\/b> one-way roads between cities. The chef will travel between cities along these roads using a very unusual bike.\nThe circumference of the front wheel is <b>n<\/b> (the same as the number of cities) yet the circumference of its rear wheel is only <b>n - 1<\/b>. We think of the circumference of each wheel as being broken up into equal-spaced <i>positions<\/i>. So the front wheel has positions <b>0, 1, ..., n-1<\/b> and the rear wheel has positions <b>0, 1, ..., n-2<\/b>. Each unit of distance travelled will advance each wheel 1 position.\n<\/p>\n\n<p>\nFor example, when the chef travels a distance of <b>d<\/b> when both wheels start at position <b>0<\/b>, \nthe position of the front wheel is  left at <b>d (mod n)<\/b> and the position of the rear wheel is left at <b>d (mod (n - 1))<\/b>.\n<\/p>\n\n<p>\nFurthermore, the chef bikes very fast and the roads are very bumpy. Quite frequently at least one wheel is not touching the ground. When this happens, the wheel does not turn at all (the bike needs some lubrication). So the front and rear wheel may not even rotate the same total number of positions when travelling along a road.\n<\/p>\n\n<p>\nFor each road <b>i<\/b>, we are given the start city <b>s[i]<\/b>,\nthe end city <b>e[i]<\/b>, the distance the front wheel travels <b>f[i]<\/b>, and the distance of the rear wheel <b>r[i]<\/b>.\n<\/p>\n\n\n<p>\nBoth wheels start at position <b>0<\/b> at the beginning of the chef's trip. After traveling a sequence of roads <b>i<sub>1<\/sub>,i<sub>2<\/sub>, ..., i<sub>k<\/sub><\/b> the front wheel is in position <b>F := f[i<sub>1<\/sub>] + f[i<sub>2<\/sub>] + ... + f[i<sub>k<\/sub>] (mod n)<\/b>.\nSimilarly, the rear wheel is in position <b>R := r[i<sub>1<\/sub>] + r[i<sub>2<\/sub>] + ... + r[i<sub>k<\/sub>] (mod n-1)<\/b>.\n<\/p>\n\n\n<p>\nThe chef wants to start and end in the same city, but is ok starting in any city. The chef is also ok visiting a city more than once; it is the journey that counts, not the destinations.\n<\/p>\n\n<p>\nThe chef is also interested in calculating the number of paths where the final positions <b>F<\/b> and <b>R<\/b> equal certain values and the number of roads traversed equals a certain value (if he uses an road twice, it counts twice).\nSince the answer is quite large, you only need to output the answer mod 1163962801.\n<\/p>\n\n\n<h3>Input<\/h3>\n<p>\nThe first line contains three integers, indicating <b>n<\/b> and <b>m<\/b> and <b>t<\/b>. Here, <b>n<\/b> is the number of cities (and the circumference of the front wheel, and one more than the circumference of the rear wheel), <b>m<\/b> is the number of roads, and <b>t<\/b> is the number of roads the chef wants to travel over. Remember, if the chef travels over the same road twice, it counts twice.\n\n<\/p>\n<p>\nThe following <b>m<\/b> lines describe a road.\nThe <b>i<\/b>'th such line contains 4 integers, namely <b>s[i], e[i], f[i], r[i]<\/b> that describe the road as specified above.\n<\/p>\n\n\n<h3>Output<\/h3>\n<p>\nOutput is arranged into <b>n<\/b> blocks. The <b>k<\/b>'th block (1 \u2264 <b>k<\/b> \u2264 <b>n<\/b>) will itself contain <b>n<\/b> lines, each consisting of <b>n-1<\/b> integers. \n<\/p>\n\n<p>\nThe <b>j<\/b>'th number on the <b>i<\/b>'th line of the <b>k<\/b>'th block should describe the number of different ways the chef can start and end a bike tour at city <b>k<\/b> that crosses precisely <b>t<\/b> roadss and leaves the front wheel at position <b>F = i<\/b> and the rear wheel at position <b>R = j<\/b>. Each number in this output should be reduced modulo 1163962801.\n<\/p>\n\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>t<\/b> \u2264 <b>1000000000<\/b><\/li>\n<li><b>2<\/b> \u2264 <b>n<\/b> \u2264 <b>22<\/b><\/li>\n<li><b>2<\/b> \u2264 <b>m<\/b> \u2264 <b>10000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>s[i]<\/b> \u2264 <b>n<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>t[i]<\/b> \u2264 <b>n<\/b><\/li>\n<li><b>990<\/b> \u2264 <b>0.99 f[i]<\/b> \u2264 <b>r[i]<\/b> \u2264 <b>f[i]<\/b> \u2264 <b>10000000<\/b><\/li>\n<li>There might be several roads between two cities<\/li>\n<li>There might be roads from a city to itself<\/li>\n<li>Subtask #1 [10 points]: <b>n<\/b> \u2264 <b>5<\/b>, <b>t<\/b> \u2264 <b>100<\/b><\/li>\n<li>Subtask #2 [20 points]: <b>n<\/b> \u2264 <b>5<\/b><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n3 6 6\n1 2 0 0\n2 1 1 1\n1 3 1 2\n3 1 2 1\n2 3 5 5\n3 2 10 10\n\n<b>Output:<\/b>\n1 5\n0 10\n1 5\n1 5\n0 10\n1 5\n1 8\n0 10\n1 2\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>I have discovered a truly marvellous enumeration of this, which this margin is too narrow to contain.<\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"7","source_sizelimit":"50000","problem_author":"wwwwodddd","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>wwwwodddd<\/span>","problem_tester":"xcwgf666","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","date_added":"15-09-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/maths'>\n                    maths\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/matrix-expo'>\n                    matrix-expo\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/nov16'>\n                    nov16\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/wwwwodddd'>\n                    wwwwodddd\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/BIKE","user":{"username":null},"time":{"view_start_date":1479115800,"submit_start_date":1479115800,"visible_start_date":1479115800,"end_date":1735669800,"current":1493556620},"todo":false,"problem_status":"unattempted"}