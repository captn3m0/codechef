{"category_name":"hard","status":"success","problem_code":"SEAPERM3","problem_name":"Sereja and Permutations 3","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/mandarin\/SEAPERM3.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/russian\/SEAPERM3.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV16\/vietnamese\/SEAPERM3.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n\nLet <b>p<\/b> be a permutation of integers <b>1, ..., N<\/b>. Lets call <b>p<\/b> <i>good<\/i> if there is at least one pair of indices <b>(i,j)<\/b> such that <b>i < j<\/b> and <b>p[i] > j, p[j] > i<\/b>.\n<p><\/p>\nSereja is interested in the number of permutations <b>p<\/b> of <b>1, ..., N<\/b> that are good. This might seem easy at first, but Sereja is only interested in permutations that obey a list of <b>M<\/b> additional rules. Rule number <b>i (1 \u2264 i \u2264 M)<\/b> in Sereja's list says <b>p(X<sub>i<\/sub>)<\/b>  should equal <b>V<sub>i<\/sub><\/b>.\n<p><\/p>\nHelp Sereja count number of good permutations that obey the <b>M<\/b> additional constraints. As this number can be quite large, you should only output its value modulo <b>2000000011<\/b>.\n<p><\/p>\n\n<h3>Input<\/h3>\nThe first line of the input contains an integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows. Each test case starts with line that contains two numbers <b>N, M<\/b>. The rest of the test cases consists of <b>M<\/b> lines describing Sereja's additional rules. The <b>i<\/b>'th such line gives the integers <b>X<sub>i<\/sub><\/b> and <b>V<sub>i<\/sub><\/b>.\n<p><\/p>\n\n<h3>Output<\/h3>\nOutput one line per test case that gives the number of good permutations obeying Sereja's constraints modulo 2000000011.\n<p><\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>10<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>10^9<\/b><\/li>\n<li><b>0<\/b> \u2264 <b>M<\/b> \u2264 <b>10^4<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>X<sub>i<\/sub>, V<sub>i<\/sub><\/b> \u2264 <b>N<\/b><\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n<tt>2\n3 0\n3 2\n3 1\n1 2<\/tt>\n\n<b>Output:<\/b>\n<tt>1\n0<\/tt>\n<\/pre>\n<p>\u00a0<\/p>\n<h3>Explanation<\/h3>\n<p><b>Example case 1.<\/b> The only good permutation is <b>3,2,1<\/b> (i = 1, j = 2).<\/p>\n<h3>Sub tasks<\/h3>\n<ul>\n<li><b>Subtask #1:<\/b> <b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>8<\/b> (5 points)<\/li>\n<li><b>Subtask #2:<\/b> <b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>20<\/b> (10 points)<\/li>\n<li><b>Subtask #3:<\/b> <b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>1000<\/b> (15 points)<\/li>\n<li><b>Subtask #4:<\/b> <b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>10000<\/b> (15 points)<\/li>\n<li><b>Subtask #5:<\/b> <b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>100000000<\/b> (20 points)<\/li>\n<li><b>Subtask #6:<\/b> <b>original<\/b> (35 points)<\/li>\n<\/ul>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"3","source_sizelimit":"50000","problem_author":"sereja","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>sereja<\/span>","problem_tester":"xcwgf666","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","date_added":"7-10-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>\n                    dynamic-programming\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/matrix-expo'>\n                    matrix-expo\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/nov16'>\n                    nov16\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/sereja'>\n                    sereja\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/SEAPERM3","user":{"username":null},"time":{"view_start_date":1479115800,"submit_start_date":1479115800,"visible_start_date":1479115800,"end_date":1735669800,"current":1493556839},"todo":false,"problem_status":"unattempted"}