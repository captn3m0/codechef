{"category_name":"hard","status":"success","problem_code":"CUTTREE","problem_name":"Chef Cuts Tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/MARCH18\/mandarin\/CUTTREE.pdf\">Mandarin chinese<\/a>, <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/MARCH18\/russian\/CUTTREE.pdf\">Russian<\/a> and <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/MARCH18\/vietnamese\/CUTTREE.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>\nA forest is an undirected acyclic graph. Let us define the <i>strength<\/i> of a forest as the sum of squares of sizes of its connected components. (Clearly, a tree with <b>n<\/b> nodes has strength <b>n<sup>2<\/sup><\/b>.)<\/p> \n\n<p>\nChef has found a tree with <b>N<\/b> nodes on day 0. On each of the next <b>N-1<\/b> days, he's going to remove one edge. Let's denote the forest that remains after <b>i<\/b> days by <b>F<sub>i<\/sub><\/b>, for each 1 \u2264 <b>i<\/b> \u2264 <b>N-1<\/b>; also, let's denote the original tree by <b>F<sub>0<\/sub><\/b>. On day <b>i<\/b>, <b>F<sub>i<\/sub><\/b> is created by randomly uniformly choosing one edge from <b>F<sub>i-1<\/sub><\/b> and removing it.\n<\/p>\n\n<p>\nLet <b>E<sub>i<\/sub><\/b> be the expected value of strength of the forest <b>F<sub>i<\/sub><\/b>, for each 0 \u2264 <b>i<\/b> \u2264 <b>N-1<\/b>. It can be proven that this number can be written in the form <b>P<sub>i<\/sub><\/b> \/ <b>Q<sub>i<\/sub><\/b>, where <b>gcd<\/b>(<b>P<sub>i<\/sub><\/b>, <b>Q<sub>i<\/sub><\/b>)<\/b> = 1 and <b>gcd<\/b>(<b>Q<sub>i<\/sub><\/b>, 10<sup>9<\/sup> + 7) = 1. Let <b>R<sub>i<\/sub><\/b> = <b>P<sub>i<\/sub><\/b> \u00b7 <b>Q<sub>i<\/sub><sup>-1<\/sup><\/b> mod 10<sup>9<\/sup> + 7, where <b>Q<sub>i<\/sub><sup>-1<\/sup><\/b> denotes the modular inverse of <b>Q<sub>i<\/sub><\/b> modulo 10<sup>9<\/sup> + 7.\n<\/p>\n\n<p>\nFind the values of <b>R<sub>0<\/sub>, R<sub>1<\/sub>, ..., R<sub>N-1<\/sub><\/b>.\n<\/p>\n\n<h3>Input<\/h3>\n<ul>\n<li>The first line of the input contains a single integer <b>N<\/b> \u2014 the number of nodes in the tree.<\/li>\n<li><b>N-1<\/b> lines follow. Each of these lines contains two space-separated integers <b>u<\/b> and <b>v<\/b> denoting an edge between nodes <b>u<\/b> and <b>v<\/b> in the tree.<\/li>\n<\/ul>\n\n<h3>Output<\/h3>\n<p>\nPrint a single line containing <b>N<\/b> space-separated integers <b>R<sub>0<\/sub>, R<sub>1<\/sub>, ..., R<sub>N-1<\/sub><\/b>.\n<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li> 1 \u2264 <b>N<\/b> \u2264 10<sup>5<sup> <\/li>\n<li> 1 \u2264 <b>u<\/b>, <b>v<\/b> \u2264 <b>N<\/b> <\/li>\n<\/ul>\n\n<h3>Subtasks<\/h3>\n<p><b>Subtask #1 (25 points):<\/b> 1 \u2264 <b>N<\/b> \u2264 10<sup>3<\/sup><\/p>\n\n<p><b>Subtask #2 (75 points):<\/b> original constraints<\/p>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n\n5\n1 2\n1 3\n2 4\n2 5\n\n<b>Output:<\/b>\n\n25 16 333333346 7 5\n<\/pre>\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, CLOJ, COB, FS","max_timelimit":"2","source_sizelimit":"50000","problem_author":"jtnydv25","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>jtnydv25<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"31-12-2017","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/centroid-decomp'>centroid-decomp<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/expected-value'>expected-value<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fft'>fft<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jtnydv25'>jtnydv25<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/march18'>march18<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/probability'>probability<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CUTTREE","time":{"view_start_date":1520847000,"submit_start_date":1520847000,"visible_start_date":1520847000,"end_date":1735669800,"current":1525454451},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}