{"category_name":"hard","status":"success","problem_code":"DIFVAL","problem_name":"Danya and Different Values","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JUNE20\/hindi\/DIFVAL.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JUNE20\/bengali\/DIFVAL.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JUNE20\/mandarin\/DIFVAL.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JUNE20\/russian\/DIFVAL.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JUNE20\/vietnamese\/DIFVAL.pdf) as well.\r\n\r\nDanya has a rooted tree with $N$ nodes (numbered $1$ through $N$). Node $1$ is the root and for each $i$ ($2 \\le i \\le N$), the parent of the $i$-th node is $p_i$. For each valid $i$, the $i$-th node also has a value $a_i$.\r\n\r\nDanya really loves his tree and wants to play with it. You should answer his $Q$ queries. In each query:\r\n- You are given two integers $X$ and $D$.\r\n- Consider the set $S$ of all nodes $v$ that lie in the subtree of node $X$ (including $X$) such that the distance between $X$ and $v$ does not exceed $D$.\r\n- The answer to this query is the number of different values $a_v$ among all $v \\in S$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N-1$ space-separated integers $p_2, p_3, \\ldots, p_N$.\r\n- The third line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$.\r\n- The fourth line contains a single integer $Q$.\r\n- $Q$ lines follow. Each of these lines contains two space-separated integers $x$ and $d$ describing a query; the parameters $X$ and $D$ can be computed in the following way:\r\n    - Let's denote the answer to the previous query by $ans$ ($ans = 0$ if this is the first query).\r\n    - Then, $X = x \\oplus ans$ and $D = d \\oplus ans$, where $\\oplus$ denotes the bitwise XOR operator.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the answer to the query.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 5$\r\n- $1 \\le N \\le 2 \\cdot 10^5$\r\n- $1 \\le p_i \\le i-1$ for each valid $i$\r\n- $1 \\le a_i \\le N$ for each valid $i$\r\n- $1 \\le Q \\le 2 \\cdot 10^5$\r\n- $0 \\le x, d \\le 4 \\cdot 10^5$\r\n- $1 \\le X \\le N$\r\n- $0 \\le D \\le N$\r\n\r\n### Subtasks\r\n**Subtask #1 (16 points):** $N, Q \\le 1,000$\r\n\r\n**Subtask #2 (24 points):** the tree is a bamboo, i.e. $p_i = i-1$ for each valid $i$\r\n\r\n**Subtask #3 (60 points):** original constraints \r\n\r\n### Example Input\r\n```\r\n1\r\n11\r\n1 2 2 2 4 4 1 8 8 10\r\n5 3 2 3 1 1 2 4 1 2 3\r\n9\r\n2 1\r\n1 1\r\n2 3\r\n0 0\r\n2 1\r\n4 6\r\n13 4\r\n11 1\r\n13 4\r\n```\r\n\r\n### Example Output\r\n```\r\n3\r\n3\r\n1\r\n3\r\n5\r\n5\r\n3\r\n4\r\n1\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JUNE20\/hindi\/DIFVAL.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JUNE20\/bengali\/DIFVAL.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JUNE20\/mandarin\/DIFVAL.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JUNE20\/russian\/DIFVAL.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JUNE20\/vietnamese\/DIFVAL.pdf) as well.\r\n\r\nDanya has a rooted tree with $N$ nodes (numbered $1$ through $N$). Node $1$ is the root and for each $i$ ($2 \\le i \\le N$), the parent of the $i$-th node is $p_i$. For each valid $i$, the $i$-th node also has a value $a_i$.\r\n\r\nDanya really loves his tree and wants to play with it. You should answer his $Q$ queries. In each query:\r\n- You are given two integers $X$ and $D$.\r\n- Consider the set $S$ of all nodes $v$ that lie in the subtree of node $X$ (including $X$) such that the distance between $X$ and $v$ does not exceed $D$.\r\n- The answer to this query is the number of different values $a_v$ among all $v \\in S$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains a single integer $N$.\r\n- The second line contains $N-1$ space-separated integers $p_2, p_3, \\ldots, p_N$.\r\n- The third line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$.\r\n- The fourth line contains a single integer $Q$.\r\n- $Q$ lines follow. Each of these lines contains two space-separated integers $x$ and $d$ describing a query; the parameters $X$ and $D$ can be computed in the following way:\r\n    - Let's denote the answer to the previous query by $ans$ ($ans = 0$ if this is the first query).\r\n    - Then, $X = x \\oplus ans$ and $D = d \\oplus ans$, where $\\oplus$ denotes the bitwise XOR operator.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the answer to the query.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 5$\r\n- $1 \\le N \\le 2 \\cdot 10^5$\r\n- $1 \\le p_i \\le i-1$ for each valid $i$\r\n- $1 \\le a_i \\le N$ for each valid $i$\r\n- $1 \\le Q \\le 2 \\cdot 10^5$\r\n- $0 \\le x, d \\le 4 \\cdot 10^5$\r\n- $1 \\le X \\le N$\r\n- $0 \\le D \\le N$\r\n\r\n### Subtasks\r\n**Subtask #1 (16 points):** $N, Q \\le 1,000$\r\n\r\n**Subtask #2 (24 points):** the tree is a bamboo, i.e. $p_i = i-1$ for each valid $i$\r\n\r\n**Subtask #3 (60 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n11\r\n1 2 2 2 4 4 1 8 8 10\r\n5 3 2 3 1 1 2 4 1 2 3\r\n9\r\n2 1\r\n1 1\r\n2 3\r\n0 0\r\n2 1\r\n4 6\r\n13 4\r\n11 1\r\n13 4","output":"3\r\n3\r\n1\r\n3\r\n5\r\n5\r\n3\r\n4\r\n1","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"3.3","source_sizelimit":"50000","problem_author":"sonechko","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>sonechko<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"20-05-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/june20'>june20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/persistence'>persistence<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rajarshi_basu'>rajarshi_basu<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/small-to-large'>small-to-large<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sonechko'>sonechko<\/a>","problem_difficulty_level":"Medium-Hard","user_zen_mode":false,"best_tag":"Segment Tree","editorial_url":"https:\/\/discuss.codechef.com\/problems\/DIFVAL","time":{"view_start_date":1592213402,"submit_start_date":1592213402,"visible_start_date":1592213402,"end_date":1735669800,"current":1643797993},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=DIFVAL","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}