{"category_name":"hard","status":"success","problem_code":"DEG3MAXT","problem_name":"Three-Degree-Bounded Maximum Cost Subtree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in Mandarin Chinese <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/OCT13\/mandarin\/DEG3MAXT.pdf\">here<\/a><\/h3>\n<h3>Problem Statement<\/h3>\n<p>Chef has become a rich man and now owns the entire road network in the country, which consists of <b>N<\/b> cities (numbered from <b>1<\/b> to <b>N<\/b>) and <b>M<\/b> bidirectional roads. Each road connects two different cities <b>i<\/b> and <b>j<\/b> and has a cost <b>C(i,j)<\/b> - this is the cost paid by the drivers which use this road (and, thus, it is Chef's profit). The road network has the following properties:\n<ul>\n<li>it is possible to reach any city from any other city using the existing roads<\/li>\n<li>any subset <b>S<\/b> of <b>10<\/b> or more cities contains at least two different cities <b>A<\/b> and <b>B<\/b> such that all the paths between <b>A<\/b> and <b>B<\/b> have at least one city <b>X<\/b> (<b>X\u2260A<\/b> and <b>X\u2260B<\/b>) in common (note that <b>X<\/b> does not necessarily belong to <b>S<\/b>) - note that this implies that if the city <b>X<\/b> were to be removed from the network, then no path would exist anymore between the cities <b>A<\/b> and <b>B<\/b><\/li>\n<\/ul>\n<\/p>\n<p>However, the anti-monopoly committee decided that Chef is making too much money and that some restrictions should be imposed. Chef will be allowed to keep a part <b>P<\/b> of the road network that he chooses, provided that:\n<ul>\n<li>there exists exactly one path from any city in <b>P<\/b> to any other city in <b>P<\/b> using only the roads from <b>P<\/b> (this means that the sets of cities and roads from <b>P<\/b> form a tree)<\/li>\n<li>every city from <b>P<\/b> has <b>at most 3<\/b> roads from <b>P<\/b> adjacent to it\n<\/li><\/ul>\n<\/p>\n<p>Note that <b>P<\/b> may consist of any subset of the <b>N<\/b> cities and any subset of roads connecting these cities, as long as the two restrictions are satisfied. However, Chef doesn't want to simply pick any part <b>P<\/b> of the road network which satisfies the restrictions. He would like to choose a part <b>P<\/b> for which the total cost of the roads which belong to <b>P<\/b> is <b>maximum<\/b>. Moreover, he would also like to know how many such parts <b>P<\/b> of maximum total cost exist. Two parts <b>P1<\/b> and <b>P2<\/b> are considered different if their subsets of cities are different or if their subsets of roads are different.<\/p>\n<h3>Input<\/h3>\n<p>The first line contains the integer number <b>T<\/b> denoting the number of test cases. The description of the <b>T<\/b> test cases follows. The first line of each test case contains the integer numbers <b>N<\/b> and <b>M<\/b>. Each of the next <b>M<\/b> lines contains three space-separated integers: <b>i, j<\/b> and <b>C(i,j)<\/b>, meaning that there is a road between the cities <b>i<\/b> and <b>j<\/b> having cost <b>C(i,j)<\/b>.<\/p>\n<h3>Output<\/h3>\n<p>For each test case print a line containing two numbers: <b>CMAX<\/b> and <b>CNT32<\/b>. <b>CMAX<\/b> is the maximum cost of any part <b>P<\/b> which satisfies the restrictions imposed by the anti-monopoly committee. Let <b>CNT<\/b> be the total number of different parts <b>P<\/b> which have maximum cost and satisfy the restrictions. <b>CNT32<\/b> is equal to <b>CNT modulo 2<sup>32<\/sup><\/b> (i.e. we are only interested in the remainder of <b>CNT<\/b> when divided by <b>2<sup>32<\/sup><\/b>).<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>6<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>100<\/b><\/li>\n<li><b>N-1<\/b> \u2264 <b>M<\/b> \u2264 <b>min(N\u00d7(N-1)\/2, 450)<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>i, j<\/b> \u2264 <b>N<\/b> (<b>i\u2260j<\/b>)<\/li>\n<li><b>-10000<\/b> \u2264 <b>C(i,j)<\/b> \u2264 <b>10000<\/b><\/li>\n<li>There exists at most one road connecting each pair of different cities.<\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n6\n6 7\n1 3 1\n3 5 2\n5 1 3\n5 2 1\n2 4 2\n4 6 3\n6 5 1\n4 4\n1 2 0\n2 3 0\n3 4 0\n2 4 0\n4 4\n1 2 -1\n2 3 -2\n3 4 -3\n2 4 -4\n8 7\n1 2 1\n2 3 1\n3 4 1\n4 5 -2\n5 6 1\n6 7 1\n7 8 1\n8 7\n1 2 1\n2 3 1\n3 4 1\n4 5 -3\n5 6 1\n6 7 1\n7 8 1\n8 7\n1 2 1\n1 3 2\n1 4 3\n1 5 4\n1 6 5\n1 7 6\n1 8 7\n\n<b>Output:<\/b>\n11 2\n0 17\n0 5\n4 1\n3 3\n18 1\n<\/pre><p\/>\n<h3>Explanation<\/h3>\n<p><b>Example case 1.<\/b> The maximum cost of a part P which satisfies the restrictions is 11. There are two such maximum cost parts, both of them containing all the cities and the following roads:\n<ul>\n<li><b>(1,5), (2,5), (2,4), (3,5), (4,6)<\/b><\/li>\n<li><b>(1,5), (2,4), (3,5), (4,6), (5,6)<\/b><\/li>\n<\/ul>\n<\/p>\n<p><b>Example case 2.<\/b> All the roads have cost 0, thus the maximum cost of any part P satisfying the restrictions is 0. The 17 different parts are as follows:\n<ul>\n<li>1 part containing 0 cities<\/li>\n<li>4 parts containing 1 city (1 part for each of the 4 cities)<\/li>\n<li>4 parts containing 2 cities and the road between them: {1,2}, {2, 3}, {2,4} and {3,4}<\/li>\n<li>5 parts containing 3 cities:\n<ul>\n<li>cities 1, 2, 3 and the roads (1,2) and (2,3)<\/li>\n<li>cities 1, 2, 4 and the roads (1,2) and (2,4)<\/li>\n<li>cities 2, 3, 4 and the roads (2,3) and (3,4)<\/li>\n<li>cities 2, 3, 4 and the roads (2,3) and (2,4)<\/li>\n<li>cities 2, 3, 4 and the roads (2,4) and (3,4)<\/li>\n<\/ul>\n<\/li>\n<li>3 parts containing all the 4 cities and the following roads:\n<ul>\n<li>(1,2), (2,3), (3,4)<\/li>\n<li>(1,2), (2,3), (2,4)<\/li>\n<li>(1,2), (2,4), (3,4)<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/p>\n<p><b>Example case 3.<\/b> The maximum cost part P which satisfies the restrictions does not contain any of the roads. Thus, there are 5 possible ways of choosing P, consisting of the following sets of cities: <b>{1}, {2}, {3}, {4}, {}<\/b>.\n<\/p>\n<p><b>Example case 4.<\/b> Chef decides to keep the entire road network, because it satisfies the restrictions and has the maximum total cost among all of its parts.\n<\/p>\n<p><b>Example case 5.<\/b> Chef has 3 choices for the maximum cost part (whose cost is 3):\n<ul>\n<li>it can choose the entire road network<\/li>\n<li>it can choose the cities 1, 2, 3, 4 and the roads (1,2), (2,3), (3,4)<\/li>\n<li>it can choose the cities 5, 6, 7, 8 and the roads (5,6), (6,7), (7,8)<\/li>\n<\/ul>\n<\/p>\n<p><b>Example case 6.<\/b> Chef chooses the cities 1, 6, 7, 8 and the roads (1,6), (1,7), (1,8).\n<\/p>\n<\/p\/>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"7.5","source_sizelimit":"50000","problem_author":"mugurelionut","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>mugurelionut<\/span>","problem_tester":"shangjingbo","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>shangjingbo<\/span>","date_added":"24-07-2013","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>\n                    dynamic-programming\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/mugurelionut'>\n                    mugurelionut\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/oct13'>\n                    oct13\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/DEG3MAXT","user":{"username":null},"time":{"view_start_date":1381743000,"submit_start_date":1381743000,"visible_start_date":1381743000,"end_date":1735669800,"current":1493556683},"todo":false,"problem_status":"unattempted"}