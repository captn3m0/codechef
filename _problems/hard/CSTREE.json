{"category_name":"hard","status":"success","problem_code":"CSTREE","problem_name":"Complement Spanning Trees","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/AUG19\/hindi\/CSTREE.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/AUG19\/bengali\/CSTREE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/AUG19\/mandarin\/CSTREE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/AUG19\/russian\/CSTREE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/AUG19\/vietnamese\/CSTREE.pdf) as well.\n\nYou are given a small graph $G_s$ with $N$ nodes (numbered $1$ through $N$) and $M$ edges.\n\nLet's create a big graph $G_b$ with $NK$ nodes (numbered $1$ through $NK$) and $MK$ edges. $G_b$ consists of $K$ copies of $G_s$ \u2015 formally, for each $k$ ($0 \\le k \\le K-1$) and each edge between nodes $u$ and $v$ in $G_s$, there is an edge between nodes $u+kN$ and $v+kN$ in $G_b$.\n\nAfterwards, let's take the complement of $G_b$ and call it $H$ \u2015 formally, $H$ is a graph with $NK$ nodes (numbered $1$ through $NK$) such that for each pair of nodes, there is an edge between these two nodes in $H$ if and only if there is no edge between these two nodes in $G_b$.\n\nCount the number of spanning trees in $H$. Since this number could be very large, compute it modulo $998,244,353$.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains three space-separated integers $N$, $M$ and $K$.\n- Each of the next $M$ lines contains two space-separated integers $a$ and $b$ denoting that the nodes $a$ and $b$ in $G_s$ are connected by an edge.\n\n### Output\nFor each test case, print a single line containing one integer \u2015 the number of spanning trees in $H$ modulo $998,244,353$.\n\n### Constraints\n- $1 \\le T \\le 20$\n- $1 \\le N \\le 30$\n- $0 \\le M \\le N(N-1)\/2$\n- $1 \\le K \\le 10^8$\n- $1 \\le a, b \\le N$\n- $G_s$ does not contain any self-loops or multi-edges\n\n### Subtasks\n**Subtask #1 (15 points):** $K \\le 10$\n\n**Subtask #2 (19 points):**\n- $K \\le 50$\n- $M \\le 5$\n\n**Subtask #3 (21 points):**\n- $K \\le 5,000$\n- $M = N(N-1)\/2$\n\n**Subtask #4 (22 points):** $K \\le 5,000$\n\n**Subtask #5 (23 points):** original constraints\n\n### Example Input\n```\n5\n3 0 1\n3 3 2\n1 2\n1 3\n2 3\n3 3 1\n1 2\n1 3\n2 3\n6 9 20\n1 3\n2 3\n4 3\n5 3\n6 3\n1 4\n2 4\n4 5\n4 6\n30 4 5000\n1 2\n3 4\n5 6\n6 7\n```\n\n### Example Output\n```\n3\n81\n0\n13872131\n797280964\n```\n\n### Explanation\n**Example case 1:** $H$ is the complete graph on three nodes, so the number of spanning trees is $3$ (any two of the edges form a spanning tree).\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/AUG19\/hindi\/CSTREE.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/AUG19\/bengali\/CSTREE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/AUG19\/mandarin\/CSTREE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/AUG19\/russian\/CSTREE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/AUG19\/vietnamese\/CSTREE.pdf) as well.\n\nYou are given a small graph $G_s$ with $N$ nodes (numbered $1$ through $N$) and $M$ edges.\n\nLet's create a big graph $G_b$ with $NK$ nodes (numbered $1$ through $NK$) and $MK$ edges. $G_b$ consists of $K$ copies of $G_s$ \u2015 formally, for each $k$ ($0 \\le k \\le K-1$) and each edge between nodes $u$ and $v$ in $G_s$, there is an edge between nodes $u+kN$ and $v+kN$ in $G_b$.\n\nAfterwards, let's take the complement of $G_b$ and call it $H$ \u2015 formally, $H$ is a graph with $NK$ nodes (numbered $1$ through $NK$) such that for each pair of nodes, there is an edge between these two nodes in $H$ if and only if there is no edge between these two nodes in $G_b$.\n\nCount the number of spanning trees in $H$. Since this number could be very large, compute it modulo $998,244,353$.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains three space-separated integers $N$, $M$ and $K$.\n- Each of the next $M$ lines contains two space-separated integers $a$ and $b$ denoting that the nodes $a$ and $b$ in $G_s$ are connected by an edge.\n\n### Output\nFor each test case, print a single line containing one integer \u2015 the number of spanning trees in $H$ modulo $998,244,353$.\n\n### Constraints\n- $1 \\le T \\le 20$\n- $1 \\le N \\le 30$\n- $0 \\le M \\le N(N-1)\/2$\n- $1 \\le K \\le 10^8$\n- $1 \\le a, b \\le N$\n- $G_s$ does not contain any self-loops or multi-edges\n\n### Subtasks\n**Subtask #1 (15 points):** $K \\le 10$\n\n**Subtask #2 (19 points):**\n- $K \\le 50$\n- $M \\le 5$\n\n**Subtask #3 (21 points):**\n- $K \\le 5,000$\n- $M = N(N-1)\/2$\n\n**Subtask #4 (22 points):** $K \\le 5,000$\n\n**Subtask #5 (23 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"5\n3 0 1\n3 3 2\n1 2\n1 3\n2 3\n3 3 1\n1 2\n1 3\n2 3\n6 9 20\n1 3\n2 3\n4 3\n5 3\n6 3\n1 4\n2 4\n4 5\n4 6\n30 4 5000\n1 2\n3 4\n5 6\n6 7","output":"3\n81\n0\n13872131\n797280964","explanation":"**Example case 1:** $H$ is the complete graph on three nodes, so the number of spanning trees is $3$ (any two of the edges form a spanning tree).","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"lg5293","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>lg5293<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"24-06-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/algebra'>algebra<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/aug19'>aug19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fast-fourier-transform'>fast-fourier-transform<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/interpolation'>interpolation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kirchhoffs-matrix-tree-theorem'>kirchhoffs-matrix-tree-theorem<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/lg5293'>lg5293<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/polynomial'>polynomial<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/vijju123'>vijju123<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Fast Fourier Transform","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CSTREE","time":{"view_start_date":1565602202,"submit_start_date":1565602202,"visible_start_date":1565602202,"end_date":1735669800,"current":1643797993},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=CSTREE","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}