{"category_name":"hard","status":"success","problem_code":"EXPGROUP","problem_name":"Random Grouping","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME92\/hindi\/EXPGROUP.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME92\/bengali\/EXPGROUP.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME92\/mandarin\/EXPGROUP.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME92\/russian\/EXPGROUP.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME92\/vietnamese\/EXPGROUP.pdf) as well.\r\n\r\nThere are $N$ students numbered $1, 2, \\ldots, N$. Their teacher wants to group them. The teacher is a fan of randomness and uses the following :\r\nLet $g$ denote the current number of groups. First the teacher makes one group containing the student $1$. So, initially $g = 1$. Now, for each student $i$ from $2$ to $N$ in this order:\r\n- With probability $1 \/ (g + 1)$, he creates a new group containing only student $i$. So, now $g$ is increased by $1$.\r\n- With probability $g \/ (g + 1)$, he picks one of the $g$ groups at random and adds student $i$ to that group.\r\n\r\nFind the expected value of sum of squares of the group sizes. If the answer is $P \/ Q$ with $\\text{gcd}(P, Q) = 1$, print the value of $P Q^{-1}$ modulo $998244353$. Here $Q^{-1}$ denotes the modular inverse of $Q$ modulo $998244353$.\r\n\r\n###Input:\r\n\r\n- The only line of the input contains a single integer, $N$.\r\n\r\n###Output:\r\nFind the expected value of sum of squares of the group sizes modulo $998244353$.\r\n\r\n\r\n###Constraints \r\n- $1 \\leq N \\leq 10^5$\r\n\r\n###Subtasks\r\n**Subtask \\#1 \\(10 Points\\)**: $1 \\leq N \\leq 1000$\r\n\r\n**Subtask \\#2 \\(90 Points\\)**: original constraints\r\n\r\n###Sample Input 1:\r\n\t2\r\n\r\n###Sample Output 1:\r\n\t3\r\n\r\n\r\n###Sample Input 2:\r\n\t3\r\n\r\n###Sample Output 2:\r\n\t665496241\r\n\r\n### Explanation:\r\n\r\nIn the first example:\r\n- With probability $1 \/ 2$, there are two groups,  $\\{1\\}$ and $ \\{2\\}$. Sum of squares of sizes is $2$.\r\n- With probability $1 \/ 2$, there is a single group  $\\{1, 2\\}$. Sum of squares of sizes is $4$.\r\n\r\nSo, the required expected value is $1\/2 \\times 2 + 1 \/ 2 \\times 4 = 3$.\r\n\r\nIn the second example,\r\n- With probability $1 \/ 6$, there are three groups : $\\{1\\}$, $\\{2\\}$ and $ \\{3\\}$. The sum of squares of sizes here is $3$.\r\n- With probability $1 \/ 6$, there are two groups : $\\{1, 3\\}$ and $\\{2\\}$. The sum of squares of sizes here is $5$.\r\n- With probability $1 \/ 6$, there are two groups : $\\{1\\}$ and $\\{2, 3\\}$. The sum of squares of sizes here is $5$.\r\n- With probability $1\/4$, there are two groups : $\\{1, 2\\}$ and $\\{3\\}$. The sum of squares of sizes here is $5$.\r\n- With probability $1 \/ 4$, there is only one group : $\\{1, 2, 3\\}$. The sum of squares of sizes is $9$.\r\n\r\nThe expected value, therefore is $1 \/ 6 \\times (3 + 5 + 5) + 1 \/ 4 \\times (5 + 9) =\\dfrac{17}{3}$.\r\n\r\n$3^{-1} = 332748118$ modulo $998244353$. So, we print $17 \\times 332748118$ modulo $998244353 = 665496241$\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME92\/hindi\/EXPGROUP.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME92\/bengali\/EXPGROUP.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME92\/mandarin\/EXPGROUP.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME92\/russian\/EXPGROUP.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME92\/vietnamese\/EXPGROUP.pdf) as well.\r\n\r\nThere are $N$ students numbered $1, 2, \\ldots, N$. Their teacher wants to group them. The teacher is a fan of randomness and uses the following :\r\nLet $g$ denote the current number of groups. First the teacher makes one group containing the student $1$. So, initially $g = 1$. Now, for each student $i$ from $2$ to $N$ in this order:\r\n- With probability $1 \/ (g + 1)$, he creates a new group containing only student $i$. So, now $g$ is increased by $1$.\r\n- With probability $g \/ (g + 1)$, he picks one of the $g$ groups at random and adds student $i$ to that group.\r\n\r\nFind the expected value of sum of squares of the group sizes. If the answer is $P \/ Q$ with $\\text{gcd}(P, Q) = 1$, print the value of $P Q^{-1}$ modulo $998244353$. Here $Q^{-1}$ denotes the modular inverse of $Q$ modulo $998244353$.\r\n\r\n###Input:\r\n\r\n- The only line of the input contains a single integer, $N$.\r\n\r\n###Output:\r\nFind the expected value of sum of squares of the group sizes modulo $998244353$.\r\n\r\n\r\n###Constraints \r\n- $1 \\leq N \\leq 10^5$\r\n\r\n###Subtasks\r\n**Subtask \\#1 \\(10 Points\\)**: $1 \\leq N \\leq 1000$\r\n\r\n**Subtask \\#2 \\(90 Points\\)**: original constraints\r\n\r\n###Sample Input 1:\r\n\t2\r\n\r\n###Sample Output 1:\r\n\t3\r\n\r\n\r\n###Sample Input 2:\r\n\t3\r\n\r\n###Sample Output 2:\r\n\t665496241\r\n\r\n### Explanation:\r\n\r\nIn the first example:\r\n- With probability $1 \/ 2$, there are two groups,  $\\{1\\}$ and $ \\{2\\}$. Sum of squares of sizes is $2$.\r\n- With probability $1 \/ 2$, there is a single group  $\\{1, 2\\}$. Sum of squares of sizes is $4$.\r\n\r\nSo, the required expected value is $1\/2 \\times 2 + 1 \/ 2 \\times 4 = 3$.\r\n\r\nIn the second example,\r\n- With probability $1 \/ 6$, there are three groups : $\\{1\\}$, $\\{2\\}$ and $ \\{3\\}$. The sum of squares of sizes here is $3$.\r\n- With probability $1 \/ 6$, there are two groups : $\\{1, 3\\}$ and $\\{2\\}$. The sum of squares of sizes here is $5$.\r\n- With probability $1 \/ 6$, there are two groups : $\\{1\\}$ and $\\{2, 3\\}$. The sum of squares of sizes here is $5$.\r\n- With probability $1\/4$, there are two groups : $\\{1, 2\\}$ and $\\{3\\}$. The sum of squares of sizes here is $5$.\r\n- With probability $1 \/ 4$, there is only one group : $\\{1, 2, 3\\}$. The sum of squares of sizes is $9$.\r\n\r\nThe expected value, therefore is $1 \/ 6 \\times (3 + 5 + 5) + 1 \/ 4 \\times (5 + 9) =\\dfrac{17}{3}$.\r\n\r\n$3^{-1} = 332748118$ modulo $998244353$. So, we print $17 \\times 332748118$ modulo $998244353 = 665496241$","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"https:\/\/youtu.be\/vnszG0X15zo","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"jtnydv25","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>jtnydv25<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"28-11-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/expected-value'>expected-value<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/generating-functions'>generating-functions<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jtnydv25'>jtnydv25<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime92'>ltime92<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Generating Functions","editorial_url":"https:\/\/discuss.codechef.com\/problems\/EXPGROUP","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797995},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=EXPGROUP","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}