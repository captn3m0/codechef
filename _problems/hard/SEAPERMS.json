{"category_name":"hard","status":"success","problem_code":"SEAPERMS","problem_name":"Sereja and Permutations","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB16\/mandarin\/SEAPERMS.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB16\/russian\/SEAPERMS.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB16\/vietnamese\/SEAPERMS.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Sereja has an array <b>A<\/b> of <b>N<\/b> integers: <b>A[1], A[2], \u2026, A[N]<\/b>. Sereja also has an integer <b>D<\/b>.<\/p>\n<p>\nSereja calls a permutation <b>P[1], P[2], \u2026, P[N]<\/b> as <b><i>good<\/i><\/b> if the following conditions hold.<br \/>\n<b>A[P[1]] + D > A[P[2]]<\/b>,<br\/>\n<b>A[P[2]] + D > A[P[3]]<\/b>,<br\/>\n\u22ee<br\/>\n<b>A[P[N-1]] + D > A[P[N]]<\/b>.\n<\/p>\n<p>\nSereja wants to sequentially perform <b>M<\/b> single-element replacement operations on the array. Each of these operations consists of choosing an index <b>p<\/b> of the array, and replacing <b>A[p]<\/b> with a new value <b>v<\/b>. Your task is to keep track of the number of <i><b>good<\/b><\/i> permutations <b>P[1], P[2], \u2026, P[N]<\/b> after each operation.\n<\/p>\n\n\n<h3>Input<\/h3>\nThe first line of input contains the integers <b>N<\/b> and <b>D<\/b> described above. The next line contains <b>N<\/b> integers <b>A[1], A[2], \u2026, A[N]<\/b>. The line after this contains a single integer, <b>M<\/b>. Each of the next <b>M<\/b> lines contain two numbers <b>p<\/b> and <b>v<\/b>, implying that the new value of <b>A[p]<\/b> is <b>v<\/b>.\n\n<h3>Output<\/h3>\nOutput <b>M<\/b> lines. The <b>i<\/b><sup>th<\/sup> line should contain the number of good permutations modulo <b>10<sup>9<\/sup> + 7<\/b> after we perform the <b>i<\/b><sup>th<\/sup> replacement operation.\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>N, M<\/b> \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>A[i], v<\/b> \u2264 <b>10<sup>9<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>D <\/b> \u2264 <b>1000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>p<\/b> \u2264 <b>N<\/b><\/li>\n<\/ul>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>Subtask #1 :<\/b><b>N, M<\/b>  \u2264 <b>10<\/b> (10 points) <\/li>\n<li><b>Subtask #2 :<\/b><b>N, M<\/b>  \u2264 <b>20<\/b> (10 points) <\/li>\n<li><b>Subtask #3: <\/b><b>N, M<\/b>  \u2264 <b>1000<\/b> (20 points) <\/li>\n<li><b>Subtask #4: <\/b> original constrains (60 points) <\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n3 3\n1 2 3\n2\n1 2\n3 5\n\n<b>Output:<\/b>\n6\n2\n\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p><b>Example case 1.<\/b> After the first replacement operation, all permutations will be good. However, after the second operation, <b>P[1]<\/b> must be <b>3<\/b>.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"2 - 8","source_sizelimit":"50000","problem_author":"sereja","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>sereja<\/span>","problem_tester":"iscsi","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>iscsi<\/span>","date_added":"22-11-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/feb16'>\n                    feb16\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/sereja'>\n                    sereja\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/SEAPERMS","user":{"username":null},"time":{"view_start_date":1455528600,"submit_start_date":1455528600,"visible_start_date":1455528600,"end_date":1735669800,"current":1493556839},"todo":false,"problem_status":"unattempted"}