{"category_name":"hard","status":"success","problem_code":"SUMRECT","problem_name":"Sum of Areas","body":"### Read problem statements in [Mandarin](https:\/\/www.codechef.com\/download\/translated\/LTIME99\/mandarin\/SUMRECT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME99\/russian\/SUMRECT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME99\/vietnamese\/SUMRECT.pdf) as well.\n\nLet a $(x, y)$ rectangle denote an axis-aligned rectangle with width equal to $x$ and height equal to $y$, where $x$ and $y$ are positive integers.\n\nYou are given a $(N, M)$ rectangle. You must repeat the following process as long as your rectangle has at least one side longer than $1$:\n- Make a horizontal or vertical cut inside the rectangle, splitting it into two rectangles. The sides of both these rectangles must still be positive integers.\n- If the cut is horizontal, discard the bottom rectangle, otherwise discard the right rectangle. The process continues with the remaining rectangle.\n\nIn the end, you are left with a $(1, 1)$ rectangle --- a square with side length $1$.\n\nThere may be several possible ways or *paths* to reduce a $(N, M)$ rectangle to a $(1,1)$ rectangle. Let's define the cost of a path as the sum of areas of all rectangles present in that path, including the $(N,M)$ and $(1,1)$ rectangle.\n\nFor example, let's consider a $(2,2)$ rectangle. There are two possible paths to reduce a $(2,2)$ rectangle to a $(1,1)$ rectangle:\n- $(2,2) \\rightarrow (1,2) \\rightarrow (1,1)$\n- $(2,2) \\rightarrow (2,1) \\rightarrow (1,1)$\n\nThe cost of the first path is $2 \\cdot 2 + 1 \\cdot 2 + 1 \\cdot 1 = 7$, and similarly, the cost of the second path is $2 \\cdot 2 + 2 \\cdot 1 + 1 \\cdot 1 = 7$.\n\nYou are also given a known prime number $P$. Find the sum of costs of all possible paths modulo $P$.\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"- $1 \\leq T \\leq 4,000$\n- $1 \\leq N \\leq 10^5$\n- $1 \\leq M \\leq 10^8$\n- the sum of $N$ over all test cases does not exceed $10^5$\n","constraintsState":true,"subtasks":"**Subtask #1 (20 points):**\n- the sum of $N$ over all test cases does not exceed $1,000$\n- the sum of $M$ over all test cases does not exceed $1,000$\n- $P = 998,244,353$\n\n**Subtask #2 (10 points):** $P = 2$\n\n**Subtask #3 (70 points):** $P = 998,244,353$\n","subtasksState":true,"statement":"### Read problem statements in [Mandarin](https:\/\/www.codechef.com\/download\/translated\/LTIME99\/mandarin\/SUMRECT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME99\/russian\/SUMRECT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME99\/vietnamese\/SUMRECT.pdf) as well.\n\nLet a $(x, y)$ rectangle denote an axis-aligned rectangle with width equal to $x$ and height equal to $y$, where $x$ and $y$ are positive integers.\n\nYou are given a $(N, M)$ rectangle. You must repeat the following process as long as your rectangle has at least one side longer than $1$:\n- Make a horizontal or vertical cut inside the rectangle, splitting it into two rectangles. The sides of both these rectangles must still be positive integers.\n- If the cut is horizontal, discard the bottom rectangle, otherwise discard the right rectangle. The process continues with the remaining rectangle.\n\nIn the end, you are left with a $(1, 1)$ rectangle --- a square with side length $1$.\n\nThere may be several possible ways or *paths* to reduce a $(N, M)$ rectangle to a $(1,1)$ rectangle. Let's define the cost of a path as the sum of areas of all rectangles present in that path, including the $(N,M)$ and $(1,1)$ rectangle.\n\nFor example, let's consider a $(2,2)$ rectangle. There are two possible paths to reduce a $(2,2)$ rectangle to a $(1,1)$ rectangle:\n- $(2,2) \\rightarrow (1,2) \\rightarrow (1,1)$\n- $(2,2) \\rightarrow (2,1) \\rightarrow (1,1)$\n\nThe cost of the first path is $2 \\cdot 2 + 1 \\cdot 2 + 1 \\cdot 1 = 7$, and similarly, the cost of the second path is $2 \\cdot 2 + 2 \\cdot 1 + 1 \\cdot 1 = 7$.\n\nYou are also given a known prime number $P$. Find the sum of costs of all possible paths modulo $P$.\n","inputFormat":"- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first and only line of each test case contains three space-separated integers $N$, $M$ and $P$.\n","inputFormatState":true,"outputFormat":"For each test case, print a single line containing one integer --- the sum of costs of all paths modulo $P$.\n","outputFormatState":true,"sampleTestCases":[{"id":"1","input":"4\n1 1 998244353\n2 2 998244353\n3 3 998244353\n3 3 2\n","output":"1\n14\n260\n0","explanation":"","isDeleted":false},{"id":"2","input":"1\n10 10 998244353","output":"996017662","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"rivalq","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>rivalq<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"25-08-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/rivalq'>rivalq<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"","editorial_url":"","time":{"view_start_date":1630170002,"submit_start_date":1630170002,"visible_start_date":1630170002,"end_date":1735669800,"current":1643798001},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SUMRECT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}