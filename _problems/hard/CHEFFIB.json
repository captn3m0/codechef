{"category_name":"hard","status":"success","problem_code":"CHEFFIB","problem_name":"Chef, Leonardo And Queries","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/DEC17\/mandarin\/CHEFFIB.pdf\">Mandarin chinese<\/a>, <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/DEC17\/russian\/CHEFFIB.pdf\">Russian<\/a> and <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/DEC17\/vietnamese\/CHEFFIB.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Chef has a tree with <b>N<\/b> nodes numbered <b>1<\/b> through <b>N<\/b>. Initially, each node has value <b>0<\/b>.<\/p>\n\n<p>Chef's best friend Leonardo loves queries on trees. He asked Chef to perform <b>Q<\/b> queries. Each query is of one of the following two types:\n<ul>\n<li> <b>1 v k a b<\/b>: Consider <b>f(0) = a<\/b>, <b>f(1) = b<\/b>, <b>f(i) = f(i - 1) + f(i - 2)<\/b> for <b>i \u2265 2<\/b>. For each node <b>u<\/b> of the tree, let <b>d<\/b> be the distance (in edges) from <b>v<\/b> to <b>u<\/b>. Then, if <b>d<\/b> \u2264 <b>k<\/b>, Chef must add <b>f(d)<\/b> to the value of node <b>u<\/b>. <\/li>\n\n<li> <b>2 v<\/b>: Print the value of node <b>v<\/b> modulo <b>10^9 + 7<\/b>.<\/li>\n<\/ul>\n<\/p>\n\n<p>Help Chef perform Leonardo's queries! <\/p>\n\n<h3>Input<\/h3>\n<p><ul>\n<li>The first line of the input contains one integer <b>T<\/b> denoting the number of test cases.<\/li>\n\n<li>The first line of each test case contains two space-separated integers <b>N<\/b> and <b>Q<\/b>.<\/li>\n\n<li>Each of the next <b>N<\/b>-1 lines contains two space-separated integers <b>x<\/b> and <b>y<\/b> denoting an edge between nodes <b>x<\/b> and <b>y<\/b>.<\/li>\n\n<li><b>Q<\/b> lines follow. Each of these lines describes one query in the format above.<\/li>\n<\/ul><\/p>\n\n<h3>Output<\/h3>\n<p>For each query of type 2, print the answer to it on a separate line.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li> 1 \u2264 <b>T<\/b> \u2264 150 <\/li>\n<li> 1 \u2264 <b>N, Q<\/b> \u2264 300,000 <\/li>\n<li> 1 \u2264 sum of <b>N<\/b> over all testcases \u2264 300,000 <\/li>\n<li> 1 \u2264 sum of <b>Q<\/b> over all testcases \u2264 300,000 <\/li>\n<li> 1 \u2264 <b>v<\/b> \u2264 <b>N<\/b> <\/li>\n<li> 0 \u2264 <b>k<\/b> \u2264 <b>N<\/b> <\/li>\n<li> 0 \u2264 <b>a, b<\/b> \u2264 1,000,000,000 <\/li>\n<\/ul>\n\n<h3>Subtasks<\/h3>\n\n<p>\n<b>Subtask #1 (15 points):<\/b>\n<ul>\n<li>sum of all <b>N<\/b> \u2264 3000<\/li>\n<li>sum of all <b>Q<\/b> \u2264 3000<\/li>\n<\/ul>\n<\/p>\n\n<p>\n<b>Subtask #2 (85 points):<\/b> original constraints\n<\/p>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n\n1\n6 5\n4 5\n1 5\n5 2\n3 4\n6 1\n1 2 0 3 3\n2 2\n1 4 2 1 5\n1 1 2 5 4\n2 4\n\n<b>Output:<\/b>\n\n3\n10\n<\/pre>\n<p>\u00a0<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, CAML, CLOJ, CLPS, COB, CPP 4.3.2, CPP 6.3, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, kotlin, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.5, RUBY, rust, SCALA, SCM chicken, SCM guile, SCM qobi, ST, swift, TCL, TEXT, WSPC","max_timelimit":"4","source_sizelimit":"50000","problem_author":"kefaa","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>kefaa<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"23-11-2017","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/dec17'>\n                    dec17\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/kefaa'>\n                    kefaa\n                <\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CHEFFIB","time":{"view_start_date":1512984600,"submit_start_date":1512984600,"visible_start_date":1512984600,"end_date":1735669800,"current":1514816598},"user":{"username":null},"todo":false,"problem_status":"unattempted"}