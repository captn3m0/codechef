{"category_name":"hard","status":"success","problem_code":"PRECPAIR","problem_name":"Precise Pairing","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MAY20\/hindi\/PRECPAIR.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MAY20\/bengali\/PRECPAIR.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/mandarin\/PRECPAIR.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MAY20\/russian\/PRECPAIR.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/vietnamese\/PRECPAIR.pdf) as well.\r\n\r\n**This is the more general version of the problem BIPPAIR.**\r\n\r\n**ATTEN-SHUN!** Time for the squad to line up for inspection in the barracks. Your soldiers should form two lines of equal length, one on each side of the room. The lineup should create pairs of soldiers who can see each other, i.e. each soldier A should be looking directly at another soldier B, who is in turn looking at A.\r\n\r\nToday is a special day \u2015 your commanding officer (CO) is joining the inspection. As such, you want your soldiers to line themselves up in the best possible way. Your CO does not know which soldier sleeps in which bunk, so you are able to rearrange them to get a better lineup.\r\n\r\nThere are $N$ soldiers (numbered $0$ through $N-1$) and $\\frac{N(N-1)}{2} - M$ pairs of soldiers that are friends. You cannot have any two soldiers facing each other if they are friends, because friends might goof off during the inspection and embarrass you in front of your CO. Furthermore, certain pairings of soldiers that face each other work better than others \u2015 for each pair of soldiers that are not friends, you are given a certain value which this pair would add to the lineup. Then, the value of a lineup is the sum of values of all pairs of soldiers that face each other in that lineup.\r\n\r\nYour CO is keen \u2015 if the value of your lineup is too big, they might suspect that you are rigging it. On the other hand, if the total value is too small, you will not leave a great impression on the CO. If only you knew the greatest value you could reach such that you still avoid suspicion! To plan ahead, you want to know all values $K$ such that it is possible to construct a lineup with value $K$.\r\n\r\nFormally, you should find all integers $K$ such that it is possible to pair up the soldiers while satisfying the following conditions:\r\n- There are exactly $N\/2$ unordered pairs of soldiers.\r\n- Each soldier is part of exactly one pair.\r\n- Whenever two soldiers are paired, they are not friends.\r\n- The sum of values of all $N\/2$ pairs is exactly $K$.\r\n\r\nNote that unlike in the problem BIPPAIR, it may be impossible to partition the soldiers into two groups with size $N\/2$ such that any two soldiers that are not friends are in different groups.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $M$.\r\n- Each of the following $M$ contains three space-separated integers $a$, $b$ and $v$ denoting that soldiers $a$ and $b$ are not friends and their pairing has value $v$.\r\n\r\n### Output\r\nIf there is no valid lineup, print a single line containing the string `\"YOU ARE IN TROUBLE\"` (without quotes).\r\n\r\nOtherwise, print two lines.\r\n- The first of these lines should contains a single integer $V$ \u2015 the number of distinct integers $K$ such that a valid lineup with value $K$ exists.\r\n- The second line should contain $V$ space-separated integers \u2015 these values of $K$ in increasing order.\r\n\r\n### Constraints\r\n- $2 \\le N \\le 100$\r\n- $N$ is even\r\n- $0 \\le M \\le N \\cdot (N-1) \/ 2$\r\n- $0 \\le a \\lt b \\lt N$\r\n- all pairs $(a, b)$ are pairwise distinct\r\n- $0 \\le v \\le 20$\r\n\r\n### Subtasks\r\n**Subtask #1 (30 points):** $v \\le 1$\r\n\r\n**Subtask #2 (70 points):** original constraints\r\n\r\n### Example Input 1\r\n```\r\n4 5\r\n0 1 1\r\n0 2 0\r\n0 3 5\r\n1 3 0\r\n2 3 2\r\n```\r\n\r\n### Example Output 1\r\n```\r\n2\r\n0 3\r\n```\r\n\r\n### Explanation\r\nThere are exactly two valid lineups: $[(0,1), (2,3)]$, which has value $3$, and $[(0,2), (1, 3)]$, which has value $0$.\r\n\r\n### Example Input 2\r\n```\r\n4 6\r\n0 1 1\r\n0 2 0\r\n0 3 1\r\n1 2 2\r\n1 3 0\r\n2 3 2\r\n```\r\n\r\n### Example Output 2\r\n```\r\n2\r\n0 3\r\n```\r\n\r\n### Explanation\r\nThere are three valid lineups: $[(0, 1), (2, 3)]$ with value $3$, $[(0, 2), (1, 3)]$ with value $0$ and $[(0, 3), (1, 2)]$ with value $3$.\r\n\r\n### Example Input 3\r\n```\r\n2 1\r\n0 1 3\r\n```\r\n\r\n### Example Output 3\r\n```\r\n1\r\n3\r\n```\r\n\r\n### Explanation\r\nThere is only a single lineup $[(0,1)]$ and its value is $3$.\r\n\r\n### Example Input 4\r\n```\r\n4 3\r\n0 1 1\r\n0 2 1\r\n0 3 1\r\n```\r\n\r\n### Example Output 4\r\n```\r\nYOU ARE IN TROUBLE\r\n```\r\n\r\n### Explanation\r\nThere is no way to pair up the soldiers such that no two friends face each other.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MAY20\/hindi\/PRECPAIR.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MAY20\/bengali\/PRECPAIR.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/mandarin\/PRECPAIR.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MAY20\/russian\/PRECPAIR.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MAY20\/vietnamese\/PRECPAIR.pdf) as well.\r\n\r\n**This is the more general version of the problem BIPPAIR.**\r\n\r\n**ATTEN-SHUN!** Time for the squad to line up for inspection in the barracks. Your soldiers should form two lines of equal length, one on each side of the room. The lineup should create pairs of soldiers who can see each other, i.e. each soldier A should be looking directly at another soldier B, who is in turn looking at A.\r\n\r\nToday is a special day \u2015 your commanding officer (CO) is joining the inspection. As such, you want your soldiers to line themselves up in the best possible way. Your CO does not know which soldier sleeps in which bunk, so you are able to rearrange them to get a better lineup.\r\n\r\nThere are $N$ soldiers (numbered $0$ through $N-1$) and $\\frac{N(N-1)}{2} - M$ pairs of soldiers that are friends. You cannot have any two soldiers facing each other if they are friends, because friends might goof off during the inspection and embarrass you in front of your CO. Furthermore, certain pairings of soldiers that face each other work better than others \u2015 for each pair of soldiers that are not friends, you are given a certain value which this pair would add to the lineup. Then, the value of a lineup is the sum of values of all pairs of soldiers that face each other in that lineup.\r\n\r\nYour CO is keen \u2015 if the value of your lineup is too big, they might suspect that you are rigging it. On the other hand, if the total value is too small, you will not leave a great impression on the CO. If only you knew the greatest value you could reach such that you still avoid suspicion! To plan ahead, you want to know all values $K$ such that it is possible to construct a lineup with value $K$.\r\n\r\nFormally, you should find all integers $K$ such that it is possible to pair up the soldiers while satisfying the following conditions:\r\n- There are exactly $N\/2$ unordered pairs of soldiers.\r\n- Each soldier is part of exactly one pair.\r\n- Whenever two soldiers are paired, they are not friends.\r\n- The sum of values of all $N\/2$ pairs is exactly $K$.\r\n\r\nNote that unlike in the problem BIPPAIR, it may be impossible to partition the soldiers into two groups with size $N\/2$ such that any two soldiers that are not friends are in different groups.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $M$.\r\n- Each of the following $M$ contains three space-separated integers $a$, $b$ and $v$ denoting that soldiers $a$ and $b$ are not friends and their pairing has value $v$.\r\n\r\n### Output\r\nIf there is no valid lineup, print a single line containing the string `\"YOU ARE IN TROUBLE\"` (without quotes).\r\n\r\nOtherwise, print two lines.\r\n- The first of these lines should contains a single integer $V$ \u2015 the number of distinct integers $K$ such that a valid lineup with value $K$ exists.\r\n- The second line should contain $V$ space-separated integers \u2015 these values of $K$ in increasing order.\r\n\r\n### Constraints\r\n- $2 \\le N \\le 100$\r\n- $N$ is even\r\n- $0 \\le M \\le N \\cdot (N-1) \/ 2$\r\n- $0 \\le a \\lt b \\lt N$\r\n- all pairs $(a, b)$ are pairwise distinct\r\n- $0 \\le v \\le 20$\r\n\r\n### Subtasks\r\n**Subtask #1 (30 points):** $v \\le 1$\r\n\r\n**Subtask #2 (70 points):** original constraints\r\n\r\n### Example Input 1\r\n```\r\n4 5\r\n0 1 1\r\n0 2 0\r\n0 3 5\r\n1 3 0\r\n2 3 2\r\n```\r\n\r\n### Example Output 1\r\n```\r\n2\r\n0 3\r\n```\r\n\r\n### Explanation\r\nThere are exactly two valid lineups: $[(0,1), (2,3)]$, which has value $3$, and $[(0,2), (1, 3)]$, which has value $0$.\r\n\r\n### Example Input 2\r\n```\r\n4 6\r\n0 1 1\r\n0 2 0\r\n0 3 1\r\n1 2 2\r\n1 3 0\r\n2 3 2\r\n```\r\n\r\n### Example Output 2\r\n```\r\n2\r\n0 3\r\n```\r\n\r\n### Explanation\r\nThere are three valid lineups: $[(0, 1), (2, 3)]$ with value $3$, $[(0, 2), (1, 3)]$ with value $0$ and $[(0, 3), (1, 2)]$ with value $3$.\r\n\r\n### Example Input 3\r\n```\r\n2 1\r\n0 1 3\r\n```\r\n\r\n### Example Output 3\r\n```\r\n1\r\n3\r\n```\r\n\r\n### Explanation\r\nThere is only a single lineup $[(0,1)]$ and its value is $3$.\r\n\r\n### Example Input 4\r\n```\r\n4 3\r\n0 1 1\r\n0 2 1\r\n0 3 1\r\n```\r\n\r\n### Example Output 4\r\n```\r\nYOU ARE IN TROUBLE\r\n```\r\n\r\n### Explanation\r\nThere is no way to pair up the soldiers such that no two friends face each other.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"5","source_sizelimit":"50000","problem_author":"zac_adm","problem_author_html_handle":"zac_adm","problem_tester":null,"problem_tester_html_handle":"","date_added":"16-04-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/algebra'>algebra<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/determinant'>determinant<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/matching'>matching<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/may20'>may20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/polynomial'>polynomial<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/randomized'>randomized<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/super-hard'>super-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/zac_adm'>zac_adm<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/zac_adm'>zac_adm<\/a>","problem_difficulty_level":"Super-Hard","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/PRECPAIR","time":{"view_start_date":1589189402,"submit_start_date":1589189402,"visible_start_date":1589189402,"end_date":1735669800,"current":1643797999},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=PRECPAIR","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}