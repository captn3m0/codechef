{"category_name":"hard","status":"success","problem_code":"DRAGONST","problem_name":"Dragonstone","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME15\/mandarin\/DRAGONST.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME15\/russian\/DRAGONST.pdf\">Russian<\/a>.<\/h3>\n<p><i>Dragonstone is the name of the island located at the entrance to Blackwater Bay and the castle thereon, which was shaped from stone to look like dragons. Dragonstone was the original seat of House Targaryen in Westeros, which they had colonized and fortified as the westernmost outpost of the Valyrian Freehold.<\/i><\/p>\n<p align=\"right\">(c) A Wiki of Ice and Fire<\/p>\n<p><img src=\"\/download\/extimages\/5423a2b5abc2376c9e1cab20b3b68ddf.jpg\" height=\"250\" \/><\/p>\n<p>After Robert's Rebellion(also known as the War of the Usurper), the island passed to Stannis Baratheon, who became the Lord of Dragonstone. It turned out, that there's a lot of secret chambers hidden underground the castle.<\/p>\n<p>In this problem we assume, that the secret chambers can be described as <b>N<\/b> points on the Cartesian plane, both coordinates of which are integers. The points are indexed with integers from 1 to <b>N<\/b>. There's a bidirected passage between any pair of the chambers.<\/p>\n<p>Let's consider two chambers <b>A(x<sub>1<\/sub>, y<sub>1<\/sub>)<\/b> and <b>B(x<sub>2<\/sub>, y<sub>2<\/sub>)<\/b>. Then it takes <b>|x1 - x2| + |y1 - y2|<\/b> minutes to travel through the passage, that connects chambers <b>A<\/b> and <b>B<\/b>.<\/p>\n<p>The passages are extremely dark, so it isn't safe to travel through them without a lantern.<\/p>\n<p>Stannis Baratheon has a very special lantern, which he's planning to use during the next <b>Q<\/b> trips between the secret chambers. Let's consider a single trip:<\/p>\n<p>At first, Stannis chooses a chamber <b>S<\/b> - where he's starting the trip - and a chamber <b>F<\/b> - where he's finishing the trip. After that, he chooses an integer <b>C<\/b>, which is the <i>capacity<\/i> of the lantern for the current trip. Stannis can refill the oil in his lantern at any chamber, but not passage. It means, that he cannot walk passages, that take more than <b>C<\/b> minutes to travel through. If <b>C<\/b> is too small, then there's a chance that Stannis won't be able to travel from chamber <b>S<\/b> to chamber <b>F<\/b>. On other hand, if <b>C<\/b> is too large, then the lantern will be quite heavy and Stannis will be exhausted by the end of the trip.<\/p>\n<p>Your task is pretty simple: determine the minimal number <b>C<\/b> for each Stannis's trip, such that he will be able to travel from <b>S<\/b> to <b>F<\/b>.<\/p>\n<h3>Note<\/h3>\n<p>\nMaybe, some of you aren't familiar with definitions from the statement. Here're some articles that could help you to understand the problem correctly:<\/p>\n<ul>\n<li>Cartesian plane: <a href=\"http:\/\/en.wikipedia.org\/wiki\/Cartesian_plane\">http:\/\/en.wikipedia.org\/wiki\/Cartesian_plane<\/a><\/li>\n<\/ul>\n\n<h3>Input<\/h3>\n<p>The first line of the input contains an integer <b>T<\/b>, denoting the number of testcases. The description of <b>T<\/b> testcases follows.<\/p>\n\n<p>The first line of each testcase contains an integer <b>N<\/b>, denoting the number of the secret chambers.<\/p>\n<p>The next <b>N<\/b> lines contain two integers <b>X<\/b> and <b>Y<\/b> each, denoting the coordinates of the corresponding chamber.<\/p>\n<p>The next line contains an integer <b>Q<\/b>, denoting the number of Stannis's trips between the secret chambers.<\/p>\n<p>The next <b>Q<\/b> lines contain two integers <b>S<\/b> and <b>F<\/b> each, denoting the start and the finish chambers of the corresponding trip.<\/p>\n<h3>Output<\/h3>\n<p>The output of each test case should contain <b>Q<\/b> lines, <b>i<\/b>'th line should contain one integer: the minimal number <b>C<\/b> for <b>i<\/b>'th Stannis's trip, such that he will be able to travel from <b>S<\/b> to <b>F<\/b>.<\/p>\n<p>Do not add any newlines between different testcases.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>T<\/b> \u2264 4, for each input file;<\/li>\n<li>1 \u2264 <b>S<\/b> \u2260 <b>F<\/b> \u2264 <b>N<\/b>, for each testcase;<\/li>\n<li>0 \u2264 <b>X<\/b>, <b>Y<\/b> \u2264 10<sup>9<\/sup>, for each testcase.<\/li>\n<li>Subtask 1(15 points): 1 \u2264 <b>N<\/b> \u2264 5000, 1 \u2264 <b>Q<\/b> \u2264 5;<\/li>\n<li>Subtask 2(15 points): 1 \u2264 <b>N<\/b> \u2264 5000, 1 \u2264 <b>Q<\/b> \u2264 200000;<\/li>\n<li>Subtask 3(35 points): 1 \u2264 <b>N<\/b> \u2264 200000, 1 \u2264 <b>Q<\/b> \u2264 5;<\/li>\n<li>Subtask 4(35 points): 1 \u2264 <b>N<\/b> \u2264 200000, 1 \u2264 <b>Q<\/b> \u2264 200000.<\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\n4\n0 0\n0 1\n1 0 \n1 1\n2\n1 2\n1 4\n4\n0 0\n0 2\n0 9\n0 12\n2\n1 4\n3 4\n\n\n<b>Output:<\/b>\n1\n1\n7\n3\n<\/pre><h3>Explanation<\/h3>\n<p>First testcase: <\/p>\n<p>First trip: When <b>C<\/b> = 1, Stannis can use 1-2 passage and he will reach the destination;<\/p>\n<p>Second trip: When <b>C<\/b> = 1, Stannis can use 1-2 and 2-4 passages and he will reach the destination.<\/p>\n\n<p>Second testcase: <\/p>\n<p>First trip: When <b>C<\/b> = 7, Stannis can use 1-2, 2-3 and 3-4 passage and he will reach the destination;<\/p>\n<p>Second trip: When <b>C<\/b> = 3, Stannis can use 3-4 passages and he will reach the destination.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"8","source_sizelimit":"50000","problem_author":"kostya_by","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>kostya_by<\/span>","problem_tester":"stzgd","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>stzgd<\/span>","date_added":"2-08-2014","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/graph'>\n                    graph\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/kostya_by'>\n                    kostya_by\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/lca'>\n                    lca\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ltime15'>\n                    ltime15\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/mst'>\n                    mst\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/tree'>\n                    tree\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/DRAGONST","user":{"username":null},"time":{"view_start_date":1409473800,"submit_start_date":1409473800,"visible_start_date":1409473800,"end_date":1735669800,"current":1493556697},"todo":false,"problem_status":"unattempted"}