{"category_name":"hard","status":"success","problem_code":"SHRINES","problem_name":"Brahma and Shiva","body":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/APRIL21\/bengali\/SHRINES.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/APRIL21\/mandarin\/SHRINES.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/APRIL21\/russian\/SHRINES.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/APRIL21\/vietnamese\/SHRINES.pdf) as well.\r\n\r\n**This in an interactive problem**\r\n\r\nBrahma created a bidimensional world, he started from a giant circle and placed $2 \\cdot N$ points (numbered $1$ through $2 \\cdot N$) in clockwise order on the circumference. Then Brahma created many regions by consecutively taking two of the points and slicing the circle with a line segment connecting them. The slices are such that the following conditions are satisfied:\r\n- There is exactly one slice going through each point on the perimeter\r\n- No three segments intersect at one point\r\n- There are no three segments that pairwise intersect each other\r\n\r\nAfter the slices, the points resulting from the intersection of two segments were numbered arbitrarily with consecutive integers from $2\\cdot N + 1$ through $V$. An unordered pair $(p,q)$ is *good*, if there is a slice that passes through points $p$ and $q$, and none of the other $V-2$ points lies in the segment $pq$. There are  in total $M$ distinct good pairs, for each valid $i$, the $i-$th good pair is $(p_i,q_i)$.\r\n\r\nBrahma stablished a city in each of the connected regions with finite area (numbered $1$ through $C$). For each valid $i$, let $R_i$ denote the sequence of indices of the points on the perimeter of the $i$-th region in increasing order. Brahma numbered the cities in lexicographically increasing order ($R_i \\lt R_{i+1}$).\r\n\r\nThen, each of the $K$ gods chose one of the regions to build their home, no city was chosen as the home of more than one god. Let $S$ be the set of cities chosen by the gods.\r\n\r\nIt is possible to travel from one city to another, if their respective regions share an edge. Let $D(u, v)$ be the length of the shortest path between cities $u$ and $v$ i.e the minimum number of edges we have to cross to go from $u$ to $v$. The *beauty* of city $u$ is given by $\\frac{1}{\\sum_{v \\in S} D(u,v)}$. The cities that have the maximum beauty among all the cities are called *holy cities*.\r\n\r\nSome eons later, Shiva decided that is time to destroy the world, the only way to calm his fury is to build a shrine in each holy city. After so much time we don't remember which cities are holy neither which cities are home of a god! However we have a plan, we'll organize many festivities to gather information. In each festivity the following happens: \r\n\r\n* We choose two cities $u$, $v$ ($u \\neq v$) and all the gods are invited to go to any of those cities.\r\n* Each god goes to the city nearest to their home. if both $u$ and $v$ are at the same distance, then that god does not assist to the festivity.\r\n* We count the number of gods that assisted to each of the two cities.\r\n\r\nYour task is to save the world by organizing at most $C$ festivities to find the holy cities.\r\n\r\n### Interaction\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of interaction for $T$ test cases follows.\r\n- For each test case, you should start by reading a line containing four space-separated integers $N$, $V$, $M$, $K$.\r\n- The next $M$ lines contains two space-separated integers $p_i$ and $q_i$.\r\n- Then, you may start organizing the festivities.\r\n    - To create a festivity, you should print a line containing three space-separated integers $1$, $u$, $v$.\r\n    - Then, you should read a line containing two space-seprated integers $x$, $y$ \u2015 the number of gods that attended city $u$ and $v$ respectively.\r\n    - If the festivity is invalid or if you organized too many festivities, you will receive the wrong answer verdict.\r\n- When you have determined which are the holy cities, you should print a line containing $L + 2 $ space-separated integers $2$, $L$, $H_1$,..., $H_L$, where for each valid $i$, $H_i$ is the index of the $i$-th holy city in increasing order ($H_i \\lt H_{i+1}$).\r\n\r\nDon't forget to flush the output after printing each line!\r\n\r\n### Constraints\r\n- $4 \\leq C \\leq 300$\r\n- The sum of $C$ over all test cases doesn't exceed $10^4$\r\n- $2 \\leq K \\leq C$\r\n- Is guaranteed that there is only one way of reconstructing the cities from the $M$ good pairs.\r\n### Subtasks\r\n**Subtask #1 (20 points):** $K=2$\r\n\r\n**Subtask #2 (80 points):** Original constraints\r\n\r\n### Example\r\n```\r\nGrader          You\r\n1\r\n4 10 8 2\r\n1 10\r\n2 10\r\n3 9\r\n4 9\r\n5 9\r\n6 10\r\n7 8\r\n9 10\r\n                1 3 7\r\n1 1                                                               \r\n                1 1 5\r\n1 1\r\n                2 6 1 2 3 4 5 6\r\n```\r\n\r\n### Explanation\r\nThe following figure describes the cities created by Brahma\r\n<img src=\"https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/APRIL21\/SHRINES\/SHRINES.png\"><\/img>\r\n\r\nThe cities are numbered lexicographically. $R_2 = (1,6,7,8,10)$, $R_6=(5,6,9,10)$, $R_7=(7,8)$\r\n\r\nThere are two gods at cities $2$ and $4$. \r\n\r\nIn the second festivity, the god at city $2$ goes to city $1$, and the god at city $4$ goes to $5$. \r\n\r\nAll cities except $7$ are holy.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Bengali](https:\/\/www.codechef.com\/download\/translated\/APRIL21\/bengali\/SHRINES.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/APRIL21\/mandarin\/SHRINES.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/APRIL21\/russian\/SHRINES.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/APRIL21\/vietnamese\/SHRINES.pdf) as well.\r\n\r\n**This in an interactive problem**\r\n\r\nBrahma created a bidimensional world, he started from a giant circle and placed $2 \\cdot N$ points (numbered $1$ through $2 \\cdot N$) in clockwise order on the circumference. Then Brahma created many regions by consecutively taking two of the points and slicing the circle with a line segment connecting them. The slices are such that the following conditions are satisfied:\r\n- There is exactly one slice going through each point on the perimeter\r\n- No three segments intersect at one point\r\n- There are no three segments that pairwise intersect each other\r\n\r\nAfter the slices, the points resulting from the intersection of two segments were numbered arbitrarily with consecutive integers from $2\\cdot N + 1$ through $V$. An unordered pair $(p,q)$ is *good*, if there is a slice that passes through points $p$ and $q$, and none of the other $V-2$ points lies in the segment $pq$. There are  in total $M$ distinct good pairs, for each valid $i$, the $i-$th good pair is $(p_i,q_i)$.\r\n\r\nBrahma stablished a city in each of the connected regions with finite area (numbered $1$ through $C$). For each valid $i$, let $R_i$ denote the sequence of indices of the points on the perimeter of the $i$-th region in increasing order. Brahma numbered the cities in lexicographically increasing order ($R_i \\lt R_{i+1}$).\r\n\r\nThen, each of the $K$ gods chose one of the regions to build their home, no city was chosen as the home of more than one god. Let $S$ be the set of cities chosen by the gods.\r\n\r\nIt is possible to travel from one city to another, if their respective regions share an edge. Let $D(u, v)$ be the length of the shortest path between cities $u$ and $v$ i.e the minimum number of edges we have to cross to go from $u$ to $v$. The *beauty* of city $u$ is given by $\\frac{1}{\\sum_{v \\in S} D(u,v)}$. The cities that have the maximum beauty among all the cities are called *holy cities*.\r\n\r\nSome eons later, Shiva decided that is time to destroy the world, the only way to calm his fury is to build a shrine in each holy city. After so much time we don't remember which cities are holy neither which cities are home of a god! However we have a plan, we'll organize many festivities to gather information. In each festivity the following happens: \r\n\r\n* We choose two cities $u$, $v$ ($u \\neq v$) and all the gods are invited to go to any of those cities.\r\n* Each god goes to the city nearest to their home. if both $u$ and $v$ are at the same distance, then that god does not assist to the festivity.\r\n* We count the number of gods that assisted to each of the two cities.\r\n\r\nYour task is to save the world by organizing at most $C$ festivities to find the holy cities.\r\n\r\n### Interaction\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of interaction for $T$ test cases follows.\r\n- For each test case, you should start by reading a line containing four space-separated integers $N$, $V$, $M$, $K$.\r\n- The next $M$ lines contains two space-separated integers $p_i$ and $q_i$.\r\n- Then, you may start organizing the festivities.\r\n    - To create a festivity, you should print a line containing three space-separated integers $1$, $u$, $v$.\r\n    - Then, you should read a line containing two space-seprated integers $x$, $y$ \u2015 the number of gods that attended city $u$ and $v$ respectively.\r\n    - If the festivity is invalid or if you organized too many festivities, you will receive the wrong answer verdict.\r\n- When you have determined which are the holy cities, you should print a line containing $L + 2 $ space-separated integers $2$, $L$, $H_1$,..., $H_L$, where for each valid $i$, $H_i$ is the index of the $i$-th holy city in increasing order ($H_i \\lt H_{i+1}$).\r\n\r\nDon't forget to flush the output after printing each line!\r\n\r\n### Constraints\r\n- $4 \\leq C \\leq 300$\r\n- The sum of $C$ over all test cases doesn't exceed $10^4$\r\n- $2 \\leq K \\leq C$\r\n- Is guaranteed that there is only one way of reconstructing the cities from the $M$ good pairs.\r\n### Subtasks\r\n**Subtask #1 (20 points):** $K=2$\r\n\r\n**Subtask #2 (80 points):** Original constraints\r\n\r\n### Example\r\n```\r\nGrader          You\r\n1\r\n4 10 8 2\r\n1 10\r\n2 10\r\n3 9\r\n4 9\r\n5 9\r\n6 10\r\n7 8\r\n9 10\r\n                1 3 7\r\n1 1                                                               \r\n                1 1 5\r\n1 1\r\n                2 6 1 2 3 4 5 6\r\n```\r\n\r\n### Explanation\r\nThe following figure describes the cities created by Brahma\r\n<img src=\"https:\/\/s3.amazonaws.com\/codechef_shared\/download\/Images\/APRIL21\/SHRINES\/SHRINES.png\"><\/img>\r\n\r\nThe cities are numbered lexicographically. $R_2 = (1,6,7,8,10)$, $R_6=(5,6,9,10)$, $R_7=(7,8)$\r\n\r\nThere are two gods at cities $2$ and $4$. \r\n\r\nIn the second festivity, the god at city $2$ goes to city $1$, and the god at city $4$ goes to $5$. \r\n\r\nAll cities except $7$ are holy.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"https:\/\/youtu.be\/V8WY4s1NWl4","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"alei","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>alei<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"26-03-2021","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alei'>alei<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/april21'>april21<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/geometry'>geometry<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/interactive'>interactive<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/planar-graphs'>planar-graphs<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SHRINES","time":{"view_start_date":1618219800,"submit_start_date":1618219800,"visible_start_date":1618219800,"end_date":1735669800,"current":1643798001},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=SHRINES","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}