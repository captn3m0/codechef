{"category_name":"hard","status":"success","problem_code":"CHN10","problem_name":"Animesh does not gift Malvika on her birthday","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>\nMalvika was sad because Animesh, the miser, did not buy her even a chocolate bar on her birthday. Animesh, feeling sorry about his behavior, repented and asked Malvika how he could make up for this catastrophic mistake. Enraged as she was, Malvika gave him an empty graph <b>H<\/b> of <b>n<\/b> vertices and asked him to add edges into it and convert the graph into a graph that she likes.\n<\/p>\n\n<p>\nMalvika always keeps a graph <b>G<\/b> with <b>n<\/b> vertices and <b>m<\/b> edges with her. Malvika likes a graph <b>H<\/b> if, and only if, she can find a permutation <b>P<\/b> of <b>1, 2, \u2026 , N<\/b> such that there's an edge between vertices <b>u<\/b> and <b>v<\/b> in <b>H<\/b> if and only if there's an edge between vertices <b>P[u]<\/b> and <b>P[v]<\/b> in <b>G<\/b>.\n<\/p>\n\n<p>\nAnimesh thought for days and days about how he could add edges into the empty graph <b>H<\/b> so that he can get a graph that Malvika likes. After putting in a lot of effort, he found such a graph and said that this is the graph you desired.\n<\/p>\n\n<p>\nMalvika was still really angry with him and asked <em>little<\/em> Animesh to come up as many graphs as possible, such that Malvika likes them. Given his recent track record, you know this is going to take him at least a few years to solve by himself. Can you help Animesh find out how many such graphs he has to come up with? Please output your answer modulo <b>10<sup>9<\/sup> + 7<\/b>.\n<\/p>\n\n<p>\nTwo ways of adding edges <b>A, B<\/b> are considered different if there is a an edge <b>(u, v)<\/b> which is present in <b>A<\/b> but not in <b>B<\/b>.\n<\/p>\n\n<p>\nYou are given the adjacency matrix of the graph <b>G<\/b> as input. The graph has a special property \u2014 each row and column of the graph has atleast <b>n - 3<\/b> 1's.\n<\/p>\n\n<p>\nNote that adjacency matrix of a graph <b>G<\/b> containing <b>n<\/b> vertices is a matrix <b>A<\/b> of size <b>n * n<\/b>. If there is an edge between vertex <b>i<\/b> and <b>j<\/b>, then <b>A(i, j) = 1<\/b>, otherwise <b>A(i, j) = 0<\/b>.\n\nIn our case, as the graph is undirected, the matrix will be a symmetric matrix. Also, the entries on the diagonal will be all zeros.\n<\/p>\n\n<h3>Input<\/h3>\n<ul>\n<li>The first line of input contains a single integer <b>T<\/b> denoting the number of test cases.<\/li>\n<li>For each test case:<\/li>\n<ul>\n\t<li>First line contains an integer <b>n<\/b> denoting the number of vertices in graph <b>G<\/b>.<\/li>\n\t<li>Each of the next <b>n<\/b> lines contains <b>n<\/b> characters, each of them will be either '0' or '1'. The <b>j<\/b><sup>th<\/sup> character in the <b>i<\/b><sup>th<\/sup> line denotes <b>A[i][j]<\/b>, where <b>A<\/b> is the adjacency matrix.<\/li>\n<\/ul>\n<\/ul>\n\n<h3>Output<\/h3>\n<ul>\n<li>For each test case, output your answer in a separate line.<\/li>\n<\/ul>\n<\/ul>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1 \u2264 T,  n \u2264 50<\/b><\/li>\n<\/ul>\n\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\n2\n01\n10\n3\n001\n001\n110\n\n<b>Output:<\/b>\n1\n3\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p><b>In the first example<\/b>, the graph <b>G<\/b> has an edge between 1 and 2. Animesh has to add only one edge in the graph <b>H<\/b> between vertices 1 and 2 to please her. This is the only graph he has to come up with.\n<\/p>\n\n<p><b>In the second example<\/b>, the graph <b>G<\/b> has edges {1, 3} and {2, 3}. Animesh can come up with the following graphs {{1, 3}, {2, 3}}, {{2, 1}, {3, 1}}, {{1, 2}, {3, 2}}. Malvika likes all of these graphs. In this representation, {{1, 3}, {2, 3}} means that a graph has 3 vertices and two edges \u2014 between 1 and 3, and between 2 and 3.\n<\/p>","languages_supported":"C, CPP14, JAVA","max_timelimit":"1","source_sizelimit":"50000","problem_author":"admin2","problem_author_html_handle":"admin2","problem_tester":null,"problem_tester_html_handle":"","date_added":"17-01-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/acm15chn'>\n                    acm15chn\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/admin2'>\n                    admin2\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>\n                    combinatorics\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/graph'>\n                    graph\n                <\/a>","user":{"username":null},"time":{"view_start_date":1453546800,"submit_start_date":1453546800,"visible_start_date":1453546800,"end_date":1735669800,"current":1493556647},"todo":false,"problem_status":"unattempted"}