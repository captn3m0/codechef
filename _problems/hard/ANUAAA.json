{"category_name":"hard","status":"success","problem_code":"ANUAAA","problem_name":"Anup at Amrithapuri","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK54\/mandarin\/ANUAAA.pdf\">Mandarin Chinese<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK54\/russian\/ANUAAA.pdf\">Russian<\/a> as well.<\/h3>\n<h3>Problem description<\/h3>\n<p>Anup recently visited Amrithapuri for ACM ICPC regional contest. A student walked up to Anup, gave him a paper which had a long programming question on it and asked him to solve it by 18th of January, 2015. As Anup was busy with school kids, he posted the question as cook off question, asking wider community to solve that question. Following is the question:<\/p>\n<pre>\nfunction f(A[0..N-1], L, R, P):\n\tif L > R:\n\t\treturn f(A, R, L, P)\n\tANSWER = 0\n\tC[] = A[L..R]\n\tfor each subset S of C:\n\t\tG = GCD(S)\n\t\tfor each prime factor PF of G:\n\t\t\tif PF == P:\n\t\t\t\tANSWER = MAX(ANSWER, SIZE(S))\n\treturn ANSWER\n<\/pre><p><br \/>\nClarifications:<br \/>\nLine 5 loops over all 2^(R-L+1) subsets.<br \/>\nGCD(S) returns the Greatest common divisor of all the elements in S.<br \/>\nSIZE(S) returns the number of elements in S.\n<\/p>\n<p><br \/>\nGiven: <b>N<\/b>, <b>M<\/b>, <b>A[0..N-1]<\/b>, <b>B[0..M-1]<\/b><br \/>\nRequired: <br \/>\n<img src=\"http:\/\/www.codechef.com\/download\/COOK54\/ANUAAA_1.gif\" \/><br \/>\nWhere <b>L = (B[i] + B[j]) % N<br \/>\nR = (B[i] - B[j] + N) % N<\/b><br \/>\nAs the answer can be large. Output it modulo 1000000007.\n<\/p>\n<h3>Input<\/h3>\n<p>First line has two integer <b>N<\/b> and <b>M<\/b>. Second line has <b>N<\/b> space separated integers representing the array <b>A<\/b>. Third line has <b>M<\/b> space separated integers representing the array <b>B<\/b>.<\/p>\n<h3>Output<\/h3>\n<p>Output single integer which is the required answer modulo 1000000007<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>100000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>M<\/b> \u2264 <b>500<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>A[i]<\/b> \u2264 <b>100000<\/b><\/li>\n<li><b>0<\/b> \u2264 <b>B[i]<\/b> &lt; <b>N<\/b><\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n5 2\n1 2 3 4 5\n1 2\n\n<b>Output:<\/b>\n34\n<\/pre><h3>Explanation<\/h3>\n<p>Here are the answers of few calls to function f()<br \/>\nf(A, 2, 0, 2) = 1<br \/>\nf(A, 2, 0, 5) = 0<br \/>\nf(A, 3, 4, 2) = 1\n<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"7","source_sizelimit":"50000","problem_author":"anudeep2011","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>anudeep2011<\/span>","problem_tester":"xiaodao","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>xiaodao<\/span>","date_added":"6-01-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/anudeep2011'>\n                    anudeep2011\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/cook54'>\n                    cook54\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/mo-algorithm'>\n                    mo-algorithm\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/ANUAAA","user":{"username":null},"time":{"view_start_date":1421609400,"submit_start_date":1421609400,"visible_start_date":1421609400,"end_date":1735669800,"current":1493556605},"todo":false,"problem_status":"unattempted"}