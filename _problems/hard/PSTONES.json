{"category_name":"hard","status":"success","problem_code":"PSTONES","problem_name":"Precious Stones ","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/AUG20\/hindi\/PSTONES.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/AUG20\/bengali\/PSTONES.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/AUG20\/mandarin\/PSTONES.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/AUG20\/russian\/PSTONES.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/AUG20\/vietnamese\/PSTONES.pdf) as well.\r\n\r\nChefland consists of $N$ villages connected by $N-1$ roads in such a way that the road network is a tree, i.e. there are no cycles and each village is reachable from any other village. A well known legend says that in the middle of each road, there is a hidden precious stone. There are $K$ different colours of stones, conveniently numbered $1$ through $K$, and for each road, we also know the colour of the stone hidden there.\r\n\r\nKing Chef wants a new beautiful crown, so he organises an expedition to find some stones in the following way:\r\n- Chef chooses a set of $M$ villages to be the *expedition basis*, in such a way that they form a connected subgraph of Chefland, i.e. for any two villages in the basis, the path between them must not visit any village that is not in the basis.\r\n- The expedition gathers the stones in all roads which lie on the \"frontier\" of the expedition basis, i.e. all edges for which one endpoint lies in the basis and the other endpoint does not.\r\n\r\nFor each of the $2^K$ possible sets of colours, Chef wants to know if it is possible that the expedition will return with exactly this set, i.e. there is a basis such that the expedition returns with at least one stone of each colour in this set and no stones with colours that are not in this set.\r\n\r\nSince Chef is not sure about the size of the expedition crew, he also wants you to find these answers for each possible value of $M$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- Each of the following $N-1$ lines contains three space-separated integers $u$, $v$ and $c$, denoting that villages $u$ and $v$ are connected by a road and in this road, there is a stone with colour $c$.\r\n\r\n### Output\r\nLet's associate a set $S$ of colours with a bitmask $\\sum_{c \\in S} 2^{c-1}$.\r\n\r\nFor each test case, print $N$ lines. For each $i$ ($1 \\le i \\le N$), the $i$-th of these lines should contain $2^K$ integers but not separated by spaces; for each $j$ ($0 \\le j < 2^K$), the $j+1$-th integer should be $1$ if it is possible to obtain the set with bitmask $j$ for $M=i$ or $0$ if it is impossible.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 500$\r\n- $1 \\le N \\le 100$\r\n- $1 \\le K \\le 12$\r\n- $1 \\le u, v \\le N$\r\n- $1 \\le c \\le K$\r\n- the graph described on the input is a tree\r\n- the sum of $N$ over all test cases does not exceed $500$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** for each valid $i$, the $i$-th edge connects vertices $i$ and $i+1$ (in other words, the tree is a line)\r\n\r\n**Subtask #2 (15 points):** $K \\le 4$\r\n\r\n**Subtask #3 (25 points):** $K \\le 8$\r\n\r\n**Subtask #4 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n2\r\n3 2\r\n1 2 1\r\n2 3 2\r\n3 1\r\n1 2 1\r\n2 3 1\r\n```\r\n\r\n### Example Output\r\n```\r\n0111\r\n0110\r\n1000\r\n01\r\n01\r\n10\r\n```\r\n\r\n### Explanation\r\n**Example case 1:**\r\nFor $M = 1$, there are three subtrees:\r\n- only vertex $1$: we obtain the set $\\{1\\}$ with bitmask $1$\r\n- only vertex $2$: we obtain the set $\\{1, 2\\}$ with bitmask $3$\r\n- only vertex $3$: we obtain the set $\\{2\\}$ with bitmask $2$\r\n\r\nFor $M = 2$, there are two possible subtrees:\r\n- vertices $\\{1, 2\\}$: we obtain the set $\\{2\\}$ with bitmask $2$\r\n- vertices $\\{2, 3\\}$: we obtain the set $\\{1\\}$ with bitmask $1$\r\n\r\nFor $M = 3$, we can only choose the whole tree, which generates the empty set (with bitmask $0$).\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/AUG20\/hindi\/PSTONES.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/AUG20\/bengali\/PSTONES.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/AUG20\/mandarin\/PSTONES.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/AUG20\/russian\/PSTONES.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/AUG20\/vietnamese\/PSTONES.pdf) as well.\r\n\r\nChefland consists of $N$ villages connected by $N-1$ roads in such a way that the road network is a tree, i.e. there are no cycles and each village is reachable from any other village. A well known legend says that in the middle of each road, there is a hidden precious stone. There are $K$ different colours of stones, conveniently numbered $1$ through $K$, and for each road, we also know the colour of the stone hidden there.\r\n\r\nKing Chef wants a new beautiful crown, so he organises an expedition to find some stones in the following way:\r\n- Chef chooses a set of $M$ villages to be the *expedition basis*, in such a way that they form a connected subgraph of Chefland, i.e. for any two villages in the basis, the path between them must not visit any village that is not in the basis.\r\n- The expedition gathers the stones in all roads which lie on the \"frontier\" of the expedition basis, i.e. all edges for which one endpoint lies in the basis and the other endpoint does not.\r\n\r\nFor each of the $2^K$ possible sets of colours, Chef wants to know if it is possible that the expedition will return with exactly this set, i.e. there is a basis such that the expedition returns with at least one stone of each colour in this set and no stones with colours that are not in this set.\r\n\r\nSince Chef is not sure about the size of the expedition crew, he also wants you to find these answers for each possible value of $M$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- Each of the following $N-1$ lines contains three space-separated integers $u$, $v$ and $c$, denoting that villages $u$ and $v$ are connected by a road and in this road, there is a stone with colour $c$.\r\n\r\n### Output\r\nLet's associate a set $S$ of colours with a bitmask $\\sum_{c \\in S} 2^{c-1}$.\r\n\r\nFor each test case, print $N$ lines. For each $i$ ($1 \\le i \\le N$), the $i$-th of these lines should contain $2^K$ integers but not separated by spaces; for each $j$ ($0 \\le j < 2^K$), the $j+1$-th integer should be $1$ if it is possible to obtain the set with bitmask $j$ for $M=i$ or $0$ if it is impossible.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 500$\r\n- $1 \\le N \\le 100$\r\n- $1 \\le K \\le 12$\r\n- $1 \\le u, v \\le N$\r\n- $1 \\le c \\le K$\r\n- the graph described on the input is a tree\r\n- the sum of $N$ over all test cases does not exceed $500$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** for each valid $i$, the $i$-th edge connects vertices $i$ and $i+1$ (in other words, the tree is a line)\r\n\r\n**Subtask #2 (15 points):** $K \\le 4$\r\n\r\n**Subtask #3 (25 points):** $K \\le 8$\r\n\r\n**Subtask #4 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n3 2\r\n1 2 1\r\n2 3 2\r\n3 1\r\n1 2 1\r\n2 3 1","output":"0111\r\n0110\r\n1000\r\n01\r\n01\r\n10","explanation":"**Example case 1:**\r\nFor $M = 1$, there are three subtrees:\r\n- only vertex $1$: we obtain the set $\\{1\\}$ with bitmask $1$\r\n- only vertex $2$: we obtain the set $\\{1, 2\\}$ with bitmask $3$\r\n- only vertex $3$: we obtain the set $\\{2\\}$ with bitmask $2$\r\n\r\nFor $M = 2$, there are two possible subtrees:\r\n- vertices $\\{1, 2\\}$: we obtain the set $\\{2\\}$ with bitmask $2$\r\n- vertices $\\{2, 3\\}$: we obtain the set $\\{1\\}$ with bitmask $1$\r\n\r\nFor $M = 3$, we can only choose the whole tree, which generates the empty set (with bitmask $0$).","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"arthurfn","problem_author_html_handle":"arthurfn","problem_tester":"","problem_tester_html_handle":"","date_added":"13-07-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/arthurfn'>arthurfn<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/arthurfn'>arthurfn<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/aug20'>aug20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/daniel_1999'>daniel_1999<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dp-on-trees'>dp-on-trees<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>dynamic-programming<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/rishup_nitdgp'>rishup_nitdgp<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/walsh-hadamard'>walsh-hadamard<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Dynamic Programming","editorial_url":"https:\/\/discuss.codechef.com\/problems\/PSTONES","time":{"view_start_date":1597656602,"submit_start_date":1597656602,"visible_start_date":1597656602,"end_date":1735669800,"current":1643797999},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=PSTONES","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}