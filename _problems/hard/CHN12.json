{"category_name":"hard","status":"success","problem_code":"CHN12","problem_name":"Praveen falls from a tall tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>\nPraveen has climbed a tall tree and now he can't get down! While he is waiting for Arjun to bring a ladder, he has decided to amuse himself by numbering the <b>N<\/b> nodes of the tree from from <b>1<\/b> to <b>N<\/b> and associating a value <b>S[i]<\/b> with every vertex.\n<\/p>\n\n<p>\nFor that, he applies the following procedure.<br>\n<pre>\n<b>val<\/b> = 1\nLet T be our tree.\nwhile T is not empty:\n\t- Identify the branching nodes of tree T. A node of tree T is said to be a branching node if its degree &gt; 2. \n\t- Choose all the nodes of T which have a path to any leaf node not passing through any of the branching nodes. \n\t- Remove all of these chosen nodes from the tree T.\n        - Set S value of all these removed nodes to be val.\n\t- Increase val by 1, i.e. val += 1\n\n<b>Note<\/b> that first step of identification of branching nodes is re-done in each execution of the while loop.\n<\/pre>\n<\/p>\n\n<p>\nPlease check the example problem statement to understand how this process works.\n\nNote that Praveen cannot actually remove the nodes from the tree. He just simulates the procedure in his head's supercomputer.\n<\/p>\n\n<p>\nAfter Arjun comes back with the ladder, Praveen decides to ask him <b>Q<\/b> queries about the tree. Each query will contain two nodes <b>u, v<\/b>. Let the path in the tree from node <b>u<\/b> to <b>v<\/b>, be <b>u, u<sub>1<\/sub>, u<sub>2<\/sub>, .., u<sub>r<\/sub>, v<\/b>. Consider the array <b>S[u], S[u<sub>1<\/sub>],..,S[u<sub>r<\/sub>], S[v]<\/b>.\nFor each query, Arjun has to find the number of inversion pairs in this array. <b>i<\/b> and <b>j<\/b> form an inversion pair, if <b>i > j<\/b> and <b>S[i] &lt; S[j]<\/b>. All these hours sitting atop the tree have made Praveen light in the head, and he refuses to come down until Arjun answers all his queries.\n<br>\nUnfortunately, Arjun does not have a supercomputer in his head like Praveen does and he has also left his laptop at home. So please help Arjun answer these queries and get Praveen down.\n<\/p>\n\n<h3>Input<\/h3>\n<ul>\n<li>The first line of input contains a single integer <b>T<\/b> denoting the number of test cases.<\/li>\n<li>For each test case: <\/li>\n<ul>\n\t<li>The first line contains two space separated integers <b>N, Q<\/b> as defined in the statement<\/li>\n\t<li>Each of next <b>N - 1<\/b> lines contains two space separated integers <b>u, v<\/b> denoting that there is an edge between vertex <b>u<\/b> and <b>v<\/b> in the tree.<\/li>\n\t<li>Each of next <b>Q<\/b> lines will contain two space separated integers <b>u, v<\/b>, the nodes corresponding to the query.<\/li>\n<\/ul>\n<\/ul>\n\n<h3>Output<\/h3>\n<ul>\n<li>For each test case, print <b>Q<\/b> lines corresponding to the answers of the queries in separate lines.<\/li>\n<\/ul>\n\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> &le; <b>T<\/b> &le; <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>1<\/b> &le; <b>N, Q<\/b> &le; <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>1<\/b> &le; <b>u, v<\/b> &le; <b>N<\/b><\/li>\n<li>Sum of all <b>N<\/b>, as well as sum of all <b>Q<\/b>, won't exceed 10<sup>5<\/sup>.<\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input 1:<\/b>\n1\n11 6\n1 2\n2 3\n2 4\n4 5\n4 6\n2 8\n2 7\n7 9\n7 10\n11 10\n5 10\n1 9\n6 10\n3 7\n2 9\n9 2\n\n<b>Output 1:<\/b>\n3\n2\n3\n0\n2\n0\n<\/pre>\n\n<h3>Explanation<\/h3>\n\n<img height=\"200\" src=\"http:\/\/www.codechef.com\/download\/ACM15CHN\/tree_s_array.jpg\"\/>\n<p>\nThe figure is the tree corresponding to the given sample input. The nodes marked red have S value 1 and the black nodes have S Value 2. In the first step, the branching nodes are 2, 4 and 7. Nodes 1, 3, 5, 6, 8, 9, 11 are leaf nodes and can be removed, i.e they have S value 1. Even 10 can be removed and it also has S value 1. The branching nodes cannot be touched. In the next iteration, with val = 2, there are no branching nodes and we can remove nodes 2, 4 and 7 giving them S Value 2.<\/p>\n<p>\nThe first query is (5,10). The path between nodes numbered 5 and 10 passes through nodes {5,4,2,7,10} with S values {1,2,2,2,1}. The number of inversions in this array is 3 formed by 3 pairs of {2,1}.\n<\/p>\n<p>\nThe second query is (1,9). The path between nodes numbered 1 and 9 passes through nodes {1,2,7,9} with S values {1,2,2,1}. The number of inversions in this array is 2 formed by 2 pairs of {2,1}.\n<\/p>\n<p>\nThe third query is (6,10). The path between nodes numbered 6 and 10 passes through nodes {6,4,2,7,10} with S values {1,2,2,2,1}. The number of inversions in this array is 3 formed by 3 pairs of {2,1}.\n<\/p>\n<p>\nThe fourth query is (3,7). The path between nodes numbered 3 and 7 passes through nodes {3,2,7} with S values {1,2,2}. There are no inversions in this array.\n<\/p>\n<p>\nThe fifth query is (2,9). The path between nodes numbered 2 and 9 passes through nodes {2,7,9} with S values {2,2,1}. The number of inversions in this array is 2 formed by 2 pairs of {2,1}.\n<\/p>\n<p>\nThe last query is (9,2). The path between nodes numbered 9 and 2 passes through nodes {9,7,2} with S values {1,2,2}. The number of inversions in this array is zero.\n<\/p>\n\n<pre><b>Input 2:<\/b>\n1\n20 4\n1 2\n2 3\n2 4\n4 6\n5 6\n6 20\n8 20\n7 20\n4 9\n9 10\n10 19\n17 19\n18 19\n10 11\n11 12\n11 13\n13 14\n13 15\n15 16\n4 10\n1 16\n17 18\n11 11\n\n<b>Output 2:<\/b>\n0\n18\n1\n0\n<\/pre>\n\n","languages_supported":"C, CPP14, JAVA","max_timelimit":"3","source_sizelimit":"50000","problem_author":"admin2","problem_author_html_handle":"admin2","problem_tester":null,"problem_tester_html_handle":"","date_added":"17-01-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/acm15chn'>\n                    acm15chn\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/admin2'>\n                    admin2\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/lca'>\n                    lca\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/tree'>\n                    tree\n                <\/a>","user":{"username":null},"time":{"view_start_date":1453546800,"submit_start_date":1453546800,"visible_start_date":1453546800,"end_date":1735669800,"current":1493556647},"todo":false,"problem_status":"unattempted"}