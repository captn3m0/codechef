{"category_name":"hard","status":"success","problem_code":"GOODSEGS","problem_name":"Good Subsequences","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/hindi\/GOODSEGS.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/bengali\/GOODSEGS.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/mandarin\/GOODSEGS.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/russian\/GOODSEGS.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/vietnamese\/GOODSEGS.pdf) as well.\r\n\r\nYou are given a permutation $p_1, p_2, \\ldots, p_N$. Let's denote a contiguous subsequence $p_l, p_{l+1}, \\ldots, p_r$ in it by $[l, r]$ and call it *interesting* if $\\max(p_l, p_{l+1}, \\ldots, p_r) - \\min(p_l, p_{l+1}, \\ldots, p_r) = r - l$.\r\n\r\nNext, let's say that two interesting subsequences $[a,b]$ and $[c,d]$ are *nested* if $a \\le c \\le d \\le b$ or $c \\le a \\le b \\le d$, and they are *interleaved* if $\\mathrm{max}(a,c) \\le \\mathrm{min}(b,d)$, but they are not nested. The intersection of two such interleaved subsequences is the subsequence $[\\mathrm{max}(a,c), \\mathrm{min}(b,d)]$.\r\n\r\nYou need to find the number of ordered pairs of interesting contiguous subsequences such that they are interleaved and their intersection contains at least $X$ elements. Since this number may be very large, compute it modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $X$.\r\n- The second line contains $N$ space-separated integers $p_1, p_2, \\ldots, p_N$.\r\n\r\n### Output\r\nPrint a single line containing one integer \u2015 the number of valid pairs of interesting subsequences modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le X \\le N \\le 300\\,000$\r\n- $1 \\le p_i \\le N$ for each valid $i$\r\n- $p_1, p_2, \\ldots, p_N$ are pairwise distinct.\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** $N \\le 150$\r\n\r\n**Subtask #2 (20 points):** $N \\le 5,000$\r\n\r\n**Subtask #3 (70 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n6 2\r\n1 4 2 5 3 6\r\n```\r\n\r\n### Example Output\r\n```\r\n2\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/hindi\/GOODSEGS.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/bengali\/GOODSEGS.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/mandarin\/GOODSEGS.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/russian\/GOODSEGS.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/MARCH20\/vietnamese\/GOODSEGS.pdf) as well.\r\n\r\nYou are given a permutation $p_1, p_2, \\ldots, p_N$. Let's denote a contiguous subsequence $p_l, p_{l+1}, \\ldots, p_r$ in it by $[l, r]$ and call it *interesting* if $\\max(p_l, p_{l+1}, \\ldots, p_r) - \\min(p_l, p_{l+1}, \\ldots, p_r) = r - l$.\r\n\r\nNext, let's say that two interesting subsequences $[a,b]$ and $[c,d]$ are *nested* if $a \\le c \\le d \\le b$ or $c \\le a \\le b \\le d$, and they are *interleaved* if $\\mathrm{max}(a,c) \\le \\mathrm{min}(b,d)$, but they are not nested. The intersection of two such interleaved subsequences is the subsequence $[\\mathrm{max}(a,c), \\mathrm{min}(b,d)]$.\r\n\r\nYou need to find the number of ordered pairs of interesting contiguous subsequences such that they are interleaved and their intersection contains at least $X$ elements. Since this number may be very large, compute it modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $X$.\r\n- The second line contains $N$ space-separated integers $p_1, p_2, \\ldots, p_N$.\r\n\r\n### Output\r\nPrint a single line containing one integer \u2015 the number of valid pairs of interesting subsequences modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le X \\le N \\le 300\\,000$\r\n- $1 \\le p_i \\le N$ for each valid $i$\r\n- $p_1, p_2, \\ldots, p_N$ are pairwise distinct.\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** $N \\le 150$\r\n\r\n**Subtask #2 (20 points):** $N \\le 5,000$\r\n\r\n**Subtask #3 (70 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"6 2\r\n1 4 2 5 3 6","output":"2","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"1","source_sizelimit":"50000","problem_author":"gainullinildar","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>gainullinildar<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"25-02-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/divide-combine-tree'>divide-combine-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/gainullinildar'>gainullinildar<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/march20'>march20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tmwilliamlin'>tmwilliamlin<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/GOODSEGS","time":{"view_start_date":1112031000,"submit_start_date":1112031000,"visible_start_date":1112031000,"end_date":1735669800,"current":1643797995},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=GOODSEGS","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}