{"category_name":"hard","status":"success","problem_code":"PANIC","problem_name":"Panic! at the Disco","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/NOV20\/hindi\/PANIC.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/NOV20\/bengali\/PANIC.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/mandarin\/PANIC.pdf),[Russian](https:\/\/www.codechef.com\/download\/translated\/NOV20\/russian\/PANIC.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/vietnamese\/PANIC.pdf) as well.\r\n\r\nYou are given a $K \\times K$ matrix $M$. For each $r$ and $c$ ($1 \\le r, c \\le K$), let's denote the element in the $r$-th row and $c$-th column by $M_{r, c}$. You are also given three integers $N$, $a$ and $d$. Let's define a $K \\times K$ matrix\r\n$$S = \\sum_{i=0}^N F_{a + i \\cdot d} \\cdot M^i \\,.$$\r\nHere, $M^0$ is the identity matrix and for any non-negative integer $i$, $F_i$ is the $i$-th Fibonacci number \u2015 formally, $F_0 = 0$, $F_1 = 1$ and $F_i = F_{i-1} + F_{i-2}$ for $i \\gt 1$.\r\n\r\nLet's denote elements of the matrix $S$ in the same way as for $M$. For each valid $r$ and $c$, compute $S_{r, c}$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains four space-separated integers $K$, $a$, $d$ and $N$.\r\n- $K$ lines follow. For each valid $i$, the $i$-th of these lines contains $K$ space-separated integers $M_{i, 1}, M_{i, 2}, \\ldots, M_{i, K}$.\r\n\r\n### Output\r\nFor each test case, print $K$ lines. For each valid $i$, the $i$-th of these lines should contain $K$ space-separated integers $S_{i, 1}, S_{i, 2}, \\ldots, S_{i, K}$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 100$\r\n- $1 \\le K \\le 100$\r\n- $0 \\le a, d \\le 10^9$\r\n- $0 \\le N \\le 10^{1,000}$\r\n- $0 \\le M_{i, j} \\lt 998,244,353$ for each valid $i$ and $j$\r\n- the sum of $K$ over all test cases does not exceed $100$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $K = 1$\r\n- $N \\le 10^{18}$\r\n\r\n**Subtask #2 (30 points):**\r\n- $K \\le 20$\r\n- $N \\le 10^{18}$\r\n\r\n**Subtask #3 (60 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n3\r\n1 0 2 4\r\n1\r\n2 3 4 5\r\n1 0\r\n0 1\r\n3 23 45 107\r\n5 7 2\r\n1 8 9\r\n3 4 5\r\n```\r\n\r\n### Example Output\r\n```\r\n33\r\n33552 0\r\n0 33552\r\n601338635 934201293 356700741\r\n960409891 125261415 197093893\r\n136328022 287118456 122438416\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/NOV20\/hindi\/PANIC.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/NOV20\/bengali\/PANIC.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/mandarin\/PANIC.pdf),[Russian](https:\/\/www.codechef.com\/download\/translated\/NOV20\/russian\/PANIC.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/NOV20\/vietnamese\/PANIC.pdf) as well.\r\n\r\nYou are given a $K \\times K$ matrix $M$. For each $r$ and $c$ ($1 \\le r, c \\le K$), let's denote the element in the $r$-th row and $c$-th column by $M_{r, c}$. You are also given three integers $N$, $a$ and $d$. Let's define a $K \\times K$ matrix\r\n$$S = \\sum_{i=0}^N F_{a + i \\cdot d} \\cdot M^i \\,.$$\r\nHere, $M^0$ is the identity matrix and for any non-negative integer $i$, $F_i$ is the $i$-th Fibonacci number \u2015 formally, $F_0 = 0$, $F_1 = 1$ and $F_i = F_{i-1} + F_{i-2}$ for $i \\gt 1$.\r\n\r\nLet's denote elements of the matrix $S$ in the same way as for $M$. For each valid $r$ and $c$, compute $S_{r, c}$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains four space-separated integers $K$, $a$, $d$ and $N$.\r\n- $K$ lines follow. For each valid $i$, the $i$-th of these lines contains $K$ space-separated integers $M_{i, 1}, M_{i, 2}, \\ldots, M_{i, K}$.\r\n\r\n### Output\r\nFor each test case, print $K$ lines. For each valid $i$, the $i$-th of these lines should contain $K$ space-separated integers $S_{i, 1}, S_{i, 2}, \\ldots, S_{i, K}$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 100$\r\n- $1 \\le K \\le 100$\r\n- $0 \\le a, d \\le 10^9$\r\n- $0 \\le N \\le 10^{1,000}$\r\n- $0 \\le M_{i, j} \\lt 998,244,353$ for each valid $i$ and $j$\r\n- the sum of $K$ over all test cases does not exceed $100$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $K = 1$\r\n- $N \\le 10^{18}$\r\n\r\n**Subtask #2 (30 points):**\r\n- $K \\le 20$\r\n- $N \\le 10^{18}$\r\n\r\n**Subtask #3 (60 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3\r\n1 0 2 4\r\n1\r\n2 3 4 5\r\n1 0\r\n0 1\r\n3 23 45 107\r\n5 7 2\r\n1 8 9\r\n3 4 5","output":"33\r\n33552 0\r\n0 33552\r\n601338635 934201293 356700741\r\n960409891 125261415 197093893\r\n136328022 287118456 122438416","explanation":"","isDeleted":false}]},"video_editorial_url":"https:\/\/youtu.be\/PuQ-HZZE_2w","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, SQLQ, NEM","max_timelimit":"5","source_sizelimit":"50000","problem_author":"sjshohag","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>sjshohag<\/span>","problem_tester":"","problem_tester_html_handle":"","date_added":"16-07-2020","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/berlekamp-massey'>berlekamp-massey<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/cayley-hamilton'>cayley-hamilton<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/math'>math<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/matrix-exponentiation'>matrix-exponentiation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nov20'>nov20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/number-theory'>number-theory<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/randomized'>randomized<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/recurrence'>recurrence<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sjshohag'>sjshohag<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sjshohag'>sjshohag<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Number Theory","editorial_url":"https:\/\/discuss.codechef.com\/problems\/PANIC","time":{"view_start_date":1104528600,"submit_start_date":1104528600,"visible_start_date":1104528600,"end_date":1735669800,"current":1643797999},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=PANIC","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}