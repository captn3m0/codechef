{"category_name":"hard","status":"success","problem_code":"ARMYOFME","problem_name":"Army of Me","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN20\/hindi\/ARMYOFME.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN20\/bengali\/ARMYOFME.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/mandarin\/ARMYOFME.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN20\/russian\/ARMYOFME.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/vietnamese\/ARMYOFME.pdf) as well.\r\n\r\nDr.D has recently been thinking about the phrase \"Life is short\". He decided to start doing all sorts of exotic stuff he has always wanted to do. But since life is short, he does not have the time to do it all by himself, so he made the Cloninator and used it to create $N$ clones of himself (numbered $1$ through $N$) to help him do all the stuff on his hope-to-do-list. Dr.D has already lined up the clones; for each $i$ ($1 \\le i \\le N$), the $i$-th clone in the line is the $P_i$-th clone created by Cloninator.\r\n\r\nThere are $Q$ items on Dr.D's hope-to-do-list, so you should process $Q$ queries. For each query, Dr.D wants to choose some parameters $L$ and $R$ such that $1 \\le L \\le R \\le N$ and send the clones $P_L, P_{L+1}, \\ldots, P_R$ to do an exotic activity. Dr.D waits until these clones finish and come back before proceeding with the next item on his list (the next query), so a clone may be picked multiple times in different queries.\r\n\r\nThe strength of a group of clones is the maximum number of clones in that group such that their positions in the line are consecutive and they can be reordered in such a way that their id-s $P_i$ also become consecutive (they were created consecutively by the Cloninator). Dr.D is wondering if the groups he selects are strong enough for their tasks. For each query, calculate the strength of the group of clones that Dr.D sends to do an exotic activity.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $P_1, P_2, \\ldots, P_N$.\r\n- The next $Q$ lines describe queries. Each of these lines contains two space-separated integers $X$ and $Y$; the values of $L$ and $R$ for this query can be calculated as follows:\r\n    - Let $last$ be the answer to the previous query, or $0$ if this is the first query.\r\n    - Calculate $L = ((X + last - 1)\\,\\%\\, N) + 1$.\r\n    - Calculate $R = ((Y + last - 1)\\,\\%\\, N) + 1$.\r\n    - If $L \\gt R$, swap $L$ and $R$.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the strength of the given group.\r\n\r\n### Constraints\r\n- $1 \\le N, Q \\le 5 \\cdot 10^5$\r\n- $P_1, P_2, \\ldots, P_N$ form a permutation of $1, 2, \\ldots, N$.\r\n- $1 \\le X, Y \\le N$\r\n\r\n### Subtasks\r\n**Subtask #1 (21 points):** $N, Q \\le 5,000$\r\n\r\n**Subtask #2 (79 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n7 5\r\n2 5 4 6 3 7 1\r\n2 4\r\n5 2\r\n1 7\r\n7 6\r\n3 2\r\n```\r\n\r\n### Example Output\r\n```\r\n3\r\n5\r\n1\r\n7\r\n2\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN20\/hindi\/ARMYOFME.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN20\/bengali\/ARMYOFME.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/mandarin\/ARMYOFME.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN20\/russian\/ARMYOFME.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/vietnamese\/ARMYOFME.pdf) as well.\r\n\r\nDr.D has recently been thinking about the phrase \"Life is short\". He decided to start doing all sorts of exotic stuff he has always wanted to do. But since life is short, he does not have the time to do it all by himself, so he made the Cloninator and used it to create $N$ clones of himself (numbered $1$ through $N$) to help him do all the stuff on his hope-to-do-list. Dr.D has already lined up the clones; for each $i$ ($1 \\le i \\le N$), the $i$-th clone in the line is the $P_i$-th clone created by Cloninator.\r\n\r\nThere are $Q$ items on Dr.D's hope-to-do-list, so you should process $Q$ queries. For each query, Dr.D wants to choose some parameters $L$ and $R$ such that $1 \\le L \\le R \\le N$ and send the clones $P_L, P_{L+1}, \\ldots, P_R$ to do an exotic activity. Dr.D waits until these clones finish and come back before proceeding with the next item on his list (the next query), so a clone may be picked multiple times in different queries.\r\n\r\nThe strength of a group of clones is the maximum number of clones in that group such that their positions in the line are consecutive and they can be reordered in such a way that their id-s $P_i$ also become consecutive (they were created consecutively by the Cloninator). Dr.D is wondering if the groups he selects are strong enough for their tasks. For each query, calculate the strength of the group of clones that Dr.D sends to do an exotic activity.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $P_1, P_2, \\ldots, P_N$.\r\n- The next $Q$ lines describe queries. Each of these lines contains two space-separated integers $X$ and $Y$; the values of $L$ and $R$ for this query can be calculated as follows:\r\n    - Let $last$ be the answer to the previous query, or $0$ if this is the first query.\r\n    - Calculate $L = ((X + last - 1)\\,\\%\\, N) + 1$.\r\n    - Calculate $R = ((Y + last - 1)\\,\\%\\, N) + 1$.\r\n    - If $L \\gt R$, swap $L$ and $R$.\r\n\r\n### Output\r\nFor each query, print a single line containing one integer \u2015 the strength of the given group.\r\n\r\n### Constraints\r\n- $1 \\le N, Q \\le 5 \\cdot 10^5$\r\n- $P_1, P_2, \\ldots, P_N$ form a permutation of $1, 2, \\ldots, N$.\r\n- $1 \\le X, Y \\le N$\r\n\r\n### Subtasks\r\n**Subtask #1 (21 points):** $N, Q \\le 5,000$\r\n\r\n**Subtask #2 (79 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"7 5\r\n2 5 4 6 3 7 1\r\n2 4\r\n5 2\r\n1 7\r\n7 6\r\n3 2","output":"3\r\n5\r\n1\r\n7\r\n2","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"2","source_sizelimit":"50000","problem_author":"kmaaszraa","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>kmaaszraa<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"8-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/binary-lifting'>binary-lifting<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jan20'>jan20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kmaaszraa'>kmaaszraa<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kmaaszraa'>kmaaszraa<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/lazy-propagation'>lazy-propagation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/observation'>observation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/persistent-segment-tree'>persistent-segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/vijju123'>vijju123<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Segment Tree","editorial_url":"https:\/\/discuss.codechef.com\/problems\/ARMYOFME","time":{"view_start_date":1578907800,"submit_start_date":1578907800,"visible_start_date":1578907800,"end_date":1735669800,"current":1643797991},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=ARMYOFME","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}