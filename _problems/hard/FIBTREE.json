{"category_name":"hard","status":"success","problem_code":"FIBTREE","problem_name":"Fibonacci Numbers on Tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/SEPT14\/mandarin\/FIBTREE.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/SEPT14\/russian\/FIBTREE.pdf\">Russian<\/a>.<\/h3>\n\n        <p>In mathematical terms, the sequence <b>F[N]<\/b> of Fibonacci numbers is defined by the recurrence relation <b>F[N]<\/b> = <b>F[N-1]<\/b> + <b>F[N-2]<\/b>, with seed values <b>F[1] = 1<\/b>,<b>F[2] = 1<\/b>.<\/p>\n\n\t<p>Today, Chef gives you a rooted tree, consisting of <b>N<\/b> nodes. At first, the node <b>1<\/b> is the root. The nodes are numbered from <b>1<\/b> to <b>N<\/b>, and each node has an integer that initially equals to <b>0<\/b>. Then, Chef asks you to perform <b>M<\/b> queries. <\/p>\n\n<p>The queries are as follows:<\/p>\n<ul>\n\t<ul>\n\t\t<li>\n\t\t\t<p><b>A x y<\/b><\/p>\n\t\t<\/li>\n\t\t<p>Add <b>F[1]<\/b> to the integer, associated with the node <b>x<\/b>, then add <b>F[2]<\/b> to the integer, associated with the second node on the way from <b>x<\/b> to <b>y<\/b>, then add <b>F[3]<\/b> to the integer, associated with the third node on the way from <b>x<\/b> to <b>y<\/b>, and so on. As you know, there is only one simple path from <b>x<\/b> to <b>y<\/b>.<\/p>\n\t<\/ul>\n\t<ul>\n\t\t<li>\n\t\t\t<p><b>QS x y<\/b><\/p>\n\t\t<\/li>\n\t\t<p>Let node <b>x<\/b> be the root of the tree, output the sum of all integers, associated with the nodes in the subtree of the node <b>y<\/b>, modulo <b>1000000009(10<sup>9<\/sup>+9)<\/b>.<\/p>\n\t<\/ul>\n\t<ul>\n\t\t<li>\n\t\t\t<p><b>QC x y<\/b><\/p>\n\t\t<\/li>\n\t\t<p>Output the sum of all the integers, associated with the nodes on the way from <b>x<\/b> to <b>y<\/b>, modulo <b>1000000009(10<sup>9<\/sup>+9)<\/b>.<\/p>\n\t<\/ul>\n\t<ul>\n\t\t<li>\n\t\t\t<p><b>R x<\/b><\/p>\n\t\t<\/li>\n\t\t<p>All the integers associated with the nodes return to the state after the <b>x<\/b>-th query. If <b>x<\/b> is <b>0<\/b>, then all of them become equal to <b>0<\/b>, as in the very beginning.<\/p>\n\t<\/ul>\n<\/ul>\n<p>\u00a0<\/p>\n\n<h3>Input<\/h3>\n<ul>\n<p>The first line of the input consists of two space separated intergers - <b>N<\/b> and <b>M<\/b> respectively.<\/p>\n\t<p>Then, <b>N-1<\/b> lines follow. These <b>N-1<\/b> lines describe the tree structure. Each line consists of two intergers - <b>x<\/b> and <b>y<\/b>, and that means that there is an edge between the node <b>x<\/b> and the node <b>y<\/b>.<\/p>\n\t<p>Then, <b>M<\/b> lines follow. Every single line denotes a single query, which has one of the following forms: (See the sample for the detailed explanation)<\/p>\n\t<ul>\n\t\t<li>\n\t\t\t<b>A x<sub>1<\/sub> y<\/b>\n\t\t<\/li>\n\t<\/ul>\n\t<ul>\n\t\t<li>\n\t\t\t<b>QS x<sub>1<\/sub> y<\/b>\n\t\t<\/li>\n\t<\/ul>\n\t<ul>\n\t\t<li>\n\t\t\t<b>QC x<sub>1<\/sub> y<\/b>\n\t\t<\/li>\n\t<\/ul>\n\t<ul>\n\t\t<li>\n\t\t\t<b>R x<sub>1<\/sub><\/b>\n\t\t<\/li>\n\t<\/ul>\n\t<p> <\/p>\n\t<p>As you can see, the number <b>x<\/b> isn't given to you directly. For all queries, actual number <b>x<\/b> will be equal to <b>x<sub>1<\/sub><\/b> xor <b>lastans<\/b>, where lastans denotes the last number that you have output, or <b>0<\/b> if you haven't output any numbers yet.<\/p>\n<\/ul>\n<p>\u00a0<\/p>\n\n<h3>Output<\/h3>\n<ul>\n\t<p>For each query of the type <b>QS<\/b> or <b>QC<\/b>, output the answer modulo <b>10<sup>9<\/sup>+9<\/b><\/p>\n<\/ul>\n<p>\u00a0<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n\t<li>\n\t\t<b>1<\/b> \u2264 <b>N<\/b>, <b>M<\/b> \u2264 <b>100000<\/b>\n\t<\/li>\n\t<li>\n\t\t<b>1<\/b> \u2264 <b>x<\/b>, <b>y<\/b> \u2264 <b>N<\/b>\n\t<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n5 6\n1 2\n1 3\n3 4\n3 5\nA 4 2\nA 2 5\nQS 4 3\nQC 12 4\nR 6\nQC 6 4\n\n<b>Output:<\/b>\n13\n7\n4\n<\/pre>\n<p>\u00a0<\/p>\n<h3>Explanation<\/h3>\n<ul>\n\t<p>Let\u2019s denote the first state of integers as <b>0 0 0 0 0<\/b>, where the <b>i<\/b>-th interger means the integer associated with the node <b>i<\/b>.<\/p>\n\t<p>In the first query \u201c<b>A 4 2<\/b>\u201d, the actual number is <b>x = 4 xor 0 = 4<\/b>. Hence the state will be <b>2 3 1 1 0<\/b> after this query.<\/p>\n\t<p>After the second query \u201c<b>A 2 5<\/b>\u201d, the state will be <b>3 4 3 1 3<\/b> for the similar reason.<\/p>\n\t<p>In the next query, the answer is <b>3+4+3+3=13<\/b>.<\/p>\n\t<p>In the next query, the actual number is <b>x = 12 xor 13 = 1<\/b>, the answer is <b>3+3+1=7<\/b>.<\/p>\n\t<p>In the query \u201c<b>R 6<\/b>\u201d, the actual number is <b>x = 6 xor 7 = 1<\/b>, the state will be roll backed to <b>2 3 1 1 0<\/b>.<\/p>\n\t<p>At last, the actual number is <b>x = 6 xor 7 = 1<\/b>, the answer is <b>2+1+1=4<\/b>.<\/p>\n<\/ul>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"5","source_sizelimit":"50000","problem_author":"dzy493941464","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>dzy493941464<\/span>","problem_tester":"xcwgf666","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","date_added":"25-06-2014","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/dzy493941464'>\n                    dzy493941464\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/heavy-light'>\n                    heavy-light\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/math'>\n                    math\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/persistence'>\n                    persistence\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>\n                    segment-tree\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/sept14'>\n                    sept14\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/FIBTREE","user":{"username":null},"time":{"view_start_date":1410773400,"submit_start_date":1410773400,"visible_start_date":1410773400,"end_date":1735669800,"current":1493556704},"todo":false,"problem_status":"unattempted"}