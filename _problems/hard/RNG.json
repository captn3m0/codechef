{"category_name":"hard","status":"success","problem_code":"RNG","problem_name":"Random Number Generator","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MARCH15\/mandarin\/RNG.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MARCH15\/russian\/RNG.pdf\">Russian<\/a>.<\/h3>\n<p>You may know how to write a random number generator (RNG) after solving <a href=\"http:\/\/www.codechef.com\/MARCH15\/problems\/SEAPROAR\">this problem (SEAPROAR)<\/a>.<\/p>\n<p>Another way to write a RNG is to use linear recurrence relation. e.g. let's consider the following linear recurrence: <\/p>\n<div style=\"margin-left: 3em;\"><b>A<sub>i<\/sub> = (A<sub>i\u22121<\/sub> \u00d7 C<sub>1<\/sub> + A<sub>i\u22122<\/sub> \u00d7 C<sub>2<\/sub> + ... + A<sub>i\u2212k<\/sub> \u00d7 C<sub>k<\/sub>) mod 104857601<\/b>, for <b>i = k+1, k+2, ...,<\/b><\/div>\n<p>  where <b>k<\/b> is a positive integer. <\/p>\n<p>\nYou are given initial values <b>A<sub>1<\/sub>, A<sub>2<\/sub>, ..., A<sub>k<\/sub><\/b> and the coefficients <b>C<sub>1<\/sub>, C<sub>2<\/sub>, ..., C<sub>k<\/sub><\/b>. Then the RNG can be used to generate any <b>A<sub>i<\/sub><\/b> for <b>i<\/b> larger than <b>k<\/b>.\n<\/p>\n<p>Your task is to calculate <b>A<sub>N<\/sub><\/b> for a given <b>N<\/b>.<\/p>\n<h3>Input<\/h3>\n<p>There is exactly one test case in each test file.<\/p>\n<p>The first line of input contains two space-separated integers <b>k<\/b> and <b>N<\/b> as described in the statement. The second line contains <b>k<\/b> space-separated integers <b>A<sub>1<\/sub>, A<sub>2<\/sub>, ..., A<sub>k<\/sub><\/b> denoting the initial values as defined in the problem statement.\n<\/p><p> Then the third line contains <b>k<\/b> space-separated integers <b>C<sub>1<\/sub>, C<sub>2<\/sub>, ..., C<sub>k<\/sub><\/b>, denoting the coefficients.\n<h3>Output<\/h3>\n<\/p><p>Print a single integer denoting value of <b>A<sub>N<\/sub><\/b>.<\/p>\n<h3>Constraints and Subtasks<\/h3>\n<ul>\n<li><b>1 \u2264 N \u2264 10<sup>18<\/sup><\/b><\/li>\n<li><b>0 \u2264 A<sub>i<\/sub>, C<sub>i<\/sub> &lt; 104857601<\/b><\/li>\n<\/ul>\n<p><\/p>\n<p><b>Subtask 1: 10 points<\/b><\/p>\n<ul>\n<li><b>1 \u2264 k \u2264 3000<\/b><\/li>\n<\/ul>\n<p><\/p>\n<p><b>Subtask 2: 90 points<\/b><\/p>\n<ul>\n<li><b>1 \u2264 k \u2264 30000<\/b><\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n3 5\n1 2 3\n4 5 6\n\n<b>Output:<\/b>\n139\n<\/pre><h3>Explanation<\/h3>\n<p><b>A<sub>1<\/sub> = 1.<\/b><br \/><b>A<sub>2<\/sub> = 2.<\/b><br \/><b>A<sub>3<\/sub> = 3.<\/b><br \/><b>A<sub>4<\/sub> = (A<sub>3<\/sub> \u00d7 C<sub>1<\/sub> + A<sub>2<\/sub> \u00d7 C<sub>2<\/sub> + A<sub>1<\/sub> \u00d7 C<sub>3<\/sub>) mod 104857601 = (3 \u00d7 4 + 2 \u00d7 5 + 1 \u00d7 6) mod 104857601 = (12 + 10 + 6) mod 104857601 = 28.<\/b><br \/><b>A<sub>5<\/sub> = (A<sub>4<\/sub> \u00d7 C<sub>1<\/sub> + A<sub>3<\/sub> \u00d7 C<sub>2<\/sub> + A<sub>2<\/sub> \u00d7 C<sub>3<\/sub>) mod 104857601 = (28 \u00d7 4 + 3 \u00d7 5 + 2 \u00d7 6) mod 104857601 = (112 + 15 + 12) mod 104857601 = 139.<\/b><br \/><\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"15","source_sizelimit":"50000","problem_author":"cgy4ever","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>cgy4ever<\/span>","problem_tester":"laycurse","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>laycurse<\/span>","date_added":"12-12-2014","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cgy4ever'>\n                    cgy4ever\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/fft'>\n                    fft\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/march15'>\n                    march15\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/RNG","user":{"username":null},"time":{"view_start_date":1426498200,"submit_start_date":1426498200,"visible_start_date":1426498200,"end_date":1735669800,"current":1493556816},"todo":false,"problem_status":"unattempted"}