{"category_name":"hard","status":"success","problem_code":"TMP01","problem_name":"To Queue or not to Queue","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>Chef has a string <b>S<\/b>. Initially, this string is empty. Also, Chef has a sequence of operations. Each operation is of one of the following two types:<\/p>\n<ul>\n<li>add character to the end of the string <b>S<\/b>, so the length of <b>S<\/b> increases by 1.<\/li>\n<li>delete the first character of <b>S<\/b>, so the length of <b>S<\/b> decreases by 1.<\/li>\n<\/ul>\n\n<p>After each operation Chef asks you the number of distinct substrings of the current string <b>S<\/b>. Please answer his questions!\n<\/p>\n<h3>Input<\/h3>\n<p>The first line of input contains <b>Q<\/b> - the number of operations. Then <b>Q<\/b> lines follow, each of these lines describes the operation.<\/p>\n<ul>\n<li>Add operation is of the form \"+ <b>C<\/b>\", where <b>C<\/b> is a lowercase English letter.<\/li>\n<li>Delete operation is of the from \"-\".<\/li>\n<\/ul>\n\n<p>It is guaranteed that after each operation, the length of <b>S<\/b> is a positive integer.\n<\/p>\n<h3>Output<\/h3>\n<p>Just to make the size of your output smaller, Chef asks you the sum of answers of all <b>Q<\/b> operations modulo <b>1000000007<\/b>.<br \/>\nSo, print a single integer - the sum of answers for all operations (the sum of <b>Q<\/b> numbers) modulo <b>1000000007<\/b>.\n<\/p>\n<h3>Constraints<\/h3>\n<p>\n1 \u2264 Q \u2264 1000000\n<\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n8\n+ a\n+ b\n+ a\n+ a\n-\n-\n-\n+ a\n\n<b>Output:<\/b>\n27\n<\/pre><p>\u00a0<\/p>\n<h3>Explanation<\/h3>\n<p>\nIn the first test case the string <b>S<\/b> transforms as follows: <\/p>\n<ul>\n<li>After the first operation <b>S<\/b> = a. The number of distinct substrings is 1: a.<\/li>\n<li>After the second operation <b>S<\/b> = ab. The number of distinct substrings is 3: a, b, ab.<\/li>\n<li>After the third operation <b>S<\/b> = aba. Answer is 5: a, b, ab, ba, aba.<\/li>\n<li>After the fourth operation <b>S<\/b> = abaa. Answer is 8: a, b, ab, ba, aa, aba, baa, abaa.<\/li>\n<li>After the fifth operation <b>S<\/b> = baa. Answer is 5: a, b, ba, aa, baa.<\/li>\n<li>After the sixth operation <b>S<\/b> = aa. Answer is 2: a, aa.<\/li>\n<li>After the seventh operation <b>S<\/b> = a. Answer is 1: a.<\/li>\n<li>After the eighth operation <b>S<\/b> = aa. Answer is 2: a, aa.<\/li>\n<\/ul>\n\n<p>The sum is <b>1 + 3 + 5 + 8 + 5 + 2 + 1 + 2 = 27<\/b>, <b>27 modulo 1000000007 = 27<\/b>, so, you should print 27.\n<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"3","source_sizelimit":"50000","problem_author":"gerald","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>gerald<\/span>","problem_tester":"xcwgf666","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","date_added":"24-07-2013","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/gerald'>\n                    gerald\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/sept13'>\n                    sept13\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/strings'>\n                    strings\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/suffix-trees'>\n                    suffix-trees\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/TMP01","user":{"username":null},"time":{"view_start_date":1379323800,"submit_start_date":1379323800,"visible_start_date":1379323800,"end_date":1735669800,"current":1493556875},"todo":false,"problem_status":"unattempted"}