{"category_name":"hard","status":"success","problem_code":"CTREE","problem_name":"Chef and Chefcoin","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/COOK91\/mandarin\/CTREE.pdf\">Mandarin chinese<\/a>, <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/COOK91\/russian\/CTREE.pdf\">Russian<\/a> and <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/COOK91\/vietnamese\/CTREE.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Everybody's heard about Chefland \u2014 the digital country where dreams come true, where nobody hears about crime and where everyone can get Accepted without submitting solutions. Of course, Chefland has the shape of a <a href=\"https:\/\/en.wikipedia.org\/wiki\/Tree_(graph_theory)\">tree<\/a> \u2014 there are <b>N<\/b> servers and <b>N-1<\/b> bidirectional channels connecting pairs of servers in such a way that there is exactly one path between each pair of servers.<\/p>\n\n<p>The citizens in Chefland are living online; each citizen lives on exactly one server at any point in time. Don't be surprised, it's a futuristic scenario! Each channel connecting two servers has a value called <i>ping<\/i>. Each citizen can move to a different server through channels; moving through a channel with ping <b>2w<\/b> takes <b>w<\/b> nanoseconds. Initially, there are <b>c<sub>i<\/sub><\/b> citizens living on the <b>i<\/b>-th server (for each 1 \u2264 <b>i<\/b> \u2264 <b>N<\/b>).<\/p>\n\n<p>Recently, Chef has created an <a href=\"https:\/\/en.wikipedia.org\/wiki\/Initial_coin_offering\">ICO<\/a> for Chefcoin \u2014 the cryptocurrency of the future in Chefland. Everyone in Chefland should receive exactly 1 Chefcoin. How to organize this process? Chefcoins can only be received on certain servers containing cryptoexchanges. Unfortunately, Chef can only create cryptoexchanges on two servers, since they consume a lot of electric power. The citizens want to receive Chefcoin as fast as possible; therefore, each citizen chooses the closest server with a cryptoexchange and moves to that server. Receiving Chefcoin at a cryptoexchange takes zero time.<\/p>\n\n<p>Chef wants to minimize the sum of the times each citizen needs to spend moving to receive Chefcoin. The two servers containing cryptoexchanges can be chosen arbitrarily. Compute the minimum total time it takes Chefland's citizens to receive Chefcoin!<\/p>\n\n<h3>Input<\/h3>\n<ul>\n<li>The first line of the input contains a single integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/li>\n<li>The first line of each test case contains a single integer <b>N<\/b>.<\/li>\n<li>The second line contains <b>N<\/b> space-separated integers <b>c<sub>1<\/sub>, c<sub>2<\/sub>, ..., c<sub>N<\/sub><\/b>.<\/li>\n<li><b>N-1<\/b> lines follow. Each of these lines contains three space-separated integers <b>u<\/b>, <b>v<\/b> and <b>w<\/b> denoting a channel with ping <b>2w<\/b> nanoseconds connecting servers <b>u<\/b> and <b>v<\/b>.<\/li>\n<\/ul>\n\n<h3>Output<\/h3>\n<p>For each test case, print a single line containing one integer \u2014 the minimal sum of times it takes each citizen to receive Chefcoin if the two cryptoexchanges are placed optimally.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li>2 \u2264 <b>N<\/b> \u2264 50000<\/li>\n<li>1 \u2264 <b>c<sub>i<\/sub><\/b> \u2264 50000 for each valid <b>i<\/b><\/li>\n<li>1 \u2264 <b>w<\/b> \u2264 50000<\/li>\n<li>1 \u2264 <b>u<\/b>, <b>v<\/b> \u2264 <b>N<\/b><\/li>\n<li>the channels describe a tree<\/li>\n<li>1 \u2264 sum of <b>N<\/b> over all test cases \u2264 250000<\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n\n2\n4\n10 25 15 40\n1 2 1\n2 3 3\n1 4 4\n7\n24786 24640 17641 19735 8667 15790 5948\n3 7 17108\n7 6 4875\n7 1 9317\n1 2 8597\n3 4 28200\n1 5 22026\n\n<b>Output:<\/b>\n\n55\n1148402043\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p><b>Example case 1:<\/b> Chef can create cryptoexchanges on servers 2 and 4. Citizens on these servers receive Chefcoins immediately. The total time for Chefland's remaining citizens is the time it takes 15 citizens to move from server 3 to server 2 (3 \u00b7 15 = 45) plus the time it takes 10 citizens to move from server 1 to server 2 (1 \u00b7 10 = 10), so the optimal total time is 55.<\/p>\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.5, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"mgch","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>mgch<\/span>","problem_tester":"wwwwodddd","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>wwwwodddd<\/span>","date_added":"3-02-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook91'>cook91<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/data-structure'>data-structure<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/dfs'>dfs<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/graph-theory'>graph-theory<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/mgch'>mgch<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tree'>tree<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/CTREE","time":{"view_start_date":1518978600,"submit_start_date":1518978600,"visible_start_date":1518978600,"end_date":1735669800,"current":1525454405},"user":{"username":""},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}