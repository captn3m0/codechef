{"category_name":"hard","status":"success","problem_code":"LALALANT","problem_name":"The Fools Who Dream","body":"My ant used to live in Paris. But now, he lives in La La Land, because of lower rents. There's only one disadvantage in living there: traveling in La La Land is a nightmare. \r\n\r\nLa La Land is a rectangular grid with dimensions $r\\times c$ ($r$ rows, $c$ columns). Each cell can only have one of three colors: **black**, **red**, and **white**. And as you know, ants are colored either **black** or **red**. But because the mayor of La La Land is a bit crazy, he requires every walking ant in La La Land to follow these rules:\r\n\r\n- A walking ant must always be facing in one of the four cardinal directions: north, south, east and west.\r\n- A walking ant that goes into a **white** cell must keep walking forward, not changing directions. \r\n- A walking ant that goes into a non-white cell with the **same color** as itself must turn left 90 degrees exactly once, and then keep walking forward.\r\n- A walking ant that goes into a non-white cell with a **different color** from itself must turn right 90 degrees exactly once, and then keep walking forward.\r\n- A walking ant that goes off the grid is foolish. It is very hard to go back into La La Land without tons of paperwork, so we can assume that a walking ant that goes off the grid will stay outside the grid forever.\r\n\r\nAs you can see, once an ant begins walking, it doesn't really have any choice. The ant's path is fully determined by the grid.\r\n\r\nMy ant is a black ant, and he wants to build a **house** in one of the cells in La La Land, and live there with his friend, which is a red ant. They also want to build their **garage** in one of the cells. The mayor has additional rules regarding houses and garages:\r\n\r\n- There must be exactly one house and one garage.\r\n- The cells containing the house and the garage must be different.\r\n- The cells containing the house and the garage must be white cells.\r\n- The house must have exactly one door, and it must point in one of the four cardinal directions. Thus, any walking ant leaving the house will be facing in that direction.\r\n\r\nLuckily, the garage can be entered from any direction, and the house and the garage cells don't have to be adjacent to each other.\r\n\r\nFurthermore, my ant and his friend behave in the following way:\r\n\r\n- If they reach the cell containing the house again, they just keep walking forward (since that cell is white). Note that this is not considered as \"walking out of the house\", so in particular, they will keep their current direction and not switch to the direction of the door.\r\n- _As soon as_ they reach the cell containing the garage, they immediately stop walking. (They will then ride their car. Yes, these ants are rich.)\r\n\r\nMy ant, which is a black ant, has a *special* subset $B$ of the cells that he wants to visit every time he walks out from his house. His friend, which is a red ant, also has a *special* subset $R$ of the cells that she wants to visit every time she walks out from her house. They may optionally visit other cells outside their *special* subset, but they must visit all cells in their *special* subset. Also, they must end their walk at the garage. \r\n\r\nYou are friends with the mayor, and so you managed to talk him into changing the colors of the cells for you. The mayor has given you complete freedom to choose the color of every cell in the grid with only one restriction: since the mayor is a red ant, he doesn't like black, so he requires the final grid to have at most $11$ black cells.\r\n\r\nHelp my ant and his friend achieve their dream, foolish as they may seem, by choosing the coloring of the grid (subject to the mayor's restriction), choosing the locations of the house and the garage, and choosing where the door of the house points to. Or, if it is impossible, say so as well.\r\n\r\n\"A bit of madness is key  \r\nto give us new colors to see.  \r\nWho knows where it will lead us?  \r\nAnd that's why they need us.\"\r\n\r\n\r\n### Input\r\n\r\nThe first line contains $T$, the number of test cases. The following lines describe the test cases.  \r\n\r\nThe first line of each test case contains four space-separated integers $r$, $c$, $|B|$ and $|R|$, where $|B|$ and $|R|$ denote the sizes of $B$ and $R$, respectively.  \r\nEach of the next $|B|$ lines contains two space-separated integers $i$ and $j$ denoting that the cell at row $i$ and column $j$ is in $B$.  \r\nEach of the next $|R|$ lines contains two space-separated integers $i$ and $j$ denoting that the cell at row $i$ and column $j$ is in $R$.  \r\n\r\n### Output\r\n\r\nFor each test case, first output a single line containing either `POSSIBLE` (if it is possible) or `FOOLISH` (if it is impossible). In addition, if it is possible, you need to output at least one valid coloring. Output $r$ more lines, each containing a string of length $c$ whose letters are one of the following:\r\n\r\n- `B` denoting a black cell;\r\n- `R` denoting a red cell;\r\n- `W` denoting a white cell;\r\n- `G` denoting a white cell containing the garage;\r\n- `^` denoting a white cell containing a house with door pointing north;\r\n- `v` denoting a white cell containing a house with door pointing south;\r\n- `(` denoting a white cell containing a house with door pointing west;\r\n- `)` denoting a white cell containing a house with door pointing east.\r\n\r\nWe assume that north is up, south is down, west is left, and east is right. Note that:\r\n\r\n- There must be exactly one cell containing `G`. \r\n- There must be exactly one cell containing one of the characters `^`, `v`, `(` or `)`. \r\n- There must be at most $11$ cells containing `B`. \r\n\r\nThere may be multiple possible answers; any one will be accepted.\r\n\r\n### Constraints \r\n\r\n- $1 \\leq T \\leq 10^5$  \r\n- $1 \\le r, c \\le 150$  \r\n- $1 \\le i \\le r$  \r\n- $1 \\le j \\le c$  \r\n- $0 \\le |B|, |R| \\le 500$  \r\n- The sum of the $rc$ in a single file is $\\le 5\\cdot 10^6$  \r\n- The sum of the $|B|$ in a single file is $\\le 10^6$  \r\n- The sum of the $|R|$ in a single file is $\\le 10^6$  \r\n\r\n### Sample Input\r\n\r\n    3\r\n    6 11 5 3\r\n    5 5\r\n    5 8\r\n    5 9\r\n    6 8\r\n    6 9\r\n    1 5\r\n    3 2\r\n    4 9\r\n    7 5 4 3\r\n    6 1\r\n    4 2\r\n    5 2\r\n    7 2\r\n    3 5\r\n    5 2\r\n    7 2\r\n    2 2 1 1\r\n    1 2\r\n    2 1\r\n\r\n\r\n### Sample Output\r\n\r\n    POSSIBLE\r\n    WWWBWWWBWWR\r\n    WRWWWWWWWBW\r\n    W)WRWWBWWWR\r\n    WWWWBBRRWGR\r\n    WWWBWWWWRRR\r\n    WBWWRWRRRRR\r\n    POSSIBLE\r\n    RWWRW\r\n    RWBRB\r\n    WBBWB\r\n    WWWBW\r\n    BR^WB\r\n    WWWWB\r\n    BGBWW\r\n    FOOLISH\r\n\r\n### Explanation  \r\n\r\nHere's an illustration of the output for the first two test cases.\r\n\r\n![Illustration of the first two sample outputs](https:\/\/s3.amazonaws.com\/codechef_shared\/uploads\/2019\/AR\/1.png?fbclid=IwAR24M2Vmb95kVBw-efGbt5qpUXaAn0I6DwcXhhQfPMjYDJQ8RoPqazxHIrY =570x230 \"Here's to the mess we make\")\r\n\r\nNote that there are other valid solutions.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"My ant used to live in Paris. But now, he lives in La La Land, because of lower rents. There's only one disadvantage in living there: traveling in La La Land is a nightmare. \r\n\r\nLa La Land is a rectangular grid with dimensions $r\\times c$ ($r$ rows, $c$ columns). Each cell can only have one of three colors: **black**, **red**, and **white**. And as you know, ants are colored either **black** or **red**. But because the mayor of La La Land is a bit crazy, he requires every walking ant in La La Land to follow these rules:\r\n\r\n- A walking ant must always be facing in one of the four cardinal directions: north, south, east and west.\r\n- A walking ant that goes into a **white** cell must keep walking forward, not changing directions. \r\n- A walking ant that goes into a non-white cell with the **same color** as itself must turn left 90 degrees exactly once, and then keep walking forward.\r\n- A walking ant that goes into a non-white cell with a **different color** from itself must turn right 90 degrees exactly once, and then keep walking forward.\r\n- A walking ant that goes off the grid is foolish. It is very hard to go back into La La Land without tons of paperwork, so we can assume that a walking ant that goes off the grid will stay outside the grid forever.\r\n\r\nAs you can see, once an ant begins walking, it doesn't really have any choice. The ant's path is fully determined by the grid.\r\n\r\nMy ant is a black ant, and he wants to build a **house** in one of the cells in La La Land, and live there with his friend, which is a red ant. They also want to build their **garage** in one of the cells. The mayor has additional rules regarding houses and garages:\r\n\r\n- There must be exactly one house and one garage.\r\n- The cells containing the house and the garage must be different.\r\n- The cells containing the house and the garage must be white cells.\r\n- The house must have exactly one door, and it must point in one of the four cardinal directions. Thus, any walking ant leaving the house will be facing in that direction.\r\n\r\nLuckily, the garage can be entered from any direction, and the house and the garage cells don't have to be adjacent to each other.\r\n\r\nFurthermore, my ant and his friend behave in the following way:\r\n\r\n- If they reach the cell containing the house again, they just keep walking forward (since that cell is white). Note that this is not considered as \"walking out of the house\", so in particular, they will keep their current direction and not switch to the direction of the door.\r\n- _As soon as_ they reach the cell containing the garage, they immediately stop walking. (They will then ride their car. Yes, these ants are rich.)\r\n\r\nMy ant, which is a black ant, has a *special* subset $B$ of the cells that he wants to visit every time he walks out from his house. His friend, which is a red ant, also has a *special* subset $R$ of the cells that she wants to visit every time she walks out from her house. They may optionally visit other cells outside their *special* subset, but they must visit all cells in their *special* subset. Also, they must end their walk at the garage. \r\n\r\nYou are friends with the mayor, and so you managed to talk him into changing the colors of the cells for you. The mayor has given you complete freedom to choose the color of every cell in the grid with only one restriction: since the mayor is a red ant, he doesn't like black, so he requires the final grid to have at most $11$ black cells.\r\n\r\nHelp my ant and his friend achieve their dream, foolish as they may seem, by choosing the coloring of the grid (subject to the mayor's restriction), choosing the locations of the house and the garage, and choosing where the door of the house points to. Or, if it is impossible, say so as well.\r\n\r\n\"A bit of madness is key  \r\nto give us new colors to see.  \r\nWho knows where it will lead us?  \r\nAnd that's why they need us.\"\r\n\r\n\r\n### Input\r\n\r\nThe first line contains $T$, the number of test cases. The following lines describe the test cases.  \r\n\r\nThe first line of each test case contains four space-separated integers $r$, $c$, $|B|$ and $|R|$, where $|B|$ and $|R|$ denote the sizes of $B$ and $R$, respectively.  \r\nEach of the next $|B|$ lines contains two space-separated integers $i$ and $j$ denoting that the cell at row $i$ and column $j$ is in $B$.  \r\nEach of the next $|R|$ lines contains two space-separated integers $i$ and $j$ denoting that the cell at row $i$ and column $j$ is in $R$.  \r\n\r\n### Output\r\n\r\nFor each test case, first output a single line containing either `POSSIBLE` (if it is possible) or `FOOLISH` (if it is impossible). In addition, if it is possible, you need to output at least one valid coloring. Output $r$ more lines, each containing a string of length $c$ whose letters are one of the following:\r\n\r\n- `B` denoting a black cell;\r\n- `R` denoting a red cell;\r\n- `W` denoting a white cell;\r\n- `G` denoting a white cell containing the garage;\r\n- `^` denoting a white cell containing a house with door pointing north;\r\n- `v` denoting a white cell containing a house with door pointing south;\r\n- `(` denoting a white cell containing a house with door pointing west;\r\n- `)` denoting a white cell containing a house with door pointing east.\r\n\r\nWe assume that north is up, south is down, west is left, and east is right. Note that:\r\n\r\n- There must be exactly one cell containing `G`. \r\n- There must be exactly one cell containing one of the characters `^`, `v`, `(` or `)`. \r\n- There must be at most $11$ cells containing `B`. \r\n\r\nThere may be multiple possible answers; any one will be accepted.\r\n\r\n### Constraints \r\n\r\n- $1 \\leq T \\leq 10^5$  \r\n- $1 \\le r, c \\le 150$  \r\n- $1 \\le i \\le r$  \r\n- $1 \\le j \\le c$  \r\n- $0 \\le |B|, |R| \\le 500$  \r\n- The sum of the $rc$ in a single file is $\\le 5\\cdot 10^6$  \r\n- The sum of the $|B|$ in a single file is $\\le 10^6$  \r\n- The sum of the $|R|$ in a single file is $\\le 10^6$  \r\n\r\n### Sample Input\r\n\r\n    3\r\n    6 11 5 3\r\n    5 5\r\n    5 8\r\n    5 9\r\n    6 8\r\n    6 9\r\n    1 5\r\n    3 2\r\n    4 9\r\n    7 5 4 3\r\n    6 1\r\n    4 2\r\n    5 2\r\n    7 2\r\n    3 5\r\n    5 2\r\n    7 2\r\n    2 2 1 1\r\n    1 2\r\n    2 1\r\n\r\n\r\n### Sample Output\r\n\r\n    POSSIBLE\r\n    WWWBWWWBWWR\r\n    WRWWWWWWWBW\r\n    W)WRWWBWWWR\r\n    WWWWBBRRWGR\r\n    WWWBWWWWRRR\r\n    WBWWRWRRRRR\r\n    POSSIBLE\r\n    RWWRW\r\n    RWBRB\r\n    WBBWB\r\n    WWWBW\r\n    BR^WB\r\n    WWWWB\r\n    BGBWW\r\n    FOOLISH\r\n\r\n### Explanation  \r\n\r\nHere's an illustration of the output for the first two test cases.\r\n\r\n![Illustration of the first two sample outputs](https:\/\/s3.amazonaws.com\/codechef_shared\/uploads\/2019\/AR\/1.png?fbclid=IwAR24M2Vmb95kVBw-efGbt5qpUXaAn0I6DwcXhhQfPMjYDJQ8RoPqazxHIrY =570x230 \"Here's to the mess we make\")\r\n\r\nNote that there are other valid solutions.\r\n","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, CPP17, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"4","source_sizelimit":"50000","problem_author":"kevinsogo","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>kevinsogo<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"25-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/kevinsogo'>kevinsogo<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"","editorial_url":"","time":{"view_start_date":1577730600,"submit_start_date":1577730600,"visible_start_date":1577730600,"end_date":1735669800,"current":1643797997},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=LALALANT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}