{"category_name":"hard","status":"success","problem_code":"OWCAFILE","problem_name":"OWCA Files","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN20\/hindi\/OWCAFILE.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN20\/bengali\/OWCAFILE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/mandarin\/OWCAFILE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN20\/russian\/OWCAFILE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/vietnamese\/OWCAFILE.pdf) as well.\r\n\r\nDr.D has broken into O.W.C.A. (The Organization Without A Cool Acronym) in order to find Agent P's reports. He has already found the great vault of O.W.C.A. where Major Monogram keeps the O.W.C.A. files. Unfortunately, the vault is protected by Major Monogram's secret password.\r\n\r\nDr.D knows that Major Monogram has always been fond of $N$ integers $A_1, A_2, \\ldots, A_N$ and the password he chose is the product of $K$ of these integers modulo some prime $P$ (since the product itself might become huge and thus hard for him to remember). The integers in the product do not have to correspond to distinct elements of $A$, Major Monogram simply chose $K$ indices $i_1, i_2, \\ldots, i_K$ and computed $A_{i_1} \\cdot A_{i_2} \\cdot \\ldots \\cdot A_{i_K}$ modulo $P$.\r\n\r\nWith a lot of effort, Dr.D found out $P$, $K$ and $A$, but he does not know how Major Monogram chose $K$ integers from the sequence $A$. In order to get into the vault, Dr.D has created the Bruteforceinator, which will try all sequences of $K$ valid indices $i_1, i_2, \\ldots, i_K$ ($N^K$ sequences in total) and for each of them, compute the product $A_{i_1} \\cdot A_{i_2} \\cdot \\ldots \\cdot A_{i_K}$ and try its remainder modulo $P$, instead of just trying all possible passwords from $0$ to $P-1$. The Bruteforceinator keeps trying even after it has tried a correct password and only unlocks the vault after it tries all $N^K$ options.\r\n\r\nWhile the Bruteforceinator is doing its job, Dr.D is wondering how many times it will try each possible password. For each $i$ beween $0$ and $P-1$ (inclusive), find the number of times the Bruteforceinator will try $i$ as the password. Since these numbers may get large, compute them modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains three space-separated integers $N$, $P$ and $K$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n### Output\r\nPrint a single line containing $P$ space-separated integers. For each $i$ ($1 \\le i \\le P$), the $i$-th of these integers should be the number of times the Bruteforceinator will try $i-1$ as the password, modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le N, P \\le 259,431$\r\n- $P$ is a prime number\r\n- $0 \\le A_i \\le P-1$ for each valid $i$\r\n- $0 \\le K \\le 10^9+9$\r\n\r\n### Subtasks\r\n**Subtask #1 (16 points):** $1 \\le N \\le 400$\r\n\r\n**Subtask #2 (84 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n6 11 3\r\n9 8 4 3 5 3\r\n```\r\n\r\n### Example Output\r\n```\r\n0 27 9 31 28 32 19 15 18 22 15 \r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JAN20\/hindi\/OWCAFILE.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JAN20\/bengali\/OWCAFILE.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/mandarin\/OWCAFILE.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JAN20\/russian\/OWCAFILE.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JAN20\/vietnamese\/OWCAFILE.pdf) as well.\r\n\r\nDr.D has broken into O.W.C.A. (The Organization Without A Cool Acronym) in order to find Agent P's reports. He has already found the great vault of O.W.C.A. where Major Monogram keeps the O.W.C.A. files. Unfortunately, the vault is protected by Major Monogram's secret password.\r\n\r\nDr.D knows that Major Monogram has always been fond of $N$ integers $A_1, A_2, \\ldots, A_N$ and the password he chose is the product of $K$ of these integers modulo some prime $P$ (since the product itself might become huge and thus hard for him to remember). The integers in the product do not have to correspond to distinct elements of $A$, Major Monogram simply chose $K$ indices $i_1, i_2, \\ldots, i_K$ and computed $A_{i_1} \\cdot A_{i_2} \\cdot \\ldots \\cdot A_{i_K}$ modulo $P$.\r\n\r\nWith a lot of effort, Dr.D found out $P$, $K$ and $A$, but he does not know how Major Monogram chose $K$ integers from the sequence $A$. In order to get into the vault, Dr.D has created the Bruteforceinator, which will try all sequences of $K$ valid indices $i_1, i_2, \\ldots, i_K$ ($N^K$ sequences in total) and for each of them, compute the product $A_{i_1} \\cdot A_{i_2} \\cdot \\ldots \\cdot A_{i_K}$ and try its remainder modulo $P$, instead of just trying all possible passwords from $0$ to $P-1$. The Bruteforceinator keeps trying even after it has tried a correct password and only unlocks the vault after it tries all $N^K$ options.\r\n\r\nWhile the Bruteforceinator is doing its job, Dr.D is wondering how many times it will try each possible password. For each $i$ beween $0$ and $P-1$ (inclusive), find the number of times the Bruteforceinator will try $i$ as the password. Since these numbers may get large, compute them modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains three space-separated integers $N$, $P$ and $K$.\r\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\r\n\r\n### Output\r\nPrint a single line containing $P$ space-separated integers. For each $i$ ($1 \\le i \\le P$), the $i$-th of these integers should be the number of times the Bruteforceinator will try $i-1$ as the password, modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le N, P \\le 259,431$\r\n- $P$ is a prime number\r\n- $0 \\le A_i \\le P-1$ for each valid $i$\r\n- $0 \\le K \\le 10^9+9$\r\n\r\n### Subtasks\r\n**Subtask #1 (16 points):** $1 \\le N \\le 400$\r\n\r\n**Subtask #2 (84 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"6 11 3\r\n9 8 4 3 5 3","output":"0 27 9 31 28 32 19 15 18 22 15","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"4","source_sizelimit":"50000","problem_author":"kmaaszraa","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span class='m-username--link'>kmaaszraa<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"8-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/binary-exponentation'>binary-exponentation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/fast-fourier-transform'>fast-fourier-transform<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/jan20'>jan20<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kmaaszraa'>kmaaszraa<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/kmaaszraa'>kmaaszraa<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/math'>math<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/primitive-root'>primitive-root<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/vijju123'>vijju123<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Fast Fourier Transform","editorial_url":"","time":{"view_start_date":1578907800,"submit_start_date":1578907800,"visible_start_date":1578907800,"end_date":1735669800,"current":1643797997},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=OWCAFILE","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}