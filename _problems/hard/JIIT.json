{"category_name":"hard","status":"success","problem_code":"JIIT","problem_name":"Queries on Matrix","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/OCT19\/hindi\/JIIT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/OCT19\/bengali\/JIIT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/OCT19\/mandarin\/JIIT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/OCT19\/russian\/JIIT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/OCT19\/vietnamese\/JIIT.pdf) as well.\r\n\r\n\"But I\u2019m no longer the troublemaker you think I am!\" - Naruto Uzumaki\r\n\r\nSakshi had a matrix with $N$ rows (numbered $1$ through $N$) and $M$ columns (numbered $1$ through $M$). Initially, all cells of this matrix contained $0$-s. Let's denote a cell in row $r$ and column $c$ by $(r, c)$.\r\n\r\nSakshi is well-known for troubling others. This time, her friends Nikki and Mansi planned to take revenge and teach her a lesson, so they changed her matrix by performing the following operation $Q$ times:\r\n- Choose any valid cell $(x, y)$.\r\n- Add $1$ to all the cells in row $x$.\r\n- Add $1$ to all the cells in column $y$.\r\n\r\nThen, Nikki and Mansi challenged Sakshi to find the total number of ways to perform a sequence of $Q$ operations on the initial matrix such that at the end, exactly $Z$ cells in the matrix contain odd integers. Sakshi is not good at math, since she has spent all her life troubling others, so this time, she really needs your help. Help Sakshi count the number of ways. Since the answer may be large, compute it modulo $998,244,353$.\r\n\r\nNote: Two ways to perform a sequence of operations are considered different if there is a valid $i$ such that the cell chosen in the $i$-th operation in one sequence is different from the cell chosen in the $i$-th operation in the other sequence. For example, if we choose the cells $(1,1)$ and $(2,2)$ in this order, it is different from choosing the cells $(2,2)$ and $(1,1)$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains four space-separated integers $N$, $M$, $Q$ and $Z$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the number of ways to perform a sequence of operations modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 50$\r\n- $1 \\le N, M \\le 2,000$\r\n- $0 \\le Z \\le N \\cdot M$\r\n- $1 \\le Q \\le 10^{18}$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** $1 \\le N, M, Q \\le 300$\r\n\r\n**Subtask #2 (40 points):** $1 \\le N, M \\le 300$\r\n\r\n**Subtask #3 (10 points):** $1 \\le N, M \\le 500$\r\n\r\n**Subtask #4 (10 points):** $1 \\le N, M \\le 600$\r\n\r\n**Subtask #5 (10 points):** $1 \\le N, M \\le 700$\r\n\r\n**Subtask #6 (10 points):** $1 \\le N, M \\le 800$\r\n\r\n**Subtask #7 (10 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n2\r\n2 2 2 0\r\n2 2 2 4\r\n```\r\n\r\n### Example Output\r\n```\r\n8\r\n8\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** If we start by choosing the cell $(1, 1)$, the matrix becomes\r\n```\r\n2 1\r\n1 0\r\n```\r\n\r\nNow we have two options \u2015 we can choose either even-valued cell. If we choose $(1, 1)$ again, the matrix becomes \r\n```\r\n4 2\r\n2 0\r\n```\r\n\r\nIf we choose $(2, 2)$ instead, it becomes\r\n```\r\n2 2\r\n2 2\r\n```\r\n\r\nFor each of the other three possible initial cells, there are also two cells we can choose in the second operation, which is $4 \\cdot 2 = 8$ ways in total.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/OCT19\/hindi\/JIIT.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/OCT19\/bengali\/JIIT.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/OCT19\/mandarin\/JIIT.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/OCT19\/russian\/JIIT.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/OCT19\/vietnamese\/JIIT.pdf) as well.\r\n\r\n\"But I\u2019m no longer the troublemaker you think I am!\" - Naruto Uzumaki\r\n\r\nSakshi had a matrix with $N$ rows (numbered $1$ through $N$) and $M$ columns (numbered $1$ through $M$). Initially, all cells of this matrix contained $0$-s. Let's denote a cell in row $r$ and column $c$ by $(r, c)$.\r\n\r\nSakshi is well-known for troubling others. This time, her friends Nikki and Mansi planned to take revenge and teach her a lesson, so they changed her matrix by performing the following operation $Q$ times:\r\n- Choose any valid cell $(x, y)$.\r\n- Add $1$ to all the cells in row $x$.\r\n- Add $1$ to all the cells in column $y$.\r\n\r\nThen, Nikki and Mansi challenged Sakshi to find the total number of ways to perform a sequence of $Q$ operations on the initial matrix such that at the end, exactly $Z$ cells in the matrix contain odd integers. Sakshi is not good at math, since she has spent all her life troubling others, so this time, she really needs your help. Help Sakshi count the number of ways. Since the answer may be large, compute it modulo $998,244,353$.\r\n\r\nNote: Two ways to perform a sequence of operations are considered different if there is a valid $i$ such that the cell chosen in the $i$-th operation in one sequence is different from the cell chosen in the $i$-th operation in the other sequence. For example, if we choose the cells $(1,1)$ and $(2,2)$ in this order, it is different from choosing the cells $(2,2)$ and $(1,1)$.\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first and only line of each test case contains four space-separated integers $N$, $M$, $Q$ and $Z$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the number of ways to perform a sequence of operations modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le T \\le 50$\r\n- $1 \\le N, M \\le 2,000$\r\n- $0 \\le Z \\le N \\cdot M$\r\n- $1 \\le Q \\le 10^{18}$\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):** $1 \\le N, M, Q \\le 300$\r\n\r\n**Subtask #2 (40 points):** $1 \\le N, M \\le 300$\r\n\r\n**Subtask #3 (10 points):** $1 \\le N, M \\le 500$\r\n\r\n**Subtask #4 (10 points):** $1 \\le N, M \\le 600$\r\n\r\n**Subtask #5 (10 points):** $1 \\le N, M \\le 700$\r\n\r\n**Subtask #6 (10 points):** $1 \\le N, M \\le 800$\r\n\r\n**Subtask #7 (10 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"2\r\n2 2 2 0\r\n2 2 2 4","output":"8\r\n8","explanation":"**Example case 1:** If we start by choosing the cell $(1, 1)$, the matrix becomes\r\n```\r\n2 1\r\n1 0\r\n```\r\n\r\nNow we have two options ? we can choose either even-valued cell. If we choose $(1, 1)$ again, the matrix becomes \r\n```\r\n4 2\r\n2 0\r\n```\r\n\r\nIf we choose $(2, 2)$ instead, it becomes\r\n```\r\n2 2\r\n2 2\r\n```\r\n\r\nFor each of the other three possible initial cells, there are also two cells we can choose in the second operation, which is $4 \\cdot 2 = 8$ ways in total.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"4","source_sizelimit":"50000","problem_author":"iamabjain","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span class='m-username--link'>iamabjain<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"11-07-2017","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/fast-fourier-transform'>fast-fourier-transform<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/iamabjain'>iamabjain<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/maths'>maths<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/oct19'>oct19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/r_64'>r_64<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Fast Fourier Transform","editorial_url":"https:\/\/discuss.codechef.com\/problems\/JIIT","time":{"view_start_date":1571045400,"submit_start_date":1571045400,"visible_start_date":1571045400,"end_date":1735669800,"current":1643797995},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=JIIT","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}