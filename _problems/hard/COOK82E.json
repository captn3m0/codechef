{"category_name":"hard","status":"success","problem_code":"COOK82E","problem_name":"Binary Tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK82\/mandarin\/COOK82E.pdf\">mandarin chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK82\/russian\/COOK82E.pdf\">russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK82\/vietnamese\/COOK82E.pdf\">vietnamese<\/a> as well.<\/h3>\n\n<p>Hussain met his friend Alex finally for the first time, because Alex travelled to USA. Hussain decided to treat him to a problem. Hussain challenged Alex to solve this task :<\/p>\n\n<p>Hussain has a binary tree, initially consisting of 1 node (called the root), and it has label 1. A binary tree is a tree where the number of children of any node is at most 2.<\/p>\n\n<p>This tree has a very nice property: At the end of each second, each leaf (a node with no children) labelled <b>x<\/b> will produce 2 children. The new left child will be labelled <b>2*x<\/b> and the new right child will be labelled <b>2*x+1<\/b>.<\/p>\n\n<p>If a node has only one child, it just reproduces the other one. (The already existing child isn't affected). <\/p>\n\n<p>Hussain can perform 2 operations on this tree : <\/p>\n\n<ol type = \"1\">\n<li>He can make this tree travel into the future by <b>T<\/b> seconds. That is,\n <b>T<\/b> seconds will pass.<\/li>\n\n<li>He can put a robot at the root of the tree, and instruct the robot to walk down the tree with a string of <b>'L'<\/b> and <b>'R'<\/b> commands. An <b>'L'<\/b> command makes the robot go to the left child, and an <b>'R'<\/b> command makes it go to the right child. It is guaranteed that the commands will be valid. After the robot finishes executing the string of commands, it explodes itself so that the node in which it is present, along with the entire subtree beneath it gets deleted. Assume that this entire operation is instantaneous and doesn't take any time.<\/li>\n<\/ol>\n\n<p><\/p>\n<p>Hussain will perform <b>Q<\/b> operations on this tree. After each operation, Alex must tell the number of nodes left in the tree, modulo <b>10<sup>9<\/sup>+7<\/b>.<\/p>\n\n<h3>Input<\/h3>\n<ul>\n<li>The first line contains a single integer, <b>M<\/b>, the number of testcases. Each testcase is described as follows: <\/li>\n<li>The first line of each testcase contains a single integer, <b>Q<\/b>, denoting the number of operations.<\/li>\n<li>The next <b>Q<\/b> lines of the testcase each contain an integer, <b>cmd<\/b>, at the beginning. <b>cmd<\/b> equals to 1 or 2.\n\n<ul>\n<li>If <b>cmd = 1<\/b>, then Hussain will make the tree travel into the future. The line will also contain another integer <b>T<\/b>, denoting the number of seconds that will pass after Hussain runs his time machine.<\/li>\n\n<li>If <b>cmd = 2<\/b>, then Hussain will send his robot. You will be given a non-empty string describing the sequence of commands that the robot will follow to reach some existing node, which it then destroys along with the subtree.<\/li>\n<\/ul>\nPlease note that in second case the string will be nonempty, so the root will never be deleted.<\/li>\n<\/ul>\n\n<h3>Output<\/h3>\n<p>For each testcase, output <b>Q<\/b> lines, the i-th of which contains the number of nodes in the tree after performing the i-th query, modulo <b>10<sup>9<\/sup>+7<\/b>.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>M<\/b> \u2264 20 <\/li>\n<li>1 \u2264 <b>Q<\/b> \u2264 3 * 10<sup>5<\/sup><\/li>\n<li>For each query where <b>cmd = 1<\/b>: 1 \u2264 <b>T<\/b> \u2264 10<sup>5<\/sup><\/li>\n<li>For each query where <b>cmd = 2<\/b>: the string of commands will consist only of the characters <b>'L'<\/b> and <b>'R'<\/b>.<\/li>\n<li>It is guaranteed that the commands will be valid, and the robot will always land on an existing node. In particular, if the command asks the robot to go to the left (or right) child, then there will be a left (or right) child.<\/li>\n<li>The sum of lengths of strings in the second type of command, in each testfile will not exceed 10<sup>6<\/sup><\/li>\n<li>The sum of time shift in each testfile will not exceed 10<sup>6<\/sup><\/li>\n<li>The sum of commands in each testfile will not exceed 10<sup>6<\/sup><\/li>\n<\/ul>\n\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\n6\n1 1\n2 L\n1 1\n2 R\n1 1\n1 1\n3\n1 3\n2 LR\n2 RRR\n\n<b>Output:<\/b>\n3\n2\n5\n2\n5\n11\n15\n12\n11\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>We will explain the first testcase. At the beginning, there is just the root, and the tree is as follows:<\/p>\n\n<p><\/p>\n<img src=\"https:\/\/puu.sh\/vWPJG\/7de2e400bf.png\" \/> \n<p><\/p>\n\n<p>Then, Hussain time travels forward by 1 second, and so after the first operation, the tree looks like this:<\/p>\n<p><\/p>\n<img src=\"https:\/\/puu.sh\/vWPqf\/9a0cce7f8e.png\" \/> \n<p><\/p>\n\n<p>The next operation deletes the node 2. So, after that, the tree looks like:<\/p>\n<p><\/p>\n<img src=\"https:\/\/puu.sh\/vWPGs\/33f517cb10.png\" \/> \n<p><\/p>\n\n<p>Hussain time travels again by 1 second, and after that, the tree looks like this:<\/p>\n<p><\/p>\n<img src=\"https:\/\/puu.sh\/vWQ4T\/58b136870c.png\" \/> \n<p><\/p>\n\n<p>In the next operation, node 3 is exploded, along with both its children. Hence after that, the tree looks like:<\/p>\n<p><\/p>\n<img src=\"https:\/\/puu.sh\/vWPI1\/3bd4e86b29.png\" \/> \n<p><\/p>\n\n<p>One more second is time travelled, and the tree looks like:<\/p>\n<p><\/p>\n<img src=\"https:\/\/puu.sh\/vWPce\/532d9150aa.png\" \/> \n<p><\/p>\n\n<p>One more second is time travelled, and the tree looks like:<\/p>\n<p><\/p>\n<img src=\"https:\/\/puu.sh\/vWQ72\/a0f6b685eb.png\" \/> \n<p><\/p>\n\n<p>You can count the number of nodes left in the tree after each operation, and they form the output, which is 3, 2, 5, 2, 5, 11.<\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"2","source_sizelimit":"50000","problem_author":"deadwing97","problem_author_html_handle":"deadwing97","problem_tester":"kingofnumbers","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>kingofnumbers<\/span>","date_added":"21-05-2017","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/deadwing97'>\n                    deadwing97\n                <\/a>","user":{"username":null},"time":{"view_start_date":1495391400,"submit_start_date":1495391400,"visible_start_date":1495391400,"end_date":1735669800,"current":1497589508},"todo":false,"problem_status":"unattempted"}