{"category_name":"hard","status":"success","problem_code":"TREEQ1","problem_name":"Tree Query","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/hindi\/TREEQ1.pdf),[Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/bengali\/TREEQ1.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/mandarin\/TREEQ1.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/russian\/TREEQ1.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/vietnamese\/TREEQ1.pdf) as well.\r\n\r\n\r\nYou are given a tree with $N$ vertices (numbered $1$ through $N$); vertex $1$ is the root. Initially, for each valid $i$, the $i$-th vertex has a weight $w_i$. You should perform a sequence of $Q$ operations of the following two types:\r\n1. Add $x$ to the weight of vertex $v$.\r\n2. Add $x$ to the weight of each vertex in the subtree of vertex $v$ (including $v$).\r\n\r\nLet's define a function $f(u) = \\sum_{i=1}^N w_i \\cdot d(i, u)$, where $d(i, u)$ denotes the distance between vertices $i$ and $u$. After each operation, find an integer $u$ such that $f(u)$ is minimum amoung $f(1), f(2), \\ldots, f(N)$, if there are multiple values of $u$ find smallest one.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $w_1, w_2, \\ldots, w_N$.\r\n- $N-1$ lines follow. Each of these lines contains two space-separated integers $u$ and $v$ denoting that vertices $u$ and $v$ are connected by an edge.\r\n- Each of the next $Q$ lines contains three space-separated integers $t$, $v$ and $x$ describing one operation, where $t$ denotes the type of the operation.\r\n\r\n### Output\r\nPrint $Q$ lines. For each valid $i$, the $i$-th of these lines should contain one integer $u$ such that $f(u)$ is minimum among $f(1), f(2), \\ldots, f(N)$ after the $i$-th operation, if there are multiple values of $u$ find smallest one.\r\n\r\n### Constraints\r\n- $1 \\le N, Q \\le 10^5$\r\n- $1 \\le w_i \\le 10^7$ for each valid $i$\r\n- $|x| \\le 10^7$\r\n- the weights of all vertices remain positive after each operation\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** $N, Q \\le 10^3$\r\n\r\n**Subtask #2 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n5 2\r\n5 5 5 5 10\r\n1 2\r\n2 3\r\n3 4\r\n3 5\r\n1 5 -5\r\n2 4 50\r\n```\r\n\r\n### Example Output\r\n```\r\n3\r\n4\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/hindi\/TREEQ1.pdf),[Bengali](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/bengali\/TREEQ1.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/mandarin\/TREEQ1.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/russian\/TREEQ1.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/LTIME79\/vietnamese\/TREEQ1.pdf) as well.\r\n\r\n\r\nYou are given a tree with $N$ vertices (numbered $1$ through $N$); vertex $1$ is the root. Initially, for each valid $i$, the $i$-th vertex has a weight $w_i$. You should perform a sequence of $Q$ operations of the following two types:\r\n1. Add $x$ to the weight of vertex $v$.\r\n2. Add $x$ to the weight of each vertex in the subtree of vertex $v$ (including $v$).\r\n\r\nLet's define a function $f(u) = \\sum_{i=1}^N w_i \\cdot d(i, u)$, where $d(i, u)$ denotes the distance between vertices $i$ and $u$. After each operation, find an integer $u$ such that $f(u)$ is minimum amoung $f(1), f(2), \\ldots, f(N)$, if there are multiple values of $u$ find smallest one.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $Q$.\r\n- The second line contains $N$ space-separated integers $w_1, w_2, \\ldots, w_N$.\r\n- $N-1$ lines follow. Each of these lines contains two space-separated integers $u$ and $v$ denoting that vertices $u$ and $v$ are connected by an edge.\r\n- Each of the next $Q$ lines contains three space-separated integers $t$, $v$ and $x$ describing one operation, where $t$ denotes the type of the operation.\r\n\r\n### Output\r\nPrint $Q$ lines. For each valid $i$, the $i$-th of these lines should contain one integer $u$ such that $f(u)$ is minimum among $f(1), f(2), \\ldots, f(N)$ after the $i$-th operation, if there are multiple values of $u$ find smallest one.\r\n\r\n### Constraints\r\n- $1 \\le N, Q \\le 10^5$\r\n- $1 \\le w_i \\le 10^7$ for each valid $i$\r\n- $|x| \\le 10^7$\r\n- the weights of all vertices remain positive after each operation\r\n\r\n### Subtasks\r\n**Subtask #1 (50 points):** $N, Q \\le 10^3$\r\n\r\n**Subtask #2 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"5 2\r\n5 5 5 5 10\r\n1 2\r\n2 3\r\n3 4\r\n3 5\r\n1 5 -5\r\n2 4 50","output":"3\r\n4","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"3","source_sizelimit":"50000","problem_author":"chemthan","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>chemthan<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"25-12-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/chemthan'>chemthan<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"","editorial_url":"","time":{"view_start_date":1577552402,"submit_start_date":1577552402,"visible_start_date":1577552402,"end_date":1735669800,"current":1643798003},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=TREEQ1","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}