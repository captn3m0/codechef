{"category_name":"hard","status":"success","problem_code":"SEAINVS","problem_name":"Sereja and Inversions","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB17\/mandarin\/SEAINVS.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB17\/russian\/SEAINVS.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB17\/vietnamese\/SEAINVS.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>Sereja has a permutation <b>P<\/b> of the <b>N<\/b> numbers in the range <b>1<\/b> to <b>N<\/b>. You have to answer <b>M<\/b> queries over it, where each query is given four numbers <b>l<sub>1<\/sub>, r<sub>1<\/sub>, l<sub>2<\/sub>, r<sub>2<\/sub> (1 \u2264 l<sub>1<\/sub> \u2264 r<sub>1<\/sub> < l<sub>2<\/sub> \u2264 r<sub>2<\/sub> \u2264 N, r<sub>1<\/sub> - l<sub>1<\/sub> = r<sub>2<\/sub> - l<sub>2<\/sub>)<\/b>. Your task is to calculate number of permutations <b>Q<\/b> of the <b>S<\/b> integers in the range <b>1<\/b> to <b>S<\/b>, such that <b>S = r<sub>1<\/sub> - l<sub>1<\/sub> + 1<\/b>, and for each <b>i<\/b> from <b>1<\/b> to <b>S<\/b>, the condition <b>P<sub>Q<sub>i<\/sub> + l<sub>1<\/sub> - 1<\/sub> < P<sub>i + l<sub>2<\/sub> - 1<\/sub><\/b> is satisfied.\n\n<p>Please help Sereja in providing the answer for each query modulo <b>10<sup>9<\/sup> + 7<\/b>.\n\n<h3>Input<\/h3>\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/p>\n<p>First line of each test case contains two space separated integers <b>N, M<\/b>.<\/p>\n<p>Next line contains numbers <b>P<sub>1<\/sub>, P<sub>2<\/sub>, ..., P<sub>N<\/sub><\/b>.<\/p>\n<p>Each of next <b>M<\/b> lines contains numbers <b>l<sub>1<\/sub>, r<sub>1<\/sub>, l<sub>2<\/sub>, r<sub>2<\/sub><\/b> - denoting the query.<\/p>\n\n<h3>Output<\/h3>\n<p>For each query, output the corresponding answer in single line.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>10<\/b><\/li>\n<li><b>1<\/b> \u2264 sum of all <b>N<\/b> over all test cases \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 sum of all <b>M<\/b> over all test cases \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<\/ul>\n\n<h3>Subtasks<\/h3>\n<ul>\n<li><b>Subtask #1: (10 points)<\/b> <b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>10<\/b><\/li>\n<li><b>Subtask #2: (20 points)<\/b> <b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>1000<\/b><\/li>\n<li><b>Subtask #3: (70 points)<\/b> original constraints plus additionally <b>0<\/b> \u2264 number of pairs <b>i, j (1 \u2264 i < j \u2264 N, P<sub>i<\/sub> > P<sub>j<\/sub>)<\/b> over all test cases \u2264 <b>3*10<sup>6<\/sup><\/b><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n3\n4 1\n1 2 3 4\n1 2 3 4\n4 2\n1 3 2 4\n1 1 2 2\n1 2 3 4\n10 1\n1 4 3 2 9 5 6 7 10 8\n1 5 6 10\n\n<b>Output:<\/b>\n2\n1\n1\n24\n<\/pre>\n\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"2","source_sizelimit":"50000","problem_author":"sereja","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>sereja<\/span>","problem_tester":"mgch","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>mgch<\/span>","date_added":"16-10-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/sereja'>\n                    sereja\n                <\/a>","user":{"username":null},"time":{"view_start_date":1487496600,"submit_start_date":1487496600,"visible_start_date":1487496600,"end_date":1735669800,"current":1493556831},"todo":false,"problem_status":"unattempted"}