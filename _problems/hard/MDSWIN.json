{"category_name":"hard","status":"success","problem_code":"MDSWIN","problem_name":"Winning Ways","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/NOV19\/hindi\/MDSWIN.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/NOV19\/bengali\/MDSWIN.pdf), and [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/NOV19\/mandarin\/MDSWIN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/NOV19\/russian\/MDSWIN.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/NOV19\/vietnamese\/MDSWIN.pdf) as well.\r\n\r\nWelcome to the finals of Chef's Combinatorial Games Competition 2019! The finalists Irshad and Mehedi are ready to play against each other no matter what game is given. As it is the final round, Chef prepared a completely new game with the following rules:\r\n- There are $K$ stacks of stones (numbered $1$ through $K$). For each valid $i$, the $i$-th stack has a *threshold* $H_i$.\r\n- Initially, each stack contains one stone.\r\n- The players alternate turns; Irshad plays first.\r\n- During each turn, the current player must choose one or two stacks and make a move in each chosen stack.\r\n- To make a move in a stack $i$ containing $x$ stones at the beginning of the current turn, the current player must add one or more stones to this stack in such a way that the resulting number of stones $y$ ($y \\gt x$) divides that stack's threshold $H_i$. (If this stack already contains $H_i$ stones, it is impossible to make a move.)\r\n- When it is impossible to make a move in any stack, the current player loses the game.\r\n\r\nOf course, Irshad and Mehedi are brilliant programmers, so they can easily play this game optimally for given thresholds. Therefore, to spice up the game, Chef chose $K$ people from the audience and gave one stack to each of them. He also provided a set $S = \\{x_1, x_2, \\ldots, x_N\\}$. Each of the chosen people should uniformly randomly, independently from all other people, choose the threshold of his\/her stack from the set $S$.\r\n\r\nWhile this is happening, Irshad asks you: \"Hey, in how many ways can these people set the thresholds such that I win?\" You need to find the answer modulo $1,000,000,007$ ($10^9+7$).\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- $N$ lines follow. For each valid $i$, the $i$-th of these lines contains a single integer $x_i$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the number of ways to choose the thresholds such that Irshad wins, modulo $1,000,000,007$ ($10^9+7$).\r\n\r\n### Constraints\r\n- $1 \\le T \\le 5$\r\n- $1 \\le N \\le 100,000$\r\n- $1 \\le K \\le 10^9$\r\n- $1 \\le x_i \\le 10^9$ for each valid $i$\r\n- $x_1, x_2, \\ldots, x_N$ are pairwise distinct\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $N, K \\le 12$\r\n- $x_i \\le 12$ for each valid $i$\r\n\r\n**Subtask #2 (30 points):**\r\n- $N, K \\le 50,000$\r\n- $x_i \\le 50,000$ for each valid $i$\r\n\r\n**Subtask #3 (60 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n1\r\n2 3\r\n2\r\n4\r\n```\r\n\r\n### Example Output\r\n```\r\n6\r\n```\r\n\r\n### Explanation\r\n**Example case 1:** There are two choices of thresholds that are losing for Irshad: $(2, 2, 2)$ and $(4, 4, 4)$. If these thresholds are used, Mehedi always wins regarless of Irshad's moves. All six remaining choices are winning for Irshad.\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/NOV19\/hindi\/MDSWIN.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/NOV19\/bengali\/MDSWIN.pdf), and [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/NOV19\/mandarin\/MDSWIN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/NOV19\/russian\/MDSWIN.pdf), and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/NOV19\/vietnamese\/MDSWIN.pdf) as well.\r\n\r\nWelcome to the finals of Chef's Combinatorial Games Competition 2019! The finalists Irshad and Mehedi are ready to play against each other no matter what game is given. As it is the final round, Chef prepared a completely new game with the following rules:\r\n- There are $K$ stacks of stones (numbered $1$ through $K$). For each valid $i$, the $i$-th stack has a *threshold* $H_i$.\r\n- Initially, each stack contains one stone.\r\n- The players alternate turns; Irshad plays first.\r\n- During each turn, the current player must choose one or two stacks and make a move in each chosen stack.\r\n- To make a move in a stack $i$ containing $x$ stones at the beginning of the current turn, the current player must add one or more stones to this stack in such a way that the resulting number of stones $y$ ($y \\gt x$) divides that stack's threshold $H_i$. (If this stack already contains $H_i$ stones, it is impossible to make a move.)\r\n- When it is impossible to make a move in any stack, the current player loses the game.\r\n\r\nOf course, Irshad and Mehedi are brilliant programmers, so they can easily play this game optimally for given thresholds. Therefore, to spice up the game, Chef chose $K$ people from the audience and gave one stack to each of them. He also provided a set $S = \\{x_1, x_2, \\ldots, x_N\\}$. Each of the chosen people should uniformly randomly, independently from all other people, choose the threshold of his\/her stack from the set $S$.\r\n\r\nWhile this is happening, Irshad asks you: \"Hey, in how many ways can these people set the thresholds such that I win?\" You need to find the answer modulo $1,000,000,007$ ($10^9+7$).\r\n\r\n### Input\r\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\r\n- The first line of each test case contains two space-separated integers $N$ and $K$.\r\n- $N$ lines follow. For each valid $i$, the $i$-th of these lines contains a single integer $x_i$.\r\n\r\n### Output\r\nFor each test case, print a single line containing one integer \u2015 the number of ways to choose the thresholds such that Irshad wins, modulo $1,000,000,007$ ($10^9+7$).\r\n\r\n### Constraints\r\n- $1 \\le T \\le 5$\r\n- $1 \\le N \\le 100,000$\r\n- $1 \\le K \\le 10^9$\r\n- $1 \\le x_i \\le 10^9$ for each valid $i$\r\n- $x_1, x_2, \\ldots, x_N$ are pairwise distinct\r\n\r\n### Subtasks\r\n**Subtask #1 (10 points):**\r\n- $N, K \\le 12$\r\n- $x_i \\le 12$ for each valid $i$\r\n\r\n**Subtask #2 (30 points):**\r\n- $N, K \\le 50,000$\r\n- $x_i \\le 50,000$ for each valid $i$\r\n\r\n**Subtask #3 (60 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"1\r\n2 3\r\n2\r\n4","output":"6","explanation":"**Example case 1:** There are two choices of thresholds that are losing for Irshad: $(2, 2, 2)$ and $(4, 4, 4)$. If these thresholds are used, Mehedi always wins regarless of Irshad's moves. All six remaining choices are winning for Irshad.","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"7","source_sizelimit":"50000","problem_author":"upobir","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>upobir<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"1-10-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/challenge'>challenge<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nim'>nim<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nov19'>nov19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/transformation'>transformation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/upobir'>upobir<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/watcher'>watcher<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MDSWIN","time":{"view_start_date":1573464602,"submit_start_date":1573464602,"visible_start_date":1573464602,"end_date":1735669800,"current":1643797997},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=MDSWIN","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}