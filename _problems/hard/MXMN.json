{"category_name":"hard","status":"success","problem_code":"MXMN","problem_name":"Maximum and Minimum","body":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JULY19\/hindi\/MXMN.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY19\/bengali\/MXMN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/mandarin\/MXMN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY19\/russian\/MXMN.pdf) and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/vietnamese\/MXMN.pdf) as well.\r\n\r\nChef loves graphs. To express his love, he defines a function $f(G, x, y)$ for an undirected connected graph $G$ with weighted edges and two of its vertices $x$, $y$. $f(G, x, y)$ is defined as the minimum of weights of all paths in $G$ between the vertices $x$ and $y$, where the weight of a path is the maximum of weights of edges in this path.\r\n\r\nChef has two connected graphs $G_1$ and $G_2$. Each of these graphs has $N$ vertices (labelled $1$ through $N$) and $M$ edges. Calculate $$S = \\sum_{i=1}^{N-1} \\sum_{j=i+1}^N f(G_1, i, j) \\cdot f(G_2, i, j)$$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $M$.\r\n- $M$ lines follow. Each of these lines contains three space-separated integers $u$, $v$ and $w$ denoting that vertices $u$ and $v$ in $G_1$ are connected by an edge with weight $w$.\r\n- $M$ more lines follow. Each of these lines contains three space-separated integers $u$, $v$ and $w$ denoting that vertices $u$ and $v$ in $G_2$ are connected by an edge with weight $w$.\r\n\r\n### Output\r\nPrint a single line containing one integer \u2014 the sum $S$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le N \\le 10^5$\r\n- $M = 2N$\r\n- $1 \\le u, v \\le N$\r\n- $1 \\le w \\le 10^8$\r\n- $G_1$ and $G_2$ are connected graphs\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points):** $N = 2,000$\r\n\r\n**Subtask #2 (30 points):**\r\n- $N = 10^5$\r\n- $G_1$ and $G_2$ are identical graphs\r\n\r\n**Subtask #3 (50 points):** original constraints\r\n\r\n### Example Input\r\n```\r\n3 6\r\n1 2 3\r\n2 3 1\r\n3 1 2\r\n1 2 4\r\n2 3 5\r\n3 1 6\r\n1 2 2\r\n2 3 1\r\n3 1 3\r\n1 2 5\r\n2 3 4\r\n3 1 6\r\n```\r\n\r\n### Example Output\r\n```\r\n9\r\n```\r\n\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.<\/div><\/aside>","problemComponents":{"constraints":"","constraintsState":false,"subtasks":"","subtasksState":false,"statement":"### Read problem statements in [Hindi](https:\/\/www.codechef.com\/download\/translated\/JULY19\/hindi\/MXMN.pdf), [Bengali](https:\/\/www.codechef.com\/download\/translated\/JULY19\/bengali\/MXMN.pdf), [Mandarin Chinese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/mandarin\/MXMN.pdf), [Russian](https:\/\/www.codechef.com\/download\/translated\/JULY19\/russian\/MXMN.pdf) and [Vietnamese](https:\/\/www.codechef.com\/download\/translated\/JULY19\/vietnamese\/MXMN.pdf) as well.\r\n\r\nChef loves graphs. To express his love, he defines a function $f(G, x, y)$ for an undirected connected graph $G$ with weighted edges and two of its vertices $x$, $y$. $f(G, x, y)$ is defined as the minimum of weights of all paths in $G$ between the vertices $x$ and $y$, where the weight of a path is the maximum of weights of edges in this path.\r\n\r\nChef has two connected graphs $G_1$ and $G_2$. Each of these graphs has $N$ vertices (labelled $1$ through $N$) and $M$ edges. Calculate $$S = \\sum_{i=1}^{N-1} \\sum_{j=i+1}^N f(G_1, i, j) \\cdot f(G_2, i, j)$$ modulo $998,244,353$.\r\n\r\n### Input\r\n- The first line of the input contains two space-separated integers $N$ and $M$.\r\n- $M$ lines follow. Each of these lines contains three space-separated integers $u$, $v$ and $w$ denoting that vertices $u$ and $v$ in $G_1$ are connected by an edge with weight $w$.\r\n- $M$ more lines follow. Each of these lines contains three space-separated integers $u$, $v$ and $w$ denoting that vertices $u$ and $v$ in $G_2$ are connected by an edge with weight $w$.\r\n\r\n### Output\r\nPrint a single line containing one integer \u2014 the sum $S$ modulo $998,244,353$.\r\n\r\n### Constraints\r\n- $1 \\le N \\le 10^5$\r\n- $M = 2N$\r\n- $1 \\le u, v \\le N$\r\n- $1 \\le w \\le 10^8$\r\n- $G_1$ and $G_2$ are connected graphs\r\n\r\n### Subtasks\r\n**Subtask #1 (20 points):** $N = 2,000$\r\n\r\n**Subtask #2 (30 points):**\r\n- $N = 10^5$\r\n- $G_1$ and $G_2$ are identical graphs\r\n\r\n**Subtask #3 (50 points):** original constraints","inputFormat":"","inputFormatState":false,"outputFormat":"","outputFormatState":false,"sampleTestCases":[{"id":"1","input":"3 6\r\n1 2 3\r\n2 3 1\r\n3 1 2\r\n1 2 4\r\n2 3 5\r\n3 1 6\r\n1 2 2\r\n2 3 1\r\n3 1 3\r\n1 2 5\r\n2 3 4\r\n3 1 6","output":"9","explanation":"","isDeleted":false}]},"video_editorial_url":"","languages_supported":"CPP14, C, JAVA, PYTH 3.6, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, kotlin, BASH, JS, LISP sbcl, rust, PAS gpc, BF, CLOJ, R, D, CAML, FORT, ASM, swift, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, ICK, NICE, PRLG, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM","max_timelimit":"4","source_sizelimit":"50000","problem_author":"nqiiii","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span class='m-username--link'>nqiiii<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"14-06-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/auxiliary-tree'>auxiliary-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/centroid-decomposition'>centroid-decomposition<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/july19'>july19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nqiiii'>nqiiii<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/trees'>trees<\/a>","problem_difficulty_level":"Hard","user_zen_mode":false,"best_tag":"Centroid Decomposition","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MXMN","time":{"view_start_date":1563183002,"submit_start_date":1563183002,"visible_start_date":1563183002,"end_date":1735669800,"current":1643797997},"user":{"username":null,"access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false,"problemDiscussURL":"https:\/\/discuss.codechef.com\/search?q=MXMN","is_proctored":false,"is_user_verified_for_proctoring":null,"visitedContests":[]}