{"category_name":"hard","status":"success","problem_code":"CHNBGMT","problem_name":"Chef and Big Matrix","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/APRIL16\/mandarin\/CHNBGMT.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/APRIL16\/russian\/CHNBGMT.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/APRIL16\/vietnamese\/CHNBGMT.pdf\">Vietnamese<\/a> as well.<\/h3>\n<p>Chef has a rectangular table consisting of <b>N<\/b> rows and <b>M<\/b> columns. Rows are numbered by integers from 1 to <b>N<\/b> from top to bottom and columns are numbered from 1 to <b>M<\/b> from left to right. Let <b>(x, y)<\/b> denote the cell corresponding to <b>x<sup>th<\/sup><\/b> row and <b>y<sup>th<\/sup><\/b> column.<\/p>\n<p>Chef has two bunnies, both initially at the cell (1, 1). He wants them to get to the cell (<b>N<\/b>, <b>M<\/b>). Each of the bunny can move from some cell (<b>x<\/b>, <b>y<\/b>) to cell (<b>x<\/b>+1, <b>y<\/b>) or cell (<b>x<\/b>, <b>y<\/b>+1). As bunnies do not really like each other, they do not want to meet along their ways, except at the start <b>(1,1)<\/b> and end (<b>N<\/b>, <b>M<\/b>) cells.\n<\/p>\n<p>Also, there are exactly <b>C<\/b> cells in the table containing a carrot. When a bunny goes through such a cell, he eats this carrot. As Chef also wants to eat carrots, he wants that both the bunnies cumulatively don't eat more than <b>D<\/b> carrots.<\/p>\n<p>\nFind out number of ways in which bunnies can get from cell (1, 1) to cell (<b>N<\/b>, <b>M<\/b>) satisfying the above conditions. As answer could be large, please output your answer modulo <b>MOD<\/b>.\n<\/p>\n<h3>Input<\/h3>\n<ul>\n<li>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/li>\n<li>The first line of each test case contains five space-separated integers <b>N<\/b>, <b>M<\/b>, <b>C<\/b>, <b>D<\/b> and <b>MOD<\/b> denoting the sizes of table, the number of cells with a carrot, the maximum number of carrots that can be eaten by bunnies and the modulo.<\/li>\n<li>Each of next <b>C<\/b> lines contains two space-separated integers <b>x<sub>i<\/sub><\/b> and <b>y<sub>i<\/sub><\/b> denoting the coordinates of the cell with a carrot. <\/li>\n<\/ul>\n<h3>Output<\/h3>\n<ul>\n<li>For each test case, output a single line containing the numbers of ways bunnies can get from cell (1,1) to cell (<b>N<\/b>, <b>M<\/b>) modulo <b>MOD<\/b>.<\/li>\n<\/ul>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>2<\/b> \u2264 <b>N, M<\/b> \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>0<\/b> \u2264 <b>D<\/b> \u2264 <b>C<\/b> \u2264 <b>min{200, N *  M - 2}<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>x<sub>i<\/sub><\/b> \u2264 <b>N<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>y<sub>i<\/sub><\/b> \u2264 <b>M<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>MOD<\/b> \u2264 <b>10<sup>9<\/sup><\/b><\/li>\n<li>It's guaranteed that there is no carrot in cells (1, 1) and (<b>N<\/b>, <b>M<\/b>)<\/li>\n<\/ul>\n<h3>Subtasks<\/h3>\n<p><b>Subtask #1 (7 pts)<\/b><\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>100<\/b><\/li>\n<li><b>2<\/b> \u2264 <b>N, M<\/b> \u2264 <b>5<\/b><\/li>\n<li>TL = 2s<\/li>\n<\/ul>\n<p> <\/p>\n<p><b>Subtask #2 (11 pts)<\/b><\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>10<\/b><\/li>\n<li><b>2<\/b> \u2264 <b>N, M, C<\/b> \u2264 <b>60<\/b><\/li>\n<li>TL = 2s<\/li>\n<\/ul>\n<p> <\/p>\n<p><b>Subtask #3 (13 pts)<\/b><\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>10<\/b><\/li>\n<li><b>C<\/b> = <b>0<\/b><\/li>\n<li>TL = 2s<\/li>\n<\/ul>\n<p> <\/p>\n<p><b>Subtask #4 (19 pts)<\/b><\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>5<\/b><\/li>\n<li><b>0<\/b> \u2264 <b>C<\/b> \u2264 <b>100<\/b><\/li>\n<li>TL = 10s<\/li>\n<\/ul>\n<p> <\/p>\n<p><b>Subtask #5 (23 pts)<\/b><\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>5<\/b><\/li>\n<li><b>0<\/b> \u2264 <b>C<\/b> \u2264 <b>100<\/b><\/li>\n<li>TL = 2s<\/li>\n<\/ul>\n<p> <\/p>\n<p><b>Subtask #6 (27 pts)<\/b><\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>5<\/b><\/li>\n<li>TL = 2s<\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n4\n2 3 0 0 10\n2 3 1 0 16\n2 1\n3 3 1 0 7\n2 2\n2 2 2 1 11\n1 2\n2 1\n\n<b>Output:<\/b>\n1\n0\n1\n0\n<\/pre><h3>Explanation<\/h3>\n<p><b>Example case 1.<\/b><\/p>\n<p><tt>***<\/tt><br \/>\n<tt>***<\/tt><br \/>\nIn this case there is only one variant how bunnies can get from the cell (1,1) to the cell (2, 3). <br \/>\nFirst bunny - (1, 1) -> (2, 1) -> (2, 2) -> (2. 3) and the second bunny - (1, 1) -> (1, 2) -> (1, 3) -> (2, 3).<br \/>\n<\/p>\n<p><b>Example case 2.<\/b><\/p>\n<p><tt>***<\/tt><br \/>\n<tt>x**<\/tt><br \/>\nIn this example there are no two nonintersecting ways without cells with carrot. Therefore the answer is 0.<\/p>\n<p><b>Example case 4.<\/b><\/p>\n<p><tt>*x<\/tt><br \/>\n<tt>x*<\/tt><br \/>\nIn this case there is only one variant how bunnies can move. First bunny - (1, 1) -> (2, 1) -> (2, 2) and the second bunny - (1, 1) -> (1, 2) -> (2, 2). But in this case, in total, bunnies will eat two carrots(when only one carrot is allowed). Therefore the answer is 0.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"2 - 10","source_sizelimit":"50000","problem_author":"antoniuk1","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>antoniuk1<\/span>","problem_tester":"xcwgf666","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","date_added":"8-02-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/antoniuk1'>\n                    antoniuk1\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/april16'>\n                    april16\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/binomial'>\n                    binomial\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/chinese-rem'>\n                    chinese-rem\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/modular-inv'>\n                    modular-inv\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/CHNBGMT","user":{"username":null},"time":{"view_start_date":1460374200,"submit_start_date":1460374200,"visible_start_date":1460374200,"end_date":1735669800,"current":1493556655},"todo":false,"problem_status":"unattempted"}