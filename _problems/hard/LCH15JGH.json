{"category_name":"hard","status":"success","problem_code":"LCH15JGH","problem_name":"Many bananas","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME20\/mandarin\/LCH15JGH.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME20\/russian\/LCH15JGH.pdf\">Russian<\/a>.<\/h3>\n<p>You are a tribal leader and live in jungle with your people. Life of the leader is not easy sometimes. One of your responsibilities is food distribution. Let's consider this process in details.<\/p>\n<p>There are many families in your tribal. The<b>i-th<\/b> family consists of <b>X<sub>i<\/sub><\/b>people. In some moment you give each family <b>Y<\/b> bananas(<b>Y<\/b> is equal for all families independently of its size). All members of family receive equal number of bananas each and this number is maximal with condition that total number of bananas this family have received doesn't exceed <b>Y<\/b>. Of course some bananas of these initial <b>Y<\/b> are left. They are given back to the leader of the tribal(you). In other words each member of family receives <b>floor Y \/ X<sub>i<\/sub><\/b>bananas and <b> Y modulo X<sub>i<\/sub><\/b> are given back to the leader.<\/p>\n<p>. You are interested in total number of bananas you will have after this distribution process.<\/p>\n<p>But things are not so simple. There are many events in life of your tribal. You will have to process many queries of three types:<\/p>\n<ul>\n<li>New family with <b>X<sub>i<\/sub><\/b>members joined your tribal<\/li>\n<li>Some family with <b>X<sub>i<\/sub><\/b>members left your tribal(it's guaranteed that there was such a family before this query).<\/li>\n<li>You give each family in your tribal <b>Y<sub>j<\/sub><\/b> bananas. You want to know the total number of bananas you will have after distribution. <\/li>\n<\/ul>\n<h3>Input<\/h3>\n<p>The first line of input file contains one integer <b>N<\/b> denoting number of different family sizes before queries. Each of next <b>N<\/b>lines contains two space-separated integers <b>A<sub>i<\/sub><\/b> and <b>B<sub>i<\/sub><\/b> denoting size of the family and number of families with such size correspondingly. It's guaranteed that all the <b>A<sub>i<\/sub><\/b> are pairwise different.<br \/>\nThe next line contains one integer <b>M<\/b> denoting the number of queries. Next <b>M<\/b> lines describe one query each and can be one of the three types:<\/p>\n<ul>\n<li>\"+ <b>X<\/b>\" - one family with <b>X<\/b> members joined your tribal<\/li>\n<li>\"- <b>X<\/b>\" - one family with <b>X<\/b> members left your tribal(it's guaranteed that there was such a family before this query).\n<\/li>\n<li>\"? <b>Y<\/b>\" - You give each family in your tribal <b>Y<\/b> bananas. You want to know the total number of bananas you will have after distribution. <\/li>\n<\/ul>\n\n<h3>Output<\/h3>\n<p>For each third type query output one integer per line - answer for this query.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>0<\/b> \u2264 <b>N<\/b> \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>M<\/b> \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>A<sub>i<\/sub><\/b>, <b>B<sub>i<\/sub><\/b>, <b>X<sub>i<\/sub><\/b>, <b>Y<sub>i<\/sub><\/b>\u2264 <b>10<sup>5<\/sup><\/b> <\/li>\n<\/ul>\n<h3> Subtasks <\/h3>\n<p><b>Subtask #1<\/b>[25 points]: <b>M<\/b> &lt; <b>1000<\/b><br \/>\n<b>Subtask #2<\/b>[75 points]:  no additional conditions <\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n3\n1 4\n3 2\n2 2\n6\n? 10\n? 8\n+ 4\n? 9\n- 2\n? 8\n<b>Output:<\/b>\n2\n4\n3\n4\n<\/pre>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1 - 2.5","source_sizelimit":"50000","problem_author":"pavel1996","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>pavel1996<\/span>","problem_tester":"rubanenko","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>rubanenko<\/span>","date_added":"28-12-2014","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/ad-hoc'>\n                    ad-hoc\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/fenwick'>\n                    fenwick\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ltime20'>\n                    ltime20\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/maths'>\n                    maths\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/pavel1996'>\n                    pavel1996\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>\n                    segment-tree\n                <\/a>","user":{"username":null},"time":{"view_start_date":1422174605,"submit_start_date":1422174605,"visible_start_date":1422174600,"end_date":1735669800,"current":1493556981},"todo":false,"problem_status":"unattempted"}